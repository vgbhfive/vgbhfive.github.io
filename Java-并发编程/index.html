<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="https://i.loli.net/2019/12/10/JF3dKDSkZoPz7h6.jpg">
  <link rel="icon" type="image/png" sizes="16x16" href="https://i.loli.net/2019/12/10/JF3dKDSkZoPz7h6.jpg">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">
  <meta name="google-site-verification" content="G-QBK8PCQC9B">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"blog.vgbhfive.cn","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":true,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"gitalk","storage":true,"lazyload":false,"nav":null,"activeClass":"gitalk"},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="并发编程并发这一块的东西，自己之前都是断断续续的一边学一下，一边用一下，都没有很系统的整理一下，所以今天他来了。">
<meta property="og:type" content="article">
<meta property="og:title" content="Java-并发编程">
<meta property="og:url" content="https://blog.vgbhfive.cn/Java-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/index.html">
<meta property="og:site_name" content="Vgbhfive&#39;s Blog">
<meta property="og:description" content="并发编程并发这一块的东西，自己之前都是断断续续的一边学一下，一边用一下，都没有很系统的整理一下，所以今天他来了。">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2019-08-16T00:53:07.000Z">
<meta property="article:modified_time" content="2020-04-29T06:21:32.000Z">
<meta property="article:author" content="vgbhfive">
<meta property="article:tag" content="Java">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://blog.vgbhfive.cn/Java-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>

  <title>Java-并发编程 | Vgbhfive's Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<link rel="alternate" href="/atom.xml" title="Vgbhfive's Blog" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Vgbhfive's Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-pictures">

    <a href="/pictures/" rel="section"><i class="fa fa-th fa-fw"></i>Pictures</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
        <li class="menu-item menu-item-sitemap">

    <a href="/sitemap.xml" rel="section"><i class="fa fa-sitemap fa-fw"></i>Sitemap</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="reading-progress-bar"></div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://blog.vgbhfive.cn/Java-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://i.loli.net/2019/12/10/JF3dKDSkZoPz7h6.jpg">
      <meta itemprop="name" content="vgbhfive">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Vgbhfive's Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Java-并发编程
        </h1>

        <div class="post-meta">
          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2019-08-16 08:53:07" itemprop="dateCreated datePublished" datetime="2019-08-16T08:53:07+08:00">2019-08-16</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-04-29 14:21:32" itemprop="dateModified" datetime="2020-04-29T14:21:32+08:00">2020-04-29</time>
              </span>

          
            <span class="post-meta-item" title="Views" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">Views: </span>
              <span id="busuanzi_value_page_pv"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h2 id="并发编程"><a href="#并发编程" class="headerlink" title="并发编程"></a>并发编程</h2><p>并发这一块的东西，自己之前都是断断续续的一边学一下，一边用一下，都没有很系统的整理一下，所以今天他来了。</p>
<span id="more"></span>

<hr>

<h2 id="NIO"><a href="#NIO" class="headerlink" title="NIO"></a>NIO</h2><p><a target="_blank" rel="noopener" href="https://vgbhfive.cn/Java-NIO/">https://vgbhfive.cn/Java-NIO/</a></p>
<hr>

<h2 id="多线程"><a href="#多线程" class="headerlink" title="多线程"></a>多线程</h2><h3 id="synchronized-关键字"><a href="#synchronized-关键字" class="headerlink" title="synchronized 关键字"></a>synchronized 关键字</h3><p>synchronized 是Java 的关键字，是Java 的内置特性，在JVM 层实现了对临界资源的同步互斥访问，并且通过锁机制实现同步，但synchronized 粒度较大，在处理问题时有很多的局限性，比如响应中断。</p>
<h4 id="具体表现"><a href="#具体表现" class="headerlink" title="具体表现"></a>具体表现</h4><ul>
<li>对于普通方法，锁是当前实例对象。</li>
<li>对于静态同步方法，锁是当前类的Class 对象。</li>
<li>对于同步方法块，锁是Synchronized 括号里的配置对象。</li>
</ul>
<p>当一个线程试图访问同步代码块时，他必须获得锁，在抛出异常或者退出时必须释放锁。</p>
<h4 id="占有锁的线程释放锁"><a href="#占有锁的线程释放锁" class="headerlink" title="占有锁的线程释放锁"></a>占有锁的线程释放锁</h4><ul>
<li>占有锁的线程执行完了该代码块，然后释放对锁的占有。</li>
<li>占有锁的线程发生异常，此时JVM 会自动释放锁。</li>
<li>占有线程进入WAITING 状态时，从而释放锁。</li>
</ul>
<h4 id="Synchronized-实现原理"><a href="#Synchronized-实现原理" class="headerlink" title="Synchronized 实现原理"></a>Synchronized 实现原理</h4><p>Synchronized 的语义底层是通过一个monitor 的对象来完成。<br>JVM 中对于monitor 对象的描述：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Each object is associated with a monitor. A monitor is locked if and only if it has an owner. The thread that executes monitorenter attempts to gain ownership of the monitor associated with objectref, as follows:</span><br><span class="line">• If the entry count of the monitor associated with objectref is zero, the thread enters the monitor and sets its entry count to one. The thread is then the owner of the monitor.</span><br><span class="line">• If the thread already owns the monitor associated with objectref, it reenters the monitor, incrementing its entry count.</span><br><span class="line">• If another thread already owns the monitor associated with objectref, the thread blocks until the monitor&#x27;s entry count is zero, then tries again to gain ownership.</span><br></pre></td></tr></table></figure>
<p>翻译过来就是，每个对象有一个监视器锁(monitor) 。当monitor 被占用时就会处于锁定状态，线程执行monitorenter 指令时尝试获取monitor 的所有权，过程如下：<br>1、如果monitor 的进入数为0，则该线程进入monitor ，然后将进入数设置为1 ，该线程即为monitor 的所有者。<br>2、如果线程已经占有该monitor ，只是重新进入，则进入monitor 的进入数加1.<br>3.如果其他线程已经占用了monitor ，则该线程进入阻塞状态，直到monitor 的进入数为0，再重新尝试获取monitor 的所有权。</p>
<h4 id="Synchronized-与Lock-比较"><a href="#Synchronized-与Lock-比较" class="headerlink" title="Synchronized 与Lock 比较"></a>Synchronized 与Lock 比较</h4><ul>
<li>Lock 是一个接口，是JDK 层面的实现，并且Lock 提供了无条件的、可轮询的、定时的、可中断的锁获取操作，所有的加锁和解锁的方法都是显式的。</li>
<li>synchronized 在发生异常时，会自动释放锁，而Lock 在发生异常时没有释放锁，则会造成死锁现象，因此使用Lock 需要在finally 中释放锁。</li>
<li>Lock 可以让在等待锁的线程响应中断，而synchronized 不行，会一直等待下去，不能响应中断。</li>
<li>通过Lock 可以获知有没有成功获取锁，而synchronized 不行。</li>
<li>Lock 可以提高多个线程进行读操作的效率。</li>
</ul>
<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><p>从性能上说，如果竞争资源不激烈，两者的性能是差不多的。而当竞争激烈时(即大量线程同时竞争) ，此时Lock 的性能远远要比synchronized 强。</p>
<h3 id="volatile-关键字"><a href="#volatile-关键字" class="headerlink" title="volatile 关键字"></a>volatile 关键字</h3><p>一个共享变量(类的成员变量、类的静态成员变量) 被volatile修饰之后，那么就具备了两层语义：</p>
<ul>
<li>保证了不同线程对这个变量进行操作时的可见性，即一个线程修改了某个变量的值，这新值对其他线程来说是立即可见的。</li>
<li>禁止进行指令重排序。</li>
</ul>
<h4 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//线程1</span></span><br><span class="line"><span class="type">boolean</span> <span class="variable">stop</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">while</span>(!stop)&#123;</span><br><span class="line">    doSomething();</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">//线程2</span></span><br><span class="line">stop = <span class="literal">true</span>;</span><br></pre></td></tr></table></figure>
<p>在这段代码中，能够很清楚的明白，线程1 会一直循环下去。这是因为线程1 在启动之时复制了一份stop 的变量到自己的工作内存当中，此时线程2 更新了stop 的值但是线程1 却又无从得知，就造成了线程1 一直循环下去。</p>
<p>使用volatile 关键字之后就不一样了：</p>
<ul>
<li>使用volatile 关键字会强制将修改的值立即写入主存。</li>
<li>使用volatile 关键字的话，当线程2 进行修改时，会导致线程1 的工作内存中缓存变量stop 的缓存行无效(反映到硬件层的话，就是CPU 的L1 或者L2 缓存中对应的缓存行无效)<br>。</li>
<li>由于线程1 的工作内存中缓存变量stop 的缓存行无效，所以线程1 再次读取变量stop 的值时会去主存读取。</li>
</ul>
<p>那么在线程2 修改stop 值时(当然这里包括2个操作，修改线程2工作内存中的值，然后将修改后的值写入内存) ，会使得线程1 的工作内存中缓存变量stop 的缓存行无效，然后线程1 读取时，发现自己的缓存行无效，它会等待缓存行对应的主存地址被更新之后，然后去对应的主存读取最新的值。所以线程1 读取到的就是最新的正确的值。</p>
<h4 id="volatile-原理及实现机制"><a href="#volatile-原理及实现机制" class="headerlink" title="volatile 原理及实现机制"></a>volatile 原理及实现机制</h4><p>下面这段话摘自《深入理解Java虚拟机》<br>“观察加入volatile 关键字和没有加入volatile 关键字时所生成的汇编代码发现，加入volatile 关键字时，会多出一个lock 前缀指令”</p>
<p>lock 前缀指令实际上相当于一个内存屏障(也成内存栅栏) ，内存屏障会提供3个功能：</p>
<ul>
<li>它确保指令重排序时不会把其后面的指令排到内存屏障之前的位置，也不会把前面的指令排到内存屏障的后面；即在执行到内存屏障这句指令时，在它前面的操作已经全部完成。</li>
<li>它会强制将对缓存的修改操作立即写入主存。</li>
<li>如果是写操作，它会导致其他CPU 中对应的缓存行无效。</li>
</ul>
<h4 id="volatile-的疑问"><a href="#volatile-的疑问" class="headerlink" title="volatile 的疑问"></a>volatile 的疑问</h4><ol>
<li><p>如何保证原子性<br>在java 1.5 的java.util.concurrent.atomic 包下提供了一些原子操作类，即对基本数据类型的 自增(加1操作) ，自减(减1操作) 、以及加法操作(加一个数) ，减法操作(减一个数) 进行了封装，保证这些操作是原子性操作。<br>atomic 是利用CAS 来实现原子性操作的(Compare And Swap ) ，CAS 实际上是利用处理器提供的CMPXCHG 指令实现的，而处理器执行CMPXCHG 指令是一个原子性操作。</p>
</li>
<li><p>如何保证有序性<br>volatile 关键字禁止指令重排序有两层意思：</p>
</li>
</ol>
<ul>
<li>当程序执行到volatile 变量的读操作或者写操作时，在其前面的操作的更改肯定全部已经进行，且结果已经对后面的操作可见；在其后面的操作肯定还没有进行；</li>
<li>在进行指令优化时，不能将在对volatile 变量访问的语句放在其后面执行，也不能把volatile 变量后面的语句放到其前面执行。</li>
</ul>
<h4 id="使用场景"><a href="#使用场景" class="headerlink" title="使用场景"></a>使用场景</h4><p>synchronized 关键字是防止多个线程同时执行一段代码，那么就会很影响程序执行效率，而volatile 关键字在某些情况下性能要优于synchronized ，但是要注意volatile 关键字是无法替代synchronized 关键字的，因为volatile 关键字无法保证操作的原子性。</p>
<p>简单来说就是需要保证操作是原子性操作，这样才能保证使用volatile 关键字的程序在并发时能够正确执行。</p>
<h3 id="内存屏障"><a href="#内存屏障" class="headerlink" title="内存屏障"></a>内存屏障</h3><p>JVM内存屏障:(Memory Barrier)，是一种CPU指令，用于控制特定条件下的重排序和内存可见性问题，Java编译器也会根据内存屏障的规则禁止重排序。</p>
<p>硬件共有以下类型：</p>
<ul>
<li>Load 屏障，是x86上的”ifence” 指令，在其他指令前插入ifence 指令，可以让高速缓存中的数据失效，强制当前线程从主内存里面加载数据</li>
<li>Store 屏障，是x86的”sfence” 指令，在其他指令后插入sfence 指令，能让当前线程写入高速缓存中的最新数据更新写入主内存，让其他线程可见。</li>
</ul>
<p>JVM 共有以下几种类型:</p>
<ul>
<li>LoadLoad屏障。</li>
<li>StoreStore屏障。</li>
<li>LoadStore屏障。</li>
<li>StoreLoad屏障。</li>
</ul>
<p>从上述就能看出来，其实就是上面硬件屏障的两两组合。</p>
<h4 id="volatile-内存屏障"><a href="#volatile-内存屏障" class="headerlink" title="volatile 内存屏障"></a>volatile 内存屏障</h4><p>在每个volatile 写操作前插入StoreStore 屏障，这样就能让其他线程修改A 变量后，把修改的值对当前线程可见，在写操作后插入StoreLoad 屏障，这样就能让其他线程获取A 变量的时候，能够获取到已经被当前线程修改的值。<br>在每个volatile 读操作前插入LoadLoad 屏障，这样就能让当前线程获取A变量的时候，保证其他线程也都能获取到相同的值，这样所有的线程读取的数据就一样的，在读操作后插入LoadStore 屏障；这样就能让当前线程在其他线程修改A变量的值之前，获取到主内存里面A变量的的值。</p>
<h3 id="锁"><a href="#锁" class="headerlink" title="锁"></a>锁</h3><h4 id="公平锁-非公平锁"><a href="#公平锁-非公平锁" class="headerlink" title="公平锁&#x2F;非公平锁"></a>公平锁&#x2F;非公平锁</h4><p>公平锁是指多个线程按照申请锁的顺序来获取锁。<br>非公平锁是指多个线程获取锁的顺序并不是按照申请锁的顺序，有可能后申请的线程比先申请的线程优先获取锁。有可能，会造成优先级反转或者饥饿现象。</p>
<p>对于Java ReentrantLock 而言，通过构造函数指定该锁是否是公平锁，默认是非公平锁。非公平锁的优点在于吞吐量比公平锁大。<br>对于Synchronized 而言，也是一种非公平锁。由于其并不像ReentrantLock 是通过AQS 的来实现线程调度，所以并没有任何办法使其变成公平锁。</p>
<h4 id="可重入锁"><a href="#可重入锁" class="headerlink" title="可重入锁"></a>可重入锁</h4><p>可重入锁又名递归锁，是指在同一个线程在外层方法获取锁的时候，在进入内层方法会自动获取锁。说的有点抽象，下面会有一个代码的示例。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title function_">setA</span><span class="params">()</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">	Thread.sleep(<span class="number">1000</span>);</span><br><span class="line">	setB();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title function_">setB</span><span class="params">()</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">	Thread.sleep(<span class="number">1000</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>对于Java ReentrantLock 而言, 他的名字就可以看出是一个可重入锁，其名字是Re entrant Lock 重新进入锁。<br>对于Synchronized 而言,也是一个可重入锁。可重入锁的一个好处是可一定程度避免死锁。如果不是可重入锁的话，setB可能不会被当前线程执行，可能造成死锁</p>
<h4 id="独享锁-共享锁"><a href="#独享锁-共享锁" class="headerlink" title="独享锁&#x2F;共享锁"></a>独享锁&#x2F;共享锁</h4><p>独享锁是指该锁一次只能被一个线程所持有。<br>共享锁是指该锁可被多个线程所持有。</p>
<p>对于Java ReentrantLock 而言，其是独享锁。但是对于Lock 的另一个实现类ReadWriteLock ，其读锁是共享锁，其写锁是独享锁。<br>读锁的共享锁可保证并发读是非常高效的，读写、写读、写写的过程是互斥的。<br>独享锁与共享锁也是通过AQS 来实现的，通过实现不同的方法，来实现独享或者共享。<br>对于Synchronized 而言，当然是独享锁。</p>
<h4 id="互斥锁-读写锁"><a href="#互斥锁-读写锁" class="headerlink" title="互斥锁&#x2F;读写锁"></a>互斥锁&#x2F;读写锁</h4><p>上面讲的独享锁&#x2F;共享锁就是一种广义的说法，互斥锁&#x2F;读写锁就是具体的实现。<br>互斥锁在Java 中的具体实现就是ReentrantLock 。<br>读写锁在Java 中的具体实现就是ReadWriteLock 。</p>
<h4 id="乐观锁-悲观锁"><a href="#乐观锁-悲观锁" class="headerlink" title="乐观锁&#x2F;悲观锁"></a>乐观锁&#x2F;悲观锁</h4><p>乐观锁与悲观锁不是指具体的什么类型的锁，而是指看待并发同步的角度。<br>悲观锁认为对于同一个数据的并发操作，一定是会发生修改的，哪怕没有修改，也会认为修改。因此对于同一个数据的并发操作，悲观锁采取加锁的形式。悲观的认为，不加锁的并发操作一定会出问题。<br>乐观锁则认为对于同一个数据的并发操作，是不会发生修改的。在更新数据的时候，会采用尝试更新，不断重新的方式更新数据。乐观的认为，不加锁的并发操作是没有事情的。</p>
<p>从上面的描述我们可以看出，悲观锁适合写操作非常多的场景，乐观锁适合读操作非常多的场景，不加锁会带来大量的性能提升。<br>悲观锁在Java 中的使用，就是利用各种锁。<br>乐观锁在Java 中的使用，是无锁编程，常常采用的是CAS算法，典型的例子就是原子类，通过CAS 自旋实现原子操作的更新。</p>
<h4 id="分段锁"><a href="#分段锁" class="headerlink" title="分段锁"></a>分段锁</h4><p>分段锁其实是一种锁的设计，并不是具体的一种锁，对于ConcurrentHashMap 而言，其并发的实现就是通过分段锁的形式来实现高效的并发操作。</p>
<p>我们以ConcurrentHashMap 来说一下分段锁的含义以及设计思想，ConcurrentHashMap 中的分段锁称为Segment ，它即类似于HashMap (JDK7与JDK8中HashMap 的实现) 的结构，即内部拥有一个Entry 数组，数组中的每个元素又是一个链表；同时又是一个ReentrantLock(Segment 继承了ReentrantLock )。<br>当需要put 元素的时候，并不是对整个hashmap 进行加锁，而是先通过hashcode 来知道他要放在那一个分段中，然后对这个分段进行加锁，所以当多线程put 的时候，只要不是放在一个分段中，就实现了真正的并行的插入。<br>但是，在统计size 的时候，可就是获取hashmap 全局信息的时候，就需要获取所有的分段锁才能统计。</p>
<p>分段锁的设计目的是细化锁的粒度，当操作不需要更新整个数组的时候，就仅仅针对数组中的一项进行加锁操作。</p>
<h4 id="偏向锁-轻量级锁-重量级锁"><a href="#偏向锁-轻量级锁-重量级锁" class="headerlink" title="偏向锁&#x2F;轻量级锁&#x2F;重量级锁"></a>偏向锁&#x2F;轻量级锁&#x2F;重量级锁</h4><p>这三种锁是指锁的状态，并且是针对Synchronized 。在Java 5通过引入锁升级的机制来实现高效Synchronized 。这三种锁的状态是通过对象监视器在对象头中的字段来表明的。</p>
<p>偏向锁是指一段同步代码一直被一个线程所访问，那么该线程会自动获取锁。降低获取锁的代价。<br>轻量级锁是指当锁是偏向锁的时候，被另一个线程所访问，偏向锁就会升级为轻量级锁，其他线程会通过自旋的形式尝试获取锁，不会阻塞，提高性能。<br>重量级锁是指当锁为轻量级锁的时候，另一个线程虽然是自旋，但自旋不会一直持续下去，当自旋一定次数的时候，还没有获取到锁，就会进入阻塞，该锁膨胀为重量级锁。重量级锁会让其他申请的线程进入阻塞，性能降低。</p>
<h4 id="自旋锁"><a href="#自旋锁" class="headerlink" title="自旋锁"></a>自旋锁</h4><p>在Java 中，自旋锁是指尝试获取锁的线程不会立即阻塞，而是采用循环的方式去尝试获取锁，这样的好处是减少线程上下文切换的消耗，缺点是循环会消耗CPU 。</p>
<h3 id="线程池"><a href="#线程池" class="headerlink" title="线程池"></a>线程池</h3><p>java.uitl.concurrent.ThreadPoolExecutor 类是线程池中最核心的一个类，详细了解并使用以下这个类就基本上可以了。</p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/dolphin0520/p/3932921.html">推荐这篇博客</a></p>
<h3 id="线程、进程间通信"><a href="#线程、进程间通信" class="headerlink" title="线程、进程间通信"></a>线程、进程间通信</h3><p>进程是具有一定独立功能的程序、它是系统进行资源分配和调度的一个独立单位，重点在系统调度和单独的单位，也就是说进程是可以独立运行的一段程序。<br>线程是进程的一个实体，是CPU 调度和分派的基本单位，他是比进程更小的能独立运行的基本单位，线程自己基本上不拥有系统资源。在运行时，只是暂用一些计数器、寄存器和栈。</p>
<h4 id="进程、线程之间的关系"><a href="#进程、线程之间的关系" class="headerlink" title="进程、线程之间的关系"></a>进程、线程之间的关系</h4><ul>
<li>一个线程只能属于一个进程，而一个进程可以有多个线程，但至少有一个线程(通常说的主线程)<br>。</li>
<li>资源分配给进程，同一进程的所有线程共享该进程的所有资源。</li>
<li>线程在执行过程中，需要协作同步。不同进程的线程间要利用消息通信的办法实现同步。</li>
<li>处理机分给线程，即真正在处理机上运行的是线程。</li>
<li>线程是指进程内的一个执行单元，也是进程内的可调度实体。</li>
</ul>
<p>区别：</p>
<ul>
<li>调度：线程作为调度和分配的基本单位，进程作为拥有资源的基本单位。</li>
<li>并发性：不仅进程之间可以并发执行，同一个进程的多个线程之间也可以并发执行。</li>
<li>拥有资源：进程是拥有资源的一个独立单位，线程不拥有系统资源，但可以访问隶属于进程的资源。</li>
</ul>
<h4 id="多线程间通信方式"><a href="#多线程间通信方式" class="headerlink" title="多线程间通信方式"></a>多线程间通信方式</h4><ul>
<li>共享变量 (volatile)</li>
<li>wait&#x2F;notify 机制 (synchronized)</li>
<li>Lock&#x2F;Condition 机制 (Lock)</li>
<li>管道流 (pip 流)</li>
</ul>
<h4 id="进程间通信方式"><a href="#进程间通信方式" class="headerlink" title="进程间通信方式"></a>进程间通信方式</h4><ul>
<li>管道(Pipe)</li>
<li>命名管道(named pipe) </li>
<li>信号(Signal) </li>
<li>消息(Message) 队列</li>
<li>共享内存</li>
<li>内存映射(mapped memory) </li>
<li>信号量(semaphore)</li>
<li>套接口(Socket)</li>
</ul>
<hr>

<h2 id="并发"><a href="#并发" class="headerlink" title="并发"></a>并发</h2><hr>

<h2 id="实战"><a href="#实战" class="headerlink" title="实战"></a>实战</h2><h3 id="Vert-x"><a href="#Vert-x" class="headerlink" title="Vert.x"></a>Vert.x</h3><p><a target="_blank" rel="noopener" href="https://github.com/vgbhfive/VertxDemo">https://github.com/vgbhfive/VertxDemo</a></p>
<h3 id="100W-TPS-秒杀系统"><a href="#100W-TPS-秒杀系统" class="headerlink" title="100W TPS 秒杀系统"></a>100W TPS 秒杀系统</h3><p>秒杀场景一般会在电商网站举行一些活动或者节假日在12306网站上抢票时遇到。对于电商网站中一些稀缺或者特价商品，电商网站一般会在约定时间点对其进行限量销售，因为这些商品的特殊性，会吸引大量用户前来抢购，并且会在约定的时间点同时在秒杀页面进行抢购。</p>
<h4 id="设计理念"><a href="#设计理念" class="headerlink" title="设计理念"></a>设计理念</h4><ul>
<li>限流： 鉴于只有少部分用户能够秒杀成功，所以要限制大部分流量，只允许少部分流量进入服务后端。</li>
<li>削峰： 对于秒杀系统瞬时会有大量用户涌入，所以在抢购一开始会有很高的瞬间峰值。高峰值流量是压垮系统很重要的原因，所以如何把瞬间的高流量变成一段时间平稳的流量也是设计秒杀系统很重要的思路。实现削峰的常用的方法有利用缓存和消息中间件等技术。</li>
<li>异步处理： 秒杀系统是一个高并发系统，采用异步处理模式可以极大地提高系统并发量，其实异步处理就是削峰的一种实现方式。</li>
<li>内存缓存： 秒杀系统最大的瓶颈一般都是数据库读写，由于数据库读写属于磁盘IO，性能很低，如果能够把部分数据或业务逻辑转移到内存缓存，效率会有极大地提升。</li>
<li>可拓展： 当然如果我们想支持更多用户，更大的并发，最好就将系统设计成弹性可拓展的，如果流量来了，拓展机器就好了。像淘宝、京东等双十一活动时会增加大量机器应对交易高峰。</li>
</ul>
<h4 id="设计思路"><a href="#设计思路" class="headerlink" title="设计思路"></a>设计思路</h4><p>前端：</p>
<ul>
<li>页面静态化：将活动页面上的所有可以静态的元素全部静态化，并尽量减少动态元素。通过CDN来抗峰值。 </li>
<li>禁止重复提交：用户提交之后按钮置灰，禁止重复提交。</li>
<li>用户限流：在某一时间段内只允许用户提交一次请求，比如可以采取IP限流。</li>
</ul>
<p>后端：</p>
<ul>
<li>限制uid（UserID）访问频率：我们上面拦截了浏览器访问的请求，但针对某些恶意攻击或其它插件，在服务端控制层需要针对同一个访问uid，限制访问频率。</li>
<li>服务层<br> 采用消息队列缓存请求：既然服务层知道库存只有100台手机，那完全没有必要把100W个请求都传递到数据库啊，那么可以先把这些请求都写到消息队列缓存一下，数据库层订阅消息减库存，减库存成功的请求返回秒杀成功，失败的返回秒杀结束。<br> 利用缓存应对读请求：对类似于12306等购票业务，是典型的读多写少业务，大部分请求是查询请求，所以可以利用缓存分担数据库压力。</li>
<li>利用缓存应对写请求：缓存也是可以应对写请求的，比如我们就可以把数据库中的库存数据转移到Redis缓存中，所有减库存操作都在Redis中进行，然后再通过后台进程把Redis中的用户秒杀请求同步到数据库中。</li>
<li>数据库层是最脆弱的一层，一般在应用设计时在上游就需要把请求拦截掉，数据库层只承担“能力范围内”的访问请求。所以，上面通过在服务层引入队列和缓存，让最底层的数据库高枕无忧。</li>
</ul>
<h4 id="案例"><a href="#案例" class="headerlink" title="案例"></a>案例</h4><p>Redis 是一个分布式缓存系统，支持多种数据结构，我们可以利用Redis 轻松实现一个强大的秒杀系统。</p>
<p>我们可以采用Redis 最简单的key-value 数据结构，用一个原子类型的变量值(AtomicInteger )作为key，把用户id 作为value ，库存数量便是原子变量的最大值。对于每个用户的秒杀，我们使用 RPUSH key value 插入秒杀请求， 当插入的秒杀请求数达到上限时，停止所有后续插入。</p>
<p>然后我们可以在台启动多个工作线程，使用 LPOP key 读取秒杀成功者的用户id ，然后再操作数据库做最终的下订单减库存操作。</p>
<p>当然，上面Redis 也可以替换成消息中间件如ActiveMQ、RabbitMQ 等，也可以将缓存和消息中间件组合起来，缓存系统负责接收记录用户请求，消息中间件负责将缓存中的请求同步到数据库。</p>
<hr>

<h2 id="引用"><a href="#引用" class="headerlink" title="引用"></a>引用</h2><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/dolphin0520/p/3920373.html">https://www.cnblogs.com/dolphin0520/p/3920373.html</a></p>
<hr>

<h2 id="总结-1"><a href="#总结-1" class="headerlink" title="总结"></a>总结</h2><p>这一块的东西感觉怎么说呢，还是需要多动手的，毕竟代码是写出来的，不是说出来的。</p>
<hr>

<h2 id="个人备注"><a href="#个人备注" class="headerlink" title="个人备注"></a>个人备注</h2><p><strong>此博客内容均为作者学习所做笔记，侵删！</strong><br><strong>若转作其他用途，请注明来源！</strong></p>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Java/" rel="tag"># Java</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/SpringBoot-%E6%9C%8D%E5%8A%A1%E5%99%A8Tomcat/" rel="prev" title="SpringBoot-服务器Tomcat">
      <i class="fa fa-chevron-left"></i> SpringBoot-服务器Tomcat
    </a></div>
      <div class="post-nav-item">
    <a href="/MongoDB-%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8%E5%92%8C%E6%8F%90%E9%AB%98/" rel="next" title="MongoDB-快速入门和提高">
      MongoDB-快速入门和提高 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    <div class="comments" id="gitalk-container"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B"><span class="nav-number">1.</span> <span class="nav-text">并发编程</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#NIO"><span class="nav-number">2.</span> <span class="nav-text">NIO</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A4%9A%E7%BA%BF%E7%A8%8B"><span class="nav-number">3.</span> <span class="nav-text">多线程</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#synchronized-%E5%85%B3%E9%94%AE%E5%AD%97"><span class="nav-number">3.1.</span> <span class="nav-text">synchronized 关键字</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%85%B7%E4%BD%93%E8%A1%A8%E7%8E%B0"><span class="nav-number">3.1.1.</span> <span class="nav-text">具体表现</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8D%A0%E6%9C%89%E9%94%81%E7%9A%84%E7%BA%BF%E7%A8%8B%E9%87%8A%E6%94%BE%E9%94%81"><span class="nav-number">3.1.2.</span> <span class="nav-text">占有锁的线程释放锁</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Synchronized-%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86"><span class="nav-number">3.1.3.</span> <span class="nav-text">Synchronized 实现原理</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Synchronized-%E4%B8%8ELock-%E6%AF%94%E8%BE%83"><span class="nav-number">3.1.4.</span> <span class="nav-text">Synchronized 与Lock 比较</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%80%BB%E7%BB%93"><span class="nav-number">3.1.5.</span> <span class="nav-text">总结</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#volatile-%E5%85%B3%E9%94%AE%E5%AD%97"><span class="nav-number">3.2.</span> <span class="nav-text">volatile 关键字</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%A4%BA%E4%BE%8B"><span class="nav-number">3.2.1.</span> <span class="nav-text">示例</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#volatile-%E5%8E%9F%E7%90%86%E5%8F%8A%E5%AE%9E%E7%8E%B0%E6%9C%BA%E5%88%B6"><span class="nav-number">3.2.2.</span> <span class="nav-text">volatile 原理及实现机制</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#volatile-%E7%9A%84%E7%96%91%E9%97%AE"><span class="nav-number">3.2.3.</span> <span class="nav-text">volatile 的疑问</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="nav-number">3.2.4.</span> <span class="nav-text">使用场景</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%86%85%E5%AD%98%E5%B1%8F%E9%9A%9C"><span class="nav-number">3.3.</span> <span class="nav-text">内存屏障</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#volatile-%E5%86%85%E5%AD%98%E5%B1%8F%E9%9A%9C"><span class="nav-number">3.3.1.</span> <span class="nav-text">volatile 内存屏障</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%94%81"><span class="nav-number">3.4.</span> <span class="nav-text">锁</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%85%AC%E5%B9%B3%E9%94%81-%E9%9D%9E%E5%85%AC%E5%B9%B3%E9%94%81"><span class="nav-number">3.4.1.</span> <span class="nav-text">公平锁&#x2F;非公平锁</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8F%AF%E9%87%8D%E5%85%A5%E9%94%81"><span class="nav-number">3.4.2.</span> <span class="nav-text">可重入锁</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%8B%AC%E4%BA%AB%E9%94%81-%E5%85%B1%E4%BA%AB%E9%94%81"><span class="nav-number">3.4.3.</span> <span class="nav-text">独享锁&#x2F;共享锁</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BA%92%E6%96%A5%E9%94%81-%E8%AF%BB%E5%86%99%E9%94%81"><span class="nav-number">3.4.4.</span> <span class="nav-text">互斥锁&#x2F;读写锁</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B9%90%E8%A7%82%E9%94%81-%E6%82%B2%E8%A7%82%E9%94%81"><span class="nav-number">3.4.5.</span> <span class="nav-text">乐观锁&#x2F;悲观锁</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%86%E6%AE%B5%E9%94%81"><span class="nav-number">3.4.6.</span> <span class="nav-text">分段锁</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%81%8F%E5%90%91%E9%94%81-%E8%BD%BB%E9%87%8F%E7%BA%A7%E9%94%81-%E9%87%8D%E9%87%8F%E7%BA%A7%E9%94%81"><span class="nav-number">3.4.7.</span> <span class="nav-text">偏向锁&#x2F;轻量级锁&#x2F;重量级锁</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%87%AA%E6%97%8B%E9%94%81"><span class="nav-number">3.4.8.</span> <span class="nav-text">自旋锁</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BA%BF%E7%A8%8B%E6%B1%A0"><span class="nav-number">3.5.</span> <span class="nav-text">线程池</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BA%BF%E7%A8%8B%E3%80%81%E8%BF%9B%E7%A8%8B%E9%97%B4%E9%80%9A%E4%BF%A1"><span class="nav-number">3.6.</span> <span class="nav-text">线程、进程间通信</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%BF%9B%E7%A8%8B%E3%80%81%E7%BA%BF%E7%A8%8B%E4%B9%8B%E9%97%B4%E7%9A%84%E5%85%B3%E7%B3%BB"><span class="nav-number">3.6.1.</span> <span class="nav-text">进程、线程之间的关系</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%A4%9A%E7%BA%BF%E7%A8%8B%E9%97%B4%E9%80%9A%E4%BF%A1%E6%96%B9%E5%BC%8F"><span class="nav-number">3.6.2.</span> <span class="nav-text">多线程间通信方式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%BF%9B%E7%A8%8B%E9%97%B4%E9%80%9A%E4%BF%A1%E6%96%B9%E5%BC%8F"><span class="nav-number">3.6.3.</span> <span class="nav-text">进程间通信方式</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%B9%B6%E5%8F%91"><span class="nav-number">4.</span> <span class="nav-text">并发</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%9E%E6%88%98"><span class="nav-number">5.</span> <span class="nav-text">实战</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Vert-x"><span class="nav-number">5.1.</span> <span class="nav-text">Vert.x</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#100W-TPS-%E7%A7%92%E6%9D%80%E7%B3%BB%E7%BB%9F"><span class="nav-number">5.2.</span> <span class="nav-text">100W TPS 秒杀系统</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%AE%BE%E8%AE%A1%E7%90%86%E5%BF%B5"><span class="nav-number">5.2.1.</span> <span class="nav-text">设计理念</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%AE%BE%E8%AE%A1%E6%80%9D%E8%B7%AF"><span class="nav-number">5.2.2.</span> <span class="nav-text">设计思路</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A1%88%E4%BE%8B"><span class="nav-number">5.2.3.</span> <span class="nav-text">案例</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%BC%95%E7%94%A8"><span class="nav-number">6.</span> <span class="nav-text">引用</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%80%BB%E7%BB%93-1"><span class="nav-number">7.</span> <span class="nav-text">总结</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%AA%E4%BA%BA%E5%A4%87%E6%B3%A8"><span class="nav-number">8.</span> <span class="nav-text">个人备注</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="vgbhfive"
      src="https://i.loli.net/2019/12/10/JF3dKDSkZoPz7h6.jpg">
  <p class="site-author-name" itemprop="name">vgbhfive</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">144</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">49</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/vgbhfive" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;vgbhfive" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:vgbhfive@foxmail.com" title="E-Mail → mailto:vgbhfive@foxmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://vgbhfive.com/" title="Web-Site → https:&#x2F;&#x2F;vgbhfive.com" rel="noopener" target="_blank"><i class="fab fa-chrome fa-fw"></i>Web-Site</a>
      </span>
  </div>



      </div>
        <div class="back-to-top motion-element">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        
  <div class="beian"><a href="https://beian.miit.gov.cn/" rel="noopener" target="_blank">陕ICP备20002937号-1 </a>
  </div>

<div class="copyright">
  
  &copy; 2016 – 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">vgbhfive</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a>
  </div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="Total Visitors">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="Total Views">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

  

<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.css">

<script>
NexT.utils.loadComments(document.querySelector('#gitalk-container'), () => {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js', () => {
    var gitalk = new Gitalk({
      clientID    : '2ff0dea213e4c7c0bbcc',
      clientSecret: '7f3d808240b513b00a1dbf20d725809acc316b67',
      repo        : 'vgbhfive.github.io',
      owner       : 'vgbhfive',
      admin       : ['vgbhfive'],
      id          : '9d6d5d409a57c5fb2696aba1ead30d16',
        language: 'zh-CN',
      distractionFreeMode: true
    });
    gitalk.render('gitalk-container');
  }, window.Gitalk);
});
</script>

</body>
</html>
