<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="https://i.loli.net/2019/12/10/JF3dKDSkZoPz7h6.jpg">
  <link rel="icon" type="image/png" sizes="16x16" href="https://i.loli.net/2019/12/10/JF3dKDSkZoPz7h6.jpg">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">
  <meta name="google-site-verification" content="G-QBK8PCQC9B">
  <meta name="baidu-site-verification" content="codeva-K7aZhBcBPm">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"blog.vgbhfive.com","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":true,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"gitalk","storage":true,"lazyload":false,"nav":null,"activeClass":"gitalk"},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="此处依旧书接上回，话不多说且看内容！">
<meta property="og:type" content="article">
<meta property="og:title" content="Neo4j系列博客-Cypher-2">
<meta property="og:url" content="https://blog.vgbhfive.com/Neo4j%E7%B3%BB%E5%88%97%E5%8D%9A%E5%AE%A2-Cypher-2/index.html">
<meta property="og:site_name" content="Vgbhfive&#39;s Blog">
<meta property="og:description" content="此处依旧书接上回，话不多说且看内容！">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://s2.loli.net/2022/02/06/Z5VDg1bK6A8CWIh.png">
<meta property="og:image" content="https://s2.loli.net/2022/02/06/Z5VDg1bK6A8CWIh.png">
<meta property="og:image" content="https://s2.loli.net/2022/02/06/Z5VDg1bK6A8CWIh.png">
<meta property="og:image" content="https://s2.loli.net/2022/02/11/KfmlP94sZOWjk5r.png">
<meta property="og:image" content="https://s2.loli.net/2022/02/06/Z5VDg1bK6A8CWIh.png">
<meta property="article:published_time" content="2022-02-03T02:54:55.000Z">
<meta property="article:modified_time" content="2022-02-20T08:18:14.000Z">
<meta property="article:author" content="vgbhfive">
<meta property="article:tag" content="Neo4j">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://s2.loli.net/2022/02/06/Z5VDg1bK6A8CWIh.png">

<link rel="canonical" href="https://blog.vgbhfive.com/Neo4j%E7%B3%BB%E5%88%97%E5%8D%9A%E5%AE%A2-Cypher-2/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>

  <title>Neo4j系列博客-Cypher-2 | Vgbhfive's Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<link rel="alternate" href="/atom.xml" title="Vgbhfive's Blog" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Vgbhfive's Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-pictures">

    <a href="/pictures/" rel="section"><i class="fa fa-th fa-fw"></i>Pictures</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
        <li class="menu-item menu-item-sitemap">

    <a href="/sitemap.xml" rel="section"><i class="fa fa-sitemap fa-fw"></i>Sitemap</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="reading-progress-bar"></div>

  <a href="https://github.com/vgbhfive" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://blog.vgbhfive.com/Neo4j%E7%B3%BB%E5%88%97%E5%8D%9A%E5%AE%A2-Cypher-2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://i.loli.net/2019/12/10/JF3dKDSkZoPz7h6.jpg">
      <meta itemprop="name" content="vgbhfive">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Vgbhfive's Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Neo4j系列博客-Cypher-2
        </h1>

        <div class="post-meta">
          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-02-03 10:54:55" itemprop="dateCreated datePublished" datetime="2022-02-03T10:54:55+08:00">2022-02-03</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-02-20 16:18:14" itemprop="dateModified" datetime="2022-02-20T16:18:14+08:00">2022-02-20</time>
              </span>

          
            <span class="post-meta-item" title="Views" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">Views: </span>
              <span id="busuanzi_value_page_pv"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>此处依旧书接上回，话不多说且看内容！</p>
<span id="more"></span>

<h3 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h3><p>此部分主要包含 <code>Cypher</code> 查询语言中的所有函数的信息。</p>
<h4 id="断言（Predicate）函数"><a href="#断言（Predicate）函数" class="headerlink" title="断言（Predicate）函数"></a>断言（<code>Predicate</code>）函数</h4><p>断言函数是对给定的输入返回 <code>true</code> 或者 <code>false</code> 的布尔函数，他们主要用于查询的 <code>WHERE</code> 部分过滤子图。<br><img src="https://s2.loli.net/2022/02/06/Z5VDg1bK6A8CWIh.png" alt="neo4j-28.jpg"></p>
<h5 id="all"><a href="#all" class="headerlink" title="all()"></a><code>all()</code></h5><p>判断断言是否适用于列表中的所有元素。<br>语法： <code>all(variable IN list WHERE predicate)</code><br>参数：</p>
<ul>
<li><code>list</code>：返回列表的表达式</li>
<li><code>variable</code>：用于断言中的变量</li>
<li><code>predicate</code>：用于测试列表中所有元素的断言</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// 返回路径的节点中都有一个 age 大于 30 的属性</span><br><span class="line">MATCH p = (a)-[*1..3]-&gt;(b) WHERE a.name = &#x27;Alice&#x27; AND b.name = &#x27;Daniel&#x27; AND ALL (x IN nodes(p) WHERE x.age &gt; 30) RETURN p</span><br></pre></td></tr></table></figure>

<h5 id="any"><a href="#any" class="headerlink" title="any()"></a><code>any()</code></h5><p>判断断言是否<strong>至少</strong>适用于列表中的一个元素。<br>语法： <code>any(variable IN list WHERE predicate)</code><br>参数：</p>
<ul>
<li><code>list</code>：返回列表的表达式</li>
<li><code>variable</code>：用于断言中的变量</li>
<li><code>predicate</code>：用于测试列表中所有元素的断言</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// 返回路径的节点中的 array 属性中至少有一个值 one</span><br><span class="line">MATCH (a) WHERE a.name = &#x27;Eskil&#x27; AND ANY (x IN a.array WHERE x = &#x27;one&#x27;) RETURN a</span><br></pre></td></tr></table></figure>

<h5 id="none"><a href="#none" class="headerlink" title="none()"></a><code>none()</code></h5><p>判断断言不适用于列表中的所有元素，则返回 <code>true</code>。<br>语法： <code>none(variable IN list WHERE predicate)</code><br>参数：</p>
<ul>
<li><code>list</code>：返回列表的表达式</li>
<li><code>variable</code>：用于断言中的变量</li>
<li><code>predicate</code>：用于测试列表中所有元素的断言</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// 返回路径的节点没有 age 属性等于 25</span><br><span class="line">MATCH p = (a)-[*1..3]-&gt;(b) WHERE a.name = &#x27;Alice&#x27; AND NONE (x IN nodes(p) WHERE x.age = 25) RETURN p</span><br></pre></td></tr></table></figure>

<h5 id="single"><a href="#single" class="headerlink" title="single()"></a><code>single()</code></h5><p>判断断言刚好只适用于列表中的某一个元素，则返回 <code>true</code>。<br>语法： <code>single(variable IN list WHERE predicate)</code><br>参数：</p>
<ul>
<li><code>list</code>：返回列表的表达式</li>
<li><code>variable</code>：用于断言中的变量</li>
<li><code>predicate</code>：用于测试列表中所有元素的断言</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// 返回路径的节点中刚好有 eyes 属性值为 blue</span><br><span class="line">MATCH p = (a)--&gt;(b) WHERE a.name = &#x27;Alice&#x27; AND SINGLE (x IN nodes(p) WHERE x.eyes = &#x27;blue&#x27;) RETURN p</span><br></pre></td></tr></table></figure>

<h5 id="exists"><a href="#exists" class="headerlink" title="exists()"></a><code>exists()</code></h5><p>判断数据库中存在该模式或者节点中存在该属性，则返回 <code>true</code>。<br>语法： <code>exists(pattern-or-property)</code><br>参数：</p>
<ul>
<li><code>pattern-or-property</code>：模式或者属性</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// 返回节点的 name 属性和一个是否结婚的标识</span><br><span class="line">MATCH (a) WHERE exists(a.name) RETURN a.name AS name, exists((a)-[:MARRIED]-&gt;()) AS is_married</span><br></pre></td></tr></table></figure>

<h4 id="标量（Scalar）函数"><a href="#标量（Scalar）函数" class="headerlink" title="标量（Scalar）函数"></a>标量（<code>Scalar</code>）函数</h4><p>标量函数返回一个单值。<br><small><code>length()</code> 与 <code>size()</code> 函数非常相似，但他们是完全不同的函数。<code>length()</code> 目前用于字符串、路径、列表和模式表达式。</small><br><img src="https://s2.loli.net/2022/02/06/Z5VDg1bK6A8CWIh.png" alt="neo4j-28.jpg"></p>
<h5 id="size"><a href="#size" class="headerlink" title="size()"></a><code>size()</code></h5><p>返回表中元素的个数。<br>语法：<code>size(list)</code><br>参数：</p>
<ul>
<li><code>list</code>：返回列表的表达式</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// 返回列表中元素的个数</span><br><span class="line">RETURN size([&#x27;Alice&#x27;, &#x27;Bob&#x27;]) AS col</span><br></pre></td></tr></table></figure>

<h5 id="模式表达式的-size"><a href="#模式表达式的-size" class="headerlink" title="模式表达式的 size()"></a>模式表达式的 <code>size()</code></h5><p>这里的 <code>size()</code> 的参数不是列表，而是一个模式表达式匹配到的查询结果集。这里计算的是结果集元素的个数，而不是表达式本身的长度。<br>语法：<code>size(pattern expression)</code><br>参数：</p>
<ul>
<li><code>pattern expression</code>：返回列表的模式表达式</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// 返回模式表达式匹配到的子图的个数</span><br><span class="line">MARCH (a) WHERE a.name = &#x27;Alice&#x27; RETURN size((a)--&gt;()--&gt;()) AS fof</span><br></pre></td></tr></table></figure>

<h5 id="length"><a href="#length" class="headerlink" title="length()"></a><code>length()</code></h5><p>返回路径的长度。<br>语法：<code>length(path)</code><br>参数：</p>
<ul>
<li><code>path</code>：返回路径的表达式</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// 返回路径的长度</span><br><span class="line">MARCH p = (a)--&gt;(b)--&gt;(c) WHERE a.name = &#x27;Alice&#x27; RETURN length(p)</span><br></pre></td></tr></table></figure>

<h5 id="字符串-length"><a href="#字符串-length" class="headerlink" title="字符串 length()"></a>字符串 <code>length()</code></h5><p>返回字符串的长度。<br>语法：<code>length(string)</code><br>参数：</p>
<ul>
<li><code>string</code>：返回字符串的表达式</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// 返回 name 为 Alice 的长度</span><br><span class="line">MARCH (a) WHERE a.name = &#x27;Alice&#x27; RETURN length(a.name)</span><br></pre></td></tr></table></figure>

<h5 id="type"><a href="#type" class="headerlink" title="type()"></a><code>type()</code></h5><p>返回字符串代表的关系类型。<br>语法：<code>type(relationship)</code><br>参数：</p>
<ul>
<li><code>relationship</code>：一个关系</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// 返回路径的长度</span><br><span class="line">MARCH (a)-[r]-&gt;() WHERE a.name = &#x27;Alice&#x27; RETURN type(r)</span><br></pre></td></tr></table></figure>

<h5 id="id"><a href="#id" class="headerlink" title="id()"></a><code>id()</code></h5><p>返回节点或者关系的 <code>id</code>。<br>语法：<code>id(property-container)</code><br>参数：</p>
<ul>
<li><code>property-container</code>：一个节点或者关系</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// 返回节点的 ID</span><br><span class="line">MARCH (a) RETURN id(a)</span><br></pre></td></tr></table></figure>

<h5 id="coalesce"><a href="#coalesce" class="headerlink" title="coalesce()"></a><code>coalesce()</code></h5><p>返回表达式列表中的第一个非空的值。如果所有的实参都为空，则返回 <code>null</code>。<br>语法：<code>coalesce(expression[, expression]*)</code><br>参数：</p>
<ul>
<li><code>expression</code>：表达式，可能返回 null</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MARCH (a) WHERE a.name = &#x27;Alice&#x27; RETURN coalesce(a.hairColor, a.eyes)</span><br></pre></td></tr></table></figure>

<h5 id="head"><a href="#head" class="headerlink" title="head()"></a><code>head()</code></h5><p>返回列表中的第一个元素。<br>语法：<code>head(expression)</code><br>参数：</p>
<ul>
<li><code>expression</code>：返回列表的表达式</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// 返回列表中的第一个元素</span><br><span class="line">MARCH (a) WHERE a.name = &#x27;Eskil&#x27; RETURN a.array, head(a.array)</span><br></pre></td></tr></table></figure>

<h5 id="last"><a href="#last" class="headerlink" title="last()"></a><code>last()</code></h5><p>返回列表中的最后一个元素。<br>语法：<code>last(expression)</code><br>参数：</p>
<ul>
<li><code>expression</code>：返回列表的表达式</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// 返回列表中的最后一个元素</span><br><span class="line">MARCH (a) WHERE a.name = &#x27;Eskil&#x27; RETURN a.array, last(a.array)</span><br></pre></td></tr></table></figure>

<h5 id="timestamp"><a href="#timestamp" class="headerlink" title="timestamp()"></a><code>timestamp()</code></h5><p>返回当前时间的时间戳，单位以毫秒计算。它在整个查询中始终返回一个值，即使在一个运行很长时间的查询中。<br>语法：<code>timestamp()</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// 返回当前时间</span><br><span class="line">RETURN timestamp()</span><br></pre></td></tr></table></figure>

<h5 id="startNode"><a href="#startNode" class="headerlink" title="startNode()"></a><code>startNode()</code></h5><p>返回一个关系的开始节点。<br>语法：<code>startNode(relationship)</code><br>参数：</p>
<ul>
<li><code>relationship</code>：返回关系的表达式</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// 返回列表中的最后一个元素</span><br><span class="line">MARCH (a:foo)-[r]-() RETURN startNode(r)</span><br></pre></td></tr></table></figure>

<h5 id="endNode"><a href="#endNode" class="headerlink" title="endNode()"></a><code>endNode()</code></h5><p>返回一个关系的结束节点。<br>语法：<code>endNode(relationship)</code><br>参数：</p>
<ul>
<li><code>relationship</code>：返回关系的表达式</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// 返回列表中的最后一个元素</span><br><span class="line">MARCH (a:foo)-[r]-() RETURN endNode(r)</span><br></pre></td></tr></table></figure>

<h5 id="properties"><a href="#properties" class="headerlink" title="properties()"></a><code>properties()</code></h5><p>将实参转为属性值的 <code>map</code>。如果实参是一个节点或者关系，则返回的就是节点或者关系的属性的 <code>map</code>；如果市场已经是 <code>map</code>，则原样返回。<br>语法：<code>properties(expression)</code><br>参数：</p>
<ul>
<li><code>expression</code>：返回节点、关系或者 <code>map</code> 的表达式</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CREATE (p:Person &#123;name: &#x27;Stefan&#x27;, city: &#x27;Berlin&#x27;&#125;) RETURN properties(p)</span><br></pre></td></tr></table></figure>

<h5 id="toInt"><a href="#toInt" class="headerlink" title="toInt()"></a><code>toInt()</code></h5><p>将实参转为一个整数。字符串会被解析成一个整数，如果解析失败则会返回 <code>null</code>。浮点数被强制转换为整数。<br>语法：<code>toInt(expression)</code><br>参数：</p>
<ul>
<li><code>expression</code>：返回任意值的表达式</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">RETURN toInt(&#x27;42&#x27;), toInt(&#x27;not a number&#x27;)</span><br></pre></td></tr></table></figure>

<h5 id="toFloat"><a href="#toFloat" class="headerlink" title="toFloat()"></a><code>toFloat()</code></h5><p>将实参转为一个浮点数。字符串会被解析成一个浮点数，如果解析失败则会返回 <code>null</code>。整数被强制转换为浮点数。<br>语法：<code>toFloat(expression)</code><br>参数：</p>
<ul>
<li><code>expression</code>：返回任意值的表达式</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">RETURN toFloat(&#x27;42.2&#x27;), toFloat(&#x27;not a number&#x27;)</span><br></pre></td></tr></table></figure>

<h4 id="列表（List）函数"><a href="#列表（List）函数" class="headerlink" title="列表（List）函数"></a>列表（<code>List</code>）函数</h4><p>列表函数返回列表中的元素。<br><img src="https://s2.loli.net/2022/02/06/Z5VDg1bK6A8CWIh.png" alt="neo4j-28.jpg"></p>
<h5 id="nodes"><a href="#nodes" class="headerlink" title="nodes()"></a><code>nodes()</code></h5><p>返回一条路径中的所有节点。<br>语法：<code>nodes(path)</code><br>参数：</p>
<ul>
<li><code>path</code>：一条路径</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MATCH p = (a)--&gt;(b)--&gt;(c) WHERE a.name = &#x27;Alice&#x27; AND c.name = &#x27;Eskill&#x27; RETURN nodes(p)</span><br></pre></td></tr></table></figure>

<h5 id="relationships"><a href="#relationships" class="headerlink" title="relationships()"></a><code>relationships()</code></h5><p>返回一条路径中的所有关系。<br>语法：<code>relationships(path)</code><br>参数：</p>
<ul>
<li><code>path</code>：一条路径</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MATCH p = (a)--&gt;(b)--&gt;(c) WHERE a.name = &#x27;Alice&#x27; AND c.name = &#x27;Eskill&#x27; RETURN relationships(p)</span><br></pre></td></tr></table></figure>

<h5 id="labels"><a href="#labels" class="headerlink" title="labels()"></a><code>labels()</code></h5><p>以字符串列表的形式返回一条节点的所有标签。<br>语法：<code>labels(node)</code><br>参数：</p>
<ul>
<li><code>node</code>：返回单个节点的任意表达式</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// 返回节点 a 的所有标签</span><br><span class="line">MATCH (a) WHERE a.name = &#x27;Alice&#x27; RETURN labels(a)</span><br></pre></td></tr></table></figure>

<h5 id="keys"><a href="#keys" class="headerlink" title="keys()"></a><code>keys()</code></h5><p>以字符串列表的形式返回一条节点、关系或者 <code>map</code> 的所有属性的名称。<br>语法：<code>keys(property-container)</code><br>参数：</p>
<ul>
<li><code>property-container</code>：一条节点、关系或者字面值的 <code>map</code></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// 返回节点 a 的所有属性的名称</span><br><span class="line">MATCH (a) WHERE a.name = &#x27;Alice&#x27; RETURN keys(a)</span><br></pre></td></tr></table></figure>

<h5 id="extract"><a href="#extract" class="headerlink" title="extract()"></a><code>extract()</code></h5><p>返回节点或关系列表中返回单个属性或者某个函数的值。他将遍历整个列表，针对列表中的每个元素运行一个表达式，然后以列表的形式返回这些结果。他的工作方式类似于 <code>Lisp</code> 和 <code>Scala</code> 等函数式语言中的 <code>map</code> 方法。<br>语法：<code>extract(variable IN list | expression)</code><br>参数：</p>
<ul>
<li><code>list</code>：返回列表的表达式</li>
<li><code>variable</code>：引用 <code>list</code> 中元素的变量，他在 <code>expression</code> 中会用到</li>
<li><code>expression</code>：针对列表中每个元素所运行的表达式，并产生一个结果列表</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// 返回路径中所有节点的 age 属性</span><br><span class="line">MATCH p = (a)--&gt;(b)--&gt;(c) WHERE a.name = &#x27;Alice&#x27; AND b.name = &#x27;Bob&#x27; AND c.name = &#x27;Eskill&#x27; RETURN extract(n IN nodes(p) | n.age) AS extracted</span><br></pre></td></tr></table></figure>

<h5 id="extract-1"><a href="#extract-1" class="headerlink" title="extract()"></a><code>extract()</code></h5><p>返回节点或关系列表中返回单个属性或者某个函数的值。他将遍历整个列表，针对列表中的每个元素运行一个表达式，然后以列表的形式返回这些结果。他的工作方式类似于 <code>Lisp</code> 和 <code>Scala</code> 等函数式语言中的 <code>map</code> 方法。<br>语法：<code>extract(variable IN list | expression)</code><br>参数：</p>
<ul>
<li><code>list</code>：返回列表的表达式</li>
<li><code>variable</code>：引用 <code>list</code> 中元素的变量，他在 <code>expression</code> 中会用到</li>
<li><code>expression</code>：针对列表中每个元素所运行的表达式，并产生一个结果列表</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// 返回路径中所有节点的 age 属性</span><br><span class="line">MATCH p = (a)--&gt;(b)--&gt;(c) WHERE a.name = &#x27;Alice&#x27; AND b.name = &#x27;Bob&#x27; AND c.name = &#x27;Eskill&#x27; RETURN extract(n IN nodes(p) | n.age) AS extracted</span><br></pre></td></tr></table></figure>

<h5 id="filter"><a href="#filter" class="headerlink" title="filter()"></a><code>filter()</code></h5><p>返回列表中满足断言要求的所有元素。<br>语法：<code>filter(variable IN list WHERE predicate)</code><br>参数：</p>
<ul>
<li><code>list</code>：返回列表的表达式</li>
<li><code>variable</code>：用于断言中的变量</li>
<li><code>predicate</code>：用于测试列表中所有元素的断言</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// 返回节点 a 的所有属性的名称</span><br><span class="line">MATCH (a) WHERE a.name = &#x27;Eskill&#x27; RETURN a.array, filter(x IN a.array WHERE size(x) == 3)</span><br></pre></td></tr></table></figure>

<h5 id="tail"><a href="#tail" class="headerlink" title="tail()"></a><code>tail()</code></h5><p>返回列表中除首元素之外的所有元素<br>语法：<code>tail(expression)</code><br>参数：</p>
<ul>
<li><code>expression</code>：返回某个类型列表的表达式</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MATCH (a) WHERE a.name = &#x27;Eskill&#x27; RETURN a.array, tail(a.array)</span><br></pre></td></tr></table></figure>

<h5 id="range"><a href="#range" class="headerlink" title="range()"></a><code>range()</code></h5><p>返回某个范围内的数值。值之间的默认步长为 1，范围包含起始边界。<br>语法：<code>range(start, end[, step])</code><br>参数：</p>
<ul>
<li><code>start</code>：返回某个类型列表的表达式</li>
<li><code>end</code>：返回某个类型列表的表达式</li>
<li><code>step</code>：返回某个类型列表的表达式</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">RETURN range(0, 10), range(2, 18, 3)</span><br></pre></td></tr></table></figure>

<h5 id="reduce"><a href="#reduce" class="headerlink" title="reduce()"></a><code>reduce()</code></h5><p>使用 <code>reduce()</code> 对列表中的每个元素执行一个表达式，将表达式结果存入一个累加器。他的工作方式类似于 <code>Lisp</code> 和 <code>Scala</code> 等函数式语言中的 <code>fold</code> 或者 <code>reduce</code> 方法。<br>语法：<code>reduce(accumulator = initial, variable IN list | expression)</code><br>参数：</p>
<ul>
<li><code>accumulator</code>：用于累加每次迭代的部分结果</li>
<li><code>initial</code>：累加器的初始值</li>
<li><code>list</code>：返回列表的表达式</li>
<li><code>variable</code>：引用 <code>list</code> 中元素的变量，他在 <code>expression</code> 中会用到</li>
<li><code>expression</code>：针对列表中每个元素所运行的表达式，并产生一个结果列表</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// 本查询将路径中每个节点的 age 数值加起来，然后返回一个单值。</span><br><span class="line">MATCH p = (a)--&gt;(b)--&gt;(c) WHERE a.name = &#x27;Alice&#x27; AND b.name = &#x27;Bob&#x27; AND c.name = &#x27;Daniel&#x27; RETURN reduce(totalAge = 0, n IN nodes(p) | totalAge + n.age) AS reduction</span><br></pre></td></tr></table></figure>

<h4 id="数学函数"><a href="#数学函数" class="headerlink" title="数学函数"></a>数学函数</h4><p>这些函数仅适用于数值表达式。如果用于其他类型的值，将返回错误。<br><img src="https://s2.loli.net/2022/02/11/KfmlP94sZOWjk5r.png" alt="neo4j-29.jpg"></p>
<h5 id="数值函数"><a href="#数值函数" class="headerlink" title="数值函数"></a>数值函数</h5><h6 id="abs"><a href="#abs" class="headerlink" title="abs()"></a><code>abs()</code></h6><p>返回数值的绝对值。<br>语法：<code>abs(expression)</code><br>参数：</p>
<ul>
<li><code>expression</code>：数值表达式</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// 38 42 3</span><br><span class="line">MATCH (a), (e) WHERE a.name = &#x27;Alice&#x27; AND e.name = &#x27;Eskill&#x27; RETURN a.age, e.age, abs(a.age - e.age)</span><br></pre></td></tr></table></figure>

<h6 id="ceil"><a href="#ceil" class="headerlink" title="ceil()"></a><code>ceil()</code></h6><p>返回大于或等于实参的最小参数。<br>语法：<code>ceil(expression)</code><br>参数：</p>
<ul>
<li><code>expression</code>：数值表达式</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// 1</span><br><span class="line">RETURN ceil(0.1)</span><br></pre></td></tr></table></figure>

<h6 id="floor"><a href="#floor" class="headerlink" title="floor()"></a><code>floor()</code></h6><p>返回小于或等于表达式的最大的整数。<br>语法：<code>floor(expression)</code><br>参数：</p>
<ul>
<li><code>expression</code>：数值表达式</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// 0</span><br><span class="line">RETURN ceil(0.9)</span><br></pre></td></tr></table></figure>

<h6 id="round"><a href="#round" class="headerlink" title="round()"></a><code>round()</code></h6><p>返回距离表达式值最近的整数。<br>语法：<code>round(expression)</code><br>参数：</p>
<ul>
<li><code>expression</code>：数值表达式</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// 3</span><br><span class="line">RETURN round(3.1415926)</span><br></pre></td></tr></table></figure>

<h6 id="sign"><a href="#sign" class="headerlink" title="sign()"></a><code>sign()</code></h6><p>返回一个数值的正负。如果值为零，则返回 0；如果为负数，则返回 -1；如果值为正数，则返回 1。<br>语法：<code>sign(expression)</code><br>参数：</p>
<ul>
<li><code>expression</code>：数值表达式</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// -1, 1</span><br><span class="line">RETURN sign(-17), sign(2)</span><br></pre></td></tr></table></figure>

<h6 id="rand"><a href="#rand" class="headerlink" title="rand()"></a><code>rand()</code></h6><p>返回 <code>[0, 1)</code> 之间的一个随机数，返回的数值在整个区间遵循均匀分布。<br>语法：<code>rand()</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">RETURN rand()</span><br></pre></td></tr></table></figure>

<h5 id="对数函数"><a href="#对数函数" class="headerlink" title="对数函数"></a>对数函数</h5><h6 id="log"><a href="#log" class="headerlink" title="log()"></a><code>log()</code></h6><p>返回表达式的自然对数。<br>语法：<code>log(expression)</code><br>参数：</p>
<ul>
<li><code>expression</code>：数值表达式</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// 3.295836</span><br><span class="line">RETURN log(27)</span><br></pre></td></tr></table></figure>

<h6 id="log10"><a href="#log10" class="headerlink" title="log10()"></a><code>log10()</code></h6><p>返回表达式的常用对数（以 10 为底）。<br>语法：<code>log10(expression)</code><br>参数：</p>
<ul>
<li><code>expression</code>：数值表达式</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// 1.4313637</span><br><span class="line">RETURN log10(27)</span><br></pre></td></tr></table></figure>

<h6 id="exp"><a href="#exp" class="headerlink" title="exp()"></a><code>exp()</code></h6><p>返回 <code>e^n</code> ，这里 <code>e</code> 是自然对数的底，<code>n</code> 是表达式的实参值。<br>语法：<code>exp(expression)</code><br>参数：</p>
<ul>
<li><code>expression</code>：数值表达式</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// 7.389056</span><br><span class="line">RETURN exp(2)</span><br></pre></td></tr></table></figure>

<h6 id="e"><a href="#e" class="headerlink" title="e()"></a><code>e()</code></h6><p>返回自然对数的底，即 <code>e</code>。<br>语法：<code>e()</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">RETURN e()</span><br></pre></td></tr></table></figure>

<h6 id="sqrt"><a href="#sqrt" class="headerlink" title="sqrt()"></a><code>sqrt()</code></h6><p>返回数值的平方根。<br>语法：<code>sqrt(expression)</code><br>参数：</p>
<ul>
<li><code>expression</code>：数值表达式</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// 16</span><br><span class="line">RETURN sqrt(256)</span><br></pre></td></tr></table></figure>

<h5 id="三角函数"><a href="#三角函数" class="headerlink" title="三角函数"></a>三角函数</h5><p>除非特别指明，所有的三角函数都是针对弧度制进行计算的。</p>
<h6 id="sin"><a href="#sin" class="headerlink" title="sin()"></a><code>sin()</code></h6><p>返回表达式的正弦函数值。<br>语法：<code>sin(expression)</code><br>参数：</p>
<ul>
<li><code>expression</code>：表示角的弧度的数值表达式</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// 0.4794255</span><br><span class="line">RETURN sin(0.5)</span><br></pre></td></tr></table></figure>

<h6 id="cos"><a href="#cos" class="headerlink" title="cos()"></a><code>cos()</code></h6><p>返回表达式的余弦函数值。<br>语法：<code>cos(expression)</code><br>参数：</p>
<ul>
<li><code>expression</code>：表示角的弧度的数值表达式</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// 0.8775825</span><br><span class="line">RETURN cos(0.5)</span><br></pre></td></tr></table></figure>

<h6 id="tan"><a href="#tan" class="headerlink" title="tan()"></a><code>tan()</code></h6><p>返回表达式的正切值。<br>语法：<code>tan(expression)</code><br>参数：</p>
<ul>
<li><code>expression</code>：表示角的弧度的数值表达式</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// 0.5463024</span><br><span class="line">RETURN tan(0.5)</span><br></pre></td></tr></table></figure>

<h6 id="cot"><a href="#cot" class="headerlink" title="cot()"></a><code>cot()</code></h6><p>返回表达式的余切值。<br>语法：<code>cot(expression)</code><br>参数：</p>
<ul>
<li><code>expression</code>：表示角的弧度的数值表达式</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// 1.8304877</span><br><span class="line">RETURN cot(0.5)</span><br></pre></td></tr></table></figure>

<h6 id="asin"><a href="#asin" class="headerlink" title="asin()"></a><code>asin()</code></h6><p>返回表达式的反正弦值。<br>语法：<code>asin(expression)</code><br>参数：</p>
<ul>
<li><code>expression</code>：表示角的弧度的数值表达式</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// 0.5235987</span><br><span class="line">RETURN asin(0.5)</span><br></pre></td></tr></table></figure>

<h6 id="acos"><a href="#acos" class="headerlink" title="acos()"></a><code>acos()</code></h6><p>返回表达式的反余弦值。<br>语法：<code>acos(expression)</code><br>参数：</p>
<ul>
<li><code>expression</code>：表示角的弧度的数值表达式</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// 1.0471975</span><br><span class="line">RETURN acos(0.5)</span><br></pre></td></tr></table></figure>

<h6 id="atan"><a href="#atan" class="headerlink" title="atan()"></a><code>atan()</code></h6><p>返回表达式的反正切值。<br>语法：<code>atan(expression)</code><br>参数：</p>
<ul>
<li><code>expression</code>：表示角的弧度的数值表达式</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// 0.4636476</span><br><span class="line">RETURN atan(0.5)</span><br></pre></td></tr></table></figure>

<h6 id="atan2"><a href="#atan2" class="headerlink" title="atan2()"></a><code>atan2()</code></h6><p>返回方位角，也可以理解为计算复数 <code>x + y * i</code> 的幅角。<br>语法：<code>atan2(expression1, expression2)</code><br>参数：</p>
<ul>
<li><code>expression1</code>：表示复数 <code>x</code> 部分的数值表达式</li>
<li><code>expression2</code>：表示复数 <code>y</code> 部分的数值表达式</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// 0.6947382</span><br><span class="line">RETURN atan2(0.5, 0.6)</span><br></pre></td></tr></table></figure>

<h6 id="pi"><a href="#pi" class="headerlink" title="pi()"></a><code>pi()</code></h6><p>返回常数 <code>pi</code> 的数值。<br>语法：<code>pi()</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// 3.1415926</span><br><span class="line">RETURN pi()</span><br></pre></td></tr></table></figure>

<h6 id="degrees"><a href="#degrees" class="headerlink" title="degrees()"></a><code>degrees()</code></h6><p>将弧度转化为度。<br>语法：<code>degrees(expression)</code><br>参数：</p>
<ul>
<li><code>expression</code>：表示角的弧度的数值表达式</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// 179.999847</span><br><span class="line">RETURN degrees(3.14159)</span><br></pre></td></tr></table></figure>

<h6 id="radians"><a href="#radians" class="headerlink" title="radians()"></a><code>radians()</code></h6><p>将度转化为弧度。<br>语法：<code>radians(expression)</code><br>参数：</p>
<ul>
<li><code>expression</code>：表示角度数的数值表达式</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// 3.1415926</span><br><span class="line">RETURN radians(180)</span><br></pre></td></tr></table></figure>

<h6 id="haversin"><a href="#haversin" class="headerlink" title="haversin()"></a><code>haversin()</code></h6><p>返回表达式的半正矢。<br>语法：<code>haversin(expression)</code><br>参数：</p>
<ul>
<li><code>expression</code>：表示角的弧度的数值表达式</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// 0.06120871</span><br><span class="line">RETURN haversin(0.5)</span><br><span class="line">// 计算球面距离。计算柏林和加州两点之间的球面距离，地球的平均半径为 6371km。</span><br><span class="line">CREATE (ber:City &#123;lat: 52.5, lon: 12.4&#125;), (sm:City &#123;lat: 37.5, lon:-122.3&#125;)</span><br><span class="line">RETURN 2 * 6371 * asin(sqrt(haversin(radians(sm.lat - ber.lat)) + cos(radians(sm.lat)) * cos(radians(ber.lat)) * haversin(radians(sm.lon - ber.lon)))) AS dist</span><br></pre></td></tr></table></figure>

<h4 id="字符串函数"><a href="#字符串函数" class="headerlink" title="字符串函数"></a>字符串函数</h4><p>下面的函数都是只针对字符串表达式。如果用于其他值，将返回错误。<br><img src="https://s2.loli.net/2022/02/06/Z5VDg1bK6A8CWIh.png" alt="neo4j-28.jpg"></p>
<h5 id="replace"><a href="#replace" class="headerlink" title="replace()"></a><code>replace()</code></h5><p>返回被替代字符串替换后的字符串，他会替换所有出现过的字符串。<br>语法：<code>replace(original, search, replace)</code><br>参数：</p>
<ul>
<li><code>original</code>：原字符串</li>
<li><code>search</code>：期望被替换的字符串</li>
<li><code>replace</code>：用于替换的字符串</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// hewwo</span><br><span class="line">RETURN replace(&quot;hello&quot;, &quot;l&quot;, &quot;w&quot;)</span><br></pre></td></tr></table></figure>

<h5 id="substring"><a href="#substring" class="headerlink" title="substring()"></a><code>substring()</code></h5><p>返回原字符串的子串。他带有一个 <code>0</code> 为开始的索引值和长度作为参数。如果长度省略了，那么他返回从索引开始到结束的值字符串。<br>语法：<code>substring(original, start[, length])</code><br>参数：</p>
<ul>
<li><code>original</code>：原字符串</li>
<li><code>start</code>：子串的开始位置</li>
<li><code>length</code>：子串的长度</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// ell</span><br><span class="line">RETURN substring(&quot;hello&quot;, 1, 3)</span><br></pre></td></tr></table></figure>

<h5 id="left"><a href="#left" class="headerlink" title="left()"></a><code>left()</code></h5><p>返回原字符串左边指定长度的子串。<br>语法：<code>left(original, length)</code><br>参数：</p>
<ul>
<li><code>original</code>：原字符串</li>
<li><code>length</code>：左边子字符串的长度</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// hel</span><br><span class="line">RETURN left(&quot;hello&quot;, 3)</span><br></pre></td></tr></table></figure>

<h5 id="right"><a href="#right" class="headerlink" title="right()"></a><code>right()</code></h5><p>返回原字符串右边指定长度的子字符串。<br>语法：<code>right(original, length)</code><br>参数：</p>
<ul>
<li><code>original</code>：原字符串</li>
<li><code>length</code>：右边子字符串的长度</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// llo</span><br><span class="line">RETURN right(&quot;hello&quot;, 3)</span><br></pre></td></tr></table></figure>

<h5 id="ltrim"><a href="#ltrim" class="headerlink" title="ltrim()"></a><code>ltrim()</code></h5><p>返回原字符串移除左侧的空白字符后的字符串。<br>语法：<code>ltrim(original)</code><br>参数：</p>
<ul>
<li><code>original</code>：原字符串</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// hello</span><br><span class="line">RETURN ltrim(&#x27; hello&#x27;)</span><br></pre></td></tr></table></figure>

<h5 id="rtrim"><a href="#rtrim" class="headerlink" title="rtrim()"></a><code>rtrim()</code></h5><p>返回原字符串移除右侧的空白字符后的字符串。<br>语法：<code>rtrim(original)</code><br>参数：</p>
<ul>
<li><code>original</code>：原字符串</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// hello</span><br><span class="line">RETURN rtrim(&#x27;hello &#x27;)</span><br></pre></td></tr></table></figure>

<h5 id="trim"><a href="#trim" class="headerlink" title="trim()"></a><code>trim()</code></h5><p>返回原字符串移除两侧的空白字符后的字符串。<br>语法：<code>trim(original)</code><br>参数：</p>
<ul>
<li><code>original</code>：原字符串</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// hello</span><br><span class="line">RETURN trim(&#x27; hello &#x27;)</span><br></pre></td></tr></table></figure>

<h5 id="lower"><a href="#lower" class="headerlink" title="lower()"></a><code>lower()</code></h5><p>以小写的形式返回原字符串。<br>语法：<code>lower(original)</code><br>参数：</p>
<ul>
<li><code>original</code>：原字符串</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// hello</span><br><span class="line">RETURN lower(&#x27;HELLO&#x27;)</span><br></pre></td></tr></table></figure>

<h5 id="upper"><a href="#upper" class="headerlink" title="upper()"></a><code>upper()</code></h5><p>以大写的形式返回原字符串。<br>语法：<code>upper(original)</code><br>参数：</p>
<ul>
<li><code>original</code>：原字符串</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// HELLO</span><br><span class="line">RETURN upper(&#x27;hello&#x27;)</span><br></pre></td></tr></table></figure>

<h5 id="split"><a href="#split" class="headerlink" title="split()"></a><code>split()</code></h5><p>返回以指定模式分隔后的字符串序列。<br>语法：<code>split(original, splitPattern)</code><br>参数：</p>
<ul>
<li><code>original</code>：原字符串</li>
<li><code>splitPattern</code>：分隔字符串</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// [&#x27;one&#x27;, &#x27;two&#x27;]</span><br><span class="line">RETURN split(&#x27;one,two&#x27;, &#x27;,&#x27;)</span><br></pre></td></tr></table></figure>

<h5 id="reverse"><a href="#reverse" class="headerlink" title="reverse()"></a><code>reverse()</code></h5><p>返回原字符串的倒序字符串。<br>语法：<code>reverse(original)</code><br>参数：</p>
<ul>
<li><code>original</code>：原字符串</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// margana</span><br><span class="line">RETURN reverse(&#x27;anagram&#x27;)</span><br></pre></td></tr></table></figure>

<h5 id="toString-NaN"><a href="#toString-NaN" class="headerlink" title="toString()"></a><code>toString()</code></h5><p>将实参转化为字符串。他将整形、浮点型和布尔型转换为字符串。如果实参为字符串，则按原样返回。<br>语法：<code>toString(expression)</code><br>参数：</p>
<ul>
<li><code>expression</code>：返回数值、布尔或者字符串的表达式</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">RETURN toString(11.5), toString(&#x27;already a string&#x27;), toString(TRUE) </span><br></pre></td></tr></table></figure>

<h4 id="自定义函数"><a href="#自定义函数" class="headerlink" title="自定义函数"></a>自定义函数</h4><p>自定义函数用 <code>Java</code> 语言编写，可部署到数据库中，调用方式与其他 <code>Cypher</code> 函数一样。下面示例一个名为 <code>join</code> 的自定义函数。</p>
<h5 id="调用自定义函数"><a href="#调用自定义函数" class="headerlink" title="调用自定义函数"></a>调用自定义函数</h5><p>调用自定义函数 <code>org.neo4j.function.example.join()</code>。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// &#x27;John, Paul, George, Ringo&#x27;</span><br><span class="line">MATCH (n:Member) RETURN org.neo4j.function.example.join(collect(n.name))</span><br></pre></td></tr></table></figure>

<h5 id="编写自定义函数"><a href="#编写自定义函数" class="headerlink" title="编写自定义函数"></a>编写自定义函数</h5><p>自定义函数的白那些类似于过程（<code>Procedure</code>）的创建，但它采用 <code>@UseFunction</code> 注解，并且只返回一个单值。有效的输出类型包括 <code>long, double, Double, boolean, Boolean, String, Node, RelationShip, Path, Map&lt;String, Object&gt;, List&lt;T&gt;</code>，这里的 <code>T</code> 可以是任意支持的类型。<br>下面是一个简单的自定义函数例子，该函数将 <code>List</code> 中的字符串用指定的分隔符连接起来。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">public class Join &#123;</span><br><span class="line">	@UserFunction</span><br><span class="line">	@Description(&quot;example.join([&#x27;s1&#x27;, &#x27;s2&#x27;, ...], delimiter) - join the given strings with the given delimiter&quot;)</span><br><span class="line">	public String join(</span><br><span class="line">		@Name(&quot;strings&quot;) List&lt;String&gt; strings,</span><br><span class="line">		@Name(value = &quot;delimiter&quot;, defaulyValue = &quot;,&quot;) String delimiter) &#123;</span><br><span class="line">		if (strings == null || delimiter == null) &#123;</span><br><span class="line">			return null;</span><br><span class="line">		&#125;	</span><br><span class="line">		return Strings.join(delimiter, strings);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>

<h3 id="模式（Schema）"><a href="#模式（Schema）" class="headerlink" title="模式（Schema）"></a>模式（<code>Schema</code>）</h3><p>基于标签的概念，<code>Neo4j 2.0</code> 为图引入了可选模式。在索引的规范中的标签为图定义约束。索引和约束是图的模式。<code>Cypher</code> 引入了数据定义语言（<code>Data Definition Language, DDL</code>）来操作模式。</p>
<h4 id="索引"><a href="#索引" class="headerlink" title="索引"></a>索引</h4><p>数据库的索引是为了检索数据效率更高而引入的冗余信息。他的代价是需要额外的存储空间和写入时速度变慢为代价的。因此，决定哪些数据需要建立索引，哪些不需要是非常重要的工作。<br><code>Cypher</code> 允许所有节点的某个属性上有2特定的标签。索引一旦创建，他将自己管理并当图发生变化时自动更新。一旦索引创建并生效之后，<code>Neo4j</code> 将自动开始使用索引。</p>
<h5 id="创建索引"><a href="#创建索引" class="headerlink" title="创建索引"></a>创建索引</h5><p>使用 <code>CREATE INDEX ON</code> 可以在拥有某个标签的所有节点的某个属性上创建索引。<strong>注意，索引是在后台创建，并不能立刻生效。</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// 在拥有 Person 标签的所有节点的 name 属性上创建索引</span><br><span class="line">CREATE INDEX ON :Person(name)</span><br></pre></td></tr></table></figure>

<p><small><code>Neo4j</code> 中的标签类似关系数据库中的表名，属性名就相当于表的列名。</small></p>
<h5 id="删除索引"><a href="#删除索引" class="headerlink" title="删除索引"></a>删除索引</h5><p>使用 <code>DROP INDEX</code> 可以删除拥有某个标签的所有节点的某个属性上的索引。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DROP INDEX ON :Person(name)</span><br></pre></td></tr></table></figure>

<h5 id="使用索引"><a href="#使用索引" class="headerlink" title="使用索引"></a>使用索引</h5><p>通常不需要在查询中指明使用哪个索引，<code>Cypher</code> 会自己决定。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MATCH (person:Person &#123;name: &#x27;Andres&#x27;&#125;) RETURN person</span><br></pre></td></tr></table></figure>

<h5 id="在-WHERE-等式中使用索引"><a href="#在-WHERE-等式中使用索引" class="headerlink" title="在 WHERE 等式中使用索引"></a>在 <code>WHERE</code> 等式中使用索引</h5><p>在 <code>WHERE</code> 语句中对索引的属性进行相等比较时，索引将会被自动使用。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MATCH (person:Person) WHERE person.name = &#x27;Andres&#x27; RETURN person</span><br></pre></td></tr></table></figure>

<h5 id="在-WHERE-不等式中使用索引"><a href="#在-WHERE-不等式中使用索引" class="headerlink" title="在 WHERE 不等式中使用索引"></a>在 <code>WHERE</code> 不等式中使用索引</h5><p>在 <code>WHERE</code> 语句中对索引的属性进行不等（范围）比较时，索引将会被自动使用。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MATCH (person:Person) WHERE person.name &gt; &#x27;B&#x27; RETURN person</span><br></pre></td></tr></table></figure>

<h5 id="在-IN-中使用索引"><a href="#在-IN-中使用索引" class="headerlink" title="在 IN 中使用索引"></a>在 <code>IN</code> 中使用索引</h5><p>针对 <code>person.name</code> 的 <code>IN</code> 断言将使用 <code>Person(name)</code> 索引。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MATCH (person:Person) WHERE person.name IN [&#x27;Andres&#x27;, &#x27;Mark&#x27;] RETURN person</span><br></pre></td></tr></table></figure>

<h5 id="在-STARTS-WITH-中使用索引"><a href="#在-STARTS-WITH-中使用索引" class="headerlink" title="在 STARTS WITH 中使用索引"></a>在 <code>STARTS WITH</code> 中使用索引</h5><p>针对 <code>person.name</code> 的 <code>STARTS WITH</code> 断言将使用 <code>Person(name)</code> 索引。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MATCH (person:Person) WHERE person.name STARTS WITH &#x27;And&#x27; RETURN person</span><br></pre></td></tr></table></figure>

<h5 id="在检查属性存在性时使用索引"><a href="#在检查属性存在性时使用索引" class="headerlink" title="在检查属性存在性时使用索引"></a>在检查属性存在性时使用索引</h5><p>查询中的 <code>has(p.name)</code> 断言将使用 <code>Person(name)</code> 索引。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MATCH (person:Person) WHERE exists(person.name) RETURN person</span><br></pre></td></tr></table></figure>

<h4 id="约束"><a href="#约束" class="headerlink" title="约束"></a>约束</h4><p><code>Neo4j</code> 通过使用约束来保证数据完整性。约束可应用于节点和关系，可以创建节点属性的唯一性约束，也可以创建节点和关系的属性存在性约束。<br>可以使用属性的唯一性约束确保拥有特定标签的所有节点的属性的值是唯一的，唯一性约束并不意味着所有节点的属性都必须有一个唯一的值。这个规则不适用于没有该属性的节点。<br>可以使用属性的存在性约束确保拥有特定标签的所有节点或者拥有特定类型的所有关系的属性是存在的，所有的试图创建新的没有该属性的节点或关系，以及试图删除强制属性的查询都会失败。</p>
<p><small>属性存在性约束是在 <code>Neo4j</code> 企业版才支持的特性。</small></p>
<p>可以对某个给定的标签添加多个约束，也可以将唯一性约束和存在性约束同时添加到同一个属性上。</p>
<p><small>添加约束是一个花费时间较长的原子操作，因此在没有扫描完所有节点前是不会生效的。</small></p>
<h5 id="节点属性的唯一性约束"><a href="#节点属性的唯一性约束" class="headerlink" title="节点属性的唯一性约束"></a>节点属性的唯一性约束</h5><ol>
<li><p>创建唯一性约束<br>使用 <code>IS UNIQUE</code> 语法创建约束，他能确保数据库中拥有特定标签和属性值的节点是唯一的。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CREATE CONSTRAINT ON (book:Book) ASSERT book.isbn IS UNIQUE</span><br></pre></td></tr></table></figure>
</li>
<li><p>删除唯一性约束<br>使用 <code>DROP CONSTRAINT</code> 可以删除数据库中的一个约束。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DROP CONSTRAINT ON (book:Book) ASSERT book.isbn IS UNIQUE</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建遵从属性唯一性约束的节点<br>创建一个数据库中不存在的 <code>isbn</code> 的 <code>Book</code> 节点。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CREATE (book:Book &#123;isbn: &#x27;144356265&#x27;, title: &#x27;Graph Databases&#x27;&#125;)</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建违背属性唯一性约束的节点<br>创建一个数据库中已经存在的 <code>isbn</code> 的 <code>Book</code> 节点。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// Node 0 already exissts</span><br><span class="line">CREATE (book:Book &#123;isbn: &#x27;144356265&#x27;, title: &#x27;Graph Databases&#x27;&#125;)</span><br></pre></td></tr></table></figure>
</li>
<li><p>因为冲突的节点而创建属性唯一性约束失败<br>当数据库存在两个 <code>Book</code> 节点拥有相同的 <code>isbn</code> 号时，在 <code>Book</code> 节点的的 <code>isbn</code> 属性上创建属性唯一性约束。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// unable to create CONSTRAINT ON (book:Book) ASSERT book.isbn IS UNIQUE; Multiple node with label &#x27;Book&#x27; have property `isbn = &#x27;144356265&#x27;`: node(0), node(1)</span><br><span class="line">CREATE CONSTRAINT ON (book:Book) ASSERT book.isbn IS UNIQUE</span><br></pre></td></tr></table></figure></li>
</ol>
<h5 id="节点属性的存在性约束"><a href="#节点属性的存在性约束" class="headerlink" title="节点属性的存在性约束"></a>节点属性的存在性约束</h5><ol>
<li><p>创建节点属性存在性约束<br>使用 <code>ASSERT exists(variable.propertyName)</code> 创建约束，可确保有指定标签的所有节点都有一个特定的属性。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CREATE CONSTRAINT ON (book:Book) ASSERT exists(book.isbn)</span><br></pre></td></tr></table></figure>
</li>
<li><p>删除节点属性存在性约束<br>使用 <code>DROP CONSTRAINT</code> 可以删除数据库中的一个约束。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DROP CONSTRAINT ON (book:Book) ASSERT exists(book.isbn)</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建遵从属性存在性约束的节点<br>创建一个数据库中不存在的 <code>isbn</code> 的 <code>Book</code> 节点。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CREATE (book:Book &#123;isbn: &#x27;144356265&#x27;, title: &#x27;Graph Databases&#x27;&#125;)</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建违背属性存在性约束的节点<br>在有 <code>:Book(isbn)</code> 属性存在性约束的情况下，创建一个没有的 <code>isbn</code> 属性的 <code>Book</code> 节点。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// Node 1 with labek &quot;Book&quot; must have the property &quot;isbn&quot; due to a constraint</span><br><span class="line">CREATE (book:Book &#123;title: &#x27;Graph Databases&#x27;&#125;)</span><br></pre></td></tr></table></figure>
</li>
<li><p>删除有存在性约束的节点属性<br>在有 <code>:Book(isbn)</code> 属性存在性约束的情况下，删除一个 <code>Book</code> 节点的 <code>isbn</code> 属性。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// Node 0 with label &quot;Book&quot; must have the property &quot;isbn&quot; due to a constraint</span><br><span class="line">MATCH (book:Book &#123;title: &#x27;Graph Databases&#x27;&#125;) REMOVE book.isbn</span><br></pre></td></tr></table></figure>
</li>
<li><p>因已存在的节点而创建节点属性存在性约束失败<br>当数据库的 <code>Book</code> 节点没有 <code>isbn</code> 属性时，试图为 <code>Book</code> 节点创建 <code>isbn</code> 的属性存在性约束。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// unable to create CONSTRAINT ON (book:Book) ASSERT exists(book.isbn): Node(0) wi8th label &#x27;Book&#x27; has no value for property `isbn`</span><br><span class="line">CREATE CONSTRAINT ON (book:Book) ASSERT exists(book.isbn)</span><br></pre></td></tr></table></figure></li>
</ol>
<h5 id="关系属性存在性约束"><a href="#关系属性存在性约束" class="headerlink" title="关系属性存在性约束"></a>关系属性存在性约束</h5><ol>
<li><p>创建关系属性存在性约束<br>使用 <code>ASSERT exists(variable.propertyName)</code> 创建约束，可确保有指定类型的所有关系都有一个特定的属性。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CREATE CONSTRAINT ON ()-[like:LIKED]-() ASSERT exists(like.day)</span><br></pre></td></tr></table></figure>
</li>
<li><p>删除关系属性存在性约束<br>使用 <code>DROP CONSTRAINT</code> 可以删除数据库中的一个约束。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DROP CONSTRAINT ON ()-[like:LIKED]-() ASSERT exists(like.day)</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建遵从属性存在性约束的关系<br>创建一个存在的 <code>day</code> 属性的 <code>LIKED</code> 关系。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CREATE (user:User)-[like:LIKED &#123;day: &#x27;yesterday&#x27;&#125;]-&gt;(book:Book)</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建违背属性存在性约束的关系<br>在有 <code>:LIKED(day)</code> 属性存在性约束的情况下，创建一个没有的 <code>day</code> 属性的 <code>LIKED</code> 关系。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// relationship 1 with type &quot;LIKED&quot; must have the property &quot;day&quot; due to a constraint</span><br><span class="line">CREATE (user:User)-[like:LIKED]-&gt;(book:Book)</span><br></pre></td></tr></table></figure>
</li>
<li><p>删除有存在性约束的关系属性<br>在有 <code>:LIKEd(day)</code> 属性存在性约束的情况下，删除一个 <code>LIKED</code> 节点的 <code>day</code> 属性。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// relationship 0 with type &quot;LIKED&quot; must have the property &quot;day&quot; due to a constraint</span><br><span class="line">MATCH (user:User)-[like:LIKED]-&gt;(book:Book) REMOVE like.day</span><br></pre></td></tr></table></figure>
</li>
<li><p>因已存在的关系而创建关系属性存在性约束失败<br>当数据库存在 <code>LIKED</code> 节点没有 <code>day</code> 属性时，试图为 <code>LIKED</code> 节点创建 <code>day</code> 的属性存在性约束。<br>这种情况因为与已存在的数据冲突，因此约束创建失败。可以选择移除冲突的关系，然后再重新创建约束。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// unable to create CONSTRAINT ON ()-[like:LIKED]-() ASSERT exists(like.day): relationship(0) with type `LIKED` has no value for property `day`</span><br><span class="line">CREATE CONSTRAINT ON ()-[like:LIKED]-() ASSERT exists(like.day)</span><br></pre></td></tr></table></figure></li>
</ol>
<h4 id="统计"><a href="#统计" class="headerlink" title="统计"></a>统计</h4><p>当执行一个 <code>Cypher</code> 查询时，他将先编译为一个执行计划 <code>(Execution Plan)</code>，该计划可以运行并响应查询。<br>为了给查询提供一个高效的计划，<code>Neo4j</code> 需要数据库的信息，如模式的索引和约束；也需要统计信息来保持数据库优化执行计划，有了这些信息，就能决定采用哪种模式将获得最好的执行计划。<br>需要的统计信息如下：</p>
<ul>
<li>拥有特定标签的节点的数量。</li>
<li>每个索引的可选择性。</li>
<li>按类型分的关系的数量。</li>
<li>以拥有指定标签的节点开始或者结束关系，按类型分各自的数量。</li>
</ul>
<p><code>Neo4j</code> 以两种方式来保持这些统计信息的更新。以标签数量为例，每当设置或者删除一个节点的标签的时候，这些数量都会被更新。<code>Neo4j</code> 需要扫描所有索引以获得可选择的数量。</p>
<h5 id="配置选项"><a href="#配置选项" class="headerlink" title="配置选项"></a>配置选项</h5><p>当产生执行计划的统计信息发生变化时，缓存的执行计划将被重新生成。下面的配置项可以控制执行计划的更新。</p>
<ol>
<li><p><code>dbms.index_sampling.background_enabled</code><br>控制当需要更新时索引是否会自动重新采样。<code>Cypher</code> 查询计划依赖于准确的统计信息来创建执行计划，因此当数据库更新时保持同步是很重要的。</p>
</li>
<li><p><code>dbms.index_sampling.update_percentage</code><br>控制多大比例的索引被更新后才触发新的采样。</p>
</li>
<li><p><code>cypher.statistics_divergence_threshold</code><br>控制一个执行计划被认为过时并必须重新生成前，允许多少统计信息发生变化。任何统计信息的相对变化超过临界值，原有执行计划将被丢弃并创建一个新的计划。</p>
</li>
</ol>
<h5 id="手动索引采样"><a href="#手动索引采样" class="headerlink" title="手动索引采样"></a>手动索引采样</h5><p>索引重采样可使用内嵌的 <code>db.resampleIndex()</code> 和 <code>dbms.resampleOutdateIndexes()</code> 两个内嵌过程来触发。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cypher-shell &#x27;CALL db.resampleIndex(&quot;:Person(name)&quot;);&#x27;</span><br><span class="line">cypher-shell &#x27;CALL db.resampleOutdateIndexes();&#x27;</span><br></pre></td></tr></table></figure>

<hr>

<h3 id="引用"><a href="#引用" class="headerlink" title="引用"></a>引用</h3><hr>

<h3 id="个人备注"><a href="#个人备注" class="headerlink" title="个人备注"></a>个人备注</h3><p><strong>此博客内容均为作者学习所做笔记，侵删！</strong><br><strong>若转作其他用途，请注明来源！</strong></p>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Neo4j/" rel="tag"># Neo4j</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84-%E5%9F%BA%E6%95%B0%E6%A0%91/" rel="prev" title="数据结构-基数树">
      <i class="fa fa-chevron-left"></i> 数据结构-基数树
    </a></div>
      <div class="post-nav-item">
    <a href="/MySQL-select%E6%9F%A5%E8%AF%A2%E4%B8%BA%E7%A9%BA%E4%BD%86%E6%95%B0%E6%8D%AE%E5%BA%93%E6%9C%89%E6%95%B0%E6%8D%AE/" rel="next" title="MySQL-select查询为空但数据库有数据">
      MySQL-select查询为空但数据库有数据 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    <div class="comments" id="gitalk-container"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%87%BD%E6%95%B0"><span class="nav-number">1.</span> <span class="nav-text">函数</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%96%AD%E8%A8%80%EF%BC%88Predicate%EF%BC%89%E5%87%BD%E6%95%B0"><span class="nav-number">1.1.</span> <span class="nav-text">断言（Predicate）函数</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#all"><span class="nav-number">1.1.1.</span> <span class="nav-text">all()</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#any"><span class="nav-number">1.1.2.</span> <span class="nav-text">any()</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#none"><span class="nav-number">1.1.3.</span> <span class="nav-text">none()</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#single"><span class="nav-number">1.1.4.</span> <span class="nav-text">single()</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#exists"><span class="nav-number">1.1.5.</span> <span class="nav-text">exists()</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A0%87%E9%87%8F%EF%BC%88Scalar%EF%BC%89%E5%87%BD%E6%95%B0"><span class="nav-number">1.2.</span> <span class="nav-text">标量（Scalar）函数</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#size"><span class="nav-number">1.2.1.</span> <span class="nav-text">size()</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%A8%A1%E5%BC%8F%E8%A1%A8%E8%BE%BE%E5%BC%8F%E7%9A%84-size"><span class="nav-number">1.2.2.</span> <span class="nav-text">模式表达式的 size()</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#length"><span class="nav-number">1.2.3.</span> <span class="nav-text">length()</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2-length"><span class="nav-number">1.2.4.</span> <span class="nav-text">字符串 length()</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#type"><span class="nav-number">1.2.5.</span> <span class="nav-text">type()</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#id"><span class="nav-number">1.2.6.</span> <span class="nav-text">id()</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#coalesce"><span class="nav-number">1.2.7.</span> <span class="nav-text">coalesce()</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#head"><span class="nav-number">1.2.8.</span> <span class="nav-text">head()</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#last"><span class="nav-number">1.2.9.</span> <span class="nav-text">last()</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#timestamp"><span class="nav-number">1.2.10.</span> <span class="nav-text">timestamp()</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#startNode"><span class="nav-number">1.2.11.</span> <span class="nav-text">startNode()</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#endNode"><span class="nav-number">1.2.12.</span> <span class="nav-text">endNode()</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#properties"><span class="nav-number">1.2.13.</span> <span class="nav-text">properties()</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#toInt"><span class="nav-number">1.2.14.</span> <span class="nav-text">toInt()</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#toFloat"><span class="nav-number">1.2.15.</span> <span class="nav-text">toFloat()</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%97%E8%A1%A8%EF%BC%88List%EF%BC%89%E5%87%BD%E6%95%B0"><span class="nav-number">1.3.</span> <span class="nav-text">列表（List）函数</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#nodes"><span class="nav-number">1.3.1.</span> <span class="nav-text">nodes()</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#relationships"><span class="nav-number">1.3.2.</span> <span class="nav-text">relationships()</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#labels"><span class="nav-number">1.3.3.</span> <span class="nav-text">labels()</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#keys"><span class="nav-number">1.3.4.</span> <span class="nav-text">keys()</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#extract"><span class="nav-number">1.3.5.</span> <span class="nav-text">extract()</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#extract-1"><span class="nav-number">1.3.6.</span> <span class="nav-text">extract()</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#filter"><span class="nav-number">1.3.7.</span> <span class="nav-text">filter()</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#tail"><span class="nav-number">1.3.8.</span> <span class="nav-text">tail()</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#range"><span class="nav-number">1.3.9.</span> <span class="nav-text">range()</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#reduce"><span class="nav-number">1.3.10.</span> <span class="nav-text">reduce()</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%95%B0%E5%AD%A6%E5%87%BD%E6%95%B0"><span class="nav-number">1.4.</span> <span class="nav-text">数学函数</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%95%B0%E5%80%BC%E5%87%BD%E6%95%B0"><span class="nav-number">1.4.1.</span> <span class="nav-text">数值函数</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#abs"><span class="nav-number">1.4.1.1.</span> <span class="nav-text">abs()</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#ceil"><span class="nav-number">1.4.1.2.</span> <span class="nav-text">ceil()</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#floor"><span class="nav-number">1.4.1.3.</span> <span class="nav-text">floor()</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#round"><span class="nav-number">1.4.1.4.</span> <span class="nav-text">round()</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#sign"><span class="nav-number">1.4.1.5.</span> <span class="nav-text">sign()</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#rand"><span class="nav-number">1.4.1.6.</span> <span class="nav-text">rand()</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%AF%B9%E6%95%B0%E5%87%BD%E6%95%B0"><span class="nav-number">1.4.2.</span> <span class="nav-text">对数函数</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#log"><span class="nav-number">1.4.2.1.</span> <span class="nav-text">log()</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#log10"><span class="nav-number">1.4.2.2.</span> <span class="nav-text">log10()</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#exp"><span class="nav-number">1.4.2.3.</span> <span class="nav-text">exp()</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#e"><span class="nav-number">1.4.2.4.</span> <span class="nav-text">e()</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#sqrt"><span class="nav-number">1.4.2.5.</span> <span class="nav-text">sqrt()</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%B8%89%E8%A7%92%E5%87%BD%E6%95%B0"><span class="nav-number">1.4.3.</span> <span class="nav-text">三角函数</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#sin"><span class="nav-number">1.4.3.1.</span> <span class="nav-text">sin()</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#cos"><span class="nav-number">1.4.3.2.</span> <span class="nav-text">cos()</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#tan"><span class="nav-number">1.4.3.3.</span> <span class="nav-text">tan()</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#cot"><span class="nav-number">1.4.3.4.</span> <span class="nav-text">cot()</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#asin"><span class="nav-number">1.4.3.5.</span> <span class="nav-text">asin()</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#acos"><span class="nav-number">1.4.3.6.</span> <span class="nav-text">acos()</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#atan"><span class="nav-number">1.4.3.7.</span> <span class="nav-text">atan()</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#atan2"><span class="nav-number">1.4.3.8.</span> <span class="nav-text">atan2()</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#pi"><span class="nav-number">1.4.3.9.</span> <span class="nav-text">pi()</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#degrees"><span class="nav-number">1.4.3.10.</span> <span class="nav-text">degrees()</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#radians"><span class="nav-number">1.4.3.11.</span> <span class="nav-text">radians()</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#haversin"><span class="nav-number">1.4.3.12.</span> <span class="nav-text">haversin()</span></a></li></ol></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%87%BD%E6%95%B0"><span class="nav-number">1.5.</span> <span class="nav-text">字符串函数</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#replace"><span class="nav-number">1.5.1.</span> <span class="nav-text">replace()</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#substring"><span class="nav-number">1.5.2.</span> <span class="nav-text">substring()</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#left"><span class="nav-number">1.5.3.</span> <span class="nav-text">left()</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#right"><span class="nav-number">1.5.4.</span> <span class="nav-text">right()</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#ltrim"><span class="nav-number">1.5.5.</span> <span class="nav-text">ltrim()</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#rtrim"><span class="nav-number">1.5.6.</span> <span class="nav-text">rtrim()</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#trim"><span class="nav-number">1.5.7.</span> <span class="nav-text">trim()</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#lower"><span class="nav-number">1.5.8.</span> <span class="nav-text">lower()</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#upper"><span class="nav-number">1.5.9.</span> <span class="nav-text">upper()</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#split"><span class="nav-number">1.5.10.</span> <span class="nav-text">split()</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#reverse"><span class="nav-number">1.5.11.</span> <span class="nav-text">reverse()</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#toString-NaN"><span class="nav-number">1.5.12.</span> <span class="nav-text">toString()</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E5%87%BD%E6%95%B0"><span class="nav-number">1.6.</span> <span class="nav-text">自定义函数</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%B0%83%E7%94%A8%E8%87%AA%E5%AE%9A%E4%B9%89%E5%87%BD%E6%95%B0"><span class="nav-number">1.6.1.</span> <span class="nav-text">调用自定义函数</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%BC%96%E5%86%99%E8%87%AA%E5%AE%9A%E4%B9%89%E5%87%BD%E6%95%B0"><span class="nav-number">1.6.2.</span> <span class="nav-text">编写自定义函数</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A8%A1%E5%BC%8F%EF%BC%88Schema%EF%BC%89"><span class="nav-number">2.</span> <span class="nav-text">模式（Schema）</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%B4%A2%E5%BC%95"><span class="nav-number">2.1.</span> <span class="nav-text">索引</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E7%B4%A2%E5%BC%95"><span class="nav-number">2.1.1.</span> <span class="nav-text">创建索引</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%88%A0%E9%99%A4%E7%B4%A2%E5%BC%95"><span class="nav-number">2.1.2.</span> <span class="nav-text">删除索引</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E7%B4%A2%E5%BC%95"><span class="nav-number">2.1.3.</span> <span class="nav-text">使用索引</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%9C%A8-WHERE-%E7%AD%89%E5%BC%8F%E4%B8%AD%E4%BD%BF%E7%94%A8%E7%B4%A2%E5%BC%95"><span class="nav-number">2.1.4.</span> <span class="nav-text">在 WHERE 等式中使用索引</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%9C%A8-WHERE-%E4%B8%8D%E7%AD%89%E5%BC%8F%E4%B8%AD%E4%BD%BF%E7%94%A8%E7%B4%A2%E5%BC%95"><span class="nav-number">2.1.5.</span> <span class="nav-text">在 WHERE 不等式中使用索引</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%9C%A8-IN-%E4%B8%AD%E4%BD%BF%E7%94%A8%E7%B4%A2%E5%BC%95"><span class="nav-number">2.1.6.</span> <span class="nav-text">在 IN 中使用索引</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%9C%A8-STARTS-WITH-%E4%B8%AD%E4%BD%BF%E7%94%A8%E7%B4%A2%E5%BC%95"><span class="nav-number">2.1.7.</span> <span class="nav-text">在 STARTS WITH 中使用索引</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%9C%A8%E6%A3%80%E6%9F%A5%E5%B1%9E%E6%80%A7%E5%AD%98%E5%9C%A8%E6%80%A7%E6%97%B6%E4%BD%BF%E7%94%A8%E7%B4%A2%E5%BC%95"><span class="nav-number">2.1.8.</span> <span class="nav-text">在检查属性存在性时使用索引</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BA%A6%E6%9D%9F"><span class="nav-number">2.2.</span> <span class="nav-text">约束</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%8A%82%E7%82%B9%E5%B1%9E%E6%80%A7%E7%9A%84%E5%94%AF%E4%B8%80%E6%80%A7%E7%BA%A6%E6%9D%9F"><span class="nav-number">2.2.1.</span> <span class="nav-text">节点属性的唯一性约束</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%8A%82%E7%82%B9%E5%B1%9E%E6%80%A7%E7%9A%84%E5%AD%98%E5%9C%A8%E6%80%A7%E7%BA%A6%E6%9D%9F"><span class="nav-number">2.2.2.</span> <span class="nav-text">节点属性的存在性约束</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%85%B3%E7%B3%BB%E5%B1%9E%E6%80%A7%E5%AD%98%E5%9C%A8%E6%80%A7%E7%BA%A6%E6%9D%9F"><span class="nav-number">2.2.3.</span> <span class="nav-text">关系属性存在性约束</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BB%9F%E8%AE%A1"><span class="nav-number">2.3.</span> <span class="nav-text">统计</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE%E9%80%89%E9%A1%B9"><span class="nav-number">2.3.1.</span> <span class="nav-text">配置选项</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%89%8B%E5%8A%A8%E7%B4%A2%E5%BC%95%E9%87%87%E6%A0%B7"><span class="nav-number">2.3.2.</span> <span class="nav-text">手动索引采样</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BC%95%E7%94%A8"><span class="nav-number">3.</span> <span class="nav-text">引用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%AA%E4%BA%BA%E5%A4%87%E6%B3%A8"><span class="nav-number">4.</span> <span class="nav-text">个人备注</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="vgbhfive"
      src="https://i.loli.net/2019/12/10/JF3dKDSkZoPz7h6.jpg">
  <p class="site-author-name" itemprop="name">vgbhfive</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">150</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">51</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/vgbhfive" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;vgbhfive" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:vgbhfive@foxmail.com" title="E-Mail → mailto:vgbhfive@foxmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://vgbhfive.com/" title="vgbhfive → https:&#x2F;&#x2F;vgbhfive.com" rel="noopener" target="_blank"><i class="fab fa-chrome fa-fw"></i>vgbhfive</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.heywhale.com/home/user/profile/65485e27d1e715cc33e7f383" title="Heywhale → https:&#x2F;&#x2F;www.heywhale.com&#x2F;home&#x2F;user&#x2F;profile&#x2F;65485e27d1e715cc33e7f383" rel="noopener" target="_blank"><i class="fab fa-fish fa-fw"></i>Heywhale</a>
      </span>
  </div>



      </div>
        <div class="back-to-top motion-element">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        
  <div class="beian"><a href="https://beian.miit.gov.cn/" rel="noopener" target="_blank">陕ICP备20002937号-1 </a>
  </div>

<div class="copyright">
  
  &copy; 2016 – 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">vgbhfive</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a>
  </div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="Total Visitors">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="Total Views">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

  

<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.css">

<script>
NexT.utils.loadComments(document.querySelector('#gitalk-container'), () => {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js', () => {
    var gitalk = new Gitalk({
      clientID    : '2ff0dea213e4c7c0bbcc',
      clientSecret: '7f3d808240b513b00a1dbf20d725809acc316b67',
      repo        : 'vgbhfive.github.io',
      owner       : 'vgbhfive',
      admin       : ['vgbhfive'],
      id          : '5c14148ddf7925f40e2eadb4ce577bbd',
        language: 'zh-CN',
      distractionFreeMode: true
    });
    gitalk.render('gitalk-container');
  }, window.Gitalk);
});
</script>

</body>
</html>
