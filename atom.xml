<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Vgbhfive&#39;s Blog</title>
  
  
  <link href="https://blog.vgbhfive.cn/atom.xml" rel="self"/>
  
  <link href="https://blog.vgbhfive.cn/"/>
  <updated>2023-12-22T15:48:32.079Z</updated>
  <id>https://blog.vgbhfive.cn/</id>
  
  <author>
    <name>vgbhfive</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Selenium-ä½¿ç”¨æ•™ç¨‹</title>
    <link href="https://blog.vgbhfive.cn/Selenium-%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/"/>
    <id>https://blog.vgbhfive.cn/Selenium-%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/</id>
    <published>2023-12-21T15:17:39.000Z</published>
    <updated>2023-12-22T15:48:32.079Z</updated>
    
    <content type="html"><![CDATA[<h3 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h3><p><strong><code>Selenium</code></strong> æœ€åˆæ˜¯ä¸€ä¸ªç”¨äºç½‘ç«™çš„è‡ªåŠ¨åŒ–æµ‹è¯•å·¥å…·ï¼Œæ”¯æŒå„ç§ <code>Chrome</code>ã€<code>Firefox</code>ã€<code>Safari</code> ç­‰ä¸»æµæµè§ˆå™¨ï¼ŒåŒæ—¶ä¹Ÿæ”¯æŒ <code>phantomJS</code> æ— ç•Œé¢æµè§ˆå™¨ã€‚ä¸è¿‡å…¶æ›´é€šå¸¸çš„ä½¿ç”¨åœ¨äºçˆ¬è™«ä¸­ä½¿ç”¨ï¼Œå…¶ä¸»è¦æ˜¯ç”¨äºè§£å†³ <code>requests</code> æ— æ³•ç›´æ¥æ‰§è¡Œ <code>JavaScript</code> ä»£ç çš„é—®é¢˜ï¼Œä¸è¿‡ç”¨äºè§£æ <code>Dom</code> å…ƒç´ æ›´æœ‰å…¶å¦™ç”¨ä¹‹å¤„ã€‚</p><span id="more"></span><hr><h3 id="åŸºç¡€ä½¿ç”¨"><a href="#åŸºç¡€ä½¿ç”¨" class="headerlink" title="åŸºç¡€ä½¿ç”¨"></a>åŸºç¡€ä½¿ç”¨</h3><h4 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h4><p>åœ¨ <code>Python</code> ä¸­ä½¿ç”¨ <code>Selenium</code> éœ€è¦é€šè¿‡ <code>pip</code> å®‰è£…å³å¯ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install selenium</span><br></pre></td></tr></table></figure><h4 id="é©±åŠ¨ç¨‹åº"><a href="#é©±åŠ¨ç¨‹åº" class="headerlink" title="é©±åŠ¨ç¨‹åº"></a>é©±åŠ¨ç¨‹åº</h4><p><code>Selenium</code> åœ¨å®‰è£…ä¹‹åè¿˜éœ€è¦ä¸€ä¸ªé©±åŠ¨ç¨‹åºæ¥ä¸æµè§ˆå™¨äº¤äº’ï¼Œä¸åŒçš„æµè§ˆå™¨éƒ½æœ‰è‡ªå·±çš„é©±åŠ¨ç¨‹åºã€‚åˆ—è¡¨å¦‚ä¸‹ï¼š</p><table><thead><tr><th>æµè§ˆå™¨</th><th>ä¸‹è½½é“¾æ¥</th></tr></thead><tbody><tr><td><code>Chrome</code></td><td><code>https://sites.google.com/chromium.org/driver/</code></td></tr><tr><td><code>Edge</code></td><td><code>https://developer.microsoft.com/en-us/microsoft-edge/tools/webdriver/</code></td></tr><tr><td><code>Firefox</code></td><td><code>https://github.com/mozilla/geckodriver/releases</code></td></tr><tr><td><code>Safari</code></td><td><code>https://webkit.org/blog/6900/webdriver-support-in-safari-10/</code></td></tr></tbody></table><p>ä¸è¿‡åœ¨æ–°ç‰ˆæœ¬ <code>4.6.0</code> ä¹‹åï¼Œå‘è¡ŒåŒ…ä¸­åŒ…å«ä¸€ä¸ª <strong><code>Selenium Manager</code> æ–°å·¥å…·</strong>ï¼Œè¯¥å·¥å…·å¸®åŠ© <code>Selenium</code> åœ¨å‘ç°é©±åŠ¨ç¨‹åºä¸å¯ç”¨æ—¶ï¼Œä¼šè‡ªåŠ¨å‘ç°ã€ä¸‹è½½å¹¶ç¼“å­˜é©±åŠ¨ç¨‹åºã€‚</p><h4 id="åŸºæœ¬ä½¿ç”¨"><a href="#åŸºæœ¬ä½¿ç”¨" class="headerlink" title="åŸºæœ¬ä½¿ç”¨"></a>åŸºæœ¬ä½¿ç”¨</h4><p>æ¨¡æ‹Ÿç‚¹å‡»<a href="https://baidu.com/">ç™¾åº¦é¦–é¡µ</a>è¾“å‡ºå…¶æ ‡é¢˜ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.by <span class="keyword">import</span> By</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;https://baidu.com&#x27;</span></span><br><span class="line">browser = webdriver.Chrome()</span><br><span class="line">browser.get(url)</span><br><span class="line"></span><br><span class="line">title = browser.find_element(By.TAG_NAME, <span class="string">&#x27;title&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(title.text)</span><br></pre></td></tr></table></figure><hr><h3 id="å¸¸ç”¨æ“ä½œ"><a href="#å¸¸ç”¨æ“ä½œ" class="headerlink" title="å¸¸ç”¨æ“ä½œ"></a>å¸¸ç”¨æ“ä½œ</h3><h4 id="å…ƒç´ å®šä½"><a href="#å…ƒç´ å®šä½" class="headerlink" title="å…ƒç´ å®šä½"></a>å…ƒç´ å®šä½</h4><p>é€šè¿‡æ–¹æ³•æŸ¥æ‰¾å…ƒç´ çš„å‡½æ•°å…±æœ‰ä¸¤ä¸ªï¼š</p><ul><li><code>find_element(By.KEY, &#39;KEY_NAME&#39;)</code></li><li><code>find_elements(By.KEY, &#39;KEY_NAME&#39;)</code></li></ul><p><code>By.KEY</code> ç”¨äºå®šä½é¡µé¢ä¸Šçš„å…ƒç´ å…±æœ‰ä»¥ä¸‹å…«ç§ï¼š</p><ul><li><code>ID</code> é€šè¿‡å…ƒç´ çš„ <code>ID</code> å±æ€§å®šä½å…ƒç´ ã€‚</li><li><code>NAME</code> é€šè¿‡å…ƒç´ çš„åç§°å±æ€§å®šä½å…ƒç´ ã€‚</li><li><code>XPATH</code> é€šè¿‡åœ¨ <code>XML</code> æ–‡æ¡£ä¸­çš„ <code>XPATH</code> èŠ‚ç‚¹å®šä½å…ƒç´ ã€‚</li><li><code>LINK_TEXT</code> é€šè¿‡é”šæ ‡è®°ä¸­ä½¿ç”¨çš„é“¾æ¥æ–‡æœ¬å®šä½å…ƒç´ ã€‚</li><li><code>PARTIAL_LINK_TEXT</code> é€šè¿‡é”šæ ‡è®°ä¸­ä½¿ç”¨çš„é“¾æ¥æ–‡æœ¬å®šä½å…ƒç´ ã€‚</li><li><code>TAG_NAME</code> é€šè¿‡æ ‡ç­¾åç§°å®šä½å…ƒç´ ã€‚</li><li><code>CLASS_NAME</code> é€šè¿‡ç±»åå®šä½å…ƒç´ ã€‚</li><li><code>CSS_SELECTOR</code> ä½¿ç”¨ <code>CSS</code> é€‰æ‹©å™¨è¯­æ³•å®šä½å…ƒç´ ã€‚</li></ul><h4 id="WebElement-å¸¸ç”¨æ–¹æ³•"><a href="#WebElement-å¸¸ç”¨æ–¹æ³•" class="headerlink" title="WebElement å¸¸ç”¨æ–¹æ³•"></a><code>WebElement</code> å¸¸ç”¨æ–¹æ³•</h4><ol><li><code>clear()</code><br>å¦‚æœå…ƒç´ æ˜¯è¾“å…¥æ–‡æœ¬ï¼Œåˆ™æ¸…é™¤æ–‡æœ¬ã€‚</li><li><code>click()</code><br>å•å‡»è¯¥å…ƒç´ ã€‚</li><li><code>get_attribute()</code><br>è·å–å…ƒç´ çš„ç»™å®šå±æ€§ã€‚</li><li><code>get_dom_attribute()</code>ã€<br>è·å–å…ƒç´ åœ¨ <code>HTML</code> æ ‡è®°ä¸­å£°æ˜çš„å…ƒç´ ã€‚</li><li><code>get_property()</code><br>è·å–å…ƒç´ çš„ç»™å®šå±æ€§ã€‚</li><li><code>is_displayed()</code><br>è¯¥å…ƒç´ æ˜¯å¦å¯¹ç”¨æˆ·å¯è§ã€‚</li><li><code>is_enabled()</code><br>è¯¥å…ƒç´ ä½¿ç”¨å¯ç”¨ã€‚</li><li><code>is_selected()</code><br>è¯¥å…ƒç´ æ˜¯å¦è¢«é€‰ä¸­ã€‚</li><li><code>send_keys()</code><br>æ¨¡æ‹Ÿåœ¨å…ƒç´ ä¸­è¾“å…¥å†…å®¹ã€‚</li><li><code>location</code><br>è·å–å…ƒç´ çš„åæ ‡ã€‚</li><li><code>submit()</code><br>æäº¤è¡¨æ ¼ã€‚</li><li><code>text</code><br>å…ƒç´ çš„æ–‡æœ¬ã€‚</li><li><code>tag_name</code><br>å…ƒç´ çš„ <code>tagName</code> å±æ€§ã€‚</li></ol><h4 id="é¼ æ ‡é”®ç›˜äº‹ä»¶"><a href="#é¼ æ ‡é”®ç›˜äº‹ä»¶" class="headerlink" title="é¼ æ ‡é”®ç›˜äº‹ä»¶"></a>é¼ æ ‡é”®ç›˜äº‹ä»¶</h4><ol><li><code>click(on_element=None)</code><br>å•å‡»å·¦é”®ã€‚</li><li><code>context_click(on_element=None)</code><br>å•å‡»å³é”®ã€‚</li><li><code>double_click(on_element=None)</code><br>åŒå‡»å·¦é”®ã€‚</li><li><code>key_down(value, on_element=None)</code><br>æŒ‰ä¸‹é”®ç›˜ä¸Šçš„æŸä¸ªé”®ã€‚</li><li><code>key_up(value, on_element=None)</code><br>æ¾å¼€é”®ç›˜ä¸Šçš„æŸä¸ªé”®ã€‚</li><li><code>move_by_offset(xoffset, yoffset)</code><br>é¼ æ ‡ä»å½“å‰ä½ç½®ç§»åŠ¨åˆ°æŸä¸ªåæ ‡ã€‚</li><li><code>move_to_element(to_element)</code><br>é¼ æ ‡ç§»åŠ¨åˆ°æŸä¸ªå…ƒç´ ã€‚</li><li><code>move_to_element_with_offset(to_element, xoffset, yoffset)</code><br>ç§»åŠ¨åˆ°è·æŸä¸ªå…ƒç´ ï¼ˆå·¦ä¸Šè§’åæ ‡ï¼‰å¤šå°‘è·ç¦»çš„ä½ç½®ã€‚</li><li><code>send_keys()</code><br>å‘é€æŸä¸ªé”®æˆ–è€…è¾“å…¥æ–‡æœ¬åˆ°å½“å‰å…ƒç´ ã€‚</li></ol><h4 id="æµè§ˆå™¨æ“ä½œ"><a href="#æµè§ˆå™¨æ“ä½œ" class="headerlink" title="æµè§ˆå™¨æ“ä½œ"></a>æµè§ˆå™¨æ“ä½œ</h4><ol><li><p>è·å–é¡µé¢çš„ <code>URL</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">browser.current_url</span><br></pre></td></tr></table></figure></li><li><p>è·å–é¡µé¢æ—¥å¿—</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">browser.maximize_window() # æœ€å¤§åŒ–</span><br><span class="line">browser.fullscreen_window() # å…¨å±</span><br><span class="line">browser.minimize_window() # æœ€å°åŒ–</span><br><span class="line">browser.get_window_position() # è·å–çª—å£çš„åæ ‡</span><br><span class="line">browser.get_window_rect() # è·å–çª—å£çš„å¤§å°å’Œåæ ‡</span><br><span class="line">browser.set_window_position(100, 200) # è®¾ç½®çª—å£çš„åæ ‡</span><br><span class="line">browser.set_window_rect(100, 200, 32, 50) # è®¾ç½®çª—å£çš„å¤§å°å’Œåæ ‡</span><br><span class="line">browser.set_window_size(200, 300) # è®¾ç½®çª—å£çš„å¤§å°</span><br></pre></td></tr></table></figure></li><li><p>å…³é—­é¡µé¢</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">browser.close() # å…³é—­å½“å‰æ ‡ç­¾é¡µ</span><br><span class="line">browser.quit() # å…³é—­æµè§ˆå™¨å¹¶å…³é—­é©±åŠ¨</span><br></pre></td></tr></table></figure></li><li><p>å±å¹•æ“ä½œ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">browser.save_screenshot(&#x27;save.png&#x27;) # æˆªå›¾ï¼Œåªæ”¯æŒ PNG æ ¼å¼</span><br><span class="line">browser.get_screenshot_as_png() # è·å–å½“å‰çª—å£çš„æˆªå›¾ä½œä¸ºäºŒè¿›åˆ¶æ•°æ®</span><br><span class="line">browser.get_screenshot_as_base64() # è·å–å½“å‰çª—å£çš„æˆªå›¾ä½œä¸º base64 ç¼–ç çš„å­—ç¬¦ä¸²</span><br></pre></td></tr></table></figure></li><li><p>å‰è¿›åé€€åˆ·æ–°</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">browser.forward() # å‰è¿›</span><br><span class="line">browser.back()  # åé€€</span><br><span class="line">browser.refresh() # åˆ·æ–°</span><br></pre></td></tr></table></figure></li></ol><h4 id="cookie-æ“ä½œ"><a href="#cookie-æ“ä½œ" class="headerlink" title="cookie æ“ä½œ"></a><code>cookie</code> æ“ä½œ</h4><ol><li><code>get_cookie(NAME)</code><br>è·å–æŒ‡å®šé”®çš„ <code>Cookies</code>ã€‚</li><li><code>get_cookies()</code><br>è·å–æ‰€æœ‰çš„ <code>Cookies</code>ã€‚</li><li><code>delete_cookie(NAME)</code><br>åˆ é™¤æŒ‡å®šé”®çš„ <code>Cookies</code>ã€‚</li><li><code>delete_all_cookies()</code><br>åˆ é™¤æ‰€æœ‰çš„ <code>Cookies</code>ã€‚</li></ol><h4 id="JavaScript-æ“ä½œ"><a href="#JavaScript-æ“ä½œ" class="headerlink" title="JavaScript æ“ä½œ"></a><code>JavaScript</code> æ“ä½œ</h4><p><code>Selenium</code> å¯ä»¥è‡ªå®šä¹‰æ‰§è¡Œ <code>JavaScript</code>ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">browser.execute_script(<span class="string">&quot;alter(&#x27;hello selenium!&#x27;)&quot;</span>)</span><br></pre></td></tr></table></figure><hr><h3 id="ç¤ºä¾‹-Demo"><a href="#ç¤ºä¾‹-Demo" class="headerlink" title="ç¤ºä¾‹ Demo"></a>ç¤ºä¾‹ <code>Demo</code></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.by <span class="keyword">import</span> By</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.keys <span class="keyword">import</span> Keys</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å–å±…æ°‘æ¶ˆè´¹ä»·æ ¼æŒ‡æ•° CPI æ•°æ®ï¼Œæ•°æ®æ¥æºäºä¸œæ–¹è´¢å¯Œç½‘ã€‚</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">to_next_page</span>(<span class="params">browser</span>):</span><br><span class="line"><span class="comment"># ç‚¹å‡»ä¸‹ä¸€é¡µï¼Œè·å–æ•°æ®</span></span><br><span class="line">pagerbox = browser.find_elements(By.CLASS_NAME, <span class="string">&#x27;pagerbox&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line">a = pagerbox.find_elements(By.TAG_NAME, <span class="string">&#x27;a&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> ai <span class="keyword">in</span> a:</span><br><span class="line"><span class="keyword">if</span> ai.text == <span class="string">&#x27;ä¸‹ä¸€é¡µ&#x27;</span>:</span><br><span class="line">ai.send_keys(Keys.ENTER)</span><br><span class="line"><span class="built_in">print</span>(ai.text)</span><br><span class="line">time.sleep(<span class="number">3</span>)</span><br><span class="line">get_data()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_data</span>(<span class="params">browser</span>):</span><br><span class="line"><span class="comment"># è§£ææ•°æ®ç»“æ„</span></span><br><span class="line">table = browser.find_element(By.CLASS_NAME, <span class="string">&#x27;table-model&#x27;</span>)</span><br><span class="line">tbody = table.find_elements(By.TAG_NAME, <span class="string">&#x27;tbody&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line">tr = tbody.find_elements(By.TAG_NAME, <span class="string">&#x27;tr&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(tr))</span><br><span class="line"><span class="comment"># éå†æ•°æ®ç»“æ„å¹¶è¾“å‡º</span></span><br><span class="line"><span class="keyword">for</span> tr_e <span class="keyword">in</span> tr:</span><br><span class="line">td = tr_e.find_elements(By.TAG_NAME, <span class="string">&#x27;td&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;-&#x27;</span>*<span class="number">50</span>)</span><br><span class="line"><span class="keyword">for</span> td_e <span class="keyword">in</span> td:</span><br><span class="line"><span class="built_in">print</span>(td_e.text)</span><br><span class="line"><span class="comment"># ä¸‹ä¸€é¡µ</span></span><br><span class="line">to_next_page(browser)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">parse_url</span>(<span class="params">url</span>):</span><br><span class="line">browser = webdriver.Chrome()</span><br><span class="line">browser.get(url)</span><br><span class="line"><span class="comment"># è·å– CPI æ•°æ®</span></span><br><span class="line">get_data(browser)</span><br><span class="line">browser.quit()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">url = <span class="string">&#x27;https://data.eastmoney.com/cjsj/cpi.html&#x27;</span></span><br><span class="line"><span class="comment"># è§£æ URL å¹¶è¾“å‡ºæ•°æ®</span></span><br><span class="line">parse_url(url)</span><br></pre></td></tr></table></figure><hr><h3 id="å¼‚å¸¸ä¿¡æ¯"><a href="#å¼‚å¸¸ä¿¡æ¯" class="headerlink" title="å¼‚å¸¸ä¿¡æ¯"></a>å¼‚å¸¸ä¿¡æ¯</h3><h4 id="NoSuchElementException"><a href="#NoSuchElementException" class="headerlink" title="NoSuchElementException"></a><code>NoSuchElementException</code></h4><p>åœ¨è·å–é¡µé¢å…ƒç´ åï¼Œå¦‚æœ <code>Dom</code> å‘ç”Ÿå˜åŒ–å°±ä¼šå‡ºç°è¯¥å¼‚å¸¸ã€‚</p><h4 id="stale-element-reference-stale-element-not-found"><a href="#stale-element-reference-stale-element-not-found" class="headerlink" title="stale element reference: stale element not found"></a><code>stale element reference: stale element not found</code></h4><p>åˆ†æè¯¥é—®é¢˜æ˜¯å› ä¸ºåœ¨ <code>Dom</code> æ ‘ä¸­æœªæ‰¾åˆ°è¯¥å…ƒç´ ã€‚å› æ­¤å…¶è§£å†³æ–¹æ¡ˆå°±æ˜¯ä¿è¯åœ¨æ“ä½œå‰ï¼Œè¯¥å…ƒç´ å­˜åœ¨ä¸”æ˜¯å¯æ“ä½œçš„ã€‚</p><hr><h3 id="å¼•ç”¨"><a href="#å¼•ç”¨" class="headerlink" title="å¼•ç”¨"></a>å¼•ç”¨</h3><p><a href="https://selenium-python.readthedocs.io/index.html">å®˜æ–¹æ–‡æ¡£</a></p><hr><h3 id="ä¸ªäººå¤‡æ³¨"><a href="#ä¸ªäººå¤‡æ³¨" class="headerlink" title="ä¸ªäººå¤‡æ³¨"></a>ä¸ªäººå¤‡æ³¨</h3><p><strong>æ­¤åšå®¢å†…å®¹å‡ä¸ºä½œè€…å­¦ä¹ æ‰€åšç¬”è®°ï¼Œä¾µåˆ ï¼</strong><br><strong>è‹¥è½¬ä½œå…¶ä»–ç”¨é€”ï¼Œè¯·æ³¨æ˜æ¥æºï¼</strong></p>]]></content>
    
    
    <summary type="html">&lt;h3 id=&quot;ç®€ä»‹&quot;&gt;&lt;a href=&quot;#ç®€ä»‹&quot; class=&quot;headerlink&quot; title=&quot;ç®€ä»‹&quot;&gt;&lt;/a&gt;ç®€ä»‹&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;&lt;code&gt;Selenium&lt;/code&gt;&lt;/strong&gt; æœ€åˆæ˜¯ä¸€ä¸ªç”¨äºç½‘ç«™çš„è‡ªåŠ¨åŒ–æµ‹è¯•å·¥å…·ï¼Œæ”¯æŒå„ç§ &lt;code&gt;Chrome&lt;/code&gt;ã€&lt;code&gt;Firefox&lt;/code&gt;ã€&lt;code&gt;Safari&lt;/code&gt; ç­‰ä¸»æµæµè§ˆå™¨ï¼ŒåŒæ—¶ä¹Ÿæ”¯æŒ &lt;code&gt;phantomJS&lt;/code&gt; æ— ç•Œé¢æµè§ˆå™¨ã€‚ä¸è¿‡å…¶æ›´é€šå¸¸çš„ä½¿ç”¨åœ¨äºçˆ¬è™«ä¸­ä½¿ç”¨ï¼Œå…¶ä¸»è¦æ˜¯ç”¨äºè§£å†³ &lt;code&gt;requests&lt;/code&gt; æ— æ³•ç›´æ¥æ‰§è¡Œ &lt;code&gt;JavaScript&lt;/code&gt; ä»£ç çš„é—®é¢˜ï¼Œä¸è¿‡ç”¨äºè§£æ &lt;code&gt;Dom&lt;/code&gt; å…ƒç´ æ›´æœ‰å…¶å¦™ç”¨ä¹‹å¤„ã€‚&lt;/p&gt;</summary>
    
    
    
    
    <category term="Python" scheme="https://blog.vgbhfive.cn/tags/Python/"/>
    
  </entry>
  
  <entry>
    <title>Linux-ncä½¿ç”¨æŒ‡å—</title>
    <link href="https://blog.vgbhfive.cn/Linux-nc%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/"/>
    <id>https://blog.vgbhfive.cn/Linux-nc%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/</id>
    <published>2023-11-02T14:59:32.000Z</published>
    <updated>2023-11-02T15:02:03.124Z</updated>
    
    <content type="html"><![CDATA[<h3 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h3><p><code>NetCat</code> æ˜¯ä¸€æ¬¾è°ƒè¯• <code>TCP/UDP</code> ç½‘ç»œè¿æ¥çš„åˆ©å™¨ï¼Œè¢«ç§°ä½œæ˜¯ç½‘ç»œè°ƒè¯•çš„ç‘å£«å†›åˆ€ï¼Œå¯è§å…¶åŠŸèƒ½å¼ºå¤§ã€‚</p><span id="more"></span><p><code>NetCat</code> çš„åŸºæœ¬åŠŸèƒ½å¦‚ä¸‹ï¼š</p><ul><li><strong><code>telnet</code> è·å–ç³»ç»Ÿ <code>banner</code> ä¿¡æ¯</strong></li><li><strong>ä¼ è¾“æ–‡æœ¬ä¿¡æ¯</strong></li><li><strong>ä¼ è¾“æ–‡ä»¶å’Œç›®å½•</strong></li><li><strong>åŠ å¯†ä¼ è¾“æ–‡ä»¶</strong></li><li><strong>ç«¯å£æ‰«æ</strong></li><li><strong>è¿œç¨‹æ§åˆ¶</strong></li></ul><hr><h3 id="å‚æ•°è¯´æ˜"><a href="#å‚æ•°è¯´æ˜" class="headerlink" title="å‚æ•°è¯´æ˜"></a>å‚æ•°è¯´æ˜</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">% </span><span class="language-bash">nc -h</span></span><br><span class="line">usage: nc [-46AacCDdEFhklMnOortUuvz] [-K tc] [-b boundif] [-i interval] [-p source_port]</span><br><span class="line">  [-s source_ip_address] [-w timeout] [-X proxy_version]</span><br><span class="line">  [-x proxy_address[:port]] [hostname] [port[s]]</span><br><span class="line">Command Summary:</span><br><span class="line">-4                            Use IPv4</span><br><span class="line">-6                            Use IPv6</span><br><span class="line">-A                            Set SO_RECV_ANYIF on socket</span><br><span class="line">-a                            Set SO_AWDL_UNRESTRICTED on socket</span><br><span class="line">-b ifbound                    Bind socket to interface</span><br><span class="line">-C                            Don&#x27;t use cellular connection</span><br><span class="line">-c                            Send CRLF as line-ending</span><br><span class="line">-D                            Enable the debug socket option</span><br><span class="line">-d                            Detach from stdin</span><br><span class="line">-E                            Don&#x27;t use expensive interfaces</span><br><span class="line">-F                            Do not use flow advisory (flow adv enabled by default)</span><br><span class="line">-G conntimo                   Connection timeout in seconds</span><br><span class="line">-H keepidle                   Initial idle timeout in seconds</span><br><span class="line">-h                            This help text</span><br><span class="line">-I keepintvl                  Interval for repeating idle timeouts in seconds</span><br><span class="line">-i secs                       Delay interval for lines sent, ports scanned</span><br><span class="line">-J keepcnt                    Number of times to repeat idle timeout</span><br><span class="line">-K tclass                     Specify traffic class</span><br><span class="line">-k                            Keep inbound sockets open for multiple connects</span><br><span class="line">-L num_probes                 Number of probes to send before generating a read timeout event</span><br><span class="line">-l                            Listen mode, for inbound connects</span><br><span class="line">-m                            Set SO_INTCOPROC_ALLOW on socket</span><br><span class="line">-N num_probes                 Number of probes to send before generating a write timeout event</span><br><span class="line">-o                            Issue socket options after connect/bind</span><br><span class="line">-n                            Suppress name/port resolutions</span><br><span class="line">-O                            Use old-style connect instead of connectx</span><br><span class="line">-p port                       Specify local port for remote connects (cannot use with -l)</span><br><span class="line">-r                            Randomize remote ports</span><br><span class="line">-s addr                       Local source address</span><br><span class="line">-t                            Answer TELNET negotiation</span><br><span class="line">-U                            Use UNIX domain socket</span><br><span class="line">-u                            UDP mode</span><br><span class="line">-v                            Verbose</span><br><span class="line">-w secs                       Timeout for connects and final net reads </span><br><span class="line">-X proto                      Proxy protocol: &quot;4&quot;, &quot;5&quot; (SOCKS) or &quot;connect&quot;</span><br><span class="line">-x addr[:port]                Specify proxy address and port</span><br><span class="line">-z                            Zero-I/O mode [used for scanning]</span><br><span class="line">Port numbers can be individual or ranges: lo-hi [inclusive]</span><br></pre></td></tr></table></figure><hr><h3 id="ç¤ºä¾‹"><a href="#ç¤ºä¾‹" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h3><h4 id="ç›‘å¬ç«¯å£"><a href="#ç›‘å¬ç«¯å£" class="headerlink" title="ç›‘å¬ç«¯å£"></a>ç›‘å¬ç«¯å£</h4><p>æŒç»­ç›‘å¬ <code>8888</code> ç«¯å£ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">% </span><span class="language-bash">nc -lk 8888</span></span><br><span class="line">GET /hello HTTP/1.1</span><br><span class="line">Host: localhost:8888</span><br><span class="line">User-Agent: curl/7.79.1</span><br><span class="line">Accept: */*</span><br></pre></td></tr></table></figure><h4 id="ç«¯å£æ‰«æ"><a href="#ç«¯å£æ‰«æ" class="headerlink" title="ç«¯å£æ‰«æ"></a>ç«¯å£æ‰«æ</h4><p>æ‰«æ <code>IP</code> ä¸º <code>192.168.0.125</code> çš„ <code>1-100</code> ç«¯å£ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">% </span><span class="language-bash">nc -v -z -w1 192.168.0.125 1-100</span></span><br><span class="line">nc: connectx to 192.168.0.125 port xx (tcp) failed: Connection refused</span><br><span class="line"><span class="meta prompt_">% </span><span class="language-bash">nc -v -z -w1 192.168.0.125 80 <span class="comment"># æ‰«æå•ä¸ªç«¯å£</span></span></span><br><span class="line">nc: connectx to 192.168.0.125 port 80 (tcp) failed: Connection refused</span><br></pre></td></tr></table></figure><h4 id="ä¼ è¾“æ–‡ä»¶"><a href="#ä¼ è¾“æ–‡ä»¶" class="headerlink" title="ä¼ è¾“æ–‡ä»¶"></a>ä¼ è¾“æ–‡ä»¶</h4><p>ä¸¤å°æœºå™¨ä¹‹é—´ä¼ è¾“æ–‡ä»¶ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ¥æ”¶ç«¯ï¼ˆæ–‡ä»¶åå¯ä»¥è‡ªå®šä¹‰ï¼‰</span></span><br><span class="line"><span class="meta prompt_">% </span><span class="language-bash">nc -lp 8888 &gt; tmp_receiver.tar.gz</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å‘é€ç«¯ï¼ˆ`192.168.0.125` ä¸ºæ¥æ”¶ç«¯çš„ `IP` åœ°å€ï¼‰ï¼Œæ¥æ”¶ç«¯å®Œæˆæ¥æ”¶åè‡ªåŠ¨é€€å‡º</span></span><br><span class="line"><span class="meta prompt_">% </span><span class="language-bash">nc -nv 192.168.0.125 8888 -i 1 &lt; tmp_sender.tar.gz</span></span><br></pre></td></tr></table></figure><h4 id="è¿œç¨‹æ§åˆ¶"><a href="#è¿œç¨‹æ§åˆ¶" class="headerlink" title="è¿œç¨‹æ§åˆ¶"></a>è¿œç¨‹æ§åˆ¶</h4><p>è¢«æ§ç«¯ä¸»åŠ¨è®¾ç½®ç«¯å£å’Œ <code>bash</code> ç¯å¢ƒï¼ˆå¦‚æœæœ‰é˜²ç«å¢™ï¼Œéœ€å¼€æ”¾ç«¯å£ï¼Œå¦åˆ™ä¼šè¢«æ‹¦æˆªï¼‰ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">è¢«æ§ç«¯</span></span><br><span class="line"><span class="meta prompt_">% </span><span class="language-bash">nc -lvnp 8888 -c bash</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ§åˆ¶ç«¯</span></span><br><span class="line"><span class="meta prompt_">% </span><span class="language-bash">nc 192.168.0.125 8888</span></span><br></pre></td></tr></table></figure><hr><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>å¤šä½¿ç”¨ï¼Œå¤šæ€»ç»“ï¼Œèä¼šè´¯é€šã€‚</p>]]></content>
    
    
    <summary type="html">&lt;h3 id=&quot;ç®€ä»‹&quot;&gt;&lt;a href=&quot;#ç®€ä»‹&quot; class=&quot;headerlink&quot; title=&quot;ç®€ä»‹&quot;&gt;&lt;/a&gt;ç®€ä»‹&lt;/h3&gt;&lt;p&gt;&lt;code&gt;NetCat&lt;/code&gt; æ˜¯ä¸€æ¬¾è°ƒè¯• &lt;code&gt;TCP/UDP&lt;/code&gt; ç½‘ç»œè¿æ¥çš„åˆ©å™¨ï¼Œè¢«ç§°ä½œæ˜¯ç½‘ç»œè°ƒè¯•çš„ç‘å£«å†›åˆ€ï¼Œå¯è§å…¶åŠŸèƒ½å¼ºå¤§ã€‚&lt;/p&gt;</summary>
    
    
    
    
    <category term="Linux" scheme="https://blog.vgbhfive.cn/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>Moto-æ‘©æ—…æ—¥è®°1</title>
    <link href="https://blog.vgbhfive.cn/Moto-%E6%91%A9%E6%97%85%E6%97%A5%E8%AE%B01/"/>
    <id>https://blog.vgbhfive.cn/Moto-%E6%91%A9%E6%97%85%E6%97%A5%E8%AE%B01/</id>
    <published>2023-10-03T03:20:11.195Z</published>
    <updated>2023-10-03T13:57:07.390Z</updated>
    
    <content type="html"><![CDATA[<h3 id="å›å¿†"><a href="#å›å¿†" class="headerlink" title="å›å¿†"></a>å›å¿†</h3><p>è®°å¾—ç¬¬ä¸€æ¬¡å‡ºå»éª‘è½¦è¿˜æ˜¯åœ¨å¤§äºŒçš„æ—¶å€™ï¼Œè®°å¾—æ˜¯è·¯çº¿ä»å­¦æ ¡å»å…´å¹³ï¼Œå…¨ç¨‹ <code>75</code> å…¬é‡Œï¼Œä¸‹åˆå››ç‚¹é’Ÿå¤šåˆ°çš„é…’åº—ï¼Œé…’åº—çš„é‚£ä¸ªé˜¿å§¨äººå¾ˆå¥½ï¼Œå¥¹è¿˜å…è®¸æˆ‘æŠŠæˆ‘çš„è‡ªè¡Œè½¦å¸¦åˆ°æ¥¼æ¢¯é—´é”èµ·æ¥ï¼ŒçŸ­æš‚ä¼‘æ¯åå°±å»äº†æ¨è´µå¦ƒå¢“ï¼Œåœ¨å¸‚åŒºé‡Œåƒäº†çƒ§çƒ¤å’Œé¸¡è›‹é†ªç³Ÿï¼Œç¬¬äºŒå¤©æ—©æ—©éª‘è½¦åˆå›äº†å­¦æ ¡ã€‚<br>ç°åœ¨å›æƒ³èµ·æ¥ï¼Œå½“æ—¶ç®€ç›´å°±æ˜¯æ— æ‰€ç•æƒ§ï¼Œä¸€ä¸ªäººå¸¦ç€æ‰‹æœºéª‘ç€å±±åœ°è½¦å°±å‡ºå‘äº†ğŸ¤¦â€â™‚ï¸</p><p><strong>å¤šå›¾è­¦å‘Šï¼ï¼ï¼</strong></p><span id="more"></span><hr><h3 id="è·¯çº¿"><a href="#è·¯çº¿" class="headerlink" title="è·¯çº¿"></a>è·¯çº¿</h3><p>æ­¤æ¬¡åŒ—äº¬ä¸œåŒ—æ–¹å‘å°ç¯çº¿æ‘©æ—…ä¸»è¦é€”å¾„åœ°ç‚¹ï¼š</p><ul><li>åŒ—äº¬</li><li>å”å±±</li><li>ç§¦çš‡å²›</li><li>æ‰¿å¾·</li><li>åŒ—äº¬</li></ul><p>æ¯ç«™ä¹‹é—´çš„è·ç¦» <code>200</code> å…¬é‡Œå·¦å³ï¼Œä¿è¯é•¿é€”éª‘è¡Œä¸èµ¶æ—¶é—´ã€å¤œæ™šæœ‰ä½å®¿çš„åœ°æ–¹ï¼Œå‰©ä½™çš„æ—¶é—´å¯ä»¥å¤šé€›é€›å½“åœ°ã€‚</p><hr><h3 id="è£…å¤‡"><a href="#è£…å¤‡" class="headerlink" title="è£…å¤‡"></a>è£…å¤‡</h3><h4 id="è½¦è¾†"><a href="#è½¦è¾†" class="headerlink" title="è½¦è¾†"></a>è½¦è¾†</h4><p>æœ¬ç”° <code>NS 125 LA</code></p><h4 id="è¯ä»¶"><a href="#è¯ä»¶" class="headerlink" title="è¯ä»¶"></a>è¯ä»¶</h4><ul><li>èº«ä»½è¯</li><li>é©¾é©¶è¯</li><li>è¡Œé©¶è¯</li></ul><h4 id="éª‘è¡Œè£…å¤‡"><a href="#éª‘è¡Œè£…å¤‡" class="headerlink" title="éª‘è¡Œè£…å¤‡"></a>éª‘è¡Œè£…å¤‡</h4><ul><li>å¤´ç›”ï¼ˆå»ºè®®å…¨ç›”ï¼‰</li><li>éª‘è¡Œæœ</li><li>æ‰‹å¥—</li><li>éª‘è¡Œé´</li></ul><h4 id="å·¥å…·"><a href="#å·¥å…·" class="headerlink" title="å·¥å…·"></a>å·¥å…·</h4><ul><li>è¾£æ¡è¡¥èƒå·¥å…·å¥—è£…</li><li>å……æ°”å®</li><li>èºä¸åˆ€ã€æ‰³æ‰‹å¥—è£…</li><li>å°åˆ€</li></ul><p><small>å»ºè®®å‡ºå‘å‰å¯ä»¥åšä¸€æ¬¡ä¿å…»ï¼Œé¿å…è·¯ä¸Šå‡ºç°é—®é¢˜ã€‚</small></p><h4 id="é€šè®¯"><a href="#é€šè®¯" class="headerlink" title="é€šè®¯"></a>é€šè®¯</h4><ul><li>æ‰‹æœºï¼ˆè®°å¾—å¸¦å……ç”µçº¿ï¼‰</li><li>å……ç”µå®ï¼ˆæ‘©æ‰˜è½¦èƒ½å……ç”µçš„å¯ä»¥ä¸å¸¦ï¼‰</li></ul><h4 id="è¡£ç‰©"><a href="#è¡£ç‰©" class="headerlink" title="è¡£ç‰©"></a>è¡£ç‰©</h4><ul><li>æ¢æ´—è¡£ç‰©ä¸¤å¥—</li><li>ä¿æš–å†…è¡£ä¸€å¥—</li><li>é€Ÿå¹²å†…è¡£ä¸€å¥—</li><li>æ´—æ¼±å¥—è£…</li><li>å¸½å­ã€æ–¹å·¾</li><li>é‹å­</li></ul><h4 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h4><ul><li>å¤‡ç”¨é£Ÿå“ï¼ˆé¥¼å¹²ã€æ°´ã€å·§å…‹åŠ›ã€ç”µè§£è´¨æ°´ã€å£é¦™ç³–ã€ç‰›è‚‰å¹²ï¼‰</li><li>ç°é‡‘</li><li>ä¿æ¸©æ¯</li><li>å¸¸ç”¨è¯å“ï¼ˆæ„Ÿå†’è¯ã€åˆ›å¯è´´ã€æ¶ˆç‚è¯ã€ç¢˜ä¼ã€çº±å¸ƒã€äº‘å—ç™½è¯ï¼‰</li><li>æŠ˜å æ¤…ï¼ˆèµ°åˆ°å–œæ¬¢çš„åœ°æ–¹å¯ä»¥éšæ—¶åä¸‹æ¥ï¼‰</li></ul><hr><h3 id="ç¾æ™¯"><a href="#ç¾æ™¯" class="headerlink" title="ç¾æ™¯"></a>ç¾æ™¯</h3><p>å›½åº†ç¬¬ä¸€å¤©æ—©æ™¨ <code>10</code> ç‚¹å‡ºå‘<br><img src="/Moto-%E6%91%A9%E6%97%85%E6%97%A5%E8%AE%B01/img-1.jpg" alt="img-1.jpg"></p><p>ä¸‹åˆéª‘è½¦æœ‰ç‚¹å›°ï¼Œå°±æ‰¾äº†ä¸ªè·¯è¾¹å°æ‘å­çš„èƒŒé˜´å¤„ä¼‘æ¯ï¼Œç»“æœâ€¦ï¼Œé£æŒ¡ç›´æ¥ç»™å¹²åºŸäº†ğŸ˜­ï¼Œä¸è¿‡å¥½åœ¨è½¦æ²¡å•¥äº‹<br><img src="/Moto-%E6%91%A9%E6%97%85%E6%97%A5%E8%AE%B01/img-2.jpg" alt="img-2.jpg"></p><p>ç¬¬ä¸€å¤©çš„ç›®çš„åœ°æ˜¯å”å±±ï¼Œä¹‹å‰çœ‹è¿‡ã€Šå”å±±å¤§åœ°éœ‡ã€‹çš„ç”µå½±ï¼Œæ—¢ç„¶åˆ°äº†å”å±±å°±æƒ³å»ä¸‹çºªå¿µé¦†ã€‚åˆ°äº†ç›®çš„åœ°ï¼Œçœ‹åˆ°é‚£é¢é‡éš¾äººå‘˜çºªå¿µå¢™ç›´æ¥ç»™æˆ‘éœ‡æ’¼ä½äº†ï¼<br><small>æ€»å…±æœ‰åäºŒé¢å¢™ï¼Œæ¯é¢å¢™ä¸Šæœ‰äºŒåå››åˆ—ã€åäºŒè¡Œï¼Œæ¯ä¸€å°å—æœ‰å…«è¡Œã€äº”åˆ—ã€‚</small><br><img src="/Moto-%E6%91%A9%E6%97%85%E6%97%A5%E8%AE%B01/img-3.jpg" alt="img-3.jpg"></p><p>æ‘©æ—…çš„ç¬¬äºŒå¤©ä¸­åˆå°±ç›´æ¥èµ¶åˆ°äº†æœ¬æ¬¡çš„é‡è¦ä¸­è½¬ç‚¹<strong>åŒ—æˆ´æ²³çš„é»„é‡‘æµ·å²¸</strong>ï¼Œå¥½å®¶ä¼™é‚£å«ä¸€ä¸ªäººå¤šï¼Œæˆ‘å‘†äº†ä¸åˆ°åŠä¸ªå°æ—¶ï¼Œæˆ‘å°±è·‘è·¯äº†ğŸ˜ï¼ˆäººæ˜¯çœŸçš„å¤šï¼Œç»™æˆ‘æ•´å®³æ€•äº†ï¼‰<br><small>å‡ºæ¥åæˆ‘å°±å‘æŒ¥äº†ä¸€ä¸ªäººå‡ºå»ç©çš„ä¼˜åŠ¿ï¼Œåœ°å›¾ä¸Šæ‰¾åˆ°äº†ä¸€ä¸ªæ•æ¸”ç å¤´ã€Šå¤§æµ¦æ²³ç å¤´ã€‹ï¼Œé¡ºç€è·¯ä¸€ç›´åˆ°é—¨å£åï¼Œä¸è¦å³æ‹ï¼Œå†ç›´ç€ä¸€ç›´é¢å‘å¤§æµ·èµ°ï¼Œä½ å°±ä¼šè·å¾—ä¸€ä¸ªä¸“å±çš„æµ·æ»©ã€‚ï¼ˆè®°å¾—è½¦ä¸è¦å¤ªé è¿‘æµ·è¾¹ï¼Œè·Ÿæˆ‘åŒè·¯å¤§å“¥çš„çŒ›ç¦½éƒ½é™·è¿›æ²™å­é‡Œäº†ğŸ˜‚ï¼‰</small><br><img src="/Moto-%E6%91%A9%E6%97%85%E6%97%A5%E8%AE%B01/img-4.jpg" alt="img-4.jpg"></p><p>ç¬¬äºŒå¤©çš„ä½å®¿æ˜¯åœ¨å±±æµ·å…³ï¼Œç«Ÿç„¶è¯¯æ‰“è¯¯æ’çš„é€šè¿‡äº†å±±æµ·å…³åŸå¢™ä¸‹çš„ä¸€ä¸ªå•è¡Œéš§é“ï¼ˆç±»ä¼¼äºåŸå¢™é—¨é‚£ç§çš„ï¼‰ï¼ŒæŒºæƒŠå–œçš„ï¼ˆå°±æ˜¯æ²¡åŠæ³•æ‹ç…§â˜¹ï¼‰<br>å¤ªå›°äº†å°±æ²¡æ€ä¹ˆåœ¨æµ·è¾¹ç©ï¼Œæ‰€ä»¥æˆ‘ç¬¬äºŒå¤©æ—©èµ·å»çœ‹äº†æ—¥å‡ºï¼ŒçœŸçš„æ˜¯å˜å˜å¥½çœ‹ï¼ˆè¿™æ˜¯åœ¨å±±æµ·å…³æ™¯åŒºåŒ—è¾¹ä¸€å…¬é‡Œçš„æµ·è¾¹åœè½¦åœºï¼‰<br><img src="/Moto-%E6%91%A9%E6%97%85%E6%97%A5%E8%AE%B01/img-5.jpg" alt="img-5.jpg"></p><p>ä»å±±æµ·å…³åˆšå‡ºå‘è¿›åˆ°å±±é‡Œï¼Œå°±çœ‹åˆ°äº†å±±å¤´çš„é•¿åŸã€‚ï¼ˆçœŸçš„ä½©æœå¤äººä¿®äº†ä¸€ä¸‡äº”åƒå…¬é‡Œçš„åŸå¢™ï¼‰<br><img src="/Moto-%E6%91%A9%E6%97%85%E6%97%A5%E8%AE%B01/img-7.jpg" alt="img-7.jpg"></p><p>çœ‹æ—¥å‡ºèµ·çš„å¤ªæ—©äº†å°±åˆå›å»ç¡äº†ä¸€ä¼šï¼Œä¹ç‚¹åŠç›´æ¥å‡ºå‘æ‰¿å¾·ï¼Œåœ¨è·¯ä¸Šå–å’–å•¡ä¼‘æ¯çš„æ—¶å€™æ‘˜çš„ä¸€æœµèŠ±ï¼ˆæˆ‘ç»™ç»‘åœ¨äº†ååº§çš„åŒ…ä¸Šï¼Œç»“æœä»æ‰¿å¾·å›åŒ—äº¬çš„è·¯ä¸Šå°±æ²¡æœ‰äº†ğŸ˜¤ï¼‰<br><img src="/Moto-%E6%91%A9%E6%97%85%E6%97%A5%E8%AE%B01/img-6.jpg" alt="img-6.jpg"></p><p>æ‰¿å¾·å‡ºå‘å›åŒ—äº¬ï¼Œå»å–äº†å½“åœ°çš„å¹³æ³‰ç¾Šæ±¤ã€‚å“‡ï¼Œç¬¬ä¸€å£æ˜¯çœŸçš„å¥½å–ï¼Œå¼ºçƒˆæ¨èçƒ§é¥¼å¤¹è‚‰ï¼ˆæ‰¿å¾·å¿æ¸…çœŸå¹³æ³‰ç¾Šæ±¤çƒ§é¥¼-åº·å®è·¯åº—ï¼‰<br><img src="/Moto-%E6%91%A9%E6%97%85%E6%97%A5%E8%AE%B01/img-8.jpg" alt="img-8.jpg"></p><p>å›äº¬é€”ä¸­ï¼Œè¯¯å…¥ä¿®è·¯å·¥åœ°ï¼Œæ™¯è‰²ä¸é”™ã€‚<br><img src="/Moto-%E6%91%A9%E6%97%85%E6%97%A5%E8%AE%B01/img-9.jpg" alt="img-9.jpg"></p><hr><h3 id="è¶£äº‹"><a href="#è¶£äº‹" class="headerlink" title="è¶£äº‹"></a>è¶£äº‹</h3><p>åœ¨å±±æµ·å…³çš„é‚£å¤©æ—©èµ·å»çœ‹äº†æ—¥å‡ºï¼Œå›å»çš„æ—¶å€™åœ¨é…’åº—æœ‰ä¸€å®¶æ—©é¤åº—ï¼Œå°±ä¹°äº†ä¸€æ¯è±†æµ†å’Œä¸¤æ ¹æ²¹æ¡ï¼Œä¸´èµ°çš„æ—¶å€™æƒ³å†ä¹°ä¸€æ¯è±†æµ†å†²å’–å•¡ï¼Œç„¶åé‚£ä¸ªå–æ—©é¤çš„é˜¿å§¨å°±å¾ˆç–‘æƒ‘ï¼Œè·Ÿæˆ‘è¯´ï¼šæˆ‘è®°å¾—ä½ æ—©ä¸Šåƒæ—©é¤äº†å‘€ï¼</p><p>åŸæ¥åœ¨æˆ‘ä»¬æœ€ä¸ç»æ„çš„åœ°æ–¹ï¼Œä¹Ÿæ˜¯æ€»æœ‰ä¸€äº›äººåœ¨å…³æ³¨ç€æˆ‘ä»¬ã€‚</p><hr><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>æ‘©æ—…æœ€é‡è¦çš„æ˜¯è¿‡ç¨‹è€Œä¸æ˜¯ç»ˆç‚¹ï¼Œäº«å—åœ¨è·¯ä¸Šçš„æ¯ä¸€åˆ†é’Ÿã€‚</p>]]></content>
    
    
    <summary type="html">&lt;h3 id=&quot;å›å¿†&quot;&gt;&lt;a href=&quot;#å›å¿†&quot; class=&quot;headerlink&quot; title=&quot;å›å¿†&quot;&gt;&lt;/a&gt;å›å¿†&lt;/h3&gt;&lt;p&gt;è®°å¾—ç¬¬ä¸€æ¬¡å‡ºå»éª‘è½¦è¿˜æ˜¯åœ¨å¤§äºŒçš„æ—¶å€™ï¼Œè®°å¾—æ˜¯è·¯çº¿ä»å­¦æ ¡å»å…´å¹³ï¼Œå…¨ç¨‹ &lt;code&gt;75&lt;/code&gt; å…¬é‡Œï¼Œä¸‹åˆå››ç‚¹é’Ÿå¤šåˆ°çš„é…’åº—ï¼Œé…’åº—çš„é‚£ä¸ªé˜¿å§¨äººå¾ˆå¥½ï¼Œå¥¹è¿˜å…è®¸æˆ‘æŠŠæˆ‘çš„è‡ªè¡Œè½¦å¸¦åˆ°æ¥¼æ¢¯é—´é”èµ·æ¥ï¼ŒçŸ­æš‚ä¼‘æ¯åå°±å»äº†æ¨è´µå¦ƒå¢“ï¼Œåœ¨å¸‚åŒºé‡Œåƒäº†çƒ§çƒ¤å’Œé¸¡è›‹é†ªç³Ÿï¼Œç¬¬äºŒå¤©æ—©æ—©éª‘è½¦åˆå›äº†å­¦æ ¡ã€‚&lt;br&gt;ç°åœ¨å›æƒ³èµ·æ¥ï¼Œå½“æ—¶ç®€ç›´å°±æ˜¯æ— æ‰€ç•æƒ§ï¼Œä¸€ä¸ªäººå¸¦ç€æ‰‹æœºéª‘ç€å±±åœ°è½¦å°±å‡ºå‘äº†ğŸ¤¦â€â™‚ï¸&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å¤šå›¾è­¦å‘Šï¼ï¼ï¼&lt;/strong&gt;&lt;/p&gt;</summary>
    
    
    
    
    <category term="Moto" scheme="https://blog.vgbhfive.cn/tags/Moto/"/>
    
  </entry>
  
  <entry>
    <title>MathJaxè¯­æ³•æŒ‡å—</title>
    <link href="https://blog.vgbhfive.cn/MathJax%E8%AF%AD%E6%B3%95%E6%8C%87%E5%8D%97/"/>
    <id>https://blog.vgbhfive.cn/MathJax%E8%AF%AD%E6%B3%95%E6%8C%87%E5%8D%97/</id>
    <published>2023-09-27T15:43:21.000Z</published>
    <updated>2023-10-06T04:57:24.409Z</updated>
    
    <content type="html"><![CDATA[<h3 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h3><p><strong><code>MathJax</code></strong> æ˜¯ä¸€ä¸ª <code>JavaScript</code> åº“ï¼Œå¯ä»¥è®©ä½ ç›´æ¥ç”¨ <code>Latex</code> è¯­æ³•æ¥å†™å¤æ‚æ•°å­¦å…¬å¼ï¼Œä½¿ç”¨ååˆ†æ–¹ä¾¿ã€‚</p><span id="more"></span><hr><h3 id="åŸºç¡€ä½¿ç”¨"><a href="#åŸºç¡€ä½¿ç”¨" class="headerlink" title="åŸºç¡€ä½¿ç”¨"></a>åŸºç¡€ä½¿ç”¨</h3><h4 id="å¦‚ä½•é…ç½®"><a href="#å¦‚ä½•é…ç½®" class="headerlink" title="å¦‚ä½•é…ç½®"></a>å¦‚ä½•é…ç½®</h4><p>å…³äºå¦‚ä½•åœ¨ <code>hexo</code> ä¸­å¢åŠ  <code>MathJax</code> çš„æ”¯æŒï¼Œå¯ä»¥çœ‹è¿™ç¯‡<a href="https://hexo-next.readthedocs.io/zh_CN/latest/next/advanced/%E9%85%8D%E7%BD%AEMathJax/">å®˜æ–¹æ–‡æ¡£</a>ã€‚</p><h4 id="ä½¿ç”¨ä½ç½®"><a href="#ä½¿ç”¨ä½ç½®" class="headerlink" title="ä½¿ç”¨ä½ç½®"></a>ä½¿ç”¨ä½ç½®</h4><ol><li>è¡Œå†… <code>$ x $</code>ï¼š$x$</li><li>æ¢è¡Œ <code>$$ x $$</code>ï¼š$$x$$</li></ol><h4 id="ä¸Šä¸‹æ ‡"><a href="#ä¸Šä¸‹æ ‡" class="headerlink" title="ä¸Šä¸‹æ ‡"></a>ä¸Šä¸‹æ ‡</h4><ol><li><p>ä¸‹æ ‡ <code>$x_1$</code>ï¼š$x_1$</p></li><li><p>ä¸Šæ ‡ <code>$x^2$</code>ï¼š$x^2$</p></li></ol><h4 id="ç©ºæ ¼"><a href="#ç©ºæ ¼" class="headerlink" title="ç©ºæ ¼"></a>ç©ºæ ¼</h4><p><code>$\quad$</code></p><h4 id="æ§åˆ¶æ‹¬å·å¤§å°"><a href="#æ§åˆ¶æ‹¬å·å¤§å°" class="headerlink" title="æ§åˆ¶æ‹¬å·å¤§å°"></a>æ§åˆ¶æ‹¬å·å¤§å°</h4><p>ä½¿ç”¨ <code>\left</code> å’Œ <code>\right</code> èƒ½è‡ªåŠ¨æ§åˆ¶ä¸åŒå±‚æ¬¡æ‹¬å·çš„å¤§å°ï¼Œéœ€è¦é…å¯¹ä½¿ç”¨ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\left( \frac&#123;3&#125;&#123;5&#125;  \left[ 3 + 2 * \left( a + b \right) \right] \right)</span><br></pre></td></tr></table></figure><p>$$ \left( \frac{3}{5}  \left[ 3 + 2 * \left( a + b \right) \right] \right) $$</p><h4 id="å…¬å¼æ‰‹åŠ¨ç¼–å·"><a href="#å…¬å¼æ‰‹åŠ¨ç¼–å·" class="headerlink" title="å…¬å¼æ‰‹åŠ¨ç¼–å·"></a>å…¬å¼æ‰‹åŠ¨ç¼–å·</h4><p>åœ¨å…¬å¼ä¹¦å†™æ—¶ä½¿ç”¨ <code>\tag&#123;num&#125;</code> æ·»åŠ æ‰‹åŠ¨ç¼–å·ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$$</span><br><span class="line">\begin&#123;equation&#125;</span><br><span class="line">f(x) = wÂ·x + b \tag&#123;1&#125;</span><br><span class="line">\end&#123;equation&#125;</span><br><span class="line">$$</span><br></pre></td></tr></table></figure><p>$$<br>\begin{equation}<br>f(x) &#x3D; wÂ·x + b \tag{1}<br>\end{equation}<br>$$</p><h4 id="å¤šè¡Œå…¬å¼å¯¹é½"><a href="#å¤šè¡Œå…¬å¼å¯¹é½" class="headerlink" title="å¤šè¡Œå…¬å¼å¯¹é½"></a>å¤šè¡Œå…¬å¼å¯¹é½</h4><p><code>begin&#123;split&#125;</code> è¡¨ç¤ºå¼€å§‹å¤šè¡Œå…¬å¼ï¼Œ<code>end&#123;split&#125;</code> è¡¨ç¤ºç»“æŸï¼Œå…¬å¼ä¸­ç”¨ <code>\\</code> è¡¨ç¤ºå›è½¦åˆ°ä¸‹ä¸€è¡Œï¼Œ<code>&amp;</code> è¡¨ç¤ºå¯¹é½çš„ä½ç½®ï¼Œ<code>\nonumber</code> è¡¨ç¤ºä¸å±•ç¤ºå…¬å¼ç¼–å·ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$$</span><br><span class="line">\begin&#123;equation&#125;</span><br><span class="line">\begin&#123;split&#125;</span><br><span class="line">f(x) &amp;= x + 2x + 14 \\\\</span><br><span class="line">&amp;= 3x + 14</span><br><span class="line">\end&#123;split&#125;</span><br><span class="line">\nonumber</span><br><span class="line">\end&#123;equation&#125;</span><br><span class="line">$$</span><br></pre></td></tr></table></figure><p>$$<br>\begin{equation}<br>\begin{split}<br>f(x) &amp;&#x3D; x + 2x + 14 \\<br>&amp;&#x3D; 3x + 14<br>\end{split}<br>\nonumber<br>\end{equation}<br>$$</p><hr><h3 id="ç¬¦å·"><a href="#ç¬¦å·" class="headerlink" title="ç¬¦å·"></a>ç¬¦å·</h3><h4 id="å¸Œè…Šå­—æ¯"><a href="#å¸Œè…Šå­—æ¯" class="headerlink" title="å¸Œè…Šå­—æ¯"></a>å¸Œè…Šå­—æ¯</h4><table><thead><tr><th><code>latex</code></th><th>æ˜¾ç¤ºæ•ˆæœ</th><th><code>latex</code></th><th>æ˜¾ç¤ºæ•ˆæœ</th><th><code>latex</code></th><th>æ˜¾ç¤ºæ•ˆæœ</th></tr></thead><tbody><tr><td><code>\alpha</code></td><td>$\alpha$</td><td></td><td></td><td></td><td></td></tr><tr><td><code>\beta</code></td><td>$\beta$</td><td></td><td></td><td></td><td></td></tr><tr><td><code>\gamma</code></td><td>$\gamma$</td><td><code>\Gamma</code></td><td>$\Gamma$</td><td><code>\digamma</code></td><td>$\digamma$</td></tr><tr><td><code>\delta</code></td><td>$\delta$</td><td><code>\Delta</code></td><td>$\Delta$</td><td></td><td></td></tr><tr><td><code>\epsilon</code></td><td>$\epsilon$</td><td><code>\varepsilon</code></td><td>$\varepsilon$</td><td></td><td></td></tr><tr><td><code>\zeta</code></td><td>$\zeta$</td><td></td><td></td><td></td><td></td></tr><tr><td><code>\eta</code></td><td>$\eta$</td><td></td><td></td><td></td><td></td></tr><tr><td><code>\theta</code></td><td>$\theta$</td><td><code>\Theta</code></td><td>$\Theta$</td><td><code>\vartheta</code></td><td>$\vartheta$</td></tr><tr><td><code>\iota</code></td><td>$\iota$</td><td></td><td></td><td></td><td></td></tr><tr><td><code>\kappa</code></td><td>$\kappa$</td><td><code>\varkappa</code></td><td>$\varkappa$</td><td></td><td></td></tr><tr><td><code>\lambda</code></td><td>$\lambda$</td><td><code>\Lambda</code></td><td>$\Lambda$</td><td></td><td></td></tr><tr><td><code>\mu</code></td><td>$\mu$</td><td><code>\nu</code></td><td>$\nu$</td><td></td><td></td></tr><tr><td><code>\xi</code></td><td>$\xi$</td><td><code>\Xi</code></td><td>$\Xi$</td><td></td><td></td></tr><tr><td><code>\pi</code></td><td>$\pi$</td><td><code>\Pi</code></td><td>$\Pi$</td><td><code>\varpi</code></td><td>$\varpi$</td></tr><tr><td><code>\rho</code></td><td>$\rho$</td><td><code>\varrho</code></td><td>$\varrho$</td><td></td><td></td></tr><tr><td><code>\sigma</code></td><td>$\sigma$</td><td><code>\Sigma</code></td><td>$\Sigma$</td><td><code>\varsigma</code></td><td>$\varsigma$</td></tr><tr><td><code>\tau</code></td><td>$\tau$</td><td></td><td></td><td></td><td></td></tr><tr><td><code>\upsilon</code></td><td>$\upsilon$</td><td><code>\Upsilon</code></td><td>$\Upsilon$</td><td></td><td></td></tr><tr><td><code>\phi</code></td><td>$\phi$</td><td><code>\Phi</code></td><td>$\Phi$</td><td><code>\varphi</code></td><td>$\varphi$</td></tr><tr><td><code>\chi</code></td><td>$\chi$</td><td></td><td></td><td></td><td></td></tr><tr><td><code>\psi</code></td><td>$\psi$</td><td><code>\Psi</code></td><td>$\Psi$</td><td></td><td></td></tr><tr><td><code>\omega</code></td><td>$\omega$</td><td><code>\Omega</code></td><td>$\Omega$</td><td></td><td></td></tr></tbody></table><h4 id="æ•°å­¦ç¬¦å·"><a href="#æ•°å­¦ç¬¦å·" class="headerlink" title="æ•°å­¦ç¬¦å·"></a>æ•°å­¦ç¬¦å·</h4><ol><li><p>æ±‚å’Œ<br><code>\sum</code>ï¼š$\sum$</p></li><li><p>åå¯¼<br><code>\partial</code>ï¼š$\partial$</p></li><li><p>æ¢¯åº¦<br><code>\nabla</code>ï¼š$\nabla$</p></li><li><p>å–æ•´<br>å‘ä¸‹å–æ•´ <code>\lfloor x \rfloor</code>ï¼š$\lfloor x \rfloor$ <br><br>å‘ä¸Šå–æ•´ <code>\lceil x \rceil</code>ï¼š$\lceil x \rceil$</p></li></ol><h4 id="ç®­å¤´ç¬¦å·"><a href="#ç®­å¤´ç¬¦å·" class="headerlink" title="ç®­å¤´ç¬¦å·"></a>ç®­å¤´ç¬¦å·</h4><table><thead><tr><th><code>latex</code></th><th>æ˜¾ç¤ºæ•ˆæœ</th><th><code>latex</code></th><th>æ˜¾ç¤ºæ•ˆæœ</th></tr></thead><tbody><tr><td><code>\uparrow</code></td><td>$\uparrow$</td><td><code>\Uparrow</code></td><td>$\Uparrow$</td></tr><tr><td><code>\downarrow</code></td><td>$\downarrow$</td><td><code>\Downarrow</code></td><td>$\Downarrow$</td></tr><tr><td><code>\updownarrow</code></td><td>$\updownarrow$</td><td><code>\Updownarrow</code></td><td>$\Updownarrow$</td></tr><tr><td><code>\leftarrow</code></td><td>$\leftarrow$</td><td><code>\Leftarrow</code></td><td>$\Leftarrow$</td></tr><tr><td><code>\rightarrow</code></td><td>$\rightarrow$</td><td><code>\Rightarrow</code></td><td>$\Rightarrow$</td></tr><tr><td><code>\leftrightarrow</code></td><td>$\leftrightarrow$</td><td><code>\Leftrightarrow</code></td><td>$\Leftrightarrow$</td></tr><tr><td><code>\leftharpoonup</code></td><td>$\leftharpoonup$</td><td><code>\leftharpoondown</code></td><td>$\leftharpoondown$</td></tr><tr><td><code>\rightharpoonup</code></td><td>$\rightharpoonup$</td><td><code>\rightharpoondown</code></td><td>$\rightharpoondown$</td></tr><tr><td><code>\upharpoonright</code></td><td>$\upharpoonright$</td><td><code>\downharpoonright</code></td><td>$\downharpoonright$</td></tr></tbody></table><h4 id="ç‰¹æ®Šç¬¦å·"><a href="#ç‰¹æ®Šç¬¦å·" class="headerlink" title="ç‰¹æ®Šç¬¦å·"></a>ç‰¹æ®Šç¬¦å·</h4><table><thead><tr><th><code>latex</code></th><th>æ˜¾ç¤ºæ•ˆæœ</th></tr></thead><tbody><tr><td><code>\aleph</code></td><td>$\aleph$</td></tr><tr><td><code>\beth</code></td><td>$\beth$</td></tr><tr><td><code>\daleth</code></td><td>$\daleth$</td></tr><tr><td><code>\gimel</code></td><td>$\gimel$</td></tr></tbody></table><hr><h3 id="å…¬å¼"><a href="#å…¬å¼" class="headerlink" title="å…¬å¼"></a>å…¬å¼</h3><h4 id="çŸ©é˜µ"><a href="#çŸ©é˜µ" class="headerlink" title="çŸ©é˜µ"></a>çŸ©é˜µ</h4><ol><li><p>æ–¹æ‹¬å·çŸ©é˜µ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$$</span><br><span class="line">A =</span><br><span class="line">\begin&#123;bmatrix&#125;</span><br><span class="line">1 &amp; 0 &amp; 2 \\\\</span><br><span class="line">-2 &amp; 1 &amp; 3 \\\\</span><br><span class="line">\end&#123;bmatrix&#125;</span><br><span class="line">$$</span><br></pre></td></tr></table></figure><p>$$<br>A &#x3D;<br>\begin{bmatrix}<br>1 &amp; 0 &amp; 2 \\<br>-2 &amp; 1 &amp; 3 \\<br>\end{bmatrix}<br>$$</p></li><li><p>æ— æ‹¬å·çŸ©é˜µ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$$</span><br><span class="line">\begin&#123;matrix&#125;</span><br><span class="line">1 &amp; x &amp; x^2 \\\\</span><br><span class="line">1 &amp; y &amp; y^2 \\\\</span><br><span class="line">1 &amp; z &amp; z^2 \\\\</span><br><span class="line">\end&#123;matrix&#125;</span><br><span class="line">$$</span><br></pre></td></tr></table></figure><p>$$<br>\begin{matrix}<br>1 &amp; x &amp; x^2 \\<br>1 &amp; y &amp; y^2 \\<br>1 &amp; z &amp; z^2 \\<br>\end{matrix}<br>$$</p></li><li><p>ç«–çº¿çŸ©é˜µ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$$</span><br><span class="line">\left[</span><br><span class="line">    \begin&#123;array&#125;&#123;cc|c&#125;</span><br><span class="line">      1&amp;2&amp;3\\\\</span><br><span class="line">      4&amp;5&amp;6</span><br><span class="line">    \end&#123;array&#125;</span><br><span class="line">\right]</span><br><span class="line">$$</span><br></pre></td></tr></table></figure><p>$$<br>\left[<br> \begin{array}{cc|c}<br>   1&amp;2&amp;3\\<br>   4&amp;5&amp;6<br> \end{array}<br>\right]<br>$$</p></li></ol><h4 id="æ–¹ç¨‹ç»„"><a href="#æ–¹ç¨‹ç»„" class="headerlink" title="æ–¹ç¨‹ç»„"></a>æ–¹ç¨‹ç»„</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$$</span><br><span class="line">\begin&#123;cases&#125;</span><br><span class="line">x = x_1 + t_1(x_2 - x_1) \\\\</span><br><span class="line">y = y_1 + t_1(y_2 - y_1)</span><br><span class="line">\end&#123;cases&#125;</span><br><span class="line">\quad t_1 \in [0,1]</span><br><span class="line">$$</span><br></pre></td></tr></table></figure><p>$$<br>\begin{cases}<br>x &#x3D; x_1 + t_1(x_2 - x_1) \\<br>y &#x3D; y_1 + t_1(y_2 - y_1)<br>\end{cases}<br>\quad t_1 \in [0,1]<br>$$</p><h4 id="å¤šè¡Œå…¬å¼"><a href="#å¤šè¡Œå…¬å¼" class="headerlink" title="å¤šè¡Œå…¬å¼"></a>å¤šè¡Œå…¬å¼</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$$</span><br><span class="line">\begin&#123;equation&#125;</span><br><span class="line">\begin&#123;split&#125;</span><br><span class="line">\frac&#123;\partial^2 f&#125;&#123;\partial&#123;x^2&#125;&#125; &amp;= \frac&#123;\partial(\Delta_x f(i,j))&#125;&#123;\partial x&#125; = \frac&#123;\partial(f(i+1,j)-f(i,j))&#125;&#123;\partial x&#125; \\\\</span><br><span class="line">&amp;= \frac&#123;\partial f(i+1,j)&#125;&#123;\partial x&#125; - \frac&#123;\partial f(i,j)&#125;&#123;\partial x&#125; \\\\</span><br><span class="line">&amp;= f(i+2,j) -2f(f+1,j) + f(i,j)</span><br><span class="line">\end&#123;split&#125;</span><br><span class="line">\nonumber</span><br><span class="line">\end&#123;equation&#125;</span><br><span class="line">$$</span><br></pre></td></tr></table></figure><p>$$<br>\begin{equation}<br>\begin{split}<br>\frac{\partial^2 f}{\partial{x^2}} &amp;&#x3D; \frac{\partial(\Delta_x f(i,j))}{\partial x} &#x3D; \frac{\partial(f(i+1,j)-f(i,j))}{\partial x} \\<br>&amp;&#x3D; \frac{\partial f(i+1,j)}{\partial x} - \frac{\partial f(i,j)}{\partial x} \\<br>&amp;&#x3D; f(i+2,j) -2f(f+1,j) + f(i,j)<br>\end{split}<br>\nonumber<br>\end{equation}<br>$$</p><h4 id="å¤šè¡Œåˆ†æ”¯ç­‰å¼"><a href="#å¤šè¡Œåˆ†æ”¯ç­‰å¼" class="headerlink" title="å¤šè¡Œåˆ†æ”¯ç­‰å¼"></a>å¤šè¡Œåˆ†æ”¯ç­‰å¼</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$$</span><br><span class="line">f(n) =</span><br><span class="line">\begin&#123;cases&#125;</span><br><span class="line">n/2,  &amp; \text&#123;if $n$ is even&#125; \\\\</span><br><span class="line">3n+1, &amp; \text&#123;if $n$ is odd&#125;</span><br><span class="line">\end&#123;cases&#125;</span><br><span class="line">$$</span><br></pre></td></tr></table></figure><p>$$<br>f(n) &#x3D;<br>\begin{cases}<br>n&#x2F;2,  &amp; \text{n &gt;&#x3D; 0} \\<br>3n+1, &amp; \text{n &lt; 0}<br>\end{cases}<br>$$</p><hr><h3 id="å·¥å…·"><a href="#å·¥å…·" class="headerlink" title="å·¥å…·"></a>å·¥å…·</h3><p><a href="https://mhchem.github.io/MathJax-mhchem/">test drive</a></p>]]></content>
    
    
    <summary type="html">&lt;h3 id=&quot;ç®€ä»‹&quot;&gt;&lt;a href=&quot;#ç®€ä»‹&quot; class=&quot;headerlink&quot; title=&quot;ç®€ä»‹&quot;&gt;&lt;/a&gt;ç®€ä»‹&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;&lt;code&gt;MathJax&lt;/code&gt;&lt;/strong&gt; æ˜¯ä¸€ä¸ª &lt;code&gt;JavaScript&lt;/code&gt; åº“ï¼Œå¯ä»¥è®©ä½ ç›´æ¥ç”¨ &lt;code&gt;Latex&lt;/code&gt; è¯­æ³•æ¥å†™å¤æ‚æ•°å­¦å…¬å¼ï¼Œä½¿ç”¨ååˆ†æ–¹ä¾¿ã€‚&lt;/p&gt;</summary>
    
    
    
    
    <category term="Utils" scheme="https://blog.vgbhfive.cn/tags/Utils/"/>
    
  </entry>
  
  <entry>
    <title>ML-é€»è¾‘å›å½’</title>
    <link href="https://blog.vgbhfive.cn/ML-%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92/"/>
    <id>https://blog.vgbhfive.cn/ML-%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92/</id>
    <published>2023-09-21T13:59:51.511Z</published>
    <updated>2023-09-28T17:02:56.860Z</updated>
    
    <content type="html"><![CDATA[<h3 id="åŸºç¡€"><a href="#åŸºç¡€" class="headerlink" title="åŸºç¡€"></a>åŸºç¡€</h3><p><strong>é€»è¾‘å›å½’ï¼ˆ<code>logistic regression</code>ï¼‰</strong>æ˜¯ç»Ÿè®¡å­¦ä¹ ä¸­çš„ç»å…¸åˆ†ç±»æ–¹æ³•ï¼Œè™½ç„¶è¢«ç§°ä¸ºå›å½’ï¼Œä½†å…¶å®æ˜¯ä¸ªåˆ†ç±»æ¨¡å‹ã€‚å…¶æœ¬è´¨æ˜¯å‡è®¾æŸä¸ªæ•°æ®æœä»é€»è¾‘åˆ†å¸ƒï¼Œå°±å¯ä»¥ä½¿ç”¨æå¤§ä¼¼ç„¶æ³•ä¼°è®¡å‡ºå…¶çº¿æ€§å›å½’çš„å‚æ•°ï¼Œä¹‹åå†ä½¿ç”¨ <code>Sigmoid</code> é€»è¾‘å‡½æ•°å¯¹å…¶åˆ†ç±»ã€‚<br><small>é¢è¯•çš„æ—¶å€™åƒä¸‡ä¸è¦è¯´ä½ å¾ˆäº†è§£ <code>LR</code>ï¼Œå› ä¸ºç»†èŠ‚çœŸçš„å¤ªå¤šäº†ğŸ˜‚</small></p><span id="more"></span><hr><h3 id="é€»è¾‘å›å½’æ¨¡å‹"><a href="#é€»è¾‘å›å½’æ¨¡å‹" class="headerlink" title="é€»è¾‘å›å½’æ¨¡å‹"></a>é€»è¾‘å›å½’æ¨¡å‹</h3><h4 id="é€»è¾‘å›å½’åˆ†å¸ƒ"><a href="#é€»è¾‘å›å½’åˆ†å¸ƒ" class="headerlink" title="é€»è¾‘å›å½’åˆ†å¸ƒ"></a>é€»è¾‘å›å½’åˆ†å¸ƒ</h4><p>è®¾ <code>X</code> æ˜¯è¿ç»­éšæœºå˜é‡ï¼Œ<code>X</code> æœä»é€»è¾‘åˆ†å¸ƒæ˜¯æŒ‡å…·æœ‰ä¸‹åˆ—<strong>åˆ†å¸ƒå‡½æ•°</strong>å’Œ<strong>å¯†åº¦å‡½æ•°</strong>ï¼š<br>$$ F(x) &#x3D; P(X&lt;&#x3D;x) &#x3D; {\frac {1} {1 + e^{-(x-\mu)&#x2F;\gamma}}} $$<br>$$ f(x) &#x3D; F^â€˜(x) &#x3D; {\frac {e^{-(x-\mu)&#x2F;\gamma}} {\gamma(1+e^{-(x-\mu)&#x2F;\gamma})^2}} $$<br><small>$\mu$ ä¸ºä½ç½®å‚æ•°ï¼Œ$\gamma&gt;0$ ä¸ºå½¢çŠ¶å‚æ•°ã€‚</small></p><p><img src="/ML-%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92/logistic_1.jpg" alt="logistic_1.png"><br>åˆ†å¸ƒå‡½æ•°å±äºé€»è¾‘å‡½æ•°ï¼Œå…¶åˆ†å¸ƒæ˜¯ä¸€æ¡ <strong><code>S</code> å‹æ›²çº¿ï¼ˆ<code>sigmoid curve</code>ï¼‰</strong>ï¼Œè¯¥æ›²çº¿ä»¥ç‚¹ $(\mu, {\frac {1} {2}})$ ä¸ºä¸­å¿ƒå¯¹æˆï¼Œå³æ»¡è¶³<br>$$ F(-x + \mu) - {\frac {1} {2}} &#x3D; -F(x-\mu) + {\frac {1} {2}} $$<br>è¯¥æ›²çº¿åœ¨ä¸­å¿ƒé™„è¿‘å¢é•¿é€Ÿåº¦è¾ƒå¿«ï¼Œåœ¨ä¸¤ç«¯å¢é•¿é€Ÿåº¦è¾ƒæ…¢ã€‚åŒæ—¶é€»è¾‘å›å½’çš„åˆ†å¸ƒå‡½æ•°åœ¨ $\mu&#x3D;0,\gamma&#x3D;1$ çš„ç‰¹æ®Šå‚æ•°ä¸‹å°±æ˜¯ <strong><code>Sigmoid</code> é€»è¾‘å‡½æ•°</strong>ã€‚<br><small>å½¢çŠ¶å‚æ•° $\gamma$ è¶Šå°ï¼Œæ›²çº¿åœ¨ä¸­å¿ƒä½ç½®çš„å¢é•¿è¶Šå¿«ã€‚</small></p><h4 id="äºŒé¡¹é€»è¾‘å›å½’æ¨¡å‹"><a href="#äºŒé¡¹é€»è¾‘å›å½’æ¨¡å‹" class="headerlink" title="äºŒé¡¹é€»è¾‘å›å½’æ¨¡å‹"></a>äºŒé¡¹é€»è¾‘å›å½’æ¨¡å‹</h4><p><strong>äºŒé¡¹é€»è¾‘å›å½’æ¨¡å‹ï¼ˆ<code>binomial logistic regression model</code>ï¼‰</strong>æ˜¯ä¸€ç§åˆ†ç±»æ¨¡å‹ï¼Œç”±æ¡ä»¶æ¦‚ç‡åˆ†å¸ƒ <code>P(Y|X)</code> è¡¨ç¤ºï¼Œå½¢å¼ä¸ºå‚æ•°åŒ–çš„é€»è¾‘åˆ†å¸ƒã€‚<br>$$ P(Y&#x3D;1|x) &#x3D; {\frac {\exp{(wÂ·x+b)}} {1+\exp{(wÂ·x+b)}}} $$<br>$$ P(Y&#x3D;0|x) &#x3D; {\frac {1} {1+\exp{(wÂ·x+b)}}} $$<br><small>éšæœºå˜é‡ <code>X</code> å–å€¼ä¸ºå®æ•°ï¼Œéšæœºå˜é‡ <code>Y</code> å–å€¼ä¸º <code>1</code> æˆ– <code>0</code>ã€‚</small><br><small>$x\in R^n$ æ˜¯è¾“å…¥ï¼Œ$Y\in{0,1}$ æ˜¯è¾“å‡ºï¼Œ$w\in R^n$ å’Œ $b\in R$ æ˜¯å‚æ•°ï¼Œ$w$ ç§°ä¸ºæƒå€¼å‘é‡ï¼Œ$b$ ç§°ä¸ºåç½®ï¼Œ$wÂ·x$ æ˜¯ $w$ å’Œ $x$ çš„å†…ç§¯ã€‚</small></p><p>è‡³æ­¤ï¼Œå¯¹äºç»™å®šçš„è¾“å…¥å®ä¾‹ï¼Œå¯ä»¥æ ¹æ®ä¸Šè¿°å…¬å¼æ±‚å¾— $P(Y&#x3D;1|x)$ å’Œ $P(Y&#x3D;0|x)$ çš„æ¦‚ç‡ï¼Œé€»è¾‘å›å½’æ¯”è¾ƒä¸¤ä¸ªå€¼çš„å¤§å°ï¼Œç„¶åå°†å®ä¾‹åˆ†åˆ°æ¦‚ç‡è¾ƒå¤§çš„ä¸€ç±»ä¸­ã€‚</p><p>æŸä¸ªäº‹ä»¶çš„<strong>å‡ ç‡ï¼ˆ<code>odds</code>ï¼‰</strong>æ˜¯æŒ‡è¯¥äº‹ä»¶å‘ç”Ÿçš„æ¦‚ç‡ä¸ä¸å‘ç”Ÿæ¦‚ç‡çš„æ¯”å€¼ã€‚å¦‚æœäº‹ä»¶å‘ç”Ÿçš„æ¦‚ç‡ä¸º $p$ï¼Œé‚£ä¹ˆè¯¥äº‹ä»¶çš„å‡ ç‡å°±æ˜¯ ${\frac {p} {1-p}}$ï¼Œè¯¥äº‹ä»¶çš„<strong>å¯¹æ•°å‡ ç‡ï¼ˆ<code>log odds</code>ï¼‰</strong>æˆ– <strong><code>logit</code> å‡½æ•°</strong>æ˜¯ï¼š<br>$$ logit(p) &#x3D; log {\frac {p} {1-p}} $$</p><p>è€Œå¯¹äºé€»è¾‘å›å½’è€Œè¨€ï¼Œå³å¯å¾—ï¼š<br>$$ log {\frac {P(Y&#x3D;1|x)} {1-P(Y&#x3D;1|x)}} &#x3D; wÂ·x $$</p><p>ä¹Ÿå°±æ˜¯è¯´åœ¨é€»è¾‘å›å½’æ¨¡å‹ä¸­ï¼Œè¾“å‡º $Y&#x3D;1$ çš„å¯¹æ•°å‡ ç‡æ˜¯è¾“å…¥ $x$ çš„çº¿æ€§å‡½æ•°ï¼Œå³å¯å°†çº¿æ€§å‡½æ•° $wÂ·x$ è½¬æ¢ä¸ºæ¦‚ç‡ï¼š<br>$$ P(Y&#x3D;1|x) &#x3D; {\frac {exp(wÂ·x)} {1+exp(wÂ·x)}} $$</p><p>æ­¤æ—¶çº¿æ€§å‡½æ•°çš„å€¼è¶Šæ¥è¿‘æ­£æ— ç©·ï¼Œæ¦‚ç‡å€¼å°±è¶Šæ¥è¿‘ <code>1</code>ï¼Œçº¿æ€§å‡½æ•°çš„å€¼è¶Šæ¥è¿‘è´Ÿæ— ç©·ï¼Œæ¦‚ç‡å€¼å°±è¶Šæ¥è¿‘ <code>0</code>ï¼Œå³æ­¤æ¨¡å‹å°±æ˜¯æ¦‚ç‡å›å½’æ¨¡å‹ã€‚</p><h4 id="å¤šé¡¹é€»è¾‘å›å½’æ¨¡å‹"><a href="#å¤šé¡¹é€»è¾‘å›å½’æ¨¡å‹" class="headerlink" title="å¤šé¡¹é€»è¾‘å›å½’æ¨¡å‹"></a>å¤šé¡¹é€»è¾‘å›å½’æ¨¡å‹</h4><p>å‰é¢è¯´çš„äºŒé¡¹é€»è¾‘å›å½’æ¨¡å‹å¯ä»¥é€šè¿‡æ‰©å±•éšæœºå˜é‡ <code>Y</code> çš„å–å€¼é›†åˆ $Y\in{1,2,3,â€¦,K}$ï¼Œé‚£ä¹ˆ<strong>å¤šé¡¹é€»è¾‘å›å½’</strong>çš„æ¨¡å‹æ˜¯ï¼š<br>$$ P(Y&#x3D;k|x) &#x3D; {\frac {exp(w_kÂ·x)} {1+sum_{k&#x3D;1}^{K-1} exp(w_kÂ·x)}} , \quad k &#x3D; {1, 2, 3, â€¦, K}$$<br><small>å…¶ä¸­ $x\in R^{n+1}, w_k\in R^{n+1}$</small></p><hr><h3 id="æ¨¡å‹å‚æ•°ä¼°è®¡"><a href="#æ¨¡å‹å‚æ•°ä¼°è®¡" class="headerlink" title="æ¨¡å‹å‚æ•°ä¼°è®¡"></a>æ¨¡å‹å‚æ•°ä¼°è®¡</h3><p>åœ¨é€»è¾‘å›å½’çš„å­¦ä¹ ä¸­ï¼Œå¯¹äºç»™å®šçš„æ•°æ®é›†ï¼Œå¯ä»¥ä½¿ç”¨æå¤§ä¼¼ç„¶ä¼°è®¡æ³•ä¼°è®¡æ¨¡å‹å‚æ•°ï¼Œä»è€Œå¾—åˆ°é€»è¾‘å›å½’æ¨¡å‹<br>å‡è®¾ï¼š<br>$$ P(Y&#x3D;1|X) &#x3D; \pi(x), \quad P(Y&#x3D;0|X) &#x3D; 1 - \pi(x) $$<br>ä¼¼ç„¶å‡½æ•°ï¼š<br>$$ \Pi_{i&#x3D;1}^N [\pi(x_i)]^{y_i} [1-\pi(x_i)]^{1-y_i} $$<br>å¯¹æ•°ä¼¼ç„¶å‡½æ•°ï¼š<br>$$\begin{equation}\begin{split}<br>L(w) &amp;&#x3D; sum_{i&#x3D;1}^N [y_i log \pi(x_i) + (1-y_i) log(1-\pi(x_i))] \\<br>&amp;&#x3D; sum_{i&#x3D;1}^N [y_i log {\frac {\pi(x_i)} {1-\pi(x_i)} + log(1-\pi(x_i))}] \\<br>&amp;&#x3D; sum_{i&#x3D;1}^N [y_i(wÂ·x_i) - log(1+exp(wÂ·x_i))]<br>\end{split}\nonumber\end{equation}$$<br>å¯¹ $L(w)$ æ±‚æå¤§å€¼ï¼Œä»è€Œå¾—åˆ° $w$ çš„ä¼°è®¡å€¼ã€‚</p><p>è‡³æ­¤é—®é¢˜å°±å˜æˆäº†ä»¥å¯¹æ•°ä¼¼ç„¶å‡½æ•°ä¸ºç›®æ ‡çš„æœ€ä¼˜åŒ–é—®é¢˜ã€‚é€»è¾‘æ–¯è°›å›å½’ä¸­é€šå¸¸é‡‡ç”¨çš„æ–¹æ³•æ˜¯ï¼š</p><ul><li><strong>æ”¹è¿›çš„è¿­ä»£å°ºåº¦æ³•</strong></li><li><strong>æ¢¯åº¦ä¸‹é™æ³•</strong></li><li>ç‰›é¡¿æ³•</li><li><strong>æ‹Ÿç‰›é¡¿æ³•</strong></li></ul><h4 id="æ”¹è¿›çš„è¿­ä»£å°ºåº¦æ³•"><a href="#æ”¹è¿›çš„è¿­ä»£å°ºåº¦æ³•" class="headerlink" title="æ”¹è¿›çš„è¿­ä»£å°ºåº¦æ³•"></a>æ”¹è¿›çš„è¿­ä»£å°ºåº¦æ³•</h4><p><strong>æ”¹è¿›çš„è¿­ä»£å°ºåº¦æ³•ï¼ˆ<code>improved iterative scaling, IIS</code>ï¼‰</strong>æ˜¯ä¸€ç§æœ€å¤§ç†µæ¨¡å‹å­¦ä¹ çš„æœ€ä¼˜åŒ–ç®—æ³•ã€‚<br><code>IIS</code> çš„æƒ³æ³•æ˜¯ï¼šå‡è®¾æœ€å¤§ç†µæ¨¡å‹å½“å‰çš„å‚æ•°å‘é‡æ˜¯ $w&#x3D;(w_1,w_2,â€¦,w_n)^T$ï¼Œé‚£å¸Œæœ›æ‰¾åˆ°æ–°çš„å‚æ•°å‘é‡ $w+\delta &#x3D; (w_1+\delta_1,w_2+\delta_2,â€¦,w_n+\delta_n)^T$ï¼Œä»¥æ­¤ä½¿å¾—æ¨¡å‹çš„å¯¹æ•°ä¼¼ç„¶å‡½æ•°å€¼å¢å¤§ã€‚å³æ‰¾åˆ°ä¸€ç§å‚æ•°å‘é‡çš„æ›´æ–°æ–¹æ³•ï¼š$\tau:w \rightarrow w+\delta$ï¼Œé‚£ä¹ˆå°±å¯ä»¥ä½¿ç”¨è¿™ä¸€æ–¹æ³•ï¼Œç›´è‡³æ‰¾åˆ°å¯¹æ•°ä¼¼ç„¶å‡½æ•°çš„æœ€å¤§å€¼ã€‚</p><p><strong>æ”¹è¿›çš„è¿­ä»£å°ºåº¦ç®—æ³• <code>IIS</code></strong> ï¼š</p><blockquote><p>è¾“å…¥ï¼šç‰¹å¾å‡½æ•° $f_1,f_2,â€¦,f_n$ï¼›ç»éªŒåˆ†å¸ƒ $\widetilde{P}(X,Y)$ï¼Œæ¨¡å‹ $P_w(y|x)$ <br><br>è¾“å‡ºï¼šæœ€ä¼˜å‚æ•°å€¼ $w_i^*$ï¼›æœ€ä¼˜æ¨¡å‹ $P_{w^*}$ <br><br>è¿‡ç¨‹ï¼š</p><ol><li>å¯¹æ‰€æœ‰çš„ $i \in {1,2,â€¦,n}$ï¼Œå–åˆå§‹å€¼ $w_i&#x3D;0$ã€‚</li><li>å¯¹æ¯ä¸€ä¸ª $i \in {1,2,â€¦,n}$ï¼š<br><br> a. ä»¤ $\delta_i$ æ˜¯æ–¹ç¨‹ $sum_{x,y} \widetilde{P}(x) P(y|x) f_i(x,y) \exp{(\delta_i sum_{i&#x3D;1}^nf_i(x,y))} &#x3D; E_{\widetilde{P}}(f_i)$ çš„è§£ã€‚<br><br>  b. æ›´æ–° $w_i$ å€¼ï¼š$w_i \leftarrow w_i + \delta_i$ã€‚</li><li>å¦‚æœæ‰€æœ‰çš„ $w_i$ éƒ½æ”¶æ•›ï¼Œåˆ™ç»§ç»­é‡å¤æ­¥éª¤ <code>2</code>ã€‚<br> è¿™ä¸€æ­¥éª¤çš„å…³é”®æ˜¯æ±‚è§£ $\delta_i$ã€‚å¦‚æœ $sum_{i&#x3D;1}^nf_i(x,y)$ æ˜¯å¸¸æ•°ï¼Œå³å¯¹æ‰€æœ‰çš„ <code>x,y</code> éƒ½æœ‰ $sum_{i&#x3D;1}^nf_i(x,y) &#x3D; M$ï¼Œé‚£ä¹ˆ $\delta_i$ å°±å¯ä»¥æ˜¾ç¤ºåœ°è¡¨ç¤ºä¸º<br> $$ \delta_i &#x3D; {\frac {1} {M}} \log{\frac {E_{\widetilde{P}} (f_i)} {E_P (f_i)}} $$<br> å¦‚æœ $sum_{i&#x3D;1}^nf_i(x,y)$ ä¸æ˜¯å¸¸æ•°ï¼Œåˆ™å¿…é¡»é€šè¿‡æ•°å€¼è®¡ç®—æ±‚ $\delta_i$ã€‚</li></ol></blockquote><h4 id="æ¢¯åº¦ä¸‹é™æ³•"><a href="#æ¢¯åº¦ä¸‹é™æ³•" class="headerlink" title="æ¢¯åº¦ä¸‹é™æ³•"></a>æ¢¯åº¦ä¸‹é™æ³•</h4><p><strong>æ¢¯åº¦ä¸‹é™æ³•ï¼ˆgradient descentï¼‰</strong>çš„è®¡ç®—è¿‡ç¨‹å°±æ˜¯æ²¿ç€æ¢¯åº¦ä¸‹é™çš„æ–¹å‘æ±‚è§£æå°å€¼ï¼ˆä¹Ÿå¯ä»¥æ²¿ç€æ¢¯åº¦ä¸Šå‡çš„æ–¹å‘æ±‚æœ€å¤§å€¼ï¼‰ã€‚<br>$$ \theta_1 &#x3D; \theta_0 - \alpha {\frac {\delta} {\delta \theta_j}} J(\theta) $$<br><small>$\alpha$ è¢«ç§°ä¸ºå­¦ä¹ ç‡æˆ–æ­¥é•¿ï¼Œç”¨æ¥æ§åˆ¶æ¯ä¸€æ­¥è¡Œèµ°çš„è·ç¦»ã€‚å…¶ä¸èƒ½å¤ªå¤§ï¼Œä¹Ÿä¸èƒ½å¤ªå°ã€‚</small></p><p><strong>æ¢¯åº¦ä¸‹é™æ³•</strong>ï¼š</p><blockquote><p>è¾“å…¥ï¼šç‰¹å¾å‡½æ•° $f_1,f_2,â€¦,f_n$ï¼›ç»éªŒåˆ†å¸ƒ $\widetilde{P}(X,Y)$ï¼Œæ¨¡å‹ $P_w(y|x)$ <br><br>è¾“å‡ºï¼šæœ€ä¼˜å‚æ•°å€¼ $w_i^*$ï¼›æœ€ä¼˜æ¨¡å‹ $P_{w^*}$ <br><br>è¿‡ç¨‹ï¼š</p><ol><li>åˆå§‹åŒ–ç»ˆæ­¢è·ç¦» $\epsilon$ ä»¥åŠæ­¥é•¿ $\alpha$ã€‚</li><li>ç¡®å®šå½“å‰ä½ç½®çš„æŸå¤±å‡½æ•°æ¢¯åº¦ï¼Œå¯¹äº $\theta_i$ï¼Œå…¶æ¢¯åº¦è¡¨è¾¾å¼å¦‚ä¸‹ï¼š<br> $$ {\frac {\delta} {\delta \theta_j}} J(\theta) $$</li><li>ä½¿ç”¨æ­¥é•¿ä¹˜ä»¥æŸå¤±å‡½æ•°çš„æ¢¯åº¦å¾—åˆ°å½“å‰çš„ä¸‹é™è·ç¦»ï¼Œå³ $\alpha {\frac {\delta} {\delta \theta_j}} J(\theta)$ã€‚</li><li>ç¡®å®šæ˜¯å¦æ‰€æœ‰çš„ $\theta_i$ éƒ½å°äºç»ˆæ­¢è·ç¦» $\epsilon$ï¼Œå¦‚æœéƒ½å°äºåˆ™ç¡®å®šå½“å‰çš„ $\theta_i$ ä¸ºæœ¬æ¬¡è®¡ç®—ç»“æœã€‚</li><li>æ›´æ–°è¡¨è¾¾å¼ $\theta_i &#x3D; \theta_i - \alpha {\frac {\delta} {\delta \theta_i}} J(\theta)$ ç„¶åè½¬å…¥æ­¥éª¤ <code>2</code>ã€‚</li></ol></blockquote><h4 id="æ‹Ÿç‰›é¡¿æ³•"><a href="#æ‹Ÿç‰›é¡¿æ³•" class="headerlink" title="æ‹Ÿç‰›é¡¿æ³•"></a>æ‹Ÿç‰›é¡¿æ³•</h4><p>æœ€å¤§ç†µæ¨¡å‹è¿˜å¯ä»¥åº”ç”¨<strong>ç‰›é¡¿æ³•</strong>æˆ–<strong>æ‹Ÿç‰›é¡¿æ³•</strong>ã€‚</p><p><strong>æœ€å¤§ç†µæ¨¡å‹å­¦ä¹ çš„ <code>BFGS</code> ç®—æ³•</strong>ï¼š</p><blockquote><p>è¾“å…¥ï¼šç‰¹å¾å‡½æ•° $f_1,f_2,â€¦,f_n$ï¼›ç»éªŒåˆ†å¸ƒ $\widetilde{P}(X,Y)$ï¼Œç›®æ ‡å‡½æ•° $f(w)$ï¼Œæ¢¯åº¦ $g(w)&#x3D; \nabla{f(w)}$ï¼Œç²¾åº¦è¦æ±‚ $\epsilon$ <br><br>è¾“å‡ºï¼šæœ€ä¼˜å‚æ•°å€¼ $w_i^*$ï¼›æœ€ä¼˜æ¨¡å‹ $P_{w^*}$ <br><br>è¿‡ç¨‹ï¼š</p><ol><li>é€‰å®šåˆè¯†ç‚¹ $w^{(0)}$ï¼Œå– $B_0$ ä¸ºæ­£å®šå¯¹ç§°çŸ©é˜µï¼Œç½® $k&#x3D;0$</li><li>è®¡ç®— $g_k&#x3D;g(w^{(k)})$ ã€‚è‹¥ $||g_k||&lt;\epsilon$ åˆ™åœæ­¢è®¡ç®—ï¼Œå¾— $w^*&#x3D;w^{(k)}$ï¼›å¦åˆ™è½¬æ­¥éª¤ <code>3</code></li><li>ç”± $B_k p_k &#x3D; -g_k$ æ±‚å‡º $p_k$</li><li>ä¸€ç»´æœç´¢ï¼šæ±‚ $\lambda_k$ ä½¿å¾—<br> $$ f(w^{(k)} + \lambda_k p_k) &#x3D; min_{\lambda&gt;&#x3D;0} f(w^{(k)} + \lambda p_k) $$</li><li>ç½® $w^{(k+1)} &#x3D; w^{(k)} + \lambda_k p_k$</li><li>è®¡ç®— $g_{k+1} &#x3D; g()w^{(k+1)}$ï¼Œè‹¥ $||g_{k+1}|| &lt; \epsilon$ åˆ™åœæ­¢è®¡ç®—ï¼Œå¾— $w^*&#x3D;w^{(k+1)}$ï¼›å¦åˆ™æ±‚å‡º $B_{k+1}$ï¼š<br> $$ B_{k+1} &#x3D; B_k + {\frac {y_k y_k^T} {y_k^T \delta_k}} - {\frac {B_k \delta_k \delta_k^T B_k} {\delta_k^T B_k \delta_k}} $$<br> <small>å…¶ä¸­ $y_k &#x3D; g_{k+1}-g_k, \delta_k &#x3D; w^{(k+1)}-w^{(k)}$</small></li><li>ç½® $k&#x3D;k+1$ï¼Œè½¬æ­¥éª¤ <code>3</code>ã€‚</li></ol></blockquote><hr><h3 id="é€»è¾‘å›å½’"><a href="#é€»è¾‘å›å½’" class="headerlink" title="é€»è¾‘å›å½’"></a>é€»è¾‘å›å½’</h3><h4 id="æ­£åˆ™åŒ–"><a href="#æ­£åˆ™åŒ–" class="headerlink" title="æ­£åˆ™åŒ–"></a>æ­£åˆ™åŒ–</h4><p>æ­£åˆ™åŒ–æ˜¯ä¸€ä¸ªé€šç”¨çš„ç®—æ³•å’Œæ€æƒ³ï¼Œä»»ä½•ä¼šäº§ç”Ÿè¿‡æ‹Ÿåˆç°è±¡çš„ç®—æ³•éƒ½å¯ä»¥ä½¿ç”¨æ­£åˆ™åŒ–æ¥é¿å…è¿‡æ‹Ÿåˆã€‚åœ¨ç»éªŒé£é™©æœ€å°åŒ–çš„åŸºç¡€ä¸Šï¼ˆè®­ç»ƒè¯¯å·®æœ€å°åŒ–ï¼‰ï¼Œå°½å¯èƒ½åœ°é‡‡ç”¨ç®€å•æ¨¡å‹ï¼Œå¯ä»¥æœ‰æ•ˆæé«˜æ³›åŒ–é¢„æµ‹ç²¾åº¦ã€‚è€Œæ­£åˆ™åŒ–ä¹‹æ‰€ä»¥æœ‰æ•ˆæ˜¯å› ä¸ºå…¶é™ä½äº†ç‰¹å¾çš„æƒé‡ï¼Œä½¿å¾—æ¨¡å‹æ›´åŠ ç®€å•ã€‚</p><p>æ­£åˆ™åŒ–ä¸€èˆ¬é‡‡ç”¨ <code>L1</code> èŒƒå¼æˆ– <code>L2</code> èŒƒå¼ï¼Œå…¶å½¢å¼åˆ†åˆ«ä¸º $\Phi(w) &#x3D; ||x||_1$ å’Œ $\Phi(w) &#x3D; ||x||_2$ã€‚</p><h5 id="L1-æ­£åˆ™åŒ–"><a href="#L1-æ­£åˆ™åŒ–" class="headerlink" title="L1 æ­£åˆ™åŒ–"></a><code>L1</code> æ­£åˆ™åŒ–</h5><p><strong><code>L1</code> æ­£åˆ™åŒ–</strong>ä¹Ÿç§°ä¸º <strong><code>LASSO</code> å›å½’</strong>ï¼Œå…¶ä¸ºæ¨¡å‹å¢åŠ äº†ä¸€ä¸ªå‚æ•° <code>w</code>ï¼Œè€Œæ­¤å‚æ•° <code>w</code> æœä»<strong>é›¶å‡å€¼æ‹‰æ™®æ‹‰æ–¯åˆ†å¸ƒ</strong>ï¼š<br>$$ f(w|\mu,b) &#x3D; {\frac {1} {2b}} \exp{-{\frac {|w-\mu|} {b}}} $$</p><p>é‚£ä¹ˆä¹‹åçš„ä¼¼ç„¶å‡½æ•°å¦‚ä¸‹ï¼š<br>$$\begin{equation}\begin{split}<br>L(w) &amp;&#x3D; P(y|w,x) P(w) \\<br>&amp;&#x3D; \Pi_{i&#x3D;1}^N p(x_i)^{y_i} (1-p(x_i))^{1-y_i} \Pi_{j&#x3D;1}^d {\frac {1} {2b}} \exp({-{\frac {|w_j|} {b}}})<br>\end{split}\nonumber\end{equation}$$</p><p>å¯¹è¯¥å¼å­å– <code>log</code> å†å–è´Ÿå¯å¾—ç›®æ ‡å‡½æ•°ï¼š<br>$$ -\ln{L(w)} &#x3D; - sum_i[y_i \ln{p(x_i)} + (1-y_i) \ln{(1-p(x_i))}] + {\frac {1} {2b^2}} sum_j |w_j| $$</p><p>ç­‰ä»·äºåŸå§‹æŸå¤±å‡½æ•°çš„åé¢å†åŠ ä¸Šäº† <code>L1</code> æ­£åˆ™é¡¹ï¼Œå› æ­¤ <code>L1</code> çš„æœ¬è´¨å°±æ˜¯ä¸ºæ¨¡å‹å¢åŠ <strong>æ¨¡å‹å‚æ•°æœä»é›¶å‡å€¼æ‹‰æ™®æ‹‰æ–¯åˆ†å¸ƒ</strong>çš„è¿™ä¸€ç‰¹ç‚¹ã€‚</p><h5 id="L2-æ­£åˆ™åŒ–"><a href="#L2-æ­£åˆ™åŒ–" class="headerlink" title="L2 æ­£åˆ™åŒ–"></a><code>L2</code> æ­£åˆ™åŒ–</h5><p><strong><code>L2</code> æ­£åˆ™åŒ–</strong>ä¹Ÿç§° <strong><code>Ridge</code> å›å½’</strong>ï¼Œå…¶æœ¬è´¨æ˜¯ä¸ºæ¨¡å‹å¢åŠ äº†ä¸€ä¸ªå‚æ•° <code>w</code>ï¼Œè€Œæ­¤å‚æ•°æœä»<strong>é›¶å‡å€¼æ­£æ€åˆ†å¸ƒ</strong>ã€‚<br>$$ f(w|\mu,)\sigma &#x3D; {\frac {1} {\sqrt{2\pi} \sigma}} \exp{(- {\frac {(w-\mu)^2} {2 \sigma^2}})} $$</p><p>é‚£ä¹ˆä¹‹åçš„ä¼¼ç„¶å‡½æ•°å¦‚ä¸‹ï¼š<br>$$\begin{equation}\begin{split}<br>L(w) &amp;&#x3D; P(y|w,x)P(w) \\<br>&amp;&#x3D; \Pi_{i&#x3D;1}^N p(x_i)^{y_i} (1-p(x_i))^{1-y_i} \Pi_{j&#x3D;1}^d {\frac {1} {\sqrt{2\pi}\sigma}} \exp{(- {\frac {w_j^2} {2\sigma^2}})} \\<br>&amp;&#x3D; \Pi_{i&#x3D;1}^N p(x_i)^{y_i} (1-p(x_i))^{1-y_i} {\frac {1} {\sqrt{2\pi}\sigma}} \exp{(- {\frac {w^T w} {2\sigma^2}})}<br>\end{split}\nonumber\end{equation}$$</p><p>å¯¹ä¸Šå¼å­å– <code>log</code> å†å–è´Ÿå¯å¾—åˆ°ç›®æ ‡å‡½æ•°ï¼š<br>$$ - \log{L(w)} &#x3D; - sum_i [y_i \log{p(x_i)} + (1 - y_i) \log{(1-p(x_i))}] + {\frac {1} {2 \sigma^2}} w^T w + const $$</p><p>ä¸Šè¿°å…¬å¼ç­‰ä»·äºåŸå§‹çš„ <code>cross - entropy</code> ä¹‹åå†åŠ ä¸Š <code>L2</code> æ­£åˆ™é¡¹ï¼Œè‡³æ­¤ <code>L2</code> æ­£åˆ™çš„æœ¬è´¨ä¹Ÿå°±æ˜¯ä¸ºæ¨¡å‹å¢åŠ <strong>æ¨¡å‹å‚æ•°æœä»é›¶å‡å€¼æ­£æ€åˆ†å¸ƒ</strong>è¿™ä¸€ç‰¹ç‚¹ã€‚ </p><h5 id="L1-æ­£åˆ™ä¸-L2-æ­£åˆ™çš„åŒºåˆ«"><a href="#L1-æ­£åˆ™ä¸-L2-æ­£åˆ™çš„åŒºåˆ«" class="headerlink" title="L1 æ­£åˆ™ä¸ L2 æ­£åˆ™çš„åŒºåˆ«"></a><code>L1</code> æ­£åˆ™ä¸ <code>L2</code> æ­£åˆ™çš„åŒºåˆ«</h5><p><code>L1</code> æ­£åˆ™åŒ–å¢åŠ äº†æ‰€æœ‰æƒé‡ <code>w</code> å‚æ•°çš„ç»å¯¹å€¼ä¹‹å’Œï¼Œä½¿å¾—æ›´å¤šçš„ <code>w</code> è¶‹å‘äºé›¶ï¼Œä»è€Œå¯¼è‡´æ¨¡å‹å‚æ•°å˜å¾—ç¨€ç–ã€‚è€Œ <code>L2</code> æ­£åˆ™åŒ–åˆ™æ˜¯å¢åŠ äº†æ‰€æœ‰æƒé‡ <code>w</code> å‚æ•°çš„å¹³æ–¹ä¹‹å’Œï¼Œä½¿å¾—å‚æ•° <code>w</code> ä»…å¯èƒ½è¶‹å‘äºé›¶ä½†ä¸ä¸ºé›¶ï¼Œä»¥æ­¤å¯¼è‡´æ¨¡å‹å‚æ•°æ›´åŠ ç¨ å¯†ï¼Œä»è€Œé˜²æ­¢è¿‡æ‹Ÿåˆã€‚</p><p><img src="/ML-%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92/logistic_3.jpg" alt="logistic_3"></p><h4 id="å¹¶è¡ŒåŒ–"><a href="#å¹¶è¡ŒåŒ–" class="headerlink" title="å¹¶è¡ŒåŒ–"></a>å¹¶è¡ŒåŒ–</h4><p>åœ¨é€»è¾‘å›å½’çš„æ±‚è§£è¿‡ç¨‹ä¸­ï¼Œæ— è®ºæ˜¯æ”¹è¿›çš„è¿­ä»£å°ºåº¦æ³•è¿˜æ˜¯ç‰›é¡¿æ³•ï¼Œå…¶æœ¬è´¨éƒ½æ˜¯éœ€è¦è®¡ç®—æ¢¯åº¦çš„ï¼Œå› æ­¤é€»è¾‘å›å½’çš„å¹¶è¡ŒåŒ–ä¸»è¦æ˜¯å¯¹<strong>ç›®æ ‡å‡½æ•°æ¢¯åº¦è®¡ç®—çš„å¹¶è¡ŒåŒ–</strong>ã€‚</p><p><a href="https://ssjcoding.github.io/2018/11/20/gradient-descent/">æ¢¯åº¦ä¸‹é™æ³•è¯¦è§£</a></p><h4 id="åœ¨çº¿å­¦ä¹ "><a href="#åœ¨çº¿å­¦ä¹ " class="headerlink" title="åœ¨çº¿å­¦ä¹ "></a>åœ¨çº¿å­¦ä¹ </h4><p>ğŸ˜­<code>TODO</code></p><hr><h3 id="æœ€å¤§ç†µæ¨¡å‹"><a href="#æœ€å¤§ç†µæ¨¡å‹" class="headerlink" title="æœ€å¤§ç†µæ¨¡å‹"></a>æœ€å¤§ç†µæ¨¡å‹</h3><h4 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h4><p><strong>æœ€å¤§ç†µæ¨¡å‹ï¼ˆ<code>maximum entropy model</code>ï¼‰</strong>æ˜¯ç”±æœ€å¤§ç†µåŸç†æ¨å¯¼è€Œæˆã€‚æœ€å¤§ç†µåŸç†è®¤ä¸ºï¼šå­¦ä¹ æ¦‚ç‡æ¨¡å‹æ—¶ï¼Œåœ¨æ‰€æœ‰å¯èƒ½çš„æ¦‚ç‡åˆ†å¸ƒä¸­ï¼Œç†µæœ€å¤§çš„æ¨¡å‹ä¹Ÿå°±æ˜¯æœ€å¥½çš„æ¨¡å‹ã€‚é€šå¸¸ä½¿ç”¨çº¦æŸæ¡ä»¶æ¥ç¡®å®šæ¦‚ç‡æ¨¡å‹çš„é›†åˆï¼Œè€Œæœ€å¤§ç†µåŸç†ä¹Ÿå¯ä»¥è¡¨ç¤ºä¸ºåœ¨æ»¡è¶³çº¦æŸæ¡ä»¶çš„æ¨¡å‹é›†åˆä¸­é€‰å–ç†µæœ€å¤§çš„æ¨¡å‹ã€‚<br>å‡è®¾ç¦»æ•£éšæœºå˜é‡ $X$ çš„æ¦‚ç‡åˆ†å¸ƒæ˜¯ $P(X)$ï¼Œåˆ™å…¶ç†µä¸ºï¼š<br>$$ H(P) &#x3D; - sum_x P(x) logP(x) $$<br><small>ç†µéœ€è¦æ»¡è¶³ $0&lt;&#x3D;H(P)&lt;&#x3D;log|X|$ï¼Œå…¶ä¸­ $|X|$ æ˜¯ <code>X</code> çš„å–å€¼ä¸ªæ•°ï¼Œå½“ä¸”ä»…å½“ <code>X</code> çš„åˆ†å¸ƒæ˜¯å‡åŒ€åˆ†å¸ƒæ˜¯å³è¾¹çš„ç­‰å·æ‰ä¼šæˆç«‹ã€‚ï¼ˆ<code>X</code> æœä»å‡åŒ€åˆ†å¸ƒæ—¶ï¼Œå…¶ç†µæœ€å¤§ï¼‰</small></p><p>æ¦‚ç‡æ¨¡å‹é›†åˆå¯ä½¿ç”¨ç”±æ¬§æ°ç©ºé—´ä¸­çš„<strong>å•çº¯å½¢</strong>è¡¨ç¤ºï¼Œå…¶ä¸­ä¸€ä¸ªç‚¹è¡¨ç¤ºä¸€ä¸ªæ¨¡å‹ï¼Œæ•´ä¸ªå•çº¯å½¢ä»£è¡¨æ¨¡å‹é›†åˆã€‚å•çº¯å½¢ä¸­çš„ç›´çº¿è¡¨ç¤ºçº¦æŸæ¡ä»¶ï¼Œç›´çº¿çš„äº¤é›†å¯¹åº”äºæ»¡è¶³æ‰€æœ‰çº¦æŸæ¡ä»¶çš„æ¨¡å‹é›†åˆã€‚ç„¶è€Œè¿™æ ·çš„æ¨¡å‹ä¼šå­˜åœ¨å¤šä¸ªï¼Œæœ€å¤§ç†µåŸç†åˆ™æ˜¯åœ¨ä¼—å¤šçš„æ¨¡å‹ä¸­é€‰æ‹©æœ€ä¼˜çš„æ¨¡å‹ã€‚<br><small>å•çº¯å½¢æ˜¯æŒ‡åœ¨ <code>n</code> ç»´æ¬§æ°ç©ºé—´ä¸­çš„ <code>n+1</code> ä¸ªä»¿å°„æ— å…³çš„ç‚¹çš„é›†åˆçš„å‡¸åŒ…ã€‚</small><br><img src="/ML-%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92/logistic_2.png" alt="logistic_2.png"></p><h4 id="å®šä¹‰"><a href="#å®šä¹‰" class="headerlink" title="å®šä¹‰"></a>å®šä¹‰</h4><p>æœ€å¤§ç†µåŸç†æ˜¯ç»Ÿè®¡å­¦ä¹ ä¸­çš„ä¸€èˆ¬åŸç†ï¼Œå°†å®ƒåº”ç”¨åˆ°åˆ†ç±»å¾—åˆ°æœ€å¤§ç†µæ¨¡å‹ã€‚å‡è®¾åˆ†ç±»æ¨¡å‹æ˜¯ä¸€ä¸ªæ¡ä»¶æ¦‚ç‡åˆ†å¸ƒ $P(Y|X)$ï¼Œå…¶è¡¨ç¤ºå¯¹äºç»™å®šçš„è¾“å…¥ <code>X</code>ï¼Œä¼šä»¥æ¡ä»¶æ¦‚ç‡ $P(Y|X)$ è¾“å‡º <code>Y</code>ï¼Œå…¶ä¸­ $X,Y$ åˆ†åˆ«è¡¨ç¤ºè¾“å…¥å’Œè¾“å‡ºã€‚</p><p>ç»™å®šä¸€ä¸ªè®­ç»ƒæ•°æ®é›† $T&#x3D;{(x_1, y_1), â€¦, (x_N, y_N)}$ï¼Œå­¦ä¹ çš„ç›®æ ‡æ˜¯ä½¿ç”¨æœ€å¤§ç†µåŸç†é€‰æ‹©æœ€å¥½çš„åˆ†ç±»æ¨¡å‹ã€‚å¯¹äºç»™å®šçš„è®­ç»ƒæ•°æ®é›†ï¼Œå¯ä»¥ç¡®å®šè”åˆåˆ†å¸ƒ $P(X, Y)$ çš„ç»éªŒåˆ†å¸ƒå’Œè¾¹ç¼˜åˆ†å¸ƒ $P(X)$ çš„ç»éªŒåˆ†å¸ƒï¼Œåˆ†åˆ«ä»¥ $\widetilde{P}(X, Y)$ å’Œ $\widetilde{P}(X)$ è¡¨ç¤ºï¼š<br>$$ \widetilde{P}(X&#x3D;x, Y&#x3D;y) &#x3D; {\frac {v(X&#x3D;x, Y&#x3D;y)} {N}} $$<br>$$ \widetilde{P}(X&#x3D;x) &#x3D; {\frac {v(X&#x3D;x)} {N}} $$<br><small>$v(X&#x3D;x, Y&#x3D;y)$ è¡¨ç¤ºè®­ç»ƒæ•°æ®ä¸­æ ·æœ¬ $(x, y)$ å‡ºç°çš„é¢‘æ•°ï¼Œ$v(X&#x3D;x)$ è¡¨ç¤ºè®­ç»ƒæ•°æ®ä¸­è¾“å‡º <code>x</code> å‡ºç°çš„é¢‘æ•°ï¼Œ<code>N</code> è¡¨ç¤ºè®­ç»ƒæ ·æœ¬å®¹é‡ã€‚</small><br><br><br>é¦–è¦æ¨¡å‹éœ€è¦è€ƒè™‘æ»¡è¶³æ¡ä»¶ï¼Œå¯ä»¥ä½¿ç”¨<strong>ç‰¹å¾å‡½æ•°ï¼ˆ<code>feature function</code>ï¼‰</strong> $f(x, y)$ æè¿°è¾“å…¥ $x$ å’Œè¾“å‡º $y$ ä¹‹é—´çš„æŸä¸€ä¸ªäº‹å®ï¼Œå…¶å®šä¹‰ä¸ºï¼š<br>$$<br>f(x, y) &#x3D;<br>\begin{cases}<br>1,  &amp; \text{x ä¸ y æ»¡è¶³æŸä¸€æ¡ä»¶} \\<br>0, &amp; \text{å¦åˆ™}<br>\end{cases}<br>$$<br><small>ä¸Šè¿°å®šä¹‰ä¸ºä¸€ä¸ª<strong>äºŒå€¼å‡½æ•°</strong>ï¼Œå½“ <code>x</code> å’Œ <code>y</code> æ»¡è¶³æŸä¸ªäº‹å®æ—¶å–å€¼ä¸º <code>1</code>ï¼Œå¦åˆ™ä¸º <code>0</code>ã€‚</small><br>ç‰¹å¾å‡½æ•° $f(x, y)$ å…³äºç»éªŒåˆ†å¸ƒ $\widetilde{P}(X, Y)$ çš„æœŸæœ›å€¼ç”¨ $E_\widetilde{p} (f)$ æ¥è¡¨ç¤ºï¼š<br>$$ E_\widetilde{p} (f) &#x3D; sum_{x,y} \widetilde{P}(x,y) f(x,y) $$<br>ç‰¹å¾å‡½æ•° $f(x, y)$ å…³äºæ¨¡å‹ $P(Y|X)$ ä¸ç»éªŒåˆ†å¸ƒ $\widetilde{P}(X)$ çš„æœŸæœ›å€¼ç”¨ $E_\widetilde{p}(f)$ æ¥è¡¨ç¤ºï¼š<br>$$ E_p (f) &#x3D; sum_{x,y} E_\widetilde{p}(x) P(y|x) f(x,y) $$<br>é‚£ä¹ˆåœ¨è®­ç»ƒæ•°æ®é›†ä¸­è·å¾—è¶³å¤Ÿå¤šçš„æ¡ä»¶ï¼Œå°±å¯ä»¥å‡è®¾ä¸¤ä¸ªæœŸæœ›å€¼ç›¸ç­‰ï¼Œå³ï¼š<br>$$ E_p (f) &#x3D; E_\widetilde{p}(f) $$<br>$$ sum_{x,y} \widetilde{P}(x) P(y|x) f(x,y) &#x3D; sum_{x,y} \widetilde{P}(x,y) f(x,y) $$<br><br><br>å‡è®¾æ»¡è¶³æ‰€æœ‰çº¦æŸæ¡ä»¶çš„æ¨¡å‹é›†åˆä¸º $\varsigma &#x3D; {p \in P|E_p(f_i) &#x3D; E_\widetilde{p}(f_i), i&#x3D;1,2, â€¦, n}$ï¼Œå®šä¹‰åœ¨æ¡ä»¶æ¦‚ç‡åˆ†å¸ƒ $P(Y|X)$ ä¸Šçš„æ¡ä»¶ç†µä¸ºï¼š<br>$$ H(P) &#x3D; - sum_{x,y} \widetilde{P}(x) P(y|x) logP(y|x) $$<br>åˆ™æ¨¡å‹é›†åˆ $\varsigma$ ä¸­æ¡ä»¶ç†µ $H(P)$ æœ€å¤§çš„æ¨¡å‹ç§°ä¸ºæœ€å¤§ç†µæ¨¡å‹ï¼Œè€Œå…¬å¼ä¸­çš„å¯¹æ•°ä¸º<strong>è‡ªç„¶å¯¹æ•°</strong>ã€‚</p><h4 id="å­¦ä¹ "><a href="#å­¦ä¹ " class="headerlink" title="å­¦ä¹ "></a>å­¦ä¹ </h4><p>æœ€å¤§ç†µæ¨¡å‹çš„å­¦ä¹ è¿‡ç¨‹å°±æ˜¯æ±‚è§£æœ€å¤§ç†µæ¨¡å‹çš„è¿‡ç¨‹ï¼Œæœ€å¤§ç†µæ¨¡å‹çš„å­¦ä¹ å¯ä»¥å½¢å¼åŒ–ä¸ºæœ€ä¼˜åŒ–é—®é¢˜ã€‚</p><p>å¯¹äºç»™å®šçš„è®­ç»ƒæ•°æ®é›† $T &#x3D; {(x_1, y_1), â€¦, (x_N, y_N)}$ ä»¥åŠç‰¹å¾å‡½æ•° $f_i(x,y), i&#x3D;1,2,â€¦,N$ï¼Œæœ€å¤§ç†µæ¨¡å‹çš„å­¦ä¹ ç­‰ä»·äºçº¦æŸæœ€ä¼˜åŒ–é—®é¢˜ï¼š<br>$$ max_{P \in \varsigma} H(P) &#x3D; - sum_{x,y} \widetilde{P}(x) P(y|x) logP(y|x) $$<br>$$ E_p(f_i) &#x3D; E_\widetilde{p}(f_i), \quad i&#x3D;1,2,â€¦,n $$<br>$$ sum_y P(y|x) &#x3D; 1 $$<br>æŒ‰ç…§æ±‚è§£æœ€ä¼˜åŒ–é—®é¢˜çš„ä¹ æƒ¯ï¼Œå°†æ±‚<strong>æœ€å¤§å€¼é—®é¢˜æ”¹å†™ä¸ºç­‰ä»·çš„æ±‚æœ€å°å€¼é—®é¢˜</strong>ï¼š<br>$$ min_{P \in \varsigma} -H(P) &#x3D; sum_{x,y} \widetilde{P}(x) P(y|x) logP(y|x) $$<br>$$ s.t. \quad E_p(f_i) - E_\widetilde{p}(f_i) &#x3D; 0, \quad i&#x3D;1,2,â€¦,n $$<br>$$ sum_y P(y|x) &#x3D; 1 $$</p><p>è‡³æ­¤å¯ä»¥å°†çº¦æŸæœ€ä¼˜åŒ–çš„åŸå§‹é—®é¢˜è½¬æ¢ä¸ºæ— çº¦æŸæœ€ä¼˜åŒ–çš„å¯¹å¶é—®é¢˜ï¼Œé€šè¿‡æ±‚è§£å¯¹å¶é—®é¢˜æ¥æ±‚è§£åŸå§‹é—®é¢˜ã€‚</p><ol><li><p>å¼•å…¥æ‹‰æ ¼æœ—æ—¥ä¹˜å­ $w_0, w_1, â€¦, w_n$ã€‚<br>å®šä¹‰æ‹‰æ ¼æœ—æ—¥å‡½æ•° $L(P, w)$ã€‚<br>$$\begin{equation}\begin{split}<br>L(P, w) &amp;&#x3D; -H(P) + w_0(1-sum_yP(y|x)) + sum_{i&#x3D;1}^n w_i (E_\widetilde{p}(f_i) - E_p(f_i)) \\<br>&amp;&#x3D; sum_{x,y} \widetilde{P}(x) P(y|x) logP(y|x) + w_0(1-sum_yP(y|x)) \\<br>&amp;+ sum_{i&#x3D;1}^n w_i (sum_{x,y} \widetilde{P}(x,y) f_i(x,y) - sum_{x,y} \widetilde{P}(x) P(y|x) f_i(x,y)) \\<br>\end{split}\nonumber\end{equation}$$</p><p> ä¸Šè¿°å¯å¾—éœ€è¦ä¼˜åŒ–çš„åŸå§‹é—®é¢˜æ˜¯:<br> $$ min_{P \in \varsigma} max_w L(P, w) $$<br> é‚£ä¹ˆå¯¹å¶é—®é¢˜æ˜¯ï¼š<br> $$ max_w min_{P \in \varsigma} L(P, w) $$</p><p> ç”±äºæ‹‰æ ¼æœ—æ—¥å‡½æ•° $L(P, w)$ æ˜¯ <code>P</code> çš„å‡¸å‡½æ•°ï¼Œå› æ­¤åŸå§‹é—®é¢˜çš„è§£ç­‰ä»·äºå¯¹å¶é—®é¢˜çš„è§£ã€‚</p></li><li><p>æ±‚è§£å¯¹å¶é—®é¢˜å†…éƒ¨çš„æå°åŒ–ã€‚<br>$min_{P \in \varsigma} L(P, w)$ æ˜¯ <code>w</code> çš„å‡½æ•°ï¼Œå°†å…¶è®°ä½œï¼š<br>$$ \Psi(w) &#x3D; min_{P \in \varsigma} L(P, w) &#x3D; L(P_w, w) $$</p><p> $\Psi(w)$ æ˜¯å¯¹å¶å‡½æ•°ï¼ŒåŒæ—¶å°†å…¶è®°ä½œï¼š<br> $$ P_w &#x3D; arg min_{P \in \varsigma} L(P, w) &#x3D; P_w(y|x) $$</p><p> ä¹‹åæ±‚ $L(P, w)$ å¯¹ $P(y|x)$ çš„åå¯¼æ•°ã€‚<br> $$\begin{equation}\begin{split}<br> {\frac {\partial{L(P, w)}} {\partial{P(y|x)}}} &amp;&#x3D; sum_{x,y} \widetilde{P}(x)(logP(y|x)+1) - sum_y w_0 - sum_{x,y}(\widetilde{P}(x) sum_{i&#x3D;1}^n w_i f_i(x,y)) \\<br> &amp;&#x3D; sum_{x,y} \widetilde{P}(x)(logP(y|x)+1-w_0-sum_{i&#x3D;1}^n w_i f_i(x,y))<br> \end{split}\nonumber\end{equation}$$</p><p> åœ¨ä»¤åå¯¼æ•°ç­‰äº <code>0</code>ï¼Œ$\widetilde{P}(x)&gt;0$ çš„æƒ…å†µä¸‹ï¼Œè§£å¾—ï¼š<br> $$\begin{equation}\begin{split}<br> P(y|x) &amp;&#x3D; exp(sum_{i&#x3D;1}^n w_i f_i(x,y) + w_0 - 1) \\<br> &amp;&#x3D; {\frac {exp(sum_{i&#x3D;1}^n w_i f_i(x,y))} {exp(1-w_0)}}<br> \end{split}\nonumber\end{equation}$$</p><p> ç”±äº $sum_yP(y|x)&#x3D;1$ï¼Œå¯å¾—ï¼š<br> $$ P_w(y|x) &#x3D; {\frac {1} {Z_w(x)}} exp(sum_{i&#x3D;1}^n w_i f_i(x,y)) $$<br> è€Œè¿™å…¶ä¸­ $Z_w(x) &#x3D; sum_y exp(sum_{i&#x3D;1}^n w_i f_i(x,y))$</p><p> <small>$Z_w(x)$ è¢«ç§°ä¸ºè§„èŒƒåŒ–å› å­ï¼Œ$f_i(x,y)$ æ˜¯ç‰¹å¾å‡½æ•°ï¼Œ$w_i$ æ˜¯ç‰¹å¾çš„æƒå€¼ï¼Œæ¨¡å‹ $P_w&#x3D;P_w(y|x)$ å°±æ˜¯æœ€å¤§ç†µæ¨¡å‹ï¼Œè€Œ <code>w</code> æ˜¯æœ€å¤§ç†µæ¨¡å‹çš„å‚æ•°å‘é‡ã€‚</small></p></li><li><p>æ±‚è§£å¯¹å¶é—®é¢˜å¤–éƒ¨çš„æå¤§åŒ–ã€‚<br>$max_w \Psi(w)$ å°†å…¶è§£è®°ä½œ $w^*$ï¼Œå³ï¼š<br>$$ w^* &#x3D; arg max_w \Psi(w) $$</p><p> åº”ç”¨æœ€ä¼˜åŒ–ç®—æ³•æ±‚å¯¹å¶é—®é¢˜ $\Psi(w)$ çš„æå¤§åŒ–å¾—åˆ° $w^*$ï¼Œè¡¨ç¤º $P^* \in \varsigma$ã€‚æ­¤æ—¶è¿™é‡Œçš„ $p^*&#x3D;P_{w^*}&#x3D;P_{w^*}(y|x)$ ä¹Ÿå°±æ˜¯å­¦ä¹ åˆ°çš„æœ€ä¼˜æ¨¡å‹ï¼ˆæœ€å¤§ç†µæ¨¡å‹ï¼‰ã€‚å³å¯å¾—åˆ°æœ€å¤§ç†µæ¨¡å‹çš„å­¦ä¹ å°±æ˜¯å¯¹å¶å‡½æ•° $\Psi(w)$ çš„æå¤§åŒ–ã€‚</p></li></ol><hr><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>å¯¹äºæ–‡ç« ä¸­ä¸ç†è§£çš„ç‰¹æœ‰åè¯ï¼Œè¿˜æ˜¯éœ€è¦è‡ªå·±å»äº†è§£æŸ¥è¯¢ã€‚<br>å¦‚æœä½ åœ¨é˜…è¯»é€”ä¸­é‡åˆ°äº†çœ‹ä¸æ‡‚ã€ä¸äº†è§£ç­‰å› ç´ ï¼Œå¯ä»¥å…ˆæ”¾ä¸€æ”¾ï¼Œé˜…è¯»å®Œæ¯•åä½ å°±ä¼šæ˜ç™½ä¹‹å‰æ˜¯ä»€ä¹ˆå«ä¹‰ã€‚</p><hr><h3 id="å¼•ç”¨"><a href="#å¼•ç”¨" class="headerlink" title="å¼•ç”¨"></a>å¼•ç”¨</h3><p><a href="https://ssjcoding.github.io/2018/11/20/gradient-descent/">æ¢¯åº¦ä¸‹é™æ³•è¯¦è§£</a><br><a href="https://www.jasper.wang/logistic_r">Logisticå›å½’</a></p><hr><h3 id="ä¸ªäººå¤‡æ³¨"><a href="#ä¸ªäººå¤‡æ³¨" class="headerlink" title="ä¸ªäººå¤‡æ³¨"></a>ä¸ªäººå¤‡æ³¨</h3><p><strong>æ­¤åšå®¢å†…å®¹å‡ä¸ºä½œè€…å­¦ä¹ ã€Šç»Ÿè®¡å­¦ä¹ æ–¹æ³•ã€‹æ‰€åšç¬”è®°ï¼Œä¾µåˆ ï¼</strong><br><strong>è‹¥è½¬ä½œå…¶ä»–ç”¨é€”ï¼Œè¯·æ³¨æ˜æ¥æºï¼</strong></p>]]></content>
    
    
    <summary type="html">&lt;h3 id=&quot;åŸºç¡€&quot;&gt;&lt;a href=&quot;#åŸºç¡€&quot; class=&quot;headerlink&quot; title=&quot;åŸºç¡€&quot;&gt;&lt;/a&gt;åŸºç¡€&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;é€»è¾‘å›å½’ï¼ˆ&lt;code&gt;logistic regression&lt;/code&gt;ï¼‰&lt;/strong&gt;æ˜¯ç»Ÿè®¡å­¦ä¹ ä¸­çš„ç»å…¸åˆ†ç±»æ–¹æ³•ï¼Œè™½ç„¶è¢«ç§°ä¸ºå›å½’ï¼Œä½†å…¶å®æ˜¯ä¸ªåˆ†ç±»æ¨¡å‹ã€‚å…¶æœ¬è´¨æ˜¯å‡è®¾æŸä¸ªæ•°æ®æœä»é€»è¾‘åˆ†å¸ƒï¼Œå°±å¯ä»¥ä½¿ç”¨æå¤§ä¼¼ç„¶æ³•ä¼°è®¡å‡ºå…¶çº¿æ€§å›å½’çš„å‚æ•°ï¼Œä¹‹åå†ä½¿ç”¨ &lt;code&gt;Sigmoid&lt;/code&gt; é€»è¾‘å‡½æ•°å¯¹å…¶åˆ†ç±»ã€‚&lt;br&gt;&lt;small&gt;é¢è¯•çš„æ—¶å€™åƒä¸‡ä¸è¦è¯´ä½ å¾ˆäº†è§£ &lt;code&gt;LR&lt;/code&gt;ï¼Œå› ä¸ºç»†èŠ‚çœŸçš„å¤ªå¤šäº†ğŸ˜‚&lt;/small&gt;&lt;/p&gt;</summary>
    
    
    
    
    <category term="ML" scheme="https://blog.vgbhfive.cn/tags/ML/"/>
    
  </entry>
  
  <entry>
    <title>ML-æ”¯æŒå‘é‡æœº</title>
    <link href="https://blog.vgbhfive.cn/ML-%E6%94%AF%E6%8C%81%E5%90%91%E9%87%8F%E6%9C%BA/"/>
    <id>https://blog.vgbhfive.cn/ML-%E6%94%AF%E6%8C%81%E5%90%91%E9%87%8F%E6%9C%BA/</id>
    <published>2023-08-27T12:19:19.000Z</published>
    <updated>2023-09-09T07:40:55.868Z</updated>
    
    <content type="html"><![CDATA[<h3 id="å°æ•…äº‹"><a href="#å°æ•…äº‹" class="headerlink" title="å°æ•…äº‹"></a>å°æ•…äº‹</h3><p>æ¯ä¸ªäººå°æ—¶å€™æœ€è®¨åŒçš„äº‹æƒ…å°±æ˜¯åƒè¯äº†ï¼Œä½†ä¸å¹¸çš„æ˜¯æœ‰ä¸€å¤©ä½ å¾—äº†æ„Ÿå†’ï¼Œå¦ˆå¦ˆç»™ä½ ä¹°äº†è¯ï¼Œä½ æ‹¿åˆ°è¯åæ‰“å¼€äº†åŒ…è£…çº¸ã€‚åœ¨è¯åŒ…é‡Œæœ‰ä¸¤ç§è¯ç‰‡ï¼Œä¸€ç§æ˜¯ç™½è‰²çš„å¦ä¸€ç§æ˜¯é»‘è‰²çš„ï¼Œç™½è‰²çš„çœ‹èµ·æ¥æ¯”è¾ƒç”œï¼Œè€Œé»‘è‰²çš„ä¸€çœ‹å°±å¾ˆè‹¦ï¼›å› æ­¤ä½ å†³å®šå…ˆåƒç™½è‰²çš„è¯ç‰‡ï¼Œé‚£ä¹ˆå¦‚ä½•ä¸€æŠŠæŠ“ä½æ‰€æœ‰çš„è¯ç‰‡å‘¢ï¼Ÿä½ å¯ä»¥æ‰¾ä¸€ä¸ªå‹ºå­è¿™ä¹ˆæŠŠè¯åˆ’åˆ†å‡ºæ¥<br><img src="/ML-%E6%94%AF%E6%8C%81%E5%90%91%E9%87%8F%E6%9C%BA/svm_1.jpeg" alt="svm_1.jpg"></p><p>é‚£ä¹ˆå¦‚æœè¯åŒ…é‡Œçš„è¯ç‰‡æ˜¯è¿™æ ·æ’å¸ƒçš„å‘¢ï¼Ÿ<br><img src="/ML-%E6%94%AF%E6%8C%81%E5%90%91%E9%87%8F%E6%9C%BA/svm_2.jpeg" alt="svm_2.jpg"></p><p>æ­¤æ—¶ä½ å¿ƒé‡Œæƒ³ç€ç»ˆäºå¯ä»¥ç¥­å‡ºæˆ‘çš„ç»ä¸–ç¥åŠŸäº†ï¼å“¼å“ˆâ€¦å……æ»¡å†…åŠ›çš„æ‰‹ä¸€æ‹æ¡Œå­ï¼Œè¯ç‰‡å°±é£åˆ°äº†åŠç©ºä¸­ï¼Œæ­¤æ—¶æ— å½±æ‰‹æŠ€èƒ½å‘åŠ¨ï¼Œä½ å°±ç”¨ä¸€å¼ çº¸æ¥ä½äº†é»‘è‰²çš„è¯ç‰‡ï¼Œå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆâ€¦<br><img src="/ML-%E6%94%AF%E6%8C%81%E5%90%91%E9%87%8F%E6%9C%BA/svm_3.jpeg" alt="svm_3.jpg"></p><span id="more"></span><p>è€Œä»Šå¤©ä½ åœ¨å­¦ä¼šäº† <code>SVM</code> ä¹‹åï¼Œä¼šå°†è¯ç‰‡æˆä¸º<strong>æ•°æ®</strong>ï¼Œå‹ºå­è¢«ç§°ä¸º<strong>åˆ†ç±»é¢</strong>ï¼Œæ‰¾åˆ°é—´éš”è¯ç‰‡è·ç¦»æœ€è¿œä½ç½®çš„è¿‡ç¨‹ç§°ä¸º<strong>ä¼˜åŒ–</strong>ï¼Œè€Œè®©è¯ç‰‡é£åˆ°ç©ºä¸­çš„ç¥åŠŸç§°ä¸º<strong>æ ¸æ˜ å°„</strong>ï¼Œåœ¨ç©ºä¸­åˆ†éš”è¯ç‰‡çš„çº¸å¼ ç§°ä¸º<strong>åˆ†ç±»è¶…å¹³é¢</strong>ã€‚</p><hr><h3 id="æ¦‚è¦"><a href="#æ¦‚è¦" class="headerlink" title="æ¦‚è¦"></a>æ¦‚è¦</h3><p><strong>æ”¯æŒå‘é‡æœºï¼ˆ<code>support vertor machines, SVM</code>ï¼‰</strong>æ˜¯ä¸€ç§<strong>äºŒç±»åˆ†ç±»æ¨¡å‹</strong>ï¼Œå…¶åŸºæœ¬æ¨¡å‹æ˜¯å®šä¹‰åœ¨<strong>ç‰¹å¾ç©ºé—´ä¸Šçš„é—´éš”æœ€å¤§çš„çº¿æ€§åˆ†ç±»å™¨</strong>ï¼Œå…¶ä¸­é—´éš”æœ€å¤§ä½¿å…¶æœ‰åˆ«äº<strong>æ„ŸçŸ¥æœº</strong>ï¼›å¦å¤–æ”¯æŒå‘é‡æœºè¿˜åŒ…å«<strong>æ ¸æŠ€å·§</strong>ï¼Œè¿™ä½¿å…¶æˆä¸ºæœ¬è´¨ä¸Šçš„éçº¿å½¢åˆ†ç±»å™¨ã€‚<br>æ”¯æŒå‘é‡æœºçš„å­¦ä¹ ç­–ç•¥æ˜¯ä½¿å¾—<strong>é—´éš”æœ€å¤§åŒ–</strong>ï¼Œé‚£ä¹ˆå¯å½¢æˆä¸€ä¸ª<strong>æ±‚è§£å‡¸äºŒæ¬¡è§„åˆ’ï¼ˆ<code>convex quadrtic programming</code>ï¼‰</strong>çš„é—®é¢˜ï¼Œä¹Ÿå°±æ˜¯ç­‰ä»·äº<strong>æ­£åˆ™åŒ–çš„åˆé¡µæŸå¤±å‡½æ•°çš„æœ€å°åŒ–é—®é¢˜</strong>ï¼Œå³æ”¯æŒå‘é‡æœºçš„å­¦ä¹ ç®—æ³•å°±æ˜¯<strong>æ±‚è§£å‡¸äºŒæ¬¡è§„åˆ’çš„æœ€ä¼˜ç®—æ³•</strong>ã€‚</p><p>æ”¯æŒå‘é‡æœºå­¦ä¹ æ–¹æ³•åŒ…å«ä»¥ä¸‹æ¨¡å‹ï¼š</p><ul><li><strong>çº¿æ€§å¯åˆ†æ”¯æŒå‘é‡æœºï¼ˆ<code>linear support vector machine in linearly separable case</code>ï¼‰</strong><br> å½“è®­ç»ƒæ•°æ®çº¿æ€§å¯åˆ†æ—¶ï¼Œé€šè¿‡<strong>ç¡¬é—´éš”æœ€å¤§åŒ–ï¼ˆ<code>hard margin maximization</code>ï¼‰</strong>ï¼Œå­¦ä¹ ä¸€ä¸ªçº¿æ€§çš„åˆ†ç±»å™¨ï¼Œå³çº¿æ€§å¯åˆ†æ”¯æŒå‘é‡æœºï¼Œåˆç§°ä¸ºç¡¬é—´éš”æ”¯æŒå‘é‡æœºã€‚</li><li><strong>çº¿æ€§æ”¯æŒå‘é‡æœºï¼ˆ<code>linear support vector machine</code>ï¼‰</strong><br> å½“è®­ç»ƒæ•°æ®æ¥è¿‘çº¿æ€§å¯åˆ†æ—¶ï¼Œé€šè¿‡<strong>è½¯é—´éš”æœ€å¤§åŒ–ï¼ˆ<code>soft margin maximization</code>ï¼‰</strong>ï¼Œä¹Ÿå­¦ä¹ ä¸€ä¸ªçº¿æ€§åˆ†ç±»å™¨ï¼Œå³çº¿æ€§æ”¯æŒå‘é‡æœºï¼Œåˆç§°è½¯é—´éš”æ”¯æŒå‘é‡æœºã€‚</li><li><strong>éçº¿æ€§æ”¯æŒå‘é‡æœºï¼ˆ<code>non-linear support vector machine</code>ï¼‰</strong><br> å½“è®­ç»ƒæ•°æ®ä¸å¯åˆ†æ—¶ï¼Œé€šè¿‡ä½¿ç”¨<strong>æ ¸æŠ€å·§ï¼ˆ<code>kernal trick</code>ï¼‰</strong>åŠ<strong>è½¯é—´éš”æœ€å¤§åŒ–</strong>ï¼Œå­¦ä¹ éçº¿æ€§æ”¯æŒå‘é‡æœºã€‚</li></ul><p>å½“è¾“å…¥ç©ºé—´ä¸ºæ¬§å¼ç©ºé—´æˆ–ç¦»æ•£é›†åˆã€ç‰¹å¾ç©ºé—´ä¸ºå¸Œå°”ä¼¯ç‰¹ç©ºé—´æ—¶ï¼Œ<strong>æ ¸å‡½æ•°ï¼ˆ<code>kernal function</code>ï¼‰</strong>è¡¨ç¤ºå°†è¾“å…¥ä»è¾“å…¥ç©ºé—´æ˜ å°„åˆ°ç‰¹å¾ç©ºé—´å¾—åˆ°çš„ç‰¹å¾å‘é‡ä¹‹é—´çš„å†…ç§¯ã€‚é€šè¿‡ä½¿ç”¨æ ¸å‡½æ•°å¯ä»¥å­¦ä¹ éçº¿æ€§æ”¯æŒå‘é‡æœºï¼Œç­‰ä»·äºéšå¼åœ°åœ¨é«˜ç»´çš„ç‰¹å¾ç©ºé—´ä¸­å­¦ä¹ å‘é‡æ”¯æŒæœºï¼Œè¿™æ ·çš„æ–¹æ³•è¢«ç§°ä¸º<strong>æ ¸æŠ€å·§</strong>ã€‚</p><p><strong>æ ¸æ–¹æ³•ï¼ˆ<code>kernal method</code>ï¼‰</strong>æ˜¯æ¯”æ”¯æŒå‘é‡æœºæ›´ä¸ºä¸€èˆ¬çš„æœºå™¨å­¦ä¹ æ–¹æ³•ã€‚</p><hr><h3 id="çº¿æ€§å¯åˆ†æ”¯æŒå‘é‡æœº"><a href="#çº¿æ€§å¯åˆ†æ”¯æŒå‘é‡æœº" class="headerlink" title="çº¿æ€§å¯åˆ†æ”¯æŒå‘é‡æœº"></a>çº¿æ€§å¯åˆ†æ”¯æŒå‘é‡æœº</h3><p>å‡è®¾ç»™å®šä¸€ä¸ªç‰¹å¾ç©ºé—´ä¸Šçš„è®­ç»ƒæ•°æ®é›†<br>$$ T &#x3D; {(x_1, y_1), (x_2, y_2), â€¦, (x_N, y_N)} $$<br><small>å…¶ä¸­ $x_i \in X &#x3D; R^nï¼Œ y_i \in Y &#x3D; \{+1, -1\}ï¼Œ i &#x3D; 1, 2, â€¦, Nï¼Œ x_i $ ç¬¬ $ i $ ä¸ªç‰¹å¾å‘é‡ï¼Œä¹Ÿç§°ä¸ºå®ä¾‹ï¼› $ y_i $ ä¸º $ x_i $ çš„ç±»æ ‡è®°ï¼Œå½“ $ y_i &#x3D; +1 $ æ—¶ï¼Œç§° $ x_i $ ä¸ºæ­£ä¾‹ï¼›å½“ $ y_i &#x3D; -1 $ æ—¶ï¼Œç§° $ x_i $ ä¸ºè´Ÿä¾‹ã€‚$ (x_i, y_i) $ ç§°ä¸ºæ ·æœ¬ç‚¹ã€‚ </small></p><p>ç›®å‰çš„å­¦ä¹ ç›®æ ‡æ˜¯åœ¨ç‰¹å¾ç©ºé—´ä¸­æ‰¾åˆ°ä¸€ä¸ª<strong>åˆ†ç¦»è¶…å¹³é¢</strong>ï¼Œèƒ½å°†å®ä¾‹åˆ†åˆ°ä¸åŒçš„ç±»ã€‚åˆ†ç¦»è¶…å¹³é¢å¯¹åº”æ–¹ç¨‹ <code>wÂ·x + b = 0</code>ï¼Œå…¶ç”±æ³•å‘é‡ <code>w</code> å’Œæˆªè· <code>b</code> å†³å®šï¼Œå¯ç”¨ <code>(w, b)</code> æ¥è¡¨ç¤ºï¼›åˆ†ç¦»è¶…å¹³é¢å°†ç‰¹å¾ç©ºé—´åˆ’åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œä¸€éƒ¨åˆ†ä¸ºæ­£ç±»ï¼Œä¸€éƒ¨åˆ†ä¸ºè´Ÿç±»ï¼›æ³•å‘é‡æŒ‡å‘çš„ä¸€ä¾§ä¸ºæ­£ç±»ï¼Œå¦ä¸€ä¾§ä¸ºè´Ÿç±»ã€‚</p><p><small>ä¸€èˆ¬å½“è®­ç»ƒæ•°æ®çº¿æ€§å¯åˆ†æ—¶ï¼Œå­˜åœ¨æ— æ•°ä¸ªåˆ†ç¦»è¶…å¹³é¢å¯å°†ä¸¤ç±»æ•°æ®æ­£ç¡®åˆ†å¼€ï¼Œè€Œæ„ŸçŸ¥æœºä½¿ç”¨è¯¯åˆ†ç±»æœ€å°çš„ç­–ç•¥æ±‚å¾—åˆ†ç¦»è¶…å¹³é¢ï¼Œä¸è¿‡æ­¤æ—¶å­˜åœ¨æ— æ•°ä¸ªè§£ï¼›è€Œçº¿æ€§å¯åˆ†æ”¯æŒå‘é‡æœºåˆ©ç”¨<strong>é—´éš”æœ€å¤§åŒ–</strong>æ±‚å¾—æœ€ä¼˜åˆ†ç¦»è¶…å¹³é¢ï¼Œå³æ­¤æ—¶å­˜åœ¨å”¯ä¸€è§£ã€‚</small></p><p>ç»™å®šçº¿æ€§å¯åˆ†è®­ç»ƒæ•°æ®é›†ï¼Œé€šè¿‡<strong>é—´éš”æœ€å¤§åŒ–</strong>æˆ–<strong>ç­‰ä»·æ±‚è§£ç›¸åº”çš„å‡¸äºŒæ¬¡è§„åˆ’é—®é¢˜</strong>å­¦ä¹ å¾—åˆ°çš„åˆ†ç±»è¶…å¹³é¢ä¸º<br>$$ w^* Â· x + b^* &#x3D; 0 $$<br>ä»¥åŠç›¸åº”çš„<strong>åˆ†ç±»å†³ç­–å‡½æ•°</strong><br>$$ f(x) &#x3D; sign(w^* Â· x + b^*) $$<br>ç§°ä¸ºçº¿æ€§å¯åˆ†æ”¯æŒå‘é‡æœºã€‚</p><h4 id="å‡½æ•°é—´éš”å’Œå‡ ä½•é—´éš”"><a href="#å‡½æ•°é—´éš”å’Œå‡ ä½•é—´éš”" class="headerlink" title="å‡½æ•°é—´éš”å’Œå‡ ä½•é—´éš”"></a>å‡½æ•°é—´éš”å’Œå‡ ä½•é—´éš”</h4><p><img src="/ML-%E6%94%AF%E6%8C%81%E5%90%91%E9%87%8F%E6%9C%BA/svm_5.jpg" alt="svm_5.jpg"></p><p>ä¸Šè¿°å›¾ä¸­æœ‰ <code>A</code>ã€ <code>B</code>ã€ <code>C</code> ä¸‰ç‚¹è¡¨ç¤ºä¸‰ä¸ªå®ä¾‹ï¼Œå…¶å‡åœ¨åˆ†ç¦»è¶…å¹³é¢çš„æ­£ç±»ä¸€ä¾§ã€‚ç‚¹ <code>A</code> è·åˆ†ç¦»è¶…å¹³é¢è¾ƒè¿œï¼Œè‹¥é¢„æµ‹è¯¥ç‚¹ä¸ºæ­£ç±»åˆ™é¢„æµ‹æ­£ç¡®çš„æ¦‚ç‡æœ€å¤§ï¼›ç‚¹ <code>C</code> è·åˆ†ç¦»è¶…å¹³é¢è¾ƒè¿‘ï¼Œåˆ™é¢„æµ‹è¯¥ç‚¹ä¸ºæ­£ç±»çš„æ¦‚ç‡æ²¡æœ‰é‚£ä¹ˆå¤§ï¼›è€Œç‚¹ <code>B</code> ä½äº <code>A</code> å’Œ <code>C</code> ä¹‹é—´ï¼Œé¢„æµ‹å…¶ä¸ºæ­£ç±»çš„æ¦‚ç‡åœ¨ <code>A</code> ä¸ <code>C</code> ä¹‹é—´ã€‚</p><p>ä¸€èˆ¬åœ°ç‚¹è·ç¦»åˆ†ç¦»è¶…å¹³é¢çš„è¿œè¿‘å¯ä»¥è¡¨ç¤ºåˆ†ç±»é¢„æµ‹çš„æ­£ç¡®æ¦‚ç‡ã€‚åœ¨è¶…å¹³é¢ $ wÂ·x + b &#x3D; 0 $ ç¡®å®šçš„æƒ…å†µä¸‹ï¼Œ$ |wÂ·x + b| $ èƒ½å¤Ÿç›¸å¯¹åœ°è¡¨ç¤ºç‚¹ <code>x</code> è·ç¦»è¶…å¹³é¢çš„è¿œè¿‘ï¼Œè€Œ $ wÂ·x + b &#x3D; 0 $ çš„ç¬¦å·ä¸æ ‡è®° <code>y</code> çš„ç¬¦å·æ˜¯å¦ä¸€è‡´å°±èƒ½å¤Ÿè¡¨ç¤ºåˆ†ç±»æ˜¯å¦æ­£ç¡®ï¼Œæ‰€ä»¥å¯ç”¨é‡ $ y(wÂ·x + b) $ æ¥è¡¨ç¤ºåˆ†ç±»çš„æ­£ç¡®æ€§åŠç¡®ä¿¡åº¦ï¼Œè¿™å°±æ˜¯<strong>å‡½æ•°é—´éš”ï¼ˆ<code>functional margin</code>ï¼‰</strong>çš„æ¦‚å¿µã€‚</p><h5 id="å‡½æ•°é—´éš”"><a href="#å‡½æ•°é—´éš”" class="headerlink" title="å‡½æ•°é—´éš”"></a>å‡½æ•°é—´éš”</h5><p>å¯¹äºç»™å®šçš„è®­ç»ƒæ•°æ®é›† $T$ å’Œè¶…å¹³é¢ $(w, b)$ï¼Œå…¶å®šä¹‰è¶…å¹³é¢ $(w, b)$ å…³äºæ ·æœ¬ç‚¹ $(x_i, y_i)$ çš„å‡½æ•°é—´éš”ä¸º<br>$$ \tilde{Y_i} &#x3D; y_i (w Â· x_i + b) $$</p><p>å‡½æ•°é—´éš”çš„æœ€å°å€¼ä¸º<br>$$ \tilde{Y} &#x3D; min_{i&#x3D;1, 2, â€¦, N} \tilde{y_i} $$</p><p>å‡½æ•°é—´éš”å¯ä»¥è¡¨ç¤ºåˆ†ç±»é¢„æµ‹çš„æ­£ç¡®æ€§å’Œå‡†ç¡®åº¦ã€‚ä½†æ˜¯åœ¨é€‰æ‹©åˆ†ç¦»è¶…å¹³é¢æ—¶ï¼Œåªæœ‰å‡½æ•°é—´éš”æ˜¯ä¸å¤Ÿçš„ï¼Œå› ä¸ºåªè¦æˆæ¯”ä¾‹åœ°æ”¹å˜ <code>w</code> å’Œ <code>b</code>ï¼Œè™½ç„¶åˆ†ç¦»è¶…å¹³é¢ä¸ä¼šæ”¹å˜ï¼Œä½†å‡½æ•°é—´éš”å´ä¼šæˆæ¯”ä¾‹æ”¹å˜ï¼Œå› æ­¤éœ€è¦å¯¹åˆ†ç¦»è¶…å¹³é¢çš„æ³•å‘é‡ <code>w</code> åŠ ä»¥çº¦æŸï¼Œä¾‹å¦‚<strong>è§„èŒƒåŒ– $||w|| &#x3D; 1$</strong> ï¼Œä»è€Œä½¿å¾—é—´éš”æ˜¯ç¡®å®šçš„ï¼Œæ­¤æ—¶å‡½æ•°é—´éš”æˆä¸º<strong>å‡ ä½•é—´éš”ï¼ˆ<code>geometric margin</code>ï¼‰</strong>ã€‚</p><p><img src="/ML-%E6%94%AF%E6%8C%81%E5%90%91%E9%87%8F%E6%9C%BA/svm_6.jpg" alt="svm_6.jpg"><br>ç‚¹ <code>A</code> è¡¨ç¤ºæŸä¸€ä¸ªå®ä¾‹ $x_i$ï¼Œå…¶ç±»æ ‡è®°ä¸º $y_i &#x3D; +1$ã€‚ç‚¹ <code>A</code> ä¸è¶…å¹³é¢ $(w, b)$ çš„è·ç¦»ç”±çº¿æ®µ <code>AB</code> ç»™å‡ºï¼Œè®°ä½œ<br>$$ Y_i &#x3D; y_i ({\frac {w} {||w||}} Â· x_i + {\frac {b} {||w||}}) $$<br><small>å…¶ä¸­ $||w||$ ä¸º <code>w</code> çš„ <strong>$L_2$ èŒƒæ•°</strong>ã€‚ </small></p><h5 id="å‡ ä½•é—´éš”"><a href="#å‡ ä½•é—´éš”" class="headerlink" title="å‡ ä½•é—´éš”"></a>å‡ ä½•é—´éš”</h5><p>å¯¹äºç»™å®šçš„è®­ç»ƒæ•°æ®é›† $T$ å’Œè¶…å¹³é¢ $(w, b)$ï¼Œå…¶å®šä¹‰è¶…å¹³é¢ $(w, b)$ å…³äºæ ·æœ¬ç‚¹ $(x_i, y_i)$ çš„<strong>å‡ ä½•é—´éš”</strong>ä¸º<br>$$ Y_i &#x3D; y_i ({\frac {w} {||w||}} Â· x_i + {\frac {b} {||w||}}) $$</p><p>å‡ ä½•é—´éš”çš„æœ€å°å€¼<br>$$ Y &#x3D; min_{i&#x3D;1, 2, â€¦, N} y_i $$</p><p>è¶…å¹³é¢ <code>(w, b)</code> å…³äºæ ·æœ¬ç‚¹ $(x_i, y_i)$ çš„å‡ ä½•é—´éš”ä¸€èˆ¬æ˜¯å®ä¾‹ç‚¹åˆ°è¶…å¹³é¢çš„å¸¦ç¬¦å·çš„è·ç¦»ï¼ˆ<code>signed distance</code>ï¼‰ï¼Œå½“æ ·æœ¬ç‚¹è¢«æ­£ç¡®åˆ†ç±»æ—¶å°±æ˜¯å®ä¾‹ç‚¹åˆ°è¶…å¹³é¢çš„è·ç¦»ã€‚</p><p>ä»å‡½æ•°é—´éš”å’Œå‡ ä½•é—´éš”çš„å®šä¹‰å¯çŸ¥ $Y_i &#x3D; {\frac {\tilde{y_i}} {||w||}}$ å’Œ $Y &#x3D; {\frac {\tilde{y}} {||w|}}$ï¼Œå¦‚æœ $||w|| &#x3D; 1$ é‚£ä¹ˆå‡½æ•°é—´éš”å’Œå‡ ä½•é—´éš”ç›¸ç­‰ã€‚<br><br><small>å¦‚æœè¶…å¹³é¢å‚æ•° <code>w</code> å’Œ <code>b</code> æˆæ¯”ä¾‹åœ°æ”¹å˜ï¼Œé‚£å‡½æ•°é—´éš”ä¹Ÿä¼šæŒ‰æ­¤æ¯”ä¾‹æ”¹å˜ï¼Œè€Œå‡ ä½•é—´éš”ä¸å˜ã€‚</small></p><h4 id="é—´éš”æœ€å¤§åŒ–"><a href="#é—´éš”æœ€å¤§åŒ–" class="headerlink" title="é—´éš”æœ€å¤§åŒ–"></a>é—´éš”æœ€å¤§åŒ–</h4><p>æ”¯æŒå‘é‡æœºå­¦ä¹ çš„åŸºæœ¬æƒ³æ³•æ˜¯æ±‚è§£èƒ½å¤Ÿæ­£ç¡®åˆ’åˆ†è®­ç»ƒæ•°æ®é›†å¹¶ä¸”é›†åˆé—´éš”æœ€å¤§çš„åˆ†ç¦»è¶…å¹³é¢ã€‚è€Œå¯¹äºçº¿æ€§å¯åˆ†çš„è®­ç»ƒæ•°æ®é›†è€Œè¨€ï¼Œçº¿æ€§å¯åˆ†çš„åˆ†ç¦»è¶…å¹³é¢æœ‰æ— æ•°ä¸ªï¼ˆç­‰ä»·äºæ„ŸçŸ¥æœºï¼‰ï¼Œä½†å‡ ä½•é—´éš”æœ€å¤§çš„åˆ†ç¦»è¶…å¹³é¢å´æ˜¯å”¯ä¸€çš„ï¼ˆ<strong>ç¡¬é—´éš”æœ€å¤§åŒ–</strong>ï¼‰ã€‚</p><p>é—´éš”æœ€å¤§åŒ–çš„ç›´æ¥è§£é‡Šå°±æ˜¯ï¼šå¯¹äºè®­ç»ƒæ•°æ®é›†æ‰¾åˆ°å‡ ä½•é—´éš”æœ€å¤§çš„è¶…å¹³é¢æ„å‘³ç€ä»¥æ¦‚ç‡æœ€å¤§çš„ç¡®ä¿¡åº¦é˜Ÿè®­ç»ƒæ•°æ®è¿›è¡Œåˆ†ç±»ã€‚</p><ol><li><p>æœ€å¤§é—´éš”åˆ†ç¦»è¶…å¹³é¢<br>æœ€å¤§é—´éš”åˆ†ç¦»è¶…å¹³é¢å³<strong>å‡ ä½•é—´éš”æœ€å¤§çš„åˆ†ç¦»è¶…å¹³é¢</strong>ï¼Œå¯ä»¥è¡¨ç¤ºä¸ºä¸‹é¢çš„çº¦æŸæœ€æœ‰é—®é¢˜ï¼š<br>$$ max_{w, b} \quad {\frac {\tilde{Y}} {||w||}} $$<br>$$ s.t. \quad y_i(wÂ·x_i + b) &gt;&#x3D; \tilde{Y} \quad i&#x3D;1, 2, â€¦, N$$<br>å‡ ä½•é—´éš” $\tilde{Y}$ çš„å–å€¼å¹¶ä¸å½±å“æœ€ä¼˜åŒ–é—®é¢˜çš„è§£ï¼Œå³æˆæ¯”ä¾‹æ”¹å˜ $w, b$ï¼Œé‚£å¯¹åº”çš„ $\tilde{Y}$ ä¹Ÿä¼šæˆæ¯”ä¾‹æ”¹å˜ã€‚ä¹Ÿå°±æ˜¯è¯´ä¼šäº§ç”Ÿä¸€ä¸ªç­‰ä»·é—®é¢˜ï¼Œæœ€å¤§åŒ– ${\frac {1} {||w||}}$ å’Œæœ€å°åŒ– ${\frac {1} {2}} {||w||}^2$ æ˜¯ç­‰ä»·çš„ï¼Œç”±æ­¤å¯å¾—åˆ°çº¿æ€§å¯åˆ†æ”¯æŒå‘é‡æœºå­¦ä¹ çš„æœ€ä¼˜åŒ–é—®é¢˜ï¼Œä¹Ÿæ˜¯ä¸€ä¸ª<strong>å‡¸äºŒæ¬¡è§„åˆ’é—®é¢˜ï¼ˆ<code>convex quadratic progranmming</code>ï¼‰</strong>ã€‚<br>$$ min_{w, b} \quad {\frac {1} {2}} {||w||}^2 $$<br>$$ s.t. \quad y_i(wÂ·x_i + b) - 1 &gt;&#x3D; 0 \quad i&#x3D;1, 2, â€¦, N $$<br><br><strong>å‡¸ä¼˜åŒ–é—®é¢˜</strong>æ˜¯æŒ‡çº¦æŸæœ€ä¼˜åŒ–é—®é¢˜ï¼š<br>$$ min_{w, b} \quad f(w) $$<br>$$ \begin{equation}\begin{split}<br>s.t. \quad g_f(w) &lt;&#x3D; 0, \quad i&#x3D;1, 2, â€¦, k  \\<br>h_i(w) &#x3D; 0, \quad i&#x3D;1, 2, â€¦, l<br>\end{split}\nonumber\end{equation}$$<br><small>ç›®æ ‡å‡½æ•° $f(w)$ å’Œçº¦æŸå‡½æ•° $g_i(w)$ éƒ½æ˜¯ $R^n$ ä¸Šçš„<strong>è¿ç»­å¯å¾®çš„å‡¸å‡½æ•°</strong>ï¼Œçº¦æŸå‡½æ•° $h_i(w)$ æ˜¯ $R^n$ ä¸Šçš„<strong>ä»¿å°„å‡½æ•°</strong>ã€‚å½“ç›®æ ‡å‡½æ•° $f(w)$ æ˜¯äºŒæ¬¡å‡½æ•°ä¸”çº¦æŸå‡½æ•° $g_i(w)$ æ˜¯ä»¿å°„å‡½æ•°æ—¶ï¼Œä¸Šè¿°å‡¸ä¼˜åŒ–é—®é¢˜å°±ä¼šæˆä¸ºå‡¸äºŒæ¬¡è§„åˆ’é—®é¢˜ã€‚</small><br>è·å¾—çº¦æŸæœ€ä¼˜åŒ–é—®é¢˜çš„è§£ $w^*, b^*$ï¼Œå¯å¾—åˆ°<strong>æœ€å¤§é—´éš”åˆ†ç¦»è¶…å¹³é¢ $w^*Â·x + b^* &#x3D; 0$</strong> åŠ<strong>åˆ†ç±»å†³ç­–å‡½æ•° $f(x)&#x3D;sign(w^*Â·x + b^*)$</strong> ï¼Œå³çº¿æ€§å¯åˆ†æ”¯æŒå‘é‡æœºæ¨¡å‹ã€‚</p><p><strong>çº¿æ€§å¯åˆ†æ”¯æŒå‘é‡æœºå­¦ä¹ ç®—æ³•-æœ€å¤§é—´éš”æ³•</strong>ï¼š</p><blockquote><p>è¾“å…¥ï¼šçº¿æ€§å¯åˆ†è®­ç»ƒæ•°æ®é›† $T &#x3D; {(x_1, y_1), â€¦, (x_N, y_N)}$ï¼Œå…¶ä¸­ $x_i \in X &#x3D; R^nï¼Œy_i \in Y &#x3D; \{+1, -1\}ï¼Œi &#x3D; 1, â€¦, N$<br>è¾“å‡ºï¼šæœ€å¤§é—´éš”åˆ†ç¦»è¶…å¹³é¢å’Œåˆ†ç±»å†³ç­–å‡½æ•°<br>è¿‡ç¨‹ï¼š</p><ol><li>æ„å»ºå¹¶æ±‚è§£çº¦æŸæœ€ä¼˜åŒ–é—®é¢˜<br> $$ min_{w, b}  \quad {\frac {1} {2}} {||w||}^2 $$<br> $$ s.t.  \quad y_i(wÂ·x_i + b) - 1 &gt;&#x3D; 0, i&#x3D;1, 2, â€¦, N $$<br> è·å–æœ€ä¼˜è§£ $ w^*, b^*$</li><li>ç”±æ­¤è€Œå¾—åˆ†ç¦»è¶…å¹³é¢å’Œåˆ†ç±»å†³ç­–å‡½æ•°<br> $$ w^*Â·x + b^* &#x3D; 0 $$<br> $$ f(x) &#x3D; sign(w^*Â·x + b^*) $$</li></ol></blockquote><br></li><li><p>æ”¯æŒå‘é‡å’Œé—´éš”è¾¹ç•Œ<br>åœ¨çº¿æ€§å¯åˆ†æƒ…å†µä¸‹è®­ç»ƒæ•°æ®é›†çš„æ ·æœ¬ç‚¹ä¸­ä¸åˆ†ç¦»è¶…å¹³é¢è·ç¦»æœ€è¿‘çš„æ ·æœ¬ç‚¹çš„å®ä¾‹ç§°ä¸º<strong>æ”¯æŒå‘é‡ï¼ˆ<code>support vector</code>ï¼‰</strong>ï¼Œå³æ”¯æŒå‘é‡æ˜¯ä½¿çº¦æŸæ¡ä»¶å¼ï¼ˆ$y_i(wÂ·x_i + b) - 1 &gt;&#x3D; 0$ï¼‰ç­‰å·æˆç«‹çš„ç‚¹ã€‚<br><br>å¯¹äº $y_i&#x3D;1$ çš„ç‚¹ï¼Œæ”¯æŒå‘é‡åœ¨è¶…å¹³é¢ $H_1:wÂ·x+b&#x3D;1$ ä¸Šï¼Œè€Œå¯¹äº $y_i&#x3D;-1$ çš„ç‚¹ï¼Œæ”¯æŒå‘é‡åœ¨è¶…å¹³é¢ $H_2:wÂ·x+b&#x3D;-1$ ä¸Šã€‚<br><img src="/ML-%E6%94%AF%E6%8C%81%E5%90%91%E9%87%8F%E6%9C%BA/svm_4.jpg" alt="svm_4.jpg"></p><p>æ³¨æ„åˆ° <code>H1</code> ä¸ <code>H2</code> ä¹‹é—´å¹³è¡Œï¼Œä½†å´æ²¡æœ‰å®ä¾‹ç‚¹åœ¨å…¶ä¸­é—´ï¼Œå³ <code>H1</code> ä¸ <code>H2</code> ä¸­é—´çš„é•¿å¸¦è¢«ç§°ä¸º<strong>é—´éš”ï¼ˆ<code>margin</code>ï¼‰</strong>ï¼Œé—´éš”ä¾èµ–äºåˆ†ç¦»è¶…å¹³é¢çš„æ³•å‘é‡ <code>w</code>ï¼Œç­‰äº ${\frac {2} {||w||}}$ï¼Œè€Œ <code>H1</code> å’Œ <code>H2</code> ä¹Ÿè¢«ç§°ä¸º<strong>é—´éš”è¾¹ç•Œ</strong>ã€‚</p></li></ol><h4 id="å¯¹å¶ç®—æ³•"><a href="#å¯¹å¶ç®—æ³•" class="headerlink" title="å¯¹å¶ç®—æ³•"></a>å¯¹å¶ç®—æ³•</h4><p>ä¸ºäº†è§£å†³çº¿æ€§å¯åˆ†æ”¯æŒå‘é‡æœºçš„æœ€ä¼˜åŒ–é—®é¢˜ï¼Œå¯å°†å…¶ä½œä¸ºåŸå§‹é—®é¢˜ï¼Œåº”ç”¨æ‹‰æ ¼æœ—æ—¥å¯¹å¶æ€§ï¼Œé€šè¿‡æ±‚è§£å¯¹å¶é—®é¢˜å¾—åˆ°åŸå§‹é—®é¢˜çš„æœ€ä¼˜è§£ï¼Œè¿™å°±æ˜¯çº¿æ€§å¯åˆ†æ”¯æŒå‘é‡æœºçš„<strong>å¯¹å¶ç®—æ³•</strong>ã€‚å…¶ä¼˜ç‚¹å¦‚ä¸‹ï¼š</p><ul><li>è½¬åŒ–ä¸ºå¯¹å¶é—®é¢˜æ›´å®¹æ˜“æ±‚è§£ã€‚</li><li>è‡ªç„¶å¼•å…¥æ ¸å‡½æ•°ï¼Œè¿›è€Œæ¨å¹¿åˆ°éçº¿æ€§åˆ†ç±»é—®é¢˜ã€‚</li></ul><p><small>åç»­çš„æ‹‰æ ¼æœ—æ—¥å‡½æ•°å†…å®¹å®åœ¨æ˜¯çœ‹ä¸æ‡‚ï¼Œå…ˆå…è®¸æˆ‘ <code>TODO</code> ä¸‹ğŸ˜</small></p><hr><h3 id="çº¿æ€§æ”¯æŒå‘é‡æœº"><a href="#çº¿æ€§æ”¯æŒå‘é‡æœº" class="headerlink" title="çº¿æ€§æ”¯æŒå‘é‡æœº"></a>çº¿æ€§æ”¯æŒå‘é‡æœº</h3><p>å¯¹äºçº¿æ€§ä¸å¯åˆ†è®­ç»ƒæ•°æ®é›†å†ä½¿ç”¨ç¡¬é—´éš”æœ€å¤§åŒ–æ¥åˆ†ç±»æ˜¯ä¸é€‚ç”¨çš„ï¼Œéœ€è¦ä½¿ç”¨<strong>è½¯é—´éš”æœ€å¤§åŒ–</strong>ã€‚<br>é€šå¸¸æƒ…å†µä¸‹ï¼Œè®­ç»ƒæ•°æ®é›†ä¸­å­˜åœ¨ä¸€äº›<strong>ç‰¹å¼‚ç‚¹ï¼ˆ<code>outlier</code>ï¼‰</strong>ï¼Œå°†è¿™äº›ç‰¹å¼‚ç‚¹å»é™¤åå‰©ä¸‹çš„å¤§éƒ¨åˆ†æ ·æœ¬ç‚¹æ˜¯å¯ä»¥æ»¡è¶³çº¿æ€§å¯åˆ†ã€‚è€Œçº¿æ€§ä¸å¯åˆ†çš„æ ·æœ¬ç‚¹ $(x_i, y_i)$ ä¹Ÿå°±æ„å‘³ç€ä¸èƒ½æ»¡è¶³é—´éš”å¤§äºç­‰äº <code>1</code> çš„çº¦æŸæ¡ä»¶ï¼Œä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¯¹æ¯ä¸ªæ ·æœ¬ç‚¹å¼•å…¥ä¸€ä¸ª<strong>æ¾å¼›å˜é‡ $ \xi_i &gt;&#x3D;0$</strong> ï¼Œä½¿å¾—å‡½æ•°é—´éš”åŠ ä¸Šæ¾å¼›å˜é‡å¤§äºç­‰äº <code>1</code>ï¼Œå³çº¦æŸæ¡ä»¶å’Œç›®æ ‡å‡½æ•°å¦‚ä¸‹ï¼š<br>$$ y_i(wÂ·x_i + b) &gt;&#x3D; 1 - \xi_i $$<br>$$ {\frac {1} {2}} {||w||}^2 + C sum_{i&#x3D;1}^N \xi_i $$<br><small>$C&gt;0$ è¢«ç§°ä¸º<strong>æƒ©ç½šå‚æ•°</strong>ï¼Œä¸€èˆ¬ç”±åº”ç”¨é—®é¢˜å†³å®šï¼Œ$C$ å€¼å¤§æ—¶å¯¹è¯¯åˆ†ç±»çš„æƒ©ç½šå¢å¤§ï¼Œ$C$ å€¼å°æ—¶å¯¹è¯¯åˆ†ç±»çš„æƒ©ç½šå‡å°ã€‚</small></p><p>çº¿æ€§ä¸å¯åˆ†çš„çº¿æ€§æ”¯æŒå‘é‡æœºçš„å­¦ä¹ é—®é¢˜å˜æˆäº†å¦‚ä¸‹çš„å‡¸äºŒæ¬¡è§„åˆ’é—®é¢˜ï¼š<br>$$ min_{w, b, \xi} \quad {\frac {1} {2}} {||w||}^2 + C sum_{i&#x3D;1}^N \xi_i $$<br>$$ \begin{equation}\begin{split}<br>s.t. \quad y_i(wÂ·x_i + b) &gt;&#x3D; 1 - \xi_i, \quad i&#x3D;1, 2, â€¦, N \\<br>\xi_i &gt;&#x3D; 0, \quad i&#x3D;1, 2, â€¦, N<br>\end{split}\nonumber\end{equation}$$</p><p>ä¸Šè¿°æ±‚è§£åå¾—åˆ° $w^*, b^*$ï¼Œå°±å¯ä»¥è¾¾åˆ°<strong>åˆ†ç¦»è¶…å¹³é¢ $w^*Â·x + b^* &#x3D; 0$</strong> åŠ<strong>åˆ†ç±»å†³ç­–å‡½æ•° $f(x)&#x3D;sign(w^*Â·x + b^*)$</strong> ï¼Œè¯¥æ¨¡å‹ä¸ºè®­ç»ƒçº¿æ€§ä¸å¯åˆ†æ—¶çš„çº¿æ€§æ”¯æŒå‘é‡æœºï¼Œç®€ç§°ä¸ºçº¿æ€§æ”¯æŒå‘é‡æœºï¼Œå…¶å¯¹äºç°å®æ•°æ®å…·æœ‰æ›´å¹¿çš„é€‚ç”¨æ€§ã€‚</p><p><strong>çº¿æ€§æ”¯æŒå‘é‡æœºå­¦ä¹ ç®—æ³•</strong>ï¼š</p><blockquote><p>è¾“å…¥ï¼šè®­ç»ƒæ•°æ®é›† $T&#x3D;{(x_1, y_1), â€¦, (x_N, y_N)}$ï¼Œå…¶ä¸­ $x_i \in X &#x3D; R^nï¼Œy_i \in Y &#x3D; \{+1, -1\}ï¼Œi &#x3D; 1, â€¦, N$ <br><br>è¾“å‡ºï¼šåˆ†ç¦»è¶…å¹³é¢å’Œåˆ†ç±»å†³ç­–å‡½æ•°<br>è¿‡ç¨‹ï¼š</p><ol><li>é€‰æ‹©æƒ©ç½šå‚æ•° $C&gt;0$ï¼Œæ„é€ å¹¶æ±‚è§£å‡¸äºŒæ¬¡è§„åˆ’é—®é¢˜<br> $$ min_{a} \quad {\frac {1} {2}} sum_{i&#x3D;1}^N sum_{j&#x3D;1}^N a_i a_j y_i y_j (x_i Â· x_j) - sum_{i&#x3D;1}^N a_i $$<br> $$ \begin{equation}\begin{split}<br>s.t. \quad sum_{i&#x3D;1}^N a_i y_i &#x3D; 0 \\<br>0 &lt;&#x3D; a_i &lt;&#x3D; C<br>\end{split}\nonumber\end{equation}$$<br> æ±‚å¾—æœ€ä¼˜è§£ $a^* &#x3D; (a_1^*, a_2^*, â€¦, a_N^*)^T $</li><li>è®¡ç®— $ w^* &#x3D; sum_{i&#x3D;1}^N a_i^* y_i x_i $<br> é€‰æ‹© $a^*$ çš„ä¸€ä¸ªåˆ†é‡ $a_j^*$ é€‚åˆæ¡ä»¶ $0 &lt;&#x3D; a_j^* &lt;&#x3D; C$ï¼Œè®¡ç®—<br> $$ b^* &#x3D; y_j - sum_{i&#x3D;1}^N y_i a_i^*(x_i Â· x_j) $$<br> <small>$a_j^*$ åœ¨å®é™…ä¸­å–æ‰€æœ‰ç¬¦åˆæ¡ä»¶çš„æ ·æœ¬ç‚¹ä¸Šçš„å¹³å‡å€¼ã€‚</small></li><li>è·å¾—åˆ†ç¦»è¶…å¹³é¢åŠåˆ†ç±»å†³ç­–å‡½æ•°<br> $$ w^*Â·x + b^* &#x3D; 0 $$<br> $$ f(x)&#x3D;sign(w^*Â·x + b^*) $$</li></ol></blockquote><h4 id="å¯¹å¶ç®—æ³•-1"><a href="#å¯¹å¶ç®—æ³•-1" class="headerlink" title="å¯¹å¶ç®—æ³•"></a>å¯¹å¶ç®—æ³•</h4><p><small>å†å…è®¸æˆ‘ <code>TODO</code> ä¸€ä¸‹ğŸ˜­</small></p><h4 id="æ”¯æŒå‘é‡"><a href="#æ”¯æŒå‘é‡" class="headerlink" title="æ”¯æŒå‘é‡"></a>æ”¯æŒå‘é‡</h4><p>åœ¨çº¿æ€§ä¸å¯åˆ†çš„æƒ…å†µä¸‹ï¼Œå°†å¯¹å¶é—®é¢˜çš„è§£ $a^* &#x3D; (a_1^*, a_2^*, â€¦, a_N^*)^T$ ä¸­å¯¹åº”çš„ $a_i^*&gt;0$ çš„æ ·æœ¬ç‚¹ $(x_i, y_i)$ çš„å®ä¾‹ $x_i$ ç§°ä¸ºæ”¯æŒå‘é‡ï¼ˆè½¯é—´éš”çš„æ”¯æŒå‘é‡ï¼‰ã€‚</p><p><img src="/ML-%E6%94%AF%E6%8C%81%E5%90%91%E9%87%8F%E6%9C%BA/svm_8.jpg" alt="svm_8.jpg"></p><p>è½¯é—´éš”çš„æ”¯æŒå‘é‡ $x_i$ åœ¨é—´éš”è¾¹ç•Œä¸Šã€åœ¨é—´éš”è¾¹ç•Œä¸åˆ†ç¦»è¶…å¹³é¢ä¹‹é—´æˆ–è€…åœ¨åˆ†ç¦»è¶…å¹³é¢è¯¯åˆ†ä¸€ä¾§ï¼š</p><ul><li>è‹¥ $a_i^*&lt;C$ï¼Œåˆ™ $\xi_i&#x3D;0$ï¼Œæ”¯æŒå‘é‡ $x_i$ æ°å¥½è½åœ¨é—´éš”è¾¹ç•Œä¸Šã€‚</li><li>è‹¥ $a_i^*&#x3D;C, 0&lt;\xi_i&lt;1$ï¼Œåˆ™åˆ†ç±»æ­£ç¡®ï¼Œæ”¯æŒå‘é‡ $x_i$ åœ¨é—´éš”è¾¹ç•Œä¸åˆ†ç¦»è¶…å¹³é¢ä¹‹é—´ã€‚</li><li>è‹¥ $a_i^*&#x3D;C, \xi_i&#x3D;1$ï¼Œåˆ™æ”¯æŒå‘é‡ $x_i$ æ°å¥½è½åœ¨åˆ†ç¦»è¶…å¹³é¢ä¸Šã€‚</li><li>è‹¥ $a_i^*&#x3D;C, \xi_i&gt;1$ï¼Œåˆ™æ”¯æŒå‘é‡ $x_i$ åœ¨åˆ†ç¦»è¶…å¹³é¢è¯¯åˆ†ä¸€ä¾§ã€‚</li></ul><hr><h3 id="éçº¿æ€§æ”¯æŒå‘é‡æœº"><a href="#éçº¿æ€§æ”¯æŒå‘é‡æœº" class="headerlink" title="éçº¿æ€§æ”¯æŒå‘é‡æœº"></a>éçº¿æ€§æ”¯æŒå‘é‡æœº</h3><p>å¯¹äºçº¿æ€§åˆ†ç±»é—®é¢˜ï¼Œæœ‰æ—¶åˆ†ç±»é—®é¢˜æ˜¯éçº¿æ€§çš„ï¼Œæ­¤æ—¶å¯ä»¥ä½¿ç”¨éçº¿æ€§æ”¯æŒå‘é‡æœºï¼Œå…¶ä¸»è¦é€‚ç”¨<strong>æ ¸æŠ€å·§ï¼ˆ<code>kernal trick</code>ï¼‰</strong>ã€‚</p><h4 id="æ ¸æŠ€å·§"><a href="#æ ¸æŠ€å·§" class="headerlink" title="æ ¸æŠ€å·§"></a>æ ¸æŠ€å·§</h4><h5 id="é‡Šä¹‰"><a href="#é‡Šä¹‰" class="headerlink" title="é‡Šä¹‰"></a>é‡Šä¹‰</h5><p>éçº¿æ€§åˆ†ç±»é—®é¢˜æ˜¯æŒ‡é€šè¿‡åˆ©ç”¨éçº¿æ€§æ¨¡å‹æ‰èƒ½è¿›è¡Œåˆ†ç±»çš„é—®é¢˜ã€‚ä¸€èˆ¬æ¥è¯´å¯¹äºç»™å®šçš„è®­ç»ƒæ•°æ®é›† $T&#x3D;{(x_1, y_1), â€¦, (x_N, y_N)}$ï¼Œå…¶ä¸­å®ä¾‹ $x_i$ å±äºè¾“å…¥ç©ºé—´ $x_i \in X &#x3D; R^n$ï¼Œå¯¹åº”çš„æ ‡è®°æœ‰ä¸¤ç±» $y_i \in Y &#x3D; {-1, +1}, i&#x3D;1,2,â€¦,N$ï¼Œå¦‚æœèƒ½ç”¨ $R^n$ ä¸­çš„ä¸€ä¸ªè¶…å¹³é¢å°†æ­£è´Ÿä¾‹æ­£ç¡®åˆ†å¼€ï¼Œåˆ™ç§°è¿™ä¸ªé—®é¢˜ä¸ºéçº¿æ€§å¯åˆ†é—®é¢˜ã€‚<br><img src="/ML-%E6%94%AF%E6%8C%81%E5%90%91%E9%87%8F%E6%9C%BA/svm_7.jpg" alt="svm_7.jpg"></p><p>éçº¿æ€§é—®é¢˜å¾€å¾€ä¸å¥½æ±‚è§£ï¼Œå› æ­¤å¸Œæœ›å¯ä»¥ä½¿ç”¨çº¿æ€§åˆ†ç±»é—®é¢˜çš„æ–¹æ³•æ¥è§£å†³é—®é¢˜ã€‚è€Œé‡‡å–çš„æ–¹æ³•å°±æ˜¯å°†éçº¿æ€§é—®é¢˜è½¬æ¢ä¸ºçº¿æ€§é—®é¢˜ï¼Œé€šè¿‡è½¬æ¢åçš„çº¿æ€§é—®é¢˜çš„æ±‚è§£æ–¹æ³•æ¥è§£å†³åŸæ¥çš„éçº¿æ€§é—®é¢˜ã€‚ </p><h5 id="å®šä¹‰"><a href="#å®šä¹‰" class="headerlink" title="å®šä¹‰"></a>å®šä¹‰</h5><p>æ ¸æŠ€å·§çš„æ€è·¯æ˜¯ï¼šåœ¨å­¦ä¹ ä¸é¢„æµ‹ä¸­åªå®šä¹‰<strong>æ ¸å‡½æ•° $K(x,z)$</strong> ï¼Œè€Œä¸æ˜¾ç¤ºåœ°å®šä¹‰<strong>æ˜ å°„å‡½æ•° $\phi$</strong> ï¼Œé€šå¸¸ç›´æ¥è®¡ç®—æ ¸å‡½æ•°æ˜¯æ¯”è¾ƒç®€å•çš„ï¼Œè€Œé€šè¿‡æ˜ å°„å‡½æ•° $\phi(x)$ å’Œ $\phi(z)$ è®¡ç®— $K(x,z)$ å¹¶ä¸ç®€å•ã€‚å¹¶ä¸”ç‰¹å¾ç©ºé—´ $H$ ä¸€èˆ¬æ˜¯é«˜ç»´çš„ï¼Œè€Œå¯¹äºç»™å®šçš„æ ¸å‡½æ•° $K(x,z)$ï¼Œç‰¹å¾ç©ºé—´ $H$ å’Œæ˜ å°„å‡½æ•° $\phi$ å¹¶ä¸å”¯ä¸€ï¼Œå³å¯ä»¥å–ä¸åŒçš„ç‰¹å¾ç©ºé—´ï¼Œç›¸åº”çš„æ˜ å°„å‡½æ•°ä¹Ÿå¯ä»¥ä¸åŒã€‚<br><br><small>$\phi$ æ˜¯è¾“å…¥ç©ºé—´ $R^n$ åˆ°ç‰¹å¾ç©ºé—´ $H$ çš„æ˜ å°„ã€‚</small></p><p>è®¾å®š $X$ æ˜¯è¾“å…¥ç©ºé—´ï¼Œåˆè®¾å®š $H$ ä¸ºç‰¹å¾ç©ºé—´ï¼Œå¦‚æœå­˜åœ¨ä¸€ä¸ªä» $X$ åˆ° $H$ çš„æ˜ å°„<br>$$ \phi(x): X -&gt; H $$</p><p>ä½¿å¾—å¯¹æ‰€æœ‰çš„ $x,z \in X$ï¼Œå‡½æ•° $K(x, z)$ æ»¡è¶³æ¡ä»¶<br>$$ K(x, z) &#x3D; \phi(x)Â·\phi(z) $$</p><p>åˆ™ç§° $K(x, z)$ ä¸ºæ ¸å‡½æ•°ï¼Œ$\phi(x)$ ä¸ºæ˜ å°„å‡½æ•°ï¼Œå¼ä¸­ $\phi(x)Â·\phi(z)$ ä¸º $\phi(x)$ å’Œ $\phi(z)$ çš„å†…ç§¯ã€‚</p><h5 id="åº”ç”¨"><a href="#åº”ç”¨" class="headerlink" title="åº”ç”¨"></a>åº”ç”¨</h5><p>åœ¨çº¿æ€§æ”¯æŒå‘é‡æœºçš„å¯¹å¶é—®é¢˜ä¸­ï¼Œæ— è®ºæ˜¯ç›®æ ‡å‡½æ•°è¿˜æ˜¯åˆ†ç±»å†³ç­–å‡½æ•°ï¼ˆåˆ†ç¦»è¶…å¹³é¢ï¼‰éƒ½ä»…æ¶‰åŠè¾“å…¥å®ä¾‹ä¸å®ä¾‹ä¹‹é—´çš„<strong>å†…ç§¯</strong>ã€‚<br>å› æ­¤å¯¹å¶é—®é¢˜çš„ç›®æ ‡å‡½æ•°ä¸­çš„å†…ç§¯ $x_iÂ·x_j$ å¯ä»¥ç”¨æ ¸å‡½æ•° $K(x_i, x_j) &#x3D; \phi(x_i)Â·\phi(x_j)$ æ¥ä»£æ›¿ï¼Œæ­¤æ—¶å¯¹å¶é—®é¢˜çš„ç›®æ ‡å‡½æ•°ç§°ä¸ºï¼š<br>$$ W(a) &#x3D; {\frac {1} {2}} sum_{i&#x3D;1}^N sum_{j&#x3D;1}^N a_i a_j y_i y_j K(x_i, x_j) - sum_{i&#x3D;1}^N a_i $$</p><p>ç±»ä¼¼çš„ï¼Œåˆ†ç±»å†³ç­–å‡½æ•°ä¸­çš„å†…ç§¯ä¹Ÿå¯ä»¥ä½¿ç”¨æ ¸å‡½æ•°ä»£æ›¿ï¼Œåˆ†ç±»å†³ç­–å‡½æ•°å¦‚ä¸‹ï¼š<br>$$ f(x) &#x3D; sign(sum_{i&#x3D;1}^N a_i^* y_i \phi(x_i) Â· \phi(x) + b^*) &#x3D; sign(sum_{i&#x3D;1}^N a_i^* y_i K(x_i, x) + b^*) $$</p><p>ä¸Šè¿°å°±ç­‰ä»·äºé€šè¿‡æ˜ å°„å‡½æ•° $\phi$ å°†åŸæ¥çš„è¾“å…¥ç©ºé—´å˜æ¢æˆä¸€ä¸ªæ–°çš„ç‰¹å¾ç©ºé—´ï¼Œå°†è¾“å…¥ç©ºé—´çš„å†…ç§¯ $x_iÂ·x_j$ å˜æ¢ä¸ºç‰¹å¾ç©ºé—´ä¸­çš„å†…ç§¯ $\phi(x_i)Â·\phi(x_j)$ï¼Œåœ¨æ–°çš„ç‰¹å¾ç©ºé—´ä¸­å­¦ä¹ çº¿æ€§æ”¯æŒå‘é‡æœºã€‚<br><br><small>æ˜ å°„å‡½æ•°ä¸ºéçº¿æ€§å‡½æ•°æ—¶ï¼Œå³å­¦ä¹ åˆ°å«æœ‰æ ¸å‡½æ•°çš„æ”¯æŒå‘é‡æœºå°±æ˜¯éçº¿æ€§æ”¯æŒå‘é‡æœºã€‚</small></p><h4 id="å¸¸ç”¨æ ¸å‡½æ•°"><a href="#å¸¸ç”¨æ ¸å‡½æ•°" class="headerlink" title="å¸¸ç”¨æ ¸å‡½æ•°"></a>å¸¸ç”¨æ ¸å‡½æ•°</h4><ol><li><p><strong>å¤šé¡¹å¼æ ¸å‡½æ•°ï¼ˆ<code>polynomial kernal function</code>ï¼‰</strong><br> $$ K(x, z) &#x3D; (xÂ·z + 1)^p $$<br> å¯¹åº”çš„æ”¯æŒå‘é‡æœºæ˜¯ä¸€ä¸ª <code>p</code> æ¬¡å¤šé¡¹å¼åˆ†ç±»å™¨ï¼Œåˆ†ç±»å†³ç­–å‡½æ•°å¦‚ä¸‹ï¼š<br> $$ f(x) &#x3D; sign(sum_{i&#x3D;1}^N a_i^* y_i (x_iÂ·x + 1)^p + b^*) $$</p></li><li><p><strong>é«˜æ–¯æ ¸å‡½æ•°ï¼ˆ<code>Gaussian kernal function</code>ï¼‰</strong><br> $$ K(x, z) &#x3D; exp(-{\frac {(||x-z||)^2} {2a^2}}) $$<br> å¯¹åº”çš„æ”¯æŒå‘é‡æœºæ˜¯é«˜æ–¯å¾„å‘åŸºå‡½æ•°ï¼ˆ<code>radial basis function</code>ï¼‰åˆ†ç±»å™¨ï¼Œåˆ†ç±»å†³ç­–å‡½æ•°å¦‚ä¸‹ï¼š<br> $$ f(x) &#x3D; sign(sum_{i&#x3D;1}^N a_i^* y_i exp(-{\frac {(||x-z||)^2} {2a^2}}) + b^*) $$</p></li><li><p><strong>å­—ç¬¦ä¸²æ ¸å‡½æ•°ï¼ˆ<code>string kernal function</code>ï¼‰</strong><br> æ ¸å‡½æ•°ä¸ä»…å¯ä»¥å®šä¹‰åœ¨æ¬§æ°ç©ºé—´ä¸Šï¼Œè¿˜å¯ä»¥å®šä¹‰åœ¨ç¦»æ•£æ•°æ®çš„é›†åˆä¸Šã€‚å­—ç¬¦ä¸²æ ¸å°±æ˜¯å®šä¹‰åœ¨å­—ç¬¦ä¸²é›†åˆä¸Šçš„æ ¸å‡½æ•°ï¼Œå…¶åœ¨æ–‡æœ¬åˆ†ç±»ã€ä¿¡æ¯æ£€ç´¢ç­‰æ–¹é¢å‡æœ‰åº”ç”¨ã€‚</p></li></ol><p>æ ¸æŠ€å·§çš„å…·ä½“æ€è·¯æ˜¯ï¼Œåœ¨å­¦ä¹ ä¸é¢„æµ‹ä¸­åªå®šä¹‰æ ¸å‡½æ•° $K(x, z)$ï¼Œè€Œä¸æ˜¾å¼å®šä¹‰æ˜ å°„å‡½æ•°ï¼Œ</p><h4 id="éçº¿æ€§æ”¯æŒå‘é‡æœº-1"><a href="#éçº¿æ€§æ”¯æŒå‘é‡æœº-1" class="headerlink" title="éçº¿æ€§æ”¯æŒå‘é‡æœº"></a>éçº¿æ€§æ”¯æŒå‘é‡æœº</h4><p>åˆ©ç”¨æ ¸æŠ€å·§å¯ä»¥å°†çº¿æ€§åˆ†ç±»é—®é¢˜çš„å­¦ä¹ æ–¹æ³•åº”ç”¨äºéçº¿æ€§åˆ†ç±»é—®é¢˜ä¸­ï¼Œä»…éœ€è¦å°†çº¿æ€§æ”¯æŒå‘é‡æœº<strong>å¯¹å¶å½¢å¼ä¸­çš„å†…ç§¯æ›¿æ¢æˆæ ¸å‡½æ•°</strong>å³å¯ã€‚<br>ä»éçº¿æ€§åˆ†ç±»è®­ç»ƒé›†ï¼Œé€šè¿‡æ ¸å‡½æ•°å’Œè½¯é—´éš”æœ€å¤§åŒ–æˆ–å‡¸äºŒæ¬¡è§„åˆ’ï¼Œå­¦ä¹ å¾—åˆ°çš„åˆ†ç±»å†³ç­–å‡½æ•°ç§°ä¸ºéçº¿æ€§æ”¯æŒå‘é‡ï¼Œ$K(x, x_i)$ æ˜¯æ­£å®šæ ¸å‡½æ•°ã€‚<br>$$ f(x) &#x3D; sign(sum_{i&#x3D;1}^N a^* y_i K(x, x_i) + b^*) $$</p><p><strong>éçº¿æ€§æ”¯æŒå‘é‡æœºå­¦ä¹ ç®—æ³•</strong>ï¼š</p><blockquote><p>è¾“å…¥ï¼šè®­ç»ƒæ•°æ®é›† $T&#x3D;{(x_1, y_1), â€¦, (x_N, y_N)}$ï¼Œå…¶ä¸­ $x_i \in X &#x3D; R^n, y_i \in Y &#x3D; \{-1, +1\}, i&#x3D;1,2,â€¦,N$ <br><br>è¾“å‡ºï¼šåˆ†ç±»å†³ç­–å‡½æ•°<br>è¿‡ç¨‹ï¼š</p><ol><li>é€‰å–é€‚å½“çš„æ ¸å‡½æ•° $K(x, z)$ å’Œé€‚å½“çš„å‚æ•° <code>C</code>ï¼Œæ„é€ å¹¶æ±‚è§£æœ€ä¼˜åŒ–é—®é¢˜<br> $$ min_a \quad {\frac {1} {2}} sum_{i&#x3D;1}^N sum_{j&#x3D;1}^N a_i a_j y_i y_j K(x_i, y_i) - sum_{i&#x3D;1}^N a_i $$<br> $$ s.t. \quad sum_{i&#x3D;1}^N a_i y_i &#x3D; 0, \quad 0 &lt;&#x3D; a_i &lt;&#x3D; C, \quad i&#x3D;1,2,â€¦,N $$<br> æ±‚å¾—æœ€ä¼˜è§£ $a^*&#x3D;(a_1^*, a_2^*, â€¦, a_N^*)$</li><li>é€‰æ‹© $a^*$ çš„ä¸€ä¸ªæ­£åˆ†é‡ $0 &lt; a_j^* &lt; C$ï¼Œè®¡ç®—<br> $$ b^* &#x3D; y_j - sum_{i&#x3D;1}^N a_i^* y_i K(x_i, y_j) $$</li><li>æ„é€ å†³ç­–å‡½æ•°<br> $$ f(x) &#x3D; sign(sum_{i&#x3D;1}^N a^* y_i K(x, x_i) + b^*) $$<br> å½“ $K(x, z)$ æ˜¯æ­£å®šæ ¸å‡½æ•°æ—¶ï¼Œæœ€ä¼˜åŒ–é—®é¢˜ä¸ºå‡¸äºŒæ¬¡è§„åˆ’é—®é¢˜ï¼Œå…¶è§£æ˜¯å­˜åœ¨çš„ã€‚</li></ol></blockquote><hr><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>å­¦ä¹ åŸç†çŸ¥è¯†ä»æ¥éƒ½æ˜¯éå¸¸æ¯ç‡¥ä¹å‘³çš„ï¼Œç‰¹åˆ«æ˜¯åˆé•¿åˆå¤æ‚çš„æ•°å­¦å…¬å¼ï¼Œä¸è¿‡å»ºè®®ä½ å¯ä»¥å»çœ‹çœ‹å…·ä½“é—®é¢˜çš„è§£å†³æ–¹æ¡ˆï¼Œé‚£è‚¯å®šèƒ½ç»™ä½ ä¸å°‘çš„<strong>æˆå°±æ„Ÿ</strong>ã€‚</p><hr><h3 id="å¼•ç”¨"><a href="#å¼•ç”¨" class="headerlink" title="å¼•ç”¨"></a>å¼•ç”¨</h3><hr><h3 id="ä¸ªäººå¤‡æ³¨"><a href="#ä¸ªäººå¤‡æ³¨" class="headerlink" title="ä¸ªäººå¤‡æ³¨"></a>ä¸ªäººå¤‡æ³¨</h3><p><strong>æ­¤åšå®¢å†…å®¹å‡ä¸ºä½œè€…å­¦ä¹ ã€Šç»Ÿè®¡å­¦ä¹ æ–¹æ³•ã€‹æ‰€åšç¬”è®°ï¼Œä¾µåˆ ï¼</strong><br><strong>è‹¥è½¬ä½œå…¶ä»–ç”¨é€”ï¼Œè¯·æ³¨æ˜æ¥æºï¼</strong></p>]]></content>
    
    
    <summary type="html">&lt;h3 id=&quot;å°æ•…äº‹&quot;&gt;&lt;a href=&quot;#å°æ•…äº‹&quot; class=&quot;headerlink&quot; title=&quot;å°æ•…äº‹&quot;&gt;&lt;/a&gt;å°æ•…äº‹&lt;/h3&gt;&lt;p&gt;æ¯ä¸ªäººå°æ—¶å€™æœ€è®¨åŒçš„äº‹æƒ…å°±æ˜¯åƒè¯äº†ï¼Œä½†ä¸å¹¸çš„æ˜¯æœ‰ä¸€å¤©ä½ å¾—äº†æ„Ÿå†’ï¼Œå¦ˆå¦ˆç»™ä½ ä¹°äº†è¯ï¼Œä½ æ‹¿åˆ°è¯åæ‰“å¼€äº†åŒ…è£…çº¸ã€‚åœ¨è¯åŒ…é‡Œæœ‰ä¸¤ç§è¯ç‰‡ï¼Œä¸€ç§æ˜¯ç™½è‰²çš„å¦ä¸€ç§æ˜¯é»‘è‰²çš„ï¼Œç™½è‰²çš„çœ‹èµ·æ¥æ¯”è¾ƒç”œï¼Œè€Œé»‘è‰²çš„ä¸€çœ‹å°±å¾ˆè‹¦ï¼›å› æ­¤ä½ å†³å®šå…ˆåƒç™½è‰²çš„è¯ç‰‡ï¼Œé‚£ä¹ˆå¦‚ä½•ä¸€æŠŠæŠ“ä½æ‰€æœ‰çš„è¯ç‰‡å‘¢ï¼Ÿä½ å¯ä»¥æ‰¾ä¸€ä¸ªå‹ºå­è¿™ä¹ˆæŠŠè¯åˆ’åˆ†å‡ºæ¥&lt;br&gt;&lt;img src=&quot;/ML-%E6%94%AF%E6%8C%81%E5%90%91%E9%87%8F%E6%9C%BA/svm_1.jpeg&quot; alt=&quot;svm_1.jpg&quot;&gt;&lt;/p&gt;
&lt;p&gt;é‚£ä¹ˆå¦‚æœè¯åŒ…é‡Œçš„è¯ç‰‡æ˜¯è¿™æ ·æ’å¸ƒçš„å‘¢ï¼Ÿ&lt;br&gt;&lt;img src=&quot;/ML-%E6%94%AF%E6%8C%81%E5%90%91%E9%87%8F%E6%9C%BA/svm_2.jpeg&quot; alt=&quot;svm_2.jpg&quot;&gt;&lt;/p&gt;
&lt;p&gt;æ­¤æ—¶ä½ å¿ƒé‡Œæƒ³ç€ç»ˆäºå¯ä»¥ç¥­å‡ºæˆ‘çš„ç»ä¸–ç¥åŠŸäº†ï¼å“¼å“ˆâ€¦å……æ»¡å†…åŠ›çš„æ‰‹ä¸€æ‹æ¡Œå­ï¼Œè¯ç‰‡å°±é£åˆ°äº†åŠç©ºä¸­ï¼Œæ­¤æ—¶æ— å½±æ‰‹æŠ€èƒ½å‘åŠ¨ï¼Œä½ å°±ç”¨ä¸€å¼ çº¸æ¥ä½äº†é»‘è‰²çš„è¯ç‰‡ï¼Œå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆâ€¦&lt;br&gt;&lt;img src=&quot;/ML-%E6%94%AF%E6%8C%81%E5%90%91%E9%87%8F%E6%9C%BA/svm_3.jpeg&quot; alt=&quot;svm_3.jpg&quot;&gt;&lt;/p&gt;</summary>
    
    
    
    
    <category term="TODO" scheme="https://blog.vgbhfive.cn/tags/TODO/"/>
    
    <category term="ML" scheme="https://blog.vgbhfive.cn/tags/ML/"/>
    
  </entry>
  
  <entry>
    <title>ML-å†³ç­–æ ‘</title>
    <link href="https://blog.vgbhfive.cn/ML-%E5%86%B3%E7%AD%96%E6%A0%91/"/>
    <id>https://blog.vgbhfive.cn/ML-%E5%86%B3%E7%AD%96%E6%A0%91/</id>
    <published>2023-08-02T13:48:52.000Z</published>
    <updated>2023-08-13T03:52:25.474Z</updated>
    
    <content type="html"><![CDATA[<h3 id="æ¦‚è¦"><a href="#æ¦‚è¦" class="headerlink" title="æ¦‚è¦"></a>æ¦‚è¦</h3><p>å†³ç­–æ ‘ï¼ˆ<code>decision tree</code>ï¼‰æ˜¯ä¸€ç§åŸºæœ¬çš„<strong>åˆ†ç±»å’Œå›å½’æ–¹æ³•</strong>ã€‚å…¶ä¸»è¦å‘ˆç°ä¸º<strong>æ ‘çŠ¶ç»“æ„</strong>ï¼Œåœ¨åˆ†ç±»é—®é¢˜ä¸­ï¼Œè¡¨ç¤ºåŸºäºç‰¹å¾å¯¹å®ä¾‹è¿›è¡Œåˆ†ç±»çš„è¿‡ç¨‹ï¼Œå¯ä»¥è¢«è®¤ä¸ºæ˜¯ <strong><code>if-then</code> çš„è§„åˆ™é›†åˆ</strong>ï¼Œä¹Ÿå¯ä»¥è¢«è®¤ä¸ºæ˜¯å®šä¹‰åœ¨<strong>ç‰¹å¾ç©ºé—´ä¸ç±»ç©ºé—´ä¸Šçš„æ¡ä»¶æ¦‚ç‡åˆ†å¸ƒ</strong>ã€‚</p><p>å…¶ä¼˜ç‚¹ä¸»è¦æœ‰åˆ†ç±»é€Ÿåº¦å¿«ã€æ¨¡å‹å…·æœ‰å¯è¯»æ€§ï¼Œåœ¨å­¦ä¹ æ—¶åˆ©ç”¨è®­ç»ƒæ•°æ®æ ¹æ®<strong>æŸå¤±å‡½æ•°æœ€å°åŒ–</strong>çš„åŸåˆ™å»ºç«‹å†³ç­–æ ‘æ¨¡å‹ï¼›è€Œåœ¨é¢„æµ‹æ—¶å¯¹æ–°çš„æ•°æ®åˆ©ç”¨<strong>å†³ç­–æ ‘æ¨¡å‹</strong>è¿›è¡Œåˆ†ç±»ã€‚</p><p>å†³ç­–æ ‘æ¨¡å‹ä¸»è¦åŒ…å«ä»¥ä¸‹æ­¥éª¤ï¼š</p><ul><li><strong>ç‰¹å¾é€‰æ‹©</strong></li><li><strong>å†³ç­–æ ‘çš„ç”Ÿæˆ</strong></li><li><strong>å†³ç­–æ ‘çš„ä¿®å‰ª</strong></li></ul><span id="more"></span><hr><h3 id="å†³ç­–æ ‘"><a href="#å†³ç­–æ ‘" class="headerlink" title="å†³ç­–æ ‘"></a>å†³ç­–æ ‘</h3><h4 id="å†³ç­–æ ‘æ¨¡å‹"><a href="#å†³ç­–æ ‘æ¨¡å‹" class="headerlink" title="å†³ç­–æ ‘æ¨¡å‹"></a>å†³ç­–æ ‘æ¨¡å‹</h4><p>åˆ†ç±»å†³ç­–æ ‘æ¨¡å‹æ˜¯ä¸€ç§æè¿°å¯¹å®ä¾‹è¿›è¡Œåˆ†ç±»çš„æ ‘çŠ¶ç»“æ„ã€‚å†³ç­–æ ‘æœ‰<strong>ç»“ç‚¹ï¼ˆ<code>node</code>ï¼‰</strong>å’Œ<strong>æœ‰å‘è¾¹ï¼ˆ<code>directed edge</code>ï¼‰</strong>ç»„æˆï¼Œç»“ç‚¹æœ‰ä¸¤ç§ç±»å‹ï¼š<strong>å†…éƒ¨ç»“ç‚¹ï¼ˆ<code>internal node</code>ï¼‰</strong>å’Œ<strong>å¶ç»“ç‚¹ï¼ˆ<code>leaf node</code>ï¼‰</strong>ï¼Œå…¶ä¸­å†…éƒ¨ç»“ç‚¹è¡¨ç¤ºä¸€ä¸ªç‰¹å¾æˆ–å±æ€§ï¼Œå¶ç»“ç‚¹è¡¨ç¤ºä¸€ä¸ªç±»ã€‚</p><p>ç”¨å†³ç­–æ ‘åˆ†ç±»ï¼Œé¦–å…ˆä»æ ¹ç»“ç‚¹å¼€å§‹å¯¹å®ä¾‹çš„æŸä¸€ä¸ªç‰¹å¾è¿›è¡Œæµ‹è¯•ï¼Œæ ¹æ®æµ‹è¯•ç»“æœå°†å®ä¾‹åˆ†é…åˆ°å…¶å­ç»“ç‚¹ä¸Šï¼Œæ¯ä¸ªå­ç»“ç‚¹å¯¹åº”ç€ä¸€ä¸ªç‰¹å¾çš„å–å€¼ã€‚å¦‚æ­¤é€’å½’åœ°å¯¹å®ä¾‹è¿›è¡Œæµ‹è¯•å’Œåˆ†é…ï¼Œç›´è‡³åˆ°è¾¾å¶ç»“ç‚¹ï¼Œæœ€åå°†å®ä¾‹åˆ†é…åˆ°å¶ç»“ç‚¹çš„åˆ†ç±»ä¸­ã€‚</p><p><img src="/ML-%E5%86%B3%E7%AD%96%E6%A0%91/decision_tree-1.jpeg" alt="decision_tree-1"></p><h4 id="åˆ†ç±»è¿‡ç¨‹"><a href="#åˆ†ç±»è¿‡ç¨‹" class="headerlink" title="åˆ†ç±»è¿‡ç¨‹"></a>åˆ†ç±»è¿‡ç¨‹</h4><ol><li><p><strong><code>if-then</code> è§„åˆ™é›†åˆ</strong><br>å†³ç­–æ ‘å¯ä»¥çœ‹æˆæ˜¯ <code>if-then</code> è§„åˆ™çš„é›†åˆã€‚å°†å†³ç­–æ ‘è½¬æ¢ä¸º <code>if-then</code> è§„åˆ™çš„æµç¨‹å¦‚ä¸‹ï¼šç”±å†³ç­–æ ‘çš„æ ¹ç»“ç‚¹åˆ°å¶ç»“ç‚¹çš„æ¯ä¸€æ¡è·¯å¾„æ„å»ºä¸€ä¸ªè§„åˆ™ï¼›è·¯å¾„ä¸Šçš„å†…éƒ¨ç»“ç‚¹çš„ç‰¹å¾è¡¨ç¤ºè§„åˆ™çš„æ¡ä»¶ï¼Œè€Œå¶ç»“ç‚¹çš„åˆ†ç±»åˆ™å¯¹åº”çš„è§„åˆ™çš„ç»“è®ºã€‚<br>å†³ç­–æ ‘ä¸Šçš„è·¯å¾„æˆ–å…¶å¯¹åº”çš„ <code>if-then</code> è§„åˆ™é›†åˆå…·æœ‰ä¸€ä¸ªé‡è¦çš„æ€§è´¨ï¼š<strong>äº’æ–¥ä¸”å®Œå¤‡</strong>ã€‚ä¹Ÿå°±æ˜¯è¯´æ¯ä¸€ä¸ªå®ä¾‹éƒ½è¢«ä¸€æ¡è·¯å¾„æˆ–å¯¹åº”çš„ä¸€æ¡è§„åˆ™è¦†ç›–ï¼Œè€Œä¸”ä»…è¢«ä¸€æ¡è·¯å¾„æˆ–ä¸€æ¡è§„åˆ™æ‰€è¦†ç›–ã€‚<br><small>è¦†ç›–æ˜¯æŒ‡å®ä¾‹çš„ç‰¹å¾ä¸è·¯å¾„ä¸Šçš„ç‰¹å¾ä¸€è‡´æˆ–å®ä¾‹æ»¡è¶³è§„åˆ™çš„æ¡ä»¶ã€‚</small></p></li><li><p><strong>æ¡ä»¶æ¦‚ç‡åˆ†å¸ƒ</strong><br>å†³ç­–æ ‘è¿˜å¯ä»¥è¡¨ç¤ºä¸ºç»™å®šç‰¹å¾æ¡ä»¶ä¸‹ç±»çš„<strong>æ¡ä»¶æ¦‚ç‡åˆ†å¸ƒ</strong>ï¼Œè¯¥æ¡ä»¶æ¦‚ç‡åˆ†å¸ƒå®šä¹‰åœ¨ç‰¹å¾ç©ºé—´çš„åˆ’åˆ†ï¼ˆ<code>partition</code>ï¼‰ä¸Šã€‚å°†ç‰¹å¾ç©ºé—´åˆ’åˆ†ä¸ºäº’ä¸ç›¸äº¤çš„å•å…ƒæˆ–åŒºåŸŸï¼Œå¹¶åœ¨æ¯ä¸ªå•å…ƒæˆ–åŒºåŸŸå®šä¹‰ä¸€ä¸ªç±»çš„æ¦‚ç‡åˆ†å¸ƒå°±å¯ä»¥æ„æˆä¸€ä¸ªæ¡ä»¶æ¦‚ç‡åˆ†å¸ƒã€‚<br>å†³ç­–æ ‘ä¸­çš„æ¯ä¸€æ¡è·¯å¾„å¯¹åº”èŠ±ç²‰ä¸­çš„æŸä¸ªå•å…ƒï¼Œå†³ç­–æ ‘æ‰€è¡¨ç¤ºçš„æ¡ä»¶æ¦‚ç‡åˆ†å¸ƒå°±æ˜¯ç”±å„ä¸ªå•å…ƒåœ¨ç»™å®šç‰¹å¾æ¡ä»¶ä¸‹ç±»çš„æ¡ä»¶æ¦‚ç‡åˆ†å¸ƒç»„æˆã€‚<br><img src="/ML-%E5%86%B3%E7%AD%96%E6%A0%91/decision_tree_3.jpg" alt="decision_tree-3"></p></li></ol><h4 id="å†³ç­–æ ‘å­¦ä¹ "><a href="#å†³ç­–æ ‘å­¦ä¹ " class="headerlink" title="å†³ç­–æ ‘å­¦ä¹ "></a>å†³ç­–æ ‘å­¦ä¹ </h4><p>å†³ç­–æ ‘å­¦ä¹ æ ¹æ®ç»™å®šçš„è®­ç»ƒæ•°æ®é›†æ„å»ºä¸€ä¸ªå†³ç­–æ ‘æ¨¡å‹ï¼Œä½¿ä¹‹å¯ä»¥æ­£ç¡®åœ°è¿›è¡Œåˆ†ç±»ï¼Œä½†å…¶æœ¬è´¨å°±æ˜¯ä»è®­ç»ƒæ•°æ®é›†ä¸­å½’çº³æ€»ç»“å‡ºä¸€ç»„åˆ†ç±»è§„åˆ™ï¼Œè€Œæœ€ç»ˆæ‰€éœ€è¦çš„æ˜¯å…·æœ‰å¾ˆå¥½çš„æ³›åŒ–èƒ½åŠ›ï¼Œæ—¢å¯ä»¥å¯¹è®­ç»ƒæ•°æ®æœ‰å¾ˆå¥½çš„æ‹Ÿåˆï¼Œä¹Ÿå¯ä»¥å¯¹æœªçŸ¥æ•°æ®æœ‰å¾ˆå¥½çš„é¢„æµ‹ã€‚<br>é‚£ä¹ˆå¦‚ä½•å¯¹è¿™ä¸€è¦æ±‚å¦‚ä½•ä½“ç°å‘¢ï¼Ÿå†³ç­–æ ‘æ¨¡å‹ä½¿ç”¨æŸå¤±å‡½æ•°æ¥è¡¨ç¤ºè¿™ä¸€ç›®æ ‡ï¼Œå…¶é€šå¸¸æ˜¯<strong>æ­£åˆ™åŒ–çš„æå¤§ä¼¼ç„¶å‡½æ•°ï¼Œç­–ç•¥æ˜¯ä»¥æŸå¤±å‡½æ•°ä¸ºç›®æ ‡å‡½æ•°çš„æœ€å°åŒ–</strong>ã€‚</p><p>å†³ç­–æ ‘å­¦ä¹ çš„ç®—æ³•é€šå¸¸å°±æ˜¯ä¸€ä¸ªé€’å½’åœ°é€‰æ‹©ç‰¹å¾ï¼Œå¹¶æ ¹æ®è¯¥ç‰¹å¾å¯¹è®­ç»ƒæ•°æ®è¿›è¡Œåˆ†å‰²ï¼Œä½¿å¾—å¯¹å„ä¸ªå­æ•°æ®é›†æœ‰ä¸€ä¸ªæœ€å¥½çš„åˆ†ç±»ï¼Œè¿™ä¸€è¿‡ç¨‹å¯¹åº”ç‰¹å¾ç©ºé—´çš„åˆ’åˆ†ï¼Œä¹Ÿæ˜¯å†³ç­–æ ‘çš„æ„å»ºã€‚<br>åœ¨å¼€å§‹æ—¶æ„å»ºæ ¹ç»“ç‚¹ï¼Œå°†æ‰€æœ‰çš„è®­ç»ƒæ•°æ®éƒ½æ”¾åœ¨æ ¹ç»“ç‚¹ï¼Œæ­¤æ—¶é€‰æ‹©ä¸€ä¸ªæœ€ä¼˜ç‰¹å¾ï¼Œæ ¹æ®è¿™ä¸€ç‰¹å¾å°†è®­ç»ƒæ•°æ®é›†åˆ’åˆ†ä¸ºå­é›†ï¼Œä½¿å¾—å„ä¸ªå­é›†åœ¨å½“å‰åˆ†ç±»æƒ…å†µä¸‹æ˜¯æœ€å¥½çš„åˆ†ç±»ï¼›å¦‚æœè¿™äº›å­é›†å¯ä»¥è¢«åŸºæœ¬æ­£ç¡®åˆ†ç±»ï¼Œé‚£å°±æ„å»ºå¶ç»“ç‚¹ï¼Œå¹¶å°†å­é›†åˆ†é…åˆ°å¯¹åº”çš„å¶ç»“ç‚¹ä¸­ï¼›å¦‚æœè¿™äº›å­é›†ä¸èƒ½è¢«æ­£ç¡®åˆ†ç±»ï¼Œåˆ™ä¸ºè¿™äº›å­é›†é‡æ–°é€‰æ‹©æ–°çš„æœ€ä¼˜ç‰¹å¾ï¼Œç»§ç»­å¯¹å…¶åˆ’åˆ†å¹¶æ„å»ºç›¸åº”çš„ç»“ç‚¹ï¼›å¦‚æ­¤é€’å½’ä¸‹å»ç›´è‡³è®­ç»ƒæ•°æ®å­é›†éƒ½èƒ½è¢«æ­£ç¡®åˆ†ç±»ï¼Œæˆ–è€…æ²¡æœ‰åˆé€‚çš„ç‰¹å¾ä¸ºæ­¢ï¼Œè‡³æ­¤æ¯ä¸ªå­é›†éƒ½ä¼šè¢«åˆ†é…åˆ°å¯¹åº”çš„å¶ç»“ç‚¹ä¸Šï¼Œè¿™å°±ç”Ÿæˆäº†ä¸€é¢—å†³ç­–æ ‘ã€‚</p><p>ä»¥ä¸Šæ–¹æ³•ç”Ÿæˆçš„å†³ç­–æ ‘å¯ä»¥å¾ˆå¥½çš„å¯¹è®­ç»ƒæ•°æ®é›†è¿›è¡Œåˆ†ç±»ï¼Œä½†å¯¹äºæœªçŸ¥çš„æ•°æ®é›†å´æœªå¿…æœ‰å¾ˆå¥½çš„åˆ†ç±»èƒ½åŠ›ï¼Œå³å¯èƒ½å‘ç”Ÿ<strong>è¿‡æ‹Ÿåˆç°è±¡</strong>ã€‚å› æ­¤éœ€è¦å¯¹ç”Ÿæˆçš„å†³ç­–æ ‘è¿›è¡Œ<strong>å‰ªæ</strong>ï¼Œå°†å†³ç­–æ ‘å˜å¾—ç®€å•åŒ–ï¼Œä½¿å…¶å…·æœ‰æ›´å¥½çš„<strong>æ³›åŒ–èƒ½åŠ›</strong>ã€‚</p><hr><h3 id="ç”Ÿæˆç®—æ³•"><a href="#ç”Ÿæˆç®—æ³•" class="headerlink" title="ç”Ÿæˆç®—æ³•"></a>ç”Ÿæˆç®—æ³•</h3><h4 id="ID3"><a href="#ID3" class="headerlink" title="ID3"></a><code>ID3</code></h4><p><code>ID3</code> ç®—æ³•çš„æ ¸å¿ƒåœ¨äºå¯¹å†³ç­–æ ‘ä¸Šçš„å„ä¸ªç»“ç‚¹åº”ç”¨<strong>ä¿¡æ¯å¢ç›Šå‡†åˆ™</strong>é€‰æ‹©ç‰¹å¾ï¼Œé€’å½’åœ°æ„å»ºå†³ç­–æ ‘ã€‚<br>å…·ä½“æ–¹æ³•æ˜¯ï¼š</p><ul><li>ä»æ ¹ç»“ç‚¹ï¼ˆ<code>root node</code>ï¼‰å¼€å§‹ï¼Œå¯¹ç»“ç‚¹è®¡ç®—æ‰€æœ‰å¯èƒ½çš„ç‰¹å¾çš„ä¿¡æ¯å¢ç›Šï¼Œé€‰æ‹©ä¿¡æ¯å¢ç›Šæœ€å¤§çš„ç‰¹å¾ä½œä¸ºç»“ç‚¹çš„ç‰¹å¾ï¼Œç”±è¯¥ç‰¹å¾çš„ä¸åŒå–å€¼å»ºç«‹å­ç»“ç‚¹ã€‚</li><li>å†å¯¹å­ç»“ç‚¹é€’å½’åœ°è°ƒç”¨ä»¥ä¸Šæ–¹æ³•ï¼Œæ„å»ºå†³ç­–æ ‘ã€‚</li><li>ç›´åˆ°æ‰€æœ‰ç‰¹å¾çš„ä¿¡æ¯å¢ç›Šéƒ½å¾ˆå°æˆ–æ²¡æœ‰ç‰¹å¾å¯ä»¥é€‰æ‹©ä¸ºæ­¢ã€‚</li><li>æœ€ç»ˆå°±ä¼šå¾—åˆ°ä¸€ä¸ªå†³ç­–æ ‘ï¼Œå…¶æœ¬è´¨æ˜¯ä½¿ç”¨ <em>æå¤§ä¼¼ç„¶æ³•</em> è¿›è¡Œæ¦‚ç‡æ¨¡å‹çš„é€‰æ‹©ã€‚</li></ul><p>ç¤ºä¾‹ï¼š</p><blockquote><p>è¾“å…¥ï¼šè®­ç»ƒæ•°æ®é›† <code>D</code>ï¼Œç‰¹å¾é›† <code>A</code>ï¼Œé˜ˆå€¼ $\omega$ <br><br>è¾“å‡ºï¼šå†³ç­–æ ‘<br>è¿‡ç¨‹ï¼š</p><ol><li>è‹¥ <code>D</code> ä¸­æ‰€æœ‰å®ä¾‹å±äºåŒä¸€ç±» $C_k$ï¼Œåˆ™ <code>T</code> ä¸ºå•ç»“ç‚¹æ ‘ï¼Œå¹¶å°†ç±» $C_k$ ä½œä¸ºè¯¥ç»“ç‚¹çš„ç±»æ ‡è®°ï¼Œè¿”å› <code>T</code>ã€‚</li><li>è‹¥ <code>A =</code> $\phi$ï¼Œåˆ™ <code>T</code> ä¸ºå•ç»“ç‚¹æ ‘ï¼Œå¹¶å°† <code>D</code> ä¸­å®ä¾‹æ•°æœ€å¤§çš„ç±» $C_k$ ä½œä¸ºè¯¥ç»“ç‚¹çš„ç±»æ ‡è®°ï¼Œè¿”å› <code>T</code>ã€‚</li><li>å¦åˆ™è®¡ç®— <code>A</code> ä¸­å„ä¸ªç‰¹å¾å¯¹ <code>D</code> çš„ä¿¡æ¯å¢ç›Šï¼Œé€‰æ‹©ä¿¡æ¯å¢ç›Šæœ€å¤§çš„ç‰¹å¾ $A_g$ã€‚</li><li>å¦‚æœ $A_g$ å°äºé˜ˆå€¼ $\omega$ï¼Œåˆ™ç½® <code>T</code> ä¸ºå•ç»“ç‚¹æ ‘ï¼Œå¹¶å°† <code>D</code> ä¸­å®ä¾‹æ•°æœ€å¤§çš„ç±» $C_k$ ä½œä¸ºè¯¥ç±»çš„æ ‡è®°ï¼Œè¿”å› <code>T</code>ã€‚</li><li>å¦åˆ™å¯¹ $A_g$ çš„æ¯ä¸€ä¸ªå¯èƒ½å€¼ $a_i$ï¼Œä¾æ® $A_g$ &#x3D; $a_i$ å°† <code>D</code> åˆ’åˆ†ä¸ºè‹¥å¹²ä¸ªéç©ºå­é›† $D_i$ï¼Œå°† $D_i$ ä¸­å®ä¾‹æ•°æœ€å¤§çš„ç±»ä½œä¸ºæ ‡è®°ï¼Œæ„å»ºå­ç»“ç‚¹ï¼Œç”±ç»“ç‚¹åŠå…¶å­ç»“ç‚¹æ„æˆæ ‘ <code>T</code>ï¼Œè¿”å› <code>T</code>ã€‚</li><li>å¯¹ç¬¬ <code>i</code> ä¸ªå­ç»“ç‚¹ï¼Œä»¥ $D_i$ ä¸ºè®­ç»ƒé›†ï¼Œä»¥ <code>A - </code>$A_g$ ä¸ºç‰¹å¾é›†ï¼Œé€’å½’åœ°è°ƒç”¨ <code>1, 2, 3, 4, 5</code> å¾—åˆ°å­æ ‘ $T_i$ï¼Œè¿”å› $T_i$ã€‚</li></ol></blockquote><h4 id="C4-5"><a href="#C4-5" class="headerlink" title="C4.5"></a><code>C4.5</code></h4><p><code>C4.5</code> ç®—æ³•ä¸ <code>ID3</code> ç®—æ³•ç±»ä¼¼ï¼Œ<code>C4.5</code> åœ¨ç”Ÿæˆè¿‡ç¨‹ä¸­ä½¿ç”¨äº†<strong>ä¿¡æ¯å¢ç›Šæ¯”</strong>æ¥é€‰æ‹©ç‰¹å¾ã€‚</p><h4 id="CART"><a href="#CART" class="headerlink" title="CART"></a><code>CART</code></h4><p><strong>åˆ†ç±»ä¸å›å½’æ ‘ï¼ˆ<code>classification and regression tree, CART</code>ï¼‰æ¨¡å‹</strong>æ˜¯åº”ç”¨éå¸¸å¹¿æ³›çš„å†³ç­–æ ‘å­¦ä¹ æ–¹æ³•ï¼Œæ—¢å¯ä»¥ç”¨äºåˆ†ç±»ï¼Œä¹Ÿå¯ä»¥ç”¨äºå›å½’ï¼Œå°†ç”¨äºåˆ†ç±»å’Œå›å½’çš„æ ‘ç»Ÿç§°ä¸ºå†³ç­–æ ‘ã€‚</p><p><code>CART</code> æ˜¯åœ¨ç»™å®šè¾“å…¥éšæœºå˜é‡ <code>X</code> æ¡ä»¶ä¸‹è¾“å‡ºéšæœºå˜é‡ <code>Y</code> çš„æ¡ä»¶æ¦‚ç‡åˆ†å¸ƒçš„å­¦ä¹ æ–¹æ³•ã€‚è§£é‡Šå…¶å«ä¹‰å°±æ˜¯ï¼Œ<code>CART</code> å‡è®¾å†³ç­–æ ‘æ˜¯äºŒå‰æ ‘ï¼Œå†…éƒ¨ç»“ç‚¹ç‰¹å¾å–å€¼ä¸º<strong>â€œæ˜¯â€</strong>æˆ– <strong>â€œå¦â€</strong>ï¼Œå³å·¦åˆ†æ”¯æ˜¯å–å€¼ä¸ºâ€œæ˜¯â€çš„åˆ†æ”¯ï¼Œå³åˆ†æ”¯æ˜¯å–å€¼ä¸ºâ€œå¦â€çš„åˆ†æ”¯ï¼Œè¿™æ ·å†³ç­–æ ‘å°±ç­‰ä»·äºé€’å½’åœ°å¯¹æ¯ä¸ªç‰¹å¾è¿›è¡ŒäºŒåˆ†ï¼Œå³å°†è¾“å…¥ç©ºé—´å³ç‰¹å¾ç©ºé—´åˆ’åˆ†ä¸ºæœ‰é™ä¸ªå•å…ƒï¼Œå¹¶åœ¨è¿™äº›å•å…ƒä¸Šç¡®å®šé¢„æµ‹çš„æ¦‚ç‡åˆ†å¸ƒï¼Œä¹Ÿå°±æ˜¯åœ¨è¾“å…¥ç»™å®šçš„æ¡ä»¶ä¸‹è¾“å‡ºçš„æ¡ä»¶æ¦‚ç‡åˆ†å¸ƒã€‚</p><p><code>CART</code> ç®—æ³•ç”±ä»¥ä¸‹ä¸¤æ­¥ç»„æˆï¼š</p><ul><li>å†³ç­–æ ‘ç”Ÿæˆï¼šåŸºäºè®­ç»ƒæ•°æ®é›†ç”Ÿæˆå†³ç­–æ ‘ï¼Œç”Ÿæˆçš„å†³ç­–æ ‘è¦å°½å¯èƒ½çš„å¤§ã€‚</li><li>å†³ç­–æ ‘å‰ªæï¼šç”¨éªŒè¯æ•°æ®é›†å¯¹å·²ç”Ÿæˆçš„æ ‘è¿›è¡Œå‰ªæå¹¶é€‰æ‹©æœ€ä¼˜å­æ ‘ï¼Œæ­¤æ—¶<strong>ä½¿ç”¨æŸå¤±å‡½æ•°æœ€å°åŒ–ä½œä¸ºå‰ªæçš„æ ‡å‡†</strong>ã€‚</li></ul><hr><h3 id="ç‰¹å¾é€‰æ‹©"><a href="#ç‰¹å¾é€‰æ‹©" class="headerlink" title="ç‰¹å¾é€‰æ‹©"></a>ç‰¹å¾é€‰æ‹©</h3><p>ç‰¹å¾é€‰æ‹©åœ¨äºé€‰å–å¯¹è®­ç»ƒæ•°æ®å…·æœ‰åˆ†ç±»èƒ½åŠ›çš„ç‰¹å¾ï¼Œè¿™æ ·å¯ä»¥å¤§å¤§æé«˜å†³ç­–æ ‘å­¦ä¹ çš„æ•ˆç‡ã€‚å¦‚æœä¸€ä¸ªç‰¹å¾è¿›è¡Œåˆ†ç±»çš„ç»“æœå’Œéšæœºåˆ†ç±»çš„ç»“æœæ²¡æœ‰å¤ªå¤§çš„å·®åˆ«ï¼Œåˆ™è¿™ä¸ªç‰¹å¾æ²¡æœ‰åˆ†ç±»èƒ½åŠ›ï¼Œå®é™…ä¸­è¿™æ ·çš„ç‰¹å¾å¯¹å†³ç­–æ ‘å­¦ä¹ çš„å‡†ç¡®åº¦å½±å“ä¸å¤§ã€‚<br>ç‰¹å¾é€‰æ‹©çš„å‡†åˆ™æ˜¯ï¼š</p><ul><li><strong>ä¿¡æ¯å¢ç›Š</strong></li><li><strong>ä¿¡æ¯å¢ç›Šæ¯”</strong></li><li><strong>åŸºå°¼ç³»æ•°</strong></li></ul><h4 id="ä¿¡æ¯å¢ç›Š"><a href="#ä¿¡æ¯å¢ç›Š" class="headerlink" title="ä¿¡æ¯å¢ç›Š"></a>ä¿¡æ¯å¢ç›Š</h4><p>åœ¨ä¿¡æ¯è®ºä¸æ¦‚ç‡ç»Ÿè®¡ä¸­ï¼Œ<strong>ç†µï¼ˆ<code>entropy</code>ï¼‰</strong>ç”¨æ¥åº¦é‡éšæœºå˜é‡çš„ä¸ç¡®å®šæ€§ã€‚</p><p><strong>æ¡ä»¶ç†µ <code>H(Y|X)</code></strong> è¡¨ç¤ºåœ¨å·²çŸ¥éšæœºå˜é‡ <code>X</code> çš„æ¡ä»¶ä¸‹éšæœºå˜é‡ <code>Y</code> çš„ä¸ç¡®å®šæ€§ï¼Œå³å®šä¹‰ä¸º <code>X</code> ç»™å®šæ¡ä»¶ä¸‹ <code>Y</code> çš„æ¡ä»¶æ¦‚ç‡åˆ†å¸ƒçš„ç†µå¯¹ <code>X</code> çš„æ•°å­¦æœŸæœ›ã€‚</p><p>$$ H(Y|X) &#x3D; \sum_{i&#x3D;1}^n p_i H (Y | X &#x3D; x_i) $$</p><p><small>å…¶ä¸­ $p_i$ <code>= P(X = </code> $x_i$ <code>), i = 1, 2, ..., n</code></small></p><p>å½“ç†µå’Œæ¡ä»¶ç†µä¸­çš„æ¦‚ç‡ç”±æ•°æ®ä¼°è®¡ï¼ˆç‰¹åˆ«æ˜¯æå¤§ä¼¼ç„¶ä¼°è®¡ï¼‰å¾—åˆ°æ—¶ï¼Œæ‰€å¯¹åº”çš„ç†µå’Œæ¡ä»¶ç†µåˆ†åˆ«è¢«ç§°ä¸º<strong>ç»éªŒç†µï¼ˆ<code>empirical entropy</code>ï¼‰</strong>å’Œ<strong>ç»éªŒæ¡ä»¶ç†µï¼ˆ<code>empirical conditional entropy</code>ï¼‰</strong>ã€‚</p><p><strong>ä¿¡æ¯å¢ç›Šï¼ˆ<code>information gain</code>ï¼‰</strong>è¡¨ç¤ºå¾—çŸ¥ç‰¹å¾ <code>X</code> çš„ä¿¡æ¯è€Œä½¿å¾—ç±» <code>Y</code> çš„ä¿¡æ¯çš„ä¸ç¡®å®šæ€§å‡å°‘çš„ç¨‹åº¦ã€‚<br>ç‰¹å¾ <code>A</code> å¯¹è®­ç»ƒæ•°æ®é›† <code>D</code> çš„ä¿¡æ¯å¢ç›Š $g(D, A)$ï¼Œå®šä¹‰ä¸ºé›†åˆ <code>D</code> çš„ç»éªŒç†µ $H(D)$ ä¸ç‰¹å¾ <code>A</code> ç»™å®šæ¡ä»¶ä¸‹ <code>D</code> çš„ç»éªŒæ¡ä»¶ç†µ $H(D|A)$ ä¹‹å·®ï¼Œå³</p><p>$$ g(D, A) &#x3D; H(D) - H(D|A) $$</p><p>ç»™å®šè®­ç»ƒæ•°æ®é›† <code>D</code> ä¸ç‰¹å¾ <code>A</code>ï¼Œ<strong>ç»éªŒç†µ $H(D)$</strong> è¡¨ç¤ºæ•°æ®é›† <code>D</code> è¿›è¡Œåˆ†ç±»çš„ä¸ç¡®å®šæ€§ï¼›è€Œ<strong>ç»éªŒæ¡ä»¶ç†µ $H(D|A)$</strong> è¡¨ç¤ºåœ¨ç‰¹å¾ <code>A</code> ç»™å®šæ¡ä»¶ä¸‹å¯¹æ•°æ®é›† <code>D</code> è¿›è¡Œåˆ†ç±»çš„ä¸ç¡®å®šæ€§ï¼Œé‚£ä¹ˆä»–ä»¬çš„å·®å³ä¿¡æ¯å¢ç›Šï¼Œè¡¨ç¤ºç”±äºç‰¹å¾ <code>A</code> è€Œä½¿å¾—å¯¹æ•°æ®é›† <code>D</code> çš„åˆ†ç±»çš„ä¸ç¡®å®šæ€§å‡å°‘çš„ç¨‹åº¦ã€‚ç”±æ­¤å¯ä»¥å¾—åˆ°ä¿¡æ¯å¢ç›Šä¾èµ–äºç‰¹å¾ï¼Œä¸åŒçš„ç‰¹å¾å…·æœ‰ä¸åŒçš„ä¿¡æ¯å¢ç›Šï¼Œè€Œä¿¡æ¯å¢ç›Šå¤§çš„ç‰¹å¾å…·æœ‰æ›´å¼ºçš„åˆ†ç±»èƒ½åŠ›ã€‚</p><p><small>ä¸€èˆ¬åœ°ï¼Œç†µ <code>H(Y)</code> ä¸æ¡ä»¶ç†µ <code>H(Y|X)</code> ä¹‹å·®ç§°ä¸ºäº’ä¿¡æ¯ï¼ˆ<code>mutual information</code>ï¼‰ï¼Œå†³ç­–æ ‘å­¦ä¹ ä¸­çš„ä¿¡æ¯å¢ç›Šç­‰ä»·äºè®­ç»ƒæ•°æ®é›†ä¸­ç±»ä¸ç‰¹å¾çš„äº’ä¿¡æ¯ï¼Œå› æ­¤å†³ç­–æ ‘å­¦ä¹ åº”ç”¨ä¿¡æ¯å¢ç›Šå‡†åˆ™é€‰æ‹©ç‰¹å¾ã€‚</small></p><p>åœ¨å®é™…ä¸­æ ¹æ®ä¿¡æ¯å¢ç›Šå‡†åˆ™é€‰æ‹©ç‰¹å¾çš„æ–¹å¼æ˜¯ï¼šå¯¹è®­ç»ƒæ•°æ®é›† <code>D</code>ï¼Œè®¡ç®—å…¶æ¯ä¸ªç‰¹å¾çš„ä¿¡æ¯å¢ç›Šï¼Œå¹¶æ¯”è¾ƒå…¶å¤§å°ï¼Œæ‹©ä¼˜é€‰æ‹©ä¿¡æ¯å¢é‡æœ€å¤§çš„ç‰¹å¾ã€‚</p><p>ä¿¡æ¯å¢ç›Šç®—æ³•ç¤ºä¾‹ï¼š </p><blockquote><p>è¾“å…¥ï¼šè®­ç»ƒæ•°æ®é›† <code>D</code> å’Œç‰¹å¾ <code>A</code><br>è¾“å‡ºï¼šç‰¹å¾ <code>A</code> å¯¹è®­ç»ƒæ•°æ®é›† <code>D</code> çš„ä¿¡æ¯å¢ç›Š <code>g(D, A)</code><br>è¿‡ç¨‹ï¼š</p><ol><li>è®¡ç®—æ•°æ®é›† <code>D</code> çš„ä¿¡æ¯å¢ç›Š<br>$$ H(D) &#x3D; - \sum_{k&#x3D;1}^K {\frac {\vert {C_k}\vert} {\vert {D} \vert} } log_2 {\frac {\vert {C_k}\vert} {\vert {D} \vert} } $$</li><li>è®¡ç®—ç‰¹å¾ <code>A</code> å¯¹æ•°æ®é›† <code>D</code> çš„ç»éªŒæ¡ä»¶ç†µ<br>$$ H(D|A) &#x3D; \sum_{i&#x3D;1}^n {\frac {\vert {D_i} \vert} {\vert {D} \vert} H(D_i) } $$</li><li>è®¡ç®—ä¿¡æ¯å¢ç›Š<br>$$ g(D, A) &#x3D; H(D) - H(D|A) $$</li></ol></blockquote><h4 id="ä¿¡æ¯å¢ç›Šæ¯”"><a href="#ä¿¡æ¯å¢ç›Šæ¯”" class="headerlink" title="ä¿¡æ¯å¢ç›Šæ¯”"></a>ä¿¡æ¯å¢ç›Šæ¯”</h4><p>ä¿¡æ¯å¢ç›Šçš„å¤§å°æ˜¯ç›¸å¯¹äºè®­ç»ƒæ•°æ®è€Œè¨€çš„ï¼Œå¹¶æ²¡æœ‰ç»å¯¹æ„ä¹‰ï¼Œè€Œåœ¨è®­ç»ƒæ•°æ®é›†çš„ç»éªŒç†µå¤§çš„æ—¶å€™ï¼Œä¿¡æ¯å¢ç›Šä¹Ÿä¼šåå¤§ã€‚åä¹‹ä¿¡æ¯å¢ç›Šå€¼ä¼šåå°ã€‚å› æ­¤ä½¿ç”¨ä¿¡æ¯å¢ç›Šæ¯”å¯ä»¥è§£å†³è¿™ä¸€é—®é¢˜ï¼Œä¹Ÿæ˜¯ç‰¹å¾é€‰æ‹©çš„å¦ä¸€ä¸ªå‡†åˆ™ã€‚<br>ç‰¹å¾ <code>A</code> å¯¹è®­ç»ƒæ•°æ®é›† <code>D</code> çš„ä¿¡æ¯å¢ç›Šæ¯” $g_r(D, A)$ï¼Œå®šä¹‰ä¸ºå…¶ä¿¡æ¯å¢ç›Š $g(D, A)$ ä¸è®­ç»ƒæ•°æ®é›† <code>D</code> çš„ç»éªŒç†µ $H(D)$ ä¹‹æ¯”ï¼š</p><p>$$ g_r(D, A) &#x3D; {\frac {g(D, A)} {H(D)} } $$</p><h4 id="åŸºå°¼ç³»æ•°"><a href="#åŸºå°¼ç³»æ•°" class="headerlink" title="åŸºå°¼ç³»æ•°"></a>åŸºå°¼ç³»æ•°</h4><p>å†³ç­–æ ‘çš„ç”Ÿæˆæ˜¯é€’å½’åœ°æ„å»ºäºŒå‰å†³ç­–æ ‘çš„è¿‡ç¨‹ï¼Œå¯¹<strong>å›å½’æ ‘ä½¿ç”¨å¹³æ–¹è¯¯å·®æœ€å°åŒ–å‡†åˆ™</strong>ï¼Œå¯¹<strong>åˆ†ç±»æ ‘ä½¿ç”¨åŸºå°¼ç³»æ•°ï¼ˆ<code>Gini index</code>ï¼‰æœ€å°åŒ–å‡†åˆ™</strong>ï¼Œè¿›è¡Œç‰¹å¾é€‰æ‹©ç”ŸæˆäºŒå‰æ ‘ã€‚</p><h5 id="ç”Ÿæˆå›å½’æ ‘"><a href="#ç”Ÿæˆå›å½’æ ‘" class="headerlink" title="ç”Ÿæˆå›å½’æ ‘"></a>ç”Ÿæˆå›å½’æ ‘</h5><p>å‡è®¾ <code>X, Y</code> åˆ†åˆ«è¡¨ç¤ºè¾“å…¥å’Œè¾“å‡ºå˜é‡ï¼Œä¸” <code>Y</code> æ˜¯è¿ç»­å˜é‡ï¼Œç»™å®šçš„æ•°æ®é›†è¡¨ç¤ºä¸ºï¼š$D &#x3D; { (x_1, y_1), (x_2, y_2), â€¦, (x_N, y_N)}$ï¼Œé‚£ä¹ˆå›å½’æ ‘å¦‚ä½•ç”Ÿæˆï¼Ÿ</p><p>ä¸€ä¸ªå›å½’æ ‘å¯¹åº”ç€è¾“å…¥ç©ºé—´ï¼ˆç‰¹å¾ç©ºé—´ï¼‰çš„ä¸€ä¸ªåˆ’åˆ†ä»¥åŠåœ¨åˆ’åˆ†å•å…ƒä¸Šçš„è¾“å‡ºå€¼ã€‚å‡è®¾å·²å°†è¾“å…¥ç©ºé—´åˆ’åˆ†ä¸º <code>M</code> ä¸ªå•å…ƒ $R_1, R_2, â€¦, R_M$ å¹¶ä¸”åœ¨æ¯ä¸ªå•å…ƒ $R_m$ ä¸Šæœ‰ä¸€ä¸ªå›ºå®šçš„è¾“å‡ºå€¼ $C_m$ï¼Œäºæ˜¯å›å½’æ ‘çš„æ¨¡å‹å¯ä»¥è¡¨ç¤ºä¸º</p><p>$$ f(x) &#x3D; \sum_{m&#x3D;1}^M C_m I(x \in R_m) $$</p><p>å½“è¾“å…¥ç©ºé—´çš„åˆ’åˆ†ç¡®å®šæ—¶å°±å¯ä»¥ä½¿ç”¨å¹³æ–¹è¯¯å·® $\sum_{x_i \in R_m} (y_i - f(x_i))^2$ è¡¨ç¤ºå›å½’æ ‘å¯¹è®­ç»ƒæ•°æ®é›†çš„é¢„æµ‹è¯¯å·®ï¼Œå³å¹³æ–¹è¯¯å·®æœ€å°æ—¶è¡¨ç¤ºè¯¥å•å…ƒä¸Šçš„æœ€ä¼˜è¾“å‡ºå€¼ã€‚</p><p>é‚£è¾“å…¥ç©ºé—´ï¼ˆç‰¹å¾ç©ºé—´ï¼‰çš„åˆ‡åˆ†ç‚¹å¦‚ä½•åˆ’åˆ†å‘¢ï¼Ÿè¿™é‡Œé‡‡ç”¨å¯å‘å¼çš„æ–¹æ³•ï¼Œé€‰æ‹©ç¬¬ <code>j</code> ä¸ªå˜é‡ $X_j$ å’Œå¯¹åº”çš„å–å€¼ $C_j$ ä½œä¸º<strong>åˆ‡åˆ†å˜é‡ï¼ˆ<code>splitting variable</code>ï¼‰</strong>å’Œ<strong>åˆ‡åˆ†ç‚¹ï¼ˆ<code>splitting point</code>ï¼‰</strong> ï¼Œå®šä¹‰ä¸¤ä¸ªåŒºåŸŸ<br>$$R_1(j, C_j) &#x3D; {X | X_j &lt;&#x3D; C_m}, R_2(j, C_j) &#x3D; {x | X_j &gt; C_m}$$<br>ç„¶åå¯»æ‰¾<strong>æœ€ä¼˜å˜é‡ <code>j</code></strong> å’Œ<strong>æœ€ä¼˜åˆ‡åˆ†ç‚¹ $C_m$</strong> ã€‚å³æ±‚è§£</p><p>$$ \min_{j,C_m}[\min_{C_1}\sum_{x_i \in R_1(j, C_m)}(y_i - C_1)^2 + \min_{C_2}\sum_{x_i \in R_1(j, C_m)}(y_i - C_2)^2] $$</p><p>è€Œå¯¹äºå›ºå®šè¾“å…¥å˜é‡ <code>j</code> å°±å¯ä»¥æ‰¾åˆ°æœ€ä¼˜åˆ‡åˆ†ç‚¹ $C_m$</p><p>$$ \bar{c_1} &#x3D; ave(y_i | x_i \in R_1(j, C_m)) , \bar{c_2} &#x3D; ave(y_i | x_i \in R_2(j, C_m)) $$</p><p>æ¥ç€éå†è¾“å…¥æ‰€æœ‰å˜é‡ï¼Œæ‰¾åˆ°æœ€ä¼˜çš„åˆ‡åˆ†å˜é‡ <code>j</code>ï¼Œæ„æˆä¸€ä¸ª $(j, C_m)$ã€‚ä¾æ¬¡å°†è¾“å…¥ç©ºé—´åˆ’åˆ†ä¸ºä¸¤ä¸ªåŒºåŸŸï¼Œæ¥ç€å¯¹ä¸Šè¿°åŒºåŸŸè¿›è¡Œé‡å¤åˆ’åˆ†ï¼Œç›´è‡³æ»¡è¶³æ¡ä»¶ä¸ºæ­¢ã€‚å³å¯ä»¥ç”Ÿæˆè¢«ç§°ä¸º<strong>æœ€å°äºŒä¹˜å›å½’æ ‘ï¼ˆ<code>least squares regression tree</code>ï¼‰</strong>ã€‚</p><p>æœ€å°äºŒä¹˜å›å½’æ ‘ç”Ÿæˆç®—æ³•ç¤ºä¾‹ï¼š</p><blockquote><p>è¾“å…¥ï¼šè®­ç»ƒæ•°æ®é›† <code>D</code><br>è¾“å‡ºï¼šå›å½’æ ‘ $f(x)$ <br><br>è¿‡ç¨‹ï¼š</p><ol><li>åœ¨è®­ç»ƒæ•°æ®é›†æ‰€åœ¨çš„è¾“å…¥ç©ºé—´ä¸­ï¼Œé€’å½’åœ°å°†æ¯ä¸ªåŒºåŸŸåˆ’åˆ†ä¸ºä¸¤ä¸ªå­åŒºåŸŸå¹¶å†³å®šæ¯ä¸ªå­åŒºåŸŸçš„è¾“å‡ºå€¼ã€‚</li><li>è®¡ç®—åˆ’åˆ†æ•°æ®é›†çš„æœ€ä¼˜åˆ‡åˆ†å˜é‡ <code>j</code> å’Œæœ€ä¼˜åˆ‡åˆ†ç‚¹ $C_m$ï¼Œæ±‚è§£<br> $$ \min_{j,C_m}[\min_{C_1}\sum_{x_i \in R_1(j, C_m)}(y_i - C_1)^2 + \min_{C_2}\sum_{x_i \in R_1(j, C_m)}(y_i - C_2)^2] $$<br>éå†å˜é‡ <code>j</code>ï¼Œå¯¹å›ºå®šçš„åˆ‡åˆ†å˜é‡ <code>j</code> å’Œåˆ‡åˆ†ç‚¹ $C_m$ èƒ½å¾—åˆ°æœ€å°å€¼çš„å¯¹ $(j, C_m)$ã€‚</li><li>ç”¨é€‰å®šçš„æœ€å°å€¼çš„å¯¹ $(j, C_m)$ åˆ’åˆ†åŒºåŸŸå¹¶è®¡ç®—å¯¹åº”çš„è¾“å‡ºå€¼<br> $$ R_1(j, C_m) &#x3D; {x|x_j &lt;&#x3D; C_m}, R_2(j, C_m) &#x3D; {x|x_j &gt; C_m} $$<br> $$ \bar{C_m} &#x3D; {\frac {1} {N_m}} \sum_{x_i \in R_m(j, C_m)} y_i, x \in R_m, m &#x3D; 1, 2 $$</li><li>ç»§ç»­å¯¹ä¸¤ä¸ªå­åŒºåŸŸè°ƒç”¨æ­¥éª¤ <code>2, 3</code>ï¼Œç›´è‡³æ»¡è¶³æ¡ä»¶ã€‚</li><li>è‡³æ­¤å°±å¯ä»¥å¾—åˆ°å°†è¾“å…¥ç©ºé—´åˆ’åˆ†ä¸º <code>M</code> ä¸ªåŒºåŸŸ $R_1, R_2, â€¦, R_M$ å³å¯ç”Ÿæˆå›å½’å†³ç­–æ ‘ã€‚<br> $$ f(x) &#x3D; \sum_{m&#x3D;1}^M \bar{C_m} I(x \in R_m) $$</li></ol></blockquote><h5 id="ç”Ÿæˆåˆ†ç±»æ ‘"><a href="#ç”Ÿæˆåˆ†ç±»æ ‘" class="headerlink" title="ç”Ÿæˆåˆ†ç±»æ ‘"></a>ç”Ÿæˆåˆ†ç±»æ ‘</h5><p>åˆ†ç±»æ ‘ç”¨<strong>åŸºå°¼æŒ‡æ•°</strong>é€‰æ‹©æœ€ä¼˜ç‰¹å¾ï¼ŒåŒæ—¶å†³å®šè¯¥ç‰¹å¾çš„æœ€ä¼˜äºŒå€¼åˆ‡åˆ†ç‚¹ã€‚<br>åœ¨åˆ†ç±»é—®é¢˜ä¸­ï¼Œå‡è®¾æœ‰ <code>K</code> ä¸ªç±»ï¼Œæ ·æœ¬ç‚¹å±äºç¬¬ <code>k</code> ç±»çš„æ¦‚ç‡ä¸º <code>Pk</code>ï¼Œåˆ™æ¦‚ç‡åˆ†å¸ƒçš„åŸºå°¼æŒ‡æ•°å®šä¹‰ä¸ºï¼š</p><p>$$ Gini(p) &#x3D; \sum_{k&#x3D;1}^K P_k (1-P_k) &#x3D; 1-\sum_{k&#x3D;1}^K p_k^2 $$</p><p>å¯¹äºäºŒåˆ†ç±»é—®é¢˜ï¼Œè‹¥æ ·æœ¬ç‚¹å±äºç¬¬ä¸€ä¸ªç±»çš„æ¦‚ç‡ä¸º <code>p</code>ï¼Œåˆ™æ¦‚ç‡åˆ†å¸ƒçš„åŸºå°¼æŒ‡æ•°ä¸ºï¼š</p><p>$$ Gini(p) &#x3D; 2p(1-p) $$</p><p>å¯¹äºç»™å®šçš„æ ·æœ¬é›†åˆ <code>D</code>ï¼Œå…¶åŸºå°¼æŒ‡æ•°ä¸ºï¼š</p><p>$$ Gini(D) &#x3D; 1 - (\sum_{k&#x3D;1}^K)({\frac {\vert{C_k}\vert} {\vert{D}\vert} })^2 $$</p><p><small>å…¶ä¸­ $C_k$ æ˜¯ <code>D</code> ä¸­å±äºç¬¬ <code>k</code> ç±»çš„æ ·æœ¬å­é›†ï¼Œ<code>K</code> æ˜¯ç±»çš„ä¸ªæ•°ã€‚</small> </p><p>å¦‚æœæ ·æœ¬é›†åˆ <code>D</code> æ ¹æ®ç‰¹å¾ <code>A</code> æ˜¯å¦å–æŸä¸€ä¸ªå¯èƒ½å€¼ <code>a</code> è¢«åˆ†å‰²ä¸º <code>D1</code> å’Œ <code>D2</code>ï¼Œå³ $D1 &#x3D; {(x, y) \in D | A(x) \in a}, D2 &#x3D; D - D1$<br>åˆ™åœ¨ç‰¹å¾ <code>A</code> çš„æ¡ä»¶ä¸‹ï¼Œé›†åˆ <code>D</code> çš„åŸºå°¼æŒ‡æ•°å®šä¹‰ä¸ºï¼š</p><p>$$ Gini(D, A) &#x3D; {\frac {\vert {D1} \vert} {\vert {D} \vert} } Gini(D1) + {\frac {\vert {D2} \vert} {\vert {D} \vert} } Gini(D2) $$</p><p><small>åŸºå°¼æŒ‡æ•° <code>Gini(D, A)</code> è¡¨ç¤º <code>A = a</code> åˆ†å‰²åé›†åˆ <code>D</code> çš„ä¸ç¡®å®šæ€§ã€‚</small></p><p><small>åŸºå°¼æŒ‡æ•°è¶Šå¤§ï¼Œæ ·æœ¬é›†åˆçš„ä¸ç¨³å®šæ€§åˆ™è¶Šå¤§ã€‚</small></p><p><code>CART</code> å†³ç­–æ ‘åŸºå°¼ç³»æ•°ç”Ÿæˆç®—æ³•ç¤ºä¾‹ï¼š</p><blockquote><p>è¾“å…¥ï¼šè®­ç»ƒæ•°æ®é›† <code>D</code>ï¼Œåœæ­¢è®¡ç®—çš„æ¡ä»¶<br>è¾“å‡ºï¼š<code>CART</code> å†³ç­–æ ‘<br>è¿‡ç¨‹ï¼š</p><ol><li>æ ¹æ®è®­ç»ƒæ•°æ®é›†ï¼Œæ ¹ç»“ç‚¹çš„æ•°æ®é›†ä¸º <code>D</code>ï¼Œè®¡ç®—ç°æœ‰ç‰¹å¾å¯¹è¯¥æ•°æ®é›†çš„åŸºå°¼æŒ‡æ•°ï¼Œå¯¹äºç‰¹å¾ <code>A</code> æœ‰ä¸€ä¸ªå¯èƒ½çš„å–å€¼ <code>a</code>ï¼Œæ ¹æ®æ ·æœ¬å¯¹ <code>A = a</code> çš„æµ‹è¯•ä¸ºâ€œæ˜¯â€æˆ–â€œå¦â€ï¼Œä»è€Œå°†æ•°æ®é›† <code>D</code> æ‹†åˆ†ä¸º $D_1$ å’Œ $D_2$ ä¸¤éƒ¨åˆ†ï¼Œè®¡ç®—å¯¹åº”çš„åŸºå°¼æŒ‡æ•°ï¼Œ</li><li>åœ¨è®¡ç®—ç‰¹å¾ <code>A</code> æ‰€æœ‰å–å€¼ <code>a</code> å¯¹åº”çš„åŸºå°¼æŒ‡æ•°åï¼Œé€‰æ‹©å…¶ä¸­åŸºå°¼æŒ‡æ•°æœ€å°çš„ç‰¹å¾ä½œä¸ºå¯¹åº”çš„æœ€ä¼˜ç‰¹å¾å’Œæœ€ä¼˜åˆ‡åˆ†ç‚¹ï¼Œè‡³æ­¤å°±å¯ä»¥å°†æ•°æ®é›†åˆ‡åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œç”Ÿæˆä¸¤ä¸ªå­ç»“ç‚¹ï¼Œå°†æ•°æ®é›†åˆ†é…åˆ°å¯¹åº”çš„å­ç»“ç‚¹ä¸­ã€‚</li><li>å¯¹ä¸¤ä¸ªå­ç»“ç‚¹é€’å½’åœ°è°ƒç”¨ <code>1, 2</code>ï¼Œç›´è‡³ç»“ç‚¹ä¸­çš„æ•°æ®é›†ä¸ªæ•°å°äºé¢„å®šé˜ˆå€¼ï¼Œæˆ–è€…åŸºå°¼æŒ‡æ•°ä½äºé¢„å®šé˜ˆå€¼ï¼Œåˆæˆ–è€…æ²¡æœ‰è¶³å¤Ÿçš„ç‰¹å¾ã€‚</li><li>è‡³æ­¤åœ¨æ»¡è¶³æ‰€æœ‰æ¡ä»¶åå³å¯ç”Ÿæˆ <code>CART</code> å†³ç­–æ ‘ã€‚</li></ol></blockquote><hr><h3 id="å†³ç­–æ ‘ä¿®å‰ª"><a href="#å†³ç­–æ ‘ä¿®å‰ª" class="headerlink" title="å†³ç­–æ ‘ä¿®å‰ª"></a>å†³ç­–æ ‘ä¿®å‰ª</h3><p>å†³ç­–æ ‘é€šè¿‡ç”Ÿæˆç®—æ³•é€’å½’åœ°äº§ç”Ÿå†³ç­–æ ‘ï¼Œç›´åˆ°ä¸èƒ½ç»§ç»­ä¸‹å»ä¸ºæ­¢ï¼Œè¿™æ ·äº§ç”Ÿçš„æ ‘å¾€å¾€å¯¹è®­ç»ƒæ•°æ®çš„åˆ†ç±»å¾ˆå‡†ç¡®ï¼Œä½†æ˜¯å´å¯¹æœªçŸ¥çš„æ•°æ®åˆ†ç±»æ²¡æœ‰é‚£ä¹ˆå‡†ç¡®ï¼Œå³å‡ºç°è¿‡æ‹Ÿåˆç°è±¡ã€‚è¿‡æ‹Ÿåˆçš„åŸå› åœ¨äºå­¦ä¹ æ—¶è¿‡å¤šçš„è€ƒè™‘å¦‚ä½•æé«˜é’ˆå¯¹è®­ç»ƒæ•°æ®çš„æ­£ç¡®åˆ†ç±»ï¼Œä»è€Œæ„å»ºå‡ºå¤æ‚çš„å†³ç­–æ ‘ï¼Œé‚£ä¹ˆè§£å†³è¿™ä¸ªé—®é¢˜å°±æ˜¯å°†å¤æ‚çš„å†³ç­–æ ‘è¿›è¡Œç®€å•åŒ–ã€‚<br>åœ¨å†³ç­–æ ‘çš„å­¦ä¹ ä¸­å°†å·²ç”Ÿæˆçš„æ ‘è¿›è¡Œç®€åŒ–çš„è¿‡ç¨‹ç§°ä¸º<strong>å‰ªæï¼ˆ<code>pruning</code>ï¼‰</strong>ï¼Œå…·ä½“å°±æ˜¯å‰ªæä»å·²ç”Ÿæˆçš„æ ‘ä¸Šè£æ‰ä¸€äº›å­æ ‘æˆ–å¶ç»“ç‚¹ï¼Œå¹¶å°†å…¶æ ¹ç»“ç‚¹æˆ–çˆ¶ç»“ç‚¹ä½œä¸ºæ–°çš„å¶ç»“ç‚¹ï¼Œä»è€Œç®€åŒ–æ ‘æ¨¡å‹ã€‚</p><p>å†³ç­–æ ‘çš„å‰ªæå¾€å¾€é€šè¿‡æå°åŒ–å†³ç­–æ ‘æ•´ä½“çš„ <em>æŸå¤±å‡½æ•°ï¼ˆ<code>lose function</code>ï¼‰</em> æˆ– <em>ä»£ä»·å‡½æ•°ï¼ˆ<code>cost function</code>ï¼‰</em> æ¥å®ç°ã€‚<br>è®¾æ ‘ <code>T</code> çš„å¶ç»“ç‚¹ä¸ªæ ‘ä¸º ${\vert {T} \vert}$ï¼Œ<code>t</code> æ˜¯æ ‘ <code>T</code> çš„å¶ç»“ç‚¹ï¼Œè¯¥å¶ç»“ç‚¹æœ‰ $N_t$ ä¸ªæ ·æœ¬ç‚¹ï¼Œå…¶ä¸­ <code>k</code> ç±»çš„æ ·æœ¬ç‚¹æœ‰ $N_{tk}$ ä¸ª <code>k = 1, 2, ..., K</code>ï¼Œ$H_t(T)$ ä¸ºå¶ç»“ç‚¹ <code>t</code> ä¸Šçš„ç»éªŒç†µï¼Œ<code>a &gt;= 0</code> ä¸ºå‚æ•°ï¼Œåˆ™å†³ç­–æ ‘å­¦ä¹ çš„æŸå¤±å‡½æ•°å¯ä»¥å®šä¹‰ä¸ºï¼š</p><p>$$ C_a(T) &#x3D; \sum_{t&#x3D;1}^{\vert {T} \vert} N_t H_t (T) + a {\vert {T} \vert} $$</p><p>å…¶ä¸­ç»éªŒç†µä¸ºï¼š</p><p>$$ H_t(T) &#x3D; -\sum_k {\frac {N_{tk} } {N_t} } log {\frac {N_{tk} } {N_t} } $$</p><p>é‚£ä¹ˆï¼š</p><p>$$ C(T) &#x3D;  \sum_{t&#x3D;1}^{\vert {T} \vert} N_t H_t (T) &#x3D; -\sum_{t&#x3D;1}^{\vert {T} \vert} N_t \sum_{k&#x3D;1}^K  {\frac {N_{tk} } {N_t} } log {\frac {N_{tk} } {N_t} } &#x3D;  -\sum_{t&#x3D;1}^{\vert {T} \vert} \sum_{k&#x3D;1}^K {N_{tk} } log {\frac {N_{tk} } {N_t} } $$</p><p>å³å¯å¾—åˆ°ï¼š</p><p>$$ C_a(T) &#x3D; C(T) + a(T) $$</p><p>ä¸Šè¿°ä¸­ $C(T)$ è¡¨ç¤ºæ¨¡å‹å¯¹è®­ç»ƒæ•°æ®çš„é¢„æµ‹è¯¯å·®ï¼Œå³æ¨¡å‹å’Œè®­ç»ƒæ•°æ®çš„æ‹Ÿåˆç¨‹åº¦ï¼Œ${\vert {T} \vert}$ è¡¨ç¤ºæ¨¡å‹å¤æ‚åº¦ï¼Œå‚æ•° <code>a &gt;= 0</code> æ§åˆ¶ä¸¤è€…ä¹‹é—´çš„å½±å“ã€‚é‚£ä¹ˆè¾ƒå¤§çš„ <code>a</code> å°±æ„å‘³ç€é€‰æ‹©è¾ƒç®€å•çš„å†³ç­–æ ‘ï¼Œè¾ƒå°çš„ <code>a</code> é€‰æ‹©è¾ƒç®€å•çš„å†³ç­–æ ‘ï¼Œ<code>a = 0</code> ä¹Ÿå°±æ„å‘³ç€åªè€ƒè™‘å†³ç­–æ ‘ä¸è®­ç»ƒæ•°æ®çš„æ‹Ÿåˆç¨‹åº¦ï¼Œä¸è€ƒè™‘å†³ç­–æ ‘çš„å¤æ‚åº¦ã€‚<br>å†³ç­–æ ‘å‰ªæä¹Ÿå°±æ˜¯å½“ <code>a</code> ç¡®å®šæ—¶ï¼Œé€‰æ‹©æŸå¤±å‡½æ•°æœ€å°çš„å†³ç­–æ ‘ï¼Œå³æŸå¤±å‡½æ•°æœ€å°çš„å­æ ‘ï¼Œåˆšå¥½é€šè¿‡ä½¿å¾—æŸå¤±å‡½æ•°æœ€å°åŒ–æ¥å¹³è¡¡å¤æ‚çš„æ¨¡å‹å’Œè®­ç»ƒæ•°æ®çš„æ‹Ÿåˆç¨‹åº¦ã€‚</p><p>ä¸‹é¢å°±æ˜¯å…·ä½“çš„å‰ªæç®—æ³•ç¤ºä¾‹ï¼š</p><blockquote><p>è¾“å…¥ï¼›ç®—æ³•ç”Ÿæˆçš„å†³ç­–æ ‘ <code>T</code>ï¼Œå‚æ•° <code>a</code><br>è¾“å‡ºï¼šä¿®å‰ªåçš„å­æ ‘ $T_a$ <br><br>è¿‡ç¨‹ï¼š</p><ol><li>è®¡ç®—æ¯ä¸ªç»“ç‚¹çš„ç»éªŒç†µã€‚</li><li>é€’å½’åœ°ä»æ ‘çš„å¶ç»“ç‚¹å‘ä¸Šå›ç¼©ã€‚<br> <img src="/ML-%E5%86%B3%E7%AD%96%E6%A0%91/decision_tree_2.jpg" alt="decision_tree-2"><br> å‡è®¾ä¸€ç»„å¶ç»“ç‚¹å›ç¼©åˆ°å…¶çˆ¶ç»“ç‚¹ä¹‹å‰ä¸ä¹‹åçš„æ•´ä½“æ ‘åˆ†åˆ«ä¸º $T_B$ ä¸ $T_A$ï¼Œå…¶å¯¹åº”çš„æŸå¤±å‡½æ•°ä¸º $C_a(T_B)$ ä¸ $C_a(T_A)$ï¼Œå¦‚æœ $ C_a(T_B) &lt;&#x3D; C_a(T_A) $ åˆ™è¿›è¡Œå‰ªæï¼Œå³å°†çˆ¶ç»“ç‚¹å˜ä¸ºæ–°çš„å¶ç»“ç‚¹ã€‚</li><li>è¿”å› <code>2</code>ï¼Œç›´è‡³ä¸èƒ½ç»§ç»­ä¸ºæ­¢ï¼Œå³å¯å¾—åˆ°æŸå¤±å‡½æ•°æœ€å°çš„å­æ ‘ $T_a$ã€‚</li></ol></blockquote><h4 id="CART-å‰ªæ"><a href="#CART-å‰ªæ" class="headerlink" title="CART å‰ªæ"></a><code>CART</code> å‰ªæ</h4><p><code>CART</code> å‰ªæç®—æ³•ä»å†³ç­–æ ‘åº•ç«¯å‰ªå»ä¸€äº›å­æ ‘ï¼Œä½¿å†³ç­–æ ‘å˜å°ï¼Œæ¨¡å‹å˜ç®€å•ï¼Œä»è€Œèƒ½å¤Ÿå¯¹æœªçŸ¥æ•°æ®æ›´å‡†ç¡®çš„é¢„æµ‹ã€‚<br><code>CART</code> å‰ªæç®—æ³•ç”±ä¸¤æ­¥ç»„æˆï¼š</p><ul><li><p>é¦–å…ˆä»ç®—æ³•ç”Ÿæˆçš„å†³ç­–æ ‘ $T_0$ åº•ç«¯å¼€å§‹ä¸æ–­å‰ªæï¼Œç›´åˆ° $T_0$ çš„æ ¹ç»“ç‚¹ï¼Œå½¢æˆä¸€ä¸ªå­æ ‘åºåˆ—ï¼ˆ$T_0$, $T_1$, â€¦, $T_n$ï¼‰ã€‚<br>  å‰ªæè¿‡ç¨‹ä¸­ï¼Œè®¡ç®—å­æ ‘çš„æŸå¤±å‡½æ•°ï¼š<br>  $$ C_a(T) &#x3D; C(T) + a{\vert {T} \vert} $$<br>  <small><code>T</code> ä¸ºä»»æ„å­æ ‘ï¼Œ$C(T)$ ä¸ºå¯¹è®­ç»ƒæ•°æ®çš„é¢„æµ‹è¯¯å·®ï¼Œ${\vert {T} \vert}$ ä¸ºå­æ ‘çš„å¶ç»“ç‚¹ä¸ªæ ‘ï¼Œ<code>a &gt;= 0</code> ä¸ºå‚æ•°ï¼Œ$C_a(T)$ ä¸ºå‚æ•°æ˜¯ <code>a</code> æ—¶çš„å­æ ‘ <code>T</code> çš„æ•´ä½“æŸå¤±ã€‚</small><br>  å¯¹äºæŸä¸ªçš„ <code>a</code>ï¼Œä¸€å®šå­˜åœ¨ä½¿æŸå¤±å‡½æ•° $C_a(T)$ æœ€å°çš„å­æ ‘ $T_a$ï¼Œå³ $T_a$ åœ¨æŸå¤±å‡½æ•° $C_a(T)$ æœ€å°æ—¶æœ€ä¼˜ã€‚å½“ <code>a</code> å¤§çš„æ—¶å€™ï¼Œæœ€ä¼˜å­æ ‘ $T_a$ åå°ï¼›å½“ <code>a</code> å°çš„æ—¶å€™ï¼Œæœ€ä¼˜å­æ ‘ $T_a$ åå¤§ï¼›è€Œæç«¯æƒ…å†µä¸‹ <code>a = 0</code>ï¼Œæ•´ä½“æ ‘æœ€ä¼˜ï¼›å½“ <code>a -&gt; </code> $\infty$ æ—¶ï¼Œæ ¹ç»“ç‚¹ç»„æˆçš„å•ç»“ç‚¹æ ‘æ˜¯æœ€ä¼˜çš„ã€‚</p><p>  å…·ä½“ä»æ•´æ ‘ $T_0$ å¼€å§‹å‰ªæï¼Œå¯¹ $T_0$ çš„ä»»æ„å†…éƒ¨ç»“ç‚¹ <code>t</code>ï¼Œä»¥ <code>t</code> ä¸ºå•ç»“ç‚¹æ ‘çš„æŸå¤±å‡½æ•°ä¸ºï¼š<br>  $$ C_a(T) &#x3D; C(t) + a $$</p><p>  ä»¥ <code>t</code> ä¸ºæ ¹ç»“ç‚¹çš„å­æ ‘ $T_t$ çš„æŸå¤±å‡½æ•°ä¸ºï¼š<br>  $$ C_a(T_t) &#x3D; C(T_t) + a {\vert {T_t} \vert} $$ </p><ul><li>å½“ <code>a = 0</code> åŠ <code>a</code> å……åˆ†å°çš„æ—¶å€™ï¼Œæœ‰ä¸ç­‰å¼ï¼š$ C_a(T_t) &lt; C_a(t) $</li><li>å½“ <code>a</code> å¢å¤§æ—¶ï¼Œåœ¨æŸä¸€ä¸ª <code>a</code> æœ‰ï¼š$ C_a(T_t) &#x3D; C_a(t) $</li><li>å½“ <code>a</code> ç»§ç»­å¢å¤§æ—¶ï¼Œåªè¦ $a &#x3D; {\frac {C(t) - C(T_t)} { {\vert {T_t}\vert} } - 1}$ å³ $T_t$ ä¸ <code>t</code> å…·æœ‰ç›¸åŒçš„æŸå¤±å‡½æ•°ï¼Œè€Œ <code>t</code> çš„ç»“ç‚¹è¾ƒå°‘ï¼Œå› æ­¤ <code>t</code> æ¯” $T_t$ æ›´å¯å–ï¼Œå¯¹ $T_t$ è¿›è¡Œå‰ªæã€‚</li></ul><p> ä¸ºæ­¤è®¡ç®— $T_0$ ä¸­æ¯ä¸ªå†…éƒ¨ç»“ç‚¹ <code>t</code><br> $$ g(t) &#x3D; {\frac {C(t) - C(T_t)} { {\vert {T_t}\vert} - 1} }$$<br> è¡¨ç¤ºå‰ªæåæ•´ä½“æŸå¤±å‡½æ•°å‡å°çš„ç¨‹åº¦ã€‚</p><p> åœ¨ $T_0$ ä¸­å‰ªå» <code>g(t)</code> æœ€å°çš„å­æ ‘ $T_t$ï¼Œå°†å¾—åˆ°å­æ ‘ä½œä¸º $T_1$ï¼ŒåŒæ—¶å°†æœ€å°çš„ <code>g(t)</code> è®¾ä¸º $a_1$ï¼Œ$T_1$ ä¸ºåŒºé—´ $[a_1, a_2)$ çš„æœ€ä¼˜å­æ ‘ã€‚å¦‚æ­¤å‰ªæä¸‹å»ç›´è‡³æ ¹ç»“ç‚¹ï¼Œè€Œåœ¨è¿™ä¸€è¿‡ç¨‹ä¸­ï¼Œä¸æ–­é€’å¢ <code>a</code>ï¼Œä¸æ–­äº§ç”Ÿæ–°çš„åŒºé—´ã€‚</p></li><li><p>æ¥ç€é€šè¿‡äº¤å‰éªŒè¯æ³•åœ¨ç‹¬ç«‹çš„éªŒè¯æ•°æ®é›†ä¸Šå¯¹å­æ ‘åºåˆ—è¿›è¡Œæµ‹è¯•ï¼Œä»è€Œé€‰å‡ºæœ€ä¼˜å­æ ‘ã€‚<br>  åˆ©ç”¨éªŒè¯æ•°æ®é›†æµ‹è¯•å­æ ‘åºåˆ— $T_0, T_1, â€¦, T_n$ ä¸­å„ä¸ªå­æ ‘çš„å¹³å‡æ–¹å·®æˆ–åŸºå°¼ç³»æ•°ï¼Œå¹³æ–¹è¯¯å·®æˆ–åŸºå°¼ç³»æ•°æœ€å°çš„å­æ ‘ä¹Ÿå°±æ˜¯æœ€ä¼˜çš„å†³ç­–æ ‘ï¼Œè€Œå½“æœ€ä¼˜å­æ ‘è¢«ç¡®å®šæ—¶ï¼Œå­æ ‘å¯¹åº”çš„ <code>a</code> ä¹Ÿä¼šè¢«ç¡®å®šï¼Œå³å¯å¾—åˆ°æœ€ä¼˜å­æ ‘ $T_a$ã€‚</p></li></ul><p>ä¸‹é¢å°±æ˜¯å…·ä½“çš„ <code>CART</code> å‰ªæç®—æ³•ç¤ºä¾‹ï¼š</p><blockquote><p>è¾“å…¥ï¼š<code>CART</code> ç®—æ³•ç”Ÿæˆçš„å†³ç­–æ ‘ $T_0$<br><br>è¾“å‡ºï¼šæœ€ä¼˜å†³ç­–æ ‘ $T_a$<br><br>è¿‡ç¨‹ï¼š</p><ol><li>è®¾ $k &#x3D; 0, T &#x3D; T_0$ã€‚</li><li>è®¾ <code>a </code> $ &#x3D; + \infty$ã€‚</li><li>è‡ªä¸Šè€Œä¸‹åœ°å¯¹å„å†…éƒ¨ç»“ç‚¹ <code>t</code> è®¡ç®— $C(T_t)$ï¼Œ${\vert {T_t} \vert}$ ä»¥åŠ<br>  $$ g(t) &#x3D; {\frac {C(t) - C(T_t)} { {\vert {T_t} \vert} - 1} } $$<br>  $$ a &#x3D; min(a, g(t)) $$<br> <small> $T_t$ è¡¨ç¤ºä»¥ <code>t</code> ä¸ºæ ¹ç»“ç‚¹çš„å­æ ‘ï¼Œ$C(T_t)$ æ˜¯å¯¹è®­ç»ƒæ•°æ®çš„é¢„æµ‹è¯¯å·®ï¼Œ${\vert {T_t} \vert}$ æ˜¯ $T_t$ çš„å¶ç»“ç‚¹ä¸ªæ ‘ã€‚</small></li><li>è‡ªä¸Šè€Œä¸‹åœ°è®¿é—®å†…éƒ¨ç»“ç‚¹ <code>t</code>ï¼Œå¦‚æœæœ‰ <code>g(t) = a</code>ï¼Œåˆ™è¿›è¡Œå‰ªæå¹¶å¯¹å¶ç»“ç‚¹ <code>t</code> ä»¥å¤šæ•°è¡¨å†³æ³•å†³å®šå…¶ç±»ï¼Œå¾—åˆ°æ ‘ <code>T</code>ã€‚</li><li>è®¾ $k &#x3D; k + 1, a_k &#x3D;$ <code> a</code> $, T_k &#x3D; T$ã€‚</li><li>å¦‚æœ <code>T</code> ä¸æ˜¯ç”±æ ¹ç»“ç‚¹å•ç‹¬ç»„æˆçš„æ ‘ï¼Œåˆ™è¿”å› <code>4</code>ã€‚</li><li>é‡‡ç”¨äº¤å‰éªŒè¯æ³•åœ¨å­æ ‘åºåˆ— $T_0, T_1, â€¦, T_n$ ä¸­é€‰å–æœ€ä¼˜å­æ ‘ $T_a$ã€‚</li></ol></blockquote><hr><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><ol><li>åˆ†ç±»å†³ç­–æ ‘æ¨¡å‹æ˜¯ç”¨äºè¡¨ç¤ºåŸºäºç‰¹å¾å¯¹å®ä¾‹è¿›è¡Œåˆ†ç±»çš„æ ‘å½¢ç»“æ„ä½“ï¼Œå†³ç­–æ ‘å¯ä»¥è½¬æ¢ä¸º <code>if-then</code> è§„åˆ™é›†åˆï¼Œä¹Ÿå¯ä»¥çœ‹ä½œæ˜¯å®šä¹‰åœ¨ç‰¹å¾ç©ºé—´ä¸Šåˆ’åˆ†çš„æ¡ä»¶æ¦‚ç‡åˆ†å¸ƒã€‚</li><li>å†³ç­–æ ‘å­¦ä¹ å®—æ—¨æ˜¯æ„å»ºä¸€ä¸ªå¯ä»¥å¯¹è®­ç»ƒæ•°æ®å¾ˆå¥½çš„åˆ†ç±»ï¼Œä½†åŒæ—¶å¤æ‚åº¦è¾ƒå°çš„å†³ç­–æ ‘ã€‚<br> å†³ç­–æ ‘å­¦ä¹ ç®—æ³•åŒ…å«ä¸‰éƒ¨åˆ†ï¼šç‰¹å¾é€‰æ‹©ã€æ ‘çš„ç”Ÿæˆã€æ ‘çš„å‰ªæã€‚<br> å¸¸ç”¨çš„ç®—æ³•ï¼š<code>ID3</code>ã€ <code>C4.5</code>ã€ <code>CART</code>ã€‚</li><li>ç‰¹å¾é€‰æ‹©çš„ç›®çš„åœ¨äºèƒ½å¤Ÿé€‰å–å¯¹å®ä¾‹åˆ†ç±»æœ‰ç”¨çš„ç‰¹å¾ï¼Œå¸¸ç”¨çš„å‡†åˆ™å¦‚ä¸‹ï¼š<ul><li>æ ·æœ¬é›†åˆ <code>D</code> å¯¹ç‰¹å¾ <code>A</code> çš„ä¿¡æ¯å¢ç›Šï¼š<br> $$ g(D, A) &#x3D; H(D) - H(D|A) $$<br> $$ H(D) &#x3D; - \sum_{k&#x3D;1}^K {\frac {\vert {C_k}\vert} {\vert {D} \vert} } log_2 {\frac {\vert {C_k}\vert} {\vert {D} \vert} } $$<br> $$ H(D|A) &#x3D; \sum_{i&#x3D;1}^n {\frac {\vert {D_i} \vert} {\vert {D} \vert} H(D_i) } $$</li><li>æ ·æœ¬é›†åˆ <code>D</code> å¯¹ç‰¹å¾ <code>A</code> çš„ä¿¡æ¯å¢ç›Šæ¯”ï¼š<br> $$ g_r(D, A) &#x3D; {\frac {g(D, A)} {H(D)} } $$</li><li>æ ·æœ¬é›†åˆ <code>D</code> çš„åŸºå°¼æŒ‡æ•°ï¼š<br> $$ Gini(D) &#x3D; 1 - \sum_{k&#x3D;1}^K ({\frac {\vert {C_k} \vert} {\vert {D} \vert} })^2 $$<br> ç‰¹å¾ <code>A</code> æ¡ä»¶ä¸‹é›†åˆ <code>D</code> çš„åŸºå°¼æŒ‡æ•°ï¼š<br> $$  Gini(D, A) &#x3D; {\frac {\vert {D1} \vert} {\vert {D} \vert} } Gini(D1) + {\frac {\vert {D2} \vert} {\vert {D} \vert} } Gini(D2) $$</li></ul></li><li>å†³ç­–æ ‘çš„ç”ŸæˆåŒæ—¶æ˜¯é‡‡ç”¨ä¿¡æ¯å¢ç›Šæœ€å¤§ã€ä¿¡æ¯å¢ç›Šæ¯”æœ€å¤§æˆ–åŸºå°¼æŒ‡æ•°æœ€å°ä½œä¸ºç‰¹å¾é€‰æ‹©çš„å‡†åˆ™ï¼Œç„¶åä»æ ¹ç»“ç‚¹å¼€å§‹ï¼Œé€šè¿‡ç‰¹å¾é€‰æ‹©å‡†åˆ™åˆ’åˆ†æ­£ç¡®çš„å­é›†ï¼Œé€’å½’åœ°ç”Ÿæˆå†³ç­–æ ‘ã€‚</li><li>ç”Ÿæˆå†³ç­–æ ‘çš„è¿‡ç¨‹ä¸­ä¼šäº§ç”Ÿè¿‡æ‹Ÿåˆé—®é¢˜ï¼Œå› æ­¤éœ€è¦å‰ªæï¼Œä»å·²ç”Ÿæˆçš„å†³ç­–æ ‘ä¸Šå‰ªæ‰ä¸€äº›å¶ç»“ç‚¹æˆ–è€…å­ç»“ç‚¹ï¼Œå¹¶å°†å…¶çˆ¶ç»“ç‚¹ä½œä¸ºæ–°çš„å¶ç»“ç‚¹ï¼Œä»è€Œç®€åŒ–å†³ç­–æ ‘ã€‚</li></ol><hr><h3 id="å¼•ç”¨"><a href="#å¼•ç”¨" class="headerlink" title="å¼•ç”¨"></a>å¼•ç”¨</h3><hr><h3 id="ä¸ªäººå¤‡æ³¨"><a href="#ä¸ªäººå¤‡æ³¨" class="headerlink" title="ä¸ªäººå¤‡æ³¨"></a>ä¸ªäººå¤‡æ³¨</h3><p><strong>æ­¤åšå®¢å†…å®¹å‡ä¸ºä½œè€…å­¦ä¹ ã€Šç»Ÿè®¡å­¦ä¹ æ–¹æ³•ã€‹æ‰€åšç¬”è®°ï¼Œä¾µåˆ ï¼</strong><br><strong>è‹¥è½¬ä½œå…¶ä»–ç”¨é€”ï¼Œè¯·æ³¨æ˜æ¥æºï¼</strong></p>]]></content>
    
    
    <summary type="html">&lt;h3 id=&quot;æ¦‚è¦&quot;&gt;&lt;a href=&quot;#æ¦‚è¦&quot; class=&quot;headerlink&quot; title=&quot;æ¦‚è¦&quot;&gt;&lt;/a&gt;æ¦‚è¦&lt;/h3&gt;&lt;p&gt;å†³ç­–æ ‘ï¼ˆ&lt;code&gt;decision tree&lt;/code&gt;ï¼‰æ˜¯ä¸€ç§åŸºæœ¬çš„&lt;strong&gt;åˆ†ç±»å’Œå›å½’æ–¹æ³•&lt;/strong&gt;ã€‚å…¶ä¸»è¦å‘ˆç°ä¸º&lt;strong&gt;æ ‘çŠ¶ç»“æ„&lt;/strong&gt;ï¼Œåœ¨åˆ†ç±»é—®é¢˜ä¸­ï¼Œè¡¨ç¤ºåŸºäºç‰¹å¾å¯¹å®ä¾‹è¿›è¡Œåˆ†ç±»çš„è¿‡ç¨‹ï¼Œå¯ä»¥è¢«è®¤ä¸ºæ˜¯ &lt;strong&gt;&lt;code&gt;if-then&lt;/code&gt; çš„è§„åˆ™é›†åˆ&lt;/strong&gt;ï¼Œä¹Ÿå¯ä»¥è¢«è®¤ä¸ºæ˜¯å®šä¹‰åœ¨&lt;strong&gt;ç‰¹å¾ç©ºé—´ä¸ç±»ç©ºé—´ä¸Šçš„æ¡ä»¶æ¦‚ç‡åˆ†å¸ƒ&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å…¶ä¼˜ç‚¹ä¸»è¦æœ‰åˆ†ç±»é€Ÿåº¦å¿«ã€æ¨¡å‹å…·æœ‰å¯è¯»æ€§ï¼Œåœ¨å­¦ä¹ æ—¶åˆ©ç”¨è®­ç»ƒæ•°æ®æ ¹æ®&lt;strong&gt;æŸå¤±å‡½æ•°æœ€å°åŒ–&lt;/strong&gt;çš„åŸåˆ™å»ºç«‹å†³ç­–æ ‘æ¨¡å‹ï¼›è€Œåœ¨é¢„æµ‹æ—¶å¯¹æ–°çš„æ•°æ®åˆ©ç”¨&lt;strong&gt;å†³ç­–æ ‘æ¨¡å‹&lt;/strong&gt;è¿›è¡Œåˆ†ç±»ã€‚&lt;/p&gt;
&lt;p&gt;å†³ç­–æ ‘æ¨¡å‹ä¸»è¦åŒ…å«ä»¥ä¸‹æ­¥éª¤ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç‰¹å¾é€‰æ‹©&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å†³ç­–æ ‘çš„ç”Ÿæˆ&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å†³ç­–æ ‘çš„ä¿®å‰ª&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;</summary>
    
    
    
    
    <category term="ML" scheme="https://blog.vgbhfive.cn/tags/ML/"/>
    
  </entry>
  
  <entry>
    <title>MLå®è·µ-Pima æ•°æ®é›†</title>
    <link href="https://blog.vgbhfive.cn/ML%E5%AE%9E%E8%B7%B5-Pima-%E6%95%B0%E6%8D%AE%E9%9B%86/"/>
    <id>https://blog.vgbhfive.cn/ML%E5%AE%9E%E8%B7%B5-Pima-%E6%95%B0%E6%8D%AE%E9%9B%86/</id>
    <published>2023-07-17T15:30:07.000Z</published>
    <updated>2023-09-09T07:49:13.562Z</updated>
    
    <content type="html"><![CDATA[<h3 id="æ•°æ®ç®€ä»‹"><a href="#æ•°æ®ç®€ä»‹" class="headerlink" title="æ•°æ®ç®€ä»‹"></a>æ•°æ®ç®€ä»‹</h3><p>è¯¥æ•°æ®é›†æœ€åˆæ¥è‡ªç³–å°¿ç—…&#x2F;æ¶ˆåŒ–&#x2F;è‚¾è„ç–¾ç—…ç ”ç©¶æ‰€ï¼Œæ­¤<a href="https://www.kaggle.com/datasets/uciml/pima-indians-diabetes-database">æ•°æ®é›†</a>çš„ç›®æ ‡æ˜¯åŸºäºæ•°æ®é›†ä¸­åŒ…å«çš„æŸäº›èº«ä½“æŒ‡æ ‡æ¥è¯Šæ–­æ€§çš„é¢„æµ‹æ‚£è€…æ˜¯å¦æ‚£æœ‰ç³–å°¿ç—…ã€‚<br>æ•°æ®é›†ç”±å¤šä¸ªåŒ»å­¦æŒ‡æ ‡å’Œä¸€ä¸ªç›®æ ‡å˜é‡ <code>Outcome</code> ç»„æˆï¼ŒåŒ»å­¦æŒ‡æ ‡åŒ…å«æ‚£è€…çš„æ€€å­•æ¬¡æ•°ã€<code>BMI</code> æŒ‡æ•°ã€èƒ°å²›ç´ æ°´å¹³ã€å¹´é¾„ã€è¡€å‹ç­‰ã€‚</p><span id="more"></span><hr><h3 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h3><h4 id="å¯¼å…¥åŸºç¡€ä¾èµ–"><a href="#å¯¼å…¥åŸºç¡€ä¾èµ–" class="headerlink" title="å¯¼å…¥åŸºç¡€ä¾èµ–"></a>å¯¼å…¥åŸºç¡€ä¾èµ–</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</span><br></pre></td></tr></table></figure><h4 id="å¯¼å…¥æ•°æ®æŸ¥çœ‹åŸºç¡€ä¿¡æ¯"><a href="#å¯¼å…¥æ•°æ®æŸ¥çœ‹åŸºç¡€ä¿¡æ¯" class="headerlink" title="å¯¼å…¥æ•°æ®æŸ¥çœ‹åŸºç¡€ä¿¡æ¯"></a>å¯¼å…¥æ•°æ®æŸ¥çœ‹åŸºç¡€ä¿¡æ¯</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">pima = pd.read_csv(<span class="string">&quot;diabetes.csv&quot;</span>)</span><br><span class="line"><span class="comment"># pima.head()</span></span><br><span class="line"><span class="comment"># pima.info()</span></span><br><span class="line"><span class="comment"># pima.shape</span></span><br><span class="line">pima.describe()</span><br></pre></td></tr></table></figure><p><img src="/ML%E5%AE%9E%E8%B7%B5-Pima-%E6%95%B0%E6%8D%AE%E9%9B%86/1.png" alt="1"></p><h4 id="æ•°æ®å¯è§†åŒ–"><a href="#æ•°æ®å¯è§†åŒ–" class="headerlink" title="æ•°æ®å¯è§†åŒ–"></a>æ•°æ®å¯è§†åŒ–</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ±çŠ¶å›¾</span></span><br><span class="line">pima.hist(figsize=(<span class="number">16</span>, <span class="number">14</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ•£ç‚¹å›¾</span></span><br><span class="line">sns.pairplot(pima, hue=<span class="string">&quot;Outcome&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç®±å›¾</span></span><br><span class="line">pima.plot(kind=<span class="string">&quot;box&quot;</span>, subplots=<span class="literal">True</span>, layout=(<span class="number">3</span>,<span class="number">3</span>), sharex=<span class="literal">False</span>, sharey=<span class="literal">False</span>, figsize=(<span class="number">16</span>,<span class="number">14</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># çƒ­ç‚¹å›¾</span></span><br><span class="line">column_x = pima.columns[<span class="number">0</span>: <span class="built_in">len</span>(pima.columns)-<span class="number">1</span>]</span><br><span class="line">column_x</span><br><span class="line">corr = pima[pima.columns].corr()</span><br><span class="line">plt.subplots(figsize=(<span class="number">16</span>,<span class="number">14</span>))</span><br><span class="line">sns.heatmap(corr, annot=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure><h4 id="ç‰¹å¾é¢„å¤„ç†"><a href="#ç‰¹å¾é¢„å¤„ç†" class="headerlink" title="ç‰¹å¾é¢„å¤„ç†"></a>ç‰¹å¾é¢„å¤„ç†</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.feature_selection <span class="keyword">import</span> SelectKBest </span><br><span class="line"><span class="keyword">from</span> sklearn.feature_selection <span class="keyword">import</span> chi2</span><br><span class="line"> </span><br><span class="line">X = pima.iloc[:, <span class="number">0</span>:<span class="number">8</span>] <span class="comment"># ç‰¹å¾åˆ— 0-7åˆ—ï¼Œä¸å«ç¬¬8åˆ—ã€‚</span></span><br><span class="line">Y = pima.iloc[:, <span class="number">8</span>] <span class="comment"># ç›®æ ‡åˆ—ä¸ºç¬¬8åˆ—</span></span><br><span class="line"><span class="comment"># iloc([rows], [cols]) ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºè¦æˆªå–çš„è¡Œï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸ºè¦æˆªå–çš„åˆ—ã€‚loc([rows], [cols_name]) ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºè¦æˆªå–çš„è¡Œï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸ºè¦æˆªå–çš„åˆ—åç§°</span></span><br><span class="line"></span><br><span class="line">select_top_4 = SelectKBest(score_func=chi2, k =<span class="number">4</span>) <span class="comment"># é€šè¿‡å¡æ–¹æ£€éªŒé€‰æ‹©4ä¸ªå¾—åˆ†æœ€é«˜çš„ç‰¹å¾</span></span><br><span class="line">fits = select_top_4.fit(X, Y) <span class="comment">#å°†ç‰¹å¾è¾“å…¥åˆ°è¯„åˆ†å‡½æ•°ï¼Œè·å–ç‰¹å¾ä¿¡æ¯å’Œç›®æ ‡å€¼ä¿¡æ¯</span></span><br><span class="line">features = fits.transform(X) <span class="comment">#å±•ç°ç‰¹å¾è½¬æ¢åçš„ç»“æœ</span></span><br><span class="line">features[<span class="number">0</span>:<span class="number">5</span>] <span class="comment">#æ–°ç‰¹å¾åˆ—</span></span><br><span class="line"></span><br><span class="line">pima.head() <span class="comment"># è¡¨ç°æœ€ä½³çš„ç‰¹å¾ä¸º Glucoseï¼Œ Insulinï¼Œ BMIï¼Œ Age</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ„é€ æ–°çš„ DataFrame</span></span><br><span class="line">x_features = pd.DataFrame(data=features, columns=[<span class="string">&#x27;Glucose&#x27;</span>, <span class="string">&#x27;Insulin&#x27;</span>, <span class="string">&#x27;BMI&#x27;</span>, <span class="string">&#x27;Age&#x27;</span>])</span><br><span class="line">x_features</span><br><span class="line">y_features = pd.DataFrame(data=Y, columns=[<span class="string">&#x27;Outcome&#x27;</span>])</span><br><span class="line">y_features</span><br></pre></td></tr></table></figure><p><img src="/ML%E5%AE%9E%E8%B7%B5-Pima-%E6%95%B0%E6%8D%AE%E9%9B%86/2.png" alt="2"><br><img src="/ML%E5%AE%9E%E8%B7%B5-Pima-%E6%95%B0%E6%8D%AE%E9%9B%86/3.png" alt="3"></p><h4 id="ç‰¹å¾æ ‡å‡†åŒ–"><a href="#ç‰¹å¾æ ‡å‡†åŒ–" class="headerlink" title="ç‰¹å¾æ ‡å‡†åŒ–"></a>ç‰¹å¾æ ‡å‡†åŒ–</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å°†å±æ€§å€¼æ›´æ”¹ä¸º å‡å€¼ä¸º0ï¼Œæ ‡å‡†å·®ä¸º1 çš„ é«˜æ–¯åˆ†å¸ƒ. å½“ç®—æ³•æœŸæœ›è¾“å…¥ç‰¹å¾å¤„äºé«˜æ–¯åˆ†å¸ƒæ—¶ï¼Œå®ƒéå¸¸æœ‰ç”¨</span></span><br><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> StandardScaler</span><br><span class="line">rescaled_x = StandardScaler().fit_transform(x_features)</span><br><span class="line">x = pd.DataFrame(data=rescaled_x, columns=x_features.columns)</span><br><span class="line">x.head()</span><br></pre></td></tr></table></figure><p><img src="/ML%E5%AE%9E%E8%B7%B5-Pima-%E6%95%B0%E6%8D%AE%E9%9B%86/4.png" alt="4"></p><h4 id="æ•°æ®åˆ‡åˆ†"><a href="#æ•°æ®åˆ‡åˆ†" class="headerlink" title="æ•°æ®åˆ‡åˆ†"></a>æ•°æ®åˆ‡åˆ†</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</span><br><span class="line">seed = <span class="number">7</span></span><br><span class="line">test_size = <span class="number">0.33</span></span><br><span class="line">x_train, x_test, y_train, y_test = train_test_split(x, y_features, test_size=test_size, random_state=seed)</span><br><span class="line">x_train.head()</span><br><span class="line">y_train.head()</span><br></pre></td></tr></table></figure><h4 id="æ„å»ºäºŒåˆ†ç±»ç®—æ³•æ¨¡å‹"><a href="#æ„å»ºäºŒåˆ†ç±»ç®—æ³•æ¨¡å‹" class="headerlink" title="æ„å»ºäºŒåˆ†ç±»ç®—æ³•æ¨¡å‹"></a>æ„å»ºäºŒåˆ†ç±»ç®—æ³•æ¨¡å‹</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> KFold</span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> cross_val_score</span><br><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LogisticRegression</span><br><span class="line"><span class="keyword">from</span> sklearn.naive_bayes <span class="keyword">import</span> GaussianNB</span><br><span class="line"><span class="keyword">from</span> sklearn.neighbors <span class="keyword">import</span> KNeighborsClassifier</span><br><span class="line"><span class="keyword">from</span> sklearn.tree <span class="keyword">import</span> DecisionTreeClassifier</span><br><span class="line"><span class="keyword">from</span> sklearn.svm <span class="keyword">import</span> SVC</span><br><span class="line"></span><br><span class="line">models = []</span><br><span class="line">models.append((<span class="string">&quot;LB&quot;</span>, LogisticRegression()))</span><br><span class="line">models.append((<span class="string">&quot;NB&quot;</span>, GaussianNB()))</span><br><span class="line">models.append((<span class="string">&quot;KNN&quot;</span>, KNeighborsClassifier()))</span><br><span class="line">models.append((<span class="string">&quot;DT&quot;</span>, DecisionTreeClassifier()))</span><br><span class="line">models.append((<span class="string">&quot;SVM&quot;</span>, SVC()))</span><br><span class="line"></span><br><span class="line">results = []</span><br><span class="line">names = []</span><br><span class="line"><span class="keyword">for</span> name, model <span class="keyword">in</span> models:</span><br><span class="line">    kfold = KFold(n_splits=<span class="number">10</span>, shuffle=<span class="literal">True</span>, random_state=<span class="number">22</span>)</span><br><span class="line">    cv_result = cross_val_score(model, x_train, y_train, cv=kfold, scoring=<span class="string">&quot;accuracy&quot;</span>)</span><br><span class="line">    names.append(name)</span><br><span class="line">    results.append(cv_result)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(names)):</span><br><span class="line">    <span class="built_in">print</span>(names[i], results[i].mean())</span><br></pre></td></tr></table></figure><p><img src="/ML%E5%AE%9E%E8%B7%B5-Pima-%E6%95%B0%E6%8D%AE%E9%9B%86/5.png" alt="5"></p><h4 id="æ¨¡å‹è¯„ä¼°"><a href="#æ¨¡å‹è¯„ä¼°" class="headerlink" title="æ¨¡å‹è¯„ä¼°"></a>æ¨¡å‹è¯„ä¼°</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.svm <span class="keyword">import</span> SVC</span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> classification_report, confusion_matrix</span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> accuracy_score</span><br><span class="line"></span><br><span class="line">classifier = SVC(kernel=<span class="string">&quot;rbf&quot;</span>)</span><br><span class="line">classifier.fit(x_train, y_train)</span><br><span class="line">y_pred = classifier.predict(x_test)</span><br><span class="line"></span><br><span class="line">cm = confusion_matrix(y_test, y_pred) <span class="comment"># æ··æ·†çŸ©é˜µ</span></span><br><span class="line">cm</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(classification_report(y_test, y_pred)) <span class="comment"># æ˜¾ç¤ºå‡†ç¡®ç‡</span></span><br><span class="line"></span><br><span class="line">accuracy = accuracy_score(y_test, y_pred)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Accuracy: %.2f%%&quot;</span> % (accuracy * <span class="number">100.0</span>))</span><br></pre></td></tr></table></figure><p><img src="/ML%E5%AE%9E%E8%B7%B5-Pima-%E6%95%B0%E6%8D%AE%E9%9B%86/6.png" alt="6"><br><img src="/ML%E5%AE%9E%E8%B7%B5-Pima-%E6%95%B0%E6%8D%AE%E9%9B%86/7.png" alt="7"><br><img src="/ML%E5%AE%9E%E8%B7%B5-Pima-%E6%95%B0%E6%8D%AE%E9%9B%86/8.png" alt="8"></p><h4 id="æ¨¡å‹ä¼˜åŒ–"><a href="#æ¨¡å‹ä¼˜åŒ–" class="headerlink" title="æ¨¡å‹ä¼˜åŒ–"></a>æ¨¡å‹ä¼˜åŒ–</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä½¿ç”¨â€ç½‘æ ¼æœç´¢â€œæ¥æé«˜æ¨¡å‹ - æ¨¡å‹ä¼˜åŒ–</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> GridSearchCV</span><br><span class="line"></span><br><span class="line">param_grid = &#123;<span class="string">&#x27;C&#x27;</span>: [<span class="number">0.1</span>, <span class="number">1</span>, <span class="number">10</span>, <span class="number">100</span>], <span class="string">&#x27;gamma&#x27;</span>: [<span class="number">1</span>, <span class="number">0.1</span>, <span class="number">0.01</span>, <span class="number">0.001</span>]&#125;</span><br><span class="line">grid = GridSearchCV(SVC(), param_grid, refit=<span class="literal">True</span>, verbose=<span class="number">2</span>)</span><br><span class="line">grid.fit(x_train, y_train)</span><br><span class="line"></span><br><span class="line">grid_prediction = grid.predict(x_test)</span><br><span class="line"><span class="built_in">print</span>(classification_report(y_test, grid_prediction))</span><br></pre></td></tr></table></figure><p><img src="/ML%E5%AE%9E%E8%B7%B5-Pima-%E6%95%B0%E6%8D%AE%E9%9B%86/9.png" alt="9"></p><hr><h3 id="è¦ç‚¹"><a href="#è¦ç‚¹" class="headerlink" title="è¦ç‚¹"></a>è¦ç‚¹</h3><h4 id="è¯„åˆ†å‡½æ•°"><a href="#è¯„åˆ†å‡½æ•°" class="headerlink" title="è¯„åˆ†å‡½æ•°"></a>è¯„åˆ†å‡½æ•°</h4><ol><li><p><code>SelectKBest()</code><br>åªä¿ç•™ <code>K</code> ä¸ªæœ€é«˜åˆ†çš„ç‰¹å¾ï¼Œèƒ½å¤Ÿè¿”å›ç‰¹å¾è¯„ä»·çš„å¾—åˆ†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SelectKBest(score_func=&lt;function f_classif&gt;, k=<span class="number">10</span>)</span><br></pre></td></tr></table></figure></li><li><p><code>SelectPercentile()</code><br>åªä¿ç•™ç”¨æˆ·æŒ‡å®šç™¾åˆ†æ¯”çš„æœ€é«˜å¾—åˆ†çš„ç‰¹å¾ï¼Œèƒ½å¤Ÿè¿”å›ç‰¹å¾è¯„ä»·çš„å¾—åˆ†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SelectPercentile(score_func=&lt;function f_classif&gt;, percentile=<span class="number">10</span>) </span><br></pre></td></tr></table></figure><p>ä½¿ç”¨å¸¸è§çš„å•å˜é‡ç»Ÿè®¡æ£€éªŒï¼šå‡æ­£ç‡ <code>SelectFpr</code>ï¼Œé”™è¯¯å‘ç°ç‡ <code>SelectFdr</code>ï¼Œæˆ–è€…æ€»ä½“é”™è¯¯ç‡ <code>SelectFwe</code>ã€‚</p></li><li><p><code>GenericUnivariateSelect()</code><br>é€šè¿‡ç»“æ„åŒ–ç­–ç•¥è¿›è¡Œç‰¹å¾é€‰æ‹©ï¼Œé€šè¿‡è¶…å‚æ•°æœç´¢ä¼°è®¡å™¨è¿›è¡Œç‰¹å¾é€‰æ‹©ã€‚</p></li></ol><h4 id="cross-val-score-å‡½æ•°"><a href="#cross-val-score-å‡½æ•°" class="headerlink" title="cross_val_score() å‡½æ•°"></a><code>cross_val_score()</code> å‡½æ•°</h4><p><code>cross_val_score()</code> å‡½æ•°ï¼Œäº¤å‰éªŒè¯è¯„åˆ†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sklearn.cross_validation.cross_val_score(estimator, X, y=<span class="literal">None</span>, scoring=<span class="literal">None</span>, cv=<span class="literal">None</span>, n_jobs=<span class="number">1</span>, verbose=<span class="number">0</span>, fit_params=<span class="literal">None</span>, pre_dispatch=<span class="string">&#x27;2*n_jobs&#x27;</span>)</span><br></pre></td></tr></table></figure><p>å‚æ•°è¯´æ˜ï¼š</p><ul><li><code>estimator</code>ï¼šæ•°æ®å¯¹è±¡ </li><li><code>X</code>ï¼šæ•°æ® </li><li><code>y</code>ï¼šé¢„æµ‹æ•°æ® </li><li><code>soring</code>ï¼šè°ƒç”¨çš„æ–¹æ³•</li><li><code>cv</code>ï¼šäº¤å‰éªŒè¯ç”Ÿæˆå™¨æˆ–å¯è¿­ä»£çš„æ¬¡æ•° </li><li><code>n_jobs</code>ï¼šåŒæ—¶å·¥ä½œçš„ <code>cpu</code> ä¸ªæ•°ï¼ˆ<code>-1</code> ä»£è¡¨å…¨éƒ¨ï¼‰</li><li><code>verbose</code>ï¼šè¯¦ç»†ç¨‹åº¦</li><li><code>fit_params</code>ï¼šä¼ é€’ç»™ä¼°è®¡å™¨çš„æ‹Ÿåˆæ–¹æ³•çš„å‚æ•°</li><li><code>pre_dispatch</code>ï¼šæ§åˆ¶å¹¶è¡Œæ‰§è¡ŒæœŸé—´è°ƒåº¦çš„ä½œä¸šæ•°é‡</li></ul><h4 id="KFold-äº¤å‰éªŒè¯"><a href="#KFold-äº¤å‰éªŒè¯" class="headerlink" title="KFold äº¤å‰éªŒè¯"></a><code>KFold</code> äº¤å‰éªŒè¯</h4><p><code>K</code> æŠ˜äº¤å‰éªŒè¯ï¼Œå°†æ•°æ®é›†åˆ†æˆ <code>K</code> ä»½çš„å®˜æ–¹ç»™å®šæ–¹æ¡ˆï¼Œæ‰€è°“ <code>K</code> æŠ˜å°±æ˜¯å°†æ•°æ®é›†é€šè¿‡ <code>K</code> æ¬¡åˆ†å‰²ï¼Œä½¿å¾—æ‰€æœ‰æ•°æ®æ—¢åœ¨è®­ç»ƒé›†å‡ºç°è¿‡ï¼Œåˆåœ¨æµ‹è¯•é›†å‡ºç°è¿‡ï¼Œå½“ç„¶æ¯æ¬¡åˆ†å‰²ä¸­ä¸ä¼šæœ‰é‡å ï¼Œç›¸å½“äºæ— æ”¾å›æŠ½æ ·ã€‚<br><code>StratifiedKFold</code> ç”¨æ³•ç±»ä¼¼ <code>Kfold</code>ï¼Œä½†æ˜¯ä»–æ˜¯åˆ†å±‚é‡‡æ ·ï¼Œç¡®ä¿è®­ç»ƒé›†ï¼Œæµ‹è¯•é›†ä¸­å„ç±»åˆ«æ ·æœ¬çš„æ¯”ä¾‹ä¸åŸå§‹æ•°æ®é›†ä¸­ç›¸åŒã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sklearn.model_selection.KFold(n_splits=<span class="number">3</span>, shuffle=<span class="literal">False</span>, random_state=<span class="literal">None</span>)</span><br></pre></td></tr></table></figure><p>å°†è®­ç»ƒ&#x2F;æµ‹è¯•æ•°æ®é›†åˆ’åˆ† <code>n_splits</code> ä¸ªäº’æ–¥å­é›†ï¼Œæ¯æ¬¡ç”¨å…¶ä¸­ä¸€ä¸ªå­é›†å½“ä½œéªŒè¯é›†ï¼Œå‰©ä¸‹çš„ <code>n_splits-1</code> ä¸ªä½œä¸ºè®­ç»ƒé›†ï¼Œè¿›è¡Œ <code>n_splits</code> æ¬¡è®­ç»ƒå’Œæµ‹è¯•ï¼Œå¾—åˆ° <code>n_splits</code> ä¸ªç»“æœã€‚</p><p>å‚æ•°è¯´æ˜ï¼š</p><ul><li><code>n_splits</code>ï¼šè¡¨ç¤ºåˆ’åˆ†å‡ ç­‰ä»½</li><li><code>shuffle</code>ï¼šåœ¨æ¯æ¬¡åˆ’åˆ†æ—¶ï¼Œæ˜¯å¦è¿›è¡Œæ´—ç‰Œ<ul><li>è‹¥ä¸º <code>False</code> æ—¶ï¼Œå…¶æ•ˆæœç­‰åŒäº <code>random_state</code> ç­‰äºæ•´æ•°ï¼Œæ¯æ¬¡åˆ’åˆ†çš„ç»“æœç›¸åŒã€‚</li><li>è‹¥ä¸º <code>True</code> æ—¶ï¼Œæ¯æ¬¡åˆ’åˆ†çš„ç»“æœéƒ½ä¸ä¸€æ ·ï¼Œè¡¨ç¤ºç»è¿‡æ´—ç‰Œï¼Œéšæœºå–æ ·çš„ã€‚</li></ul></li><li><code>random_state</code>ï¼šéšæœºç§å­æ•°</li></ul><p><small>æ³¨æ„ç‚¹ï¼šå¯¹äºä¸èƒ½å‡ç­‰ä»½çš„æ•°æ®é›†ï¼Œå…¶å‰ <code>n_samples % n_splits</code> å­é›†æ‹¥æœ‰ <code>n_samples // n_splits + 1</code> ä¸ªæ ·æœ¬ï¼Œå…¶ä½™å­é›†éƒ½åªæœ‰ <code>n_samples // n_splits</code> æ ·æœ¬ã€‚</small></p><h4 id="LeaveOneOut-ç•™ä¸€æ³•"><a href="#LeaveOneOut-ç•™ä¸€æ³•" class="headerlink" title="LeaveOneOut ç•™ä¸€æ³•"></a><code>LeaveOneOut</code> ç•™ä¸€æ³•</h4><p><code>LeaveOneOut</code> ç•™ä¸€æ³•ï¼Œæ¯ä¸€å›åˆä¸­ï¼Œå‡ ä¹æ‰€æœ‰çš„æ ·æœ¬éƒ½ç”¨äºè®­ç»ƒæ¨¡å‹ï¼Œå› æ­¤æœ€æ¥è¿‘åŸå§‹æ ·æœ¬çš„åˆ†å¸ƒï¼Œè¿™æ ·çš„è¯„ä¼°æ‰€å¾—çš„ç»“æœæ¯”è¾ƒå¯é ã€‚å®éªŒè¿‡ç¨‹ä¸­ï¼Œæ²¡æœ‰éšæœºå› ç´ ä¼šå½±å“å®éªŒæ•°æ®ï¼Œç¡®ä¿å®éªŒè¿‡ç¨‹æ˜¯å¯ä»¥è¢«å¤åˆ¶çš„ã€‚<br>ä½†æ˜¯ <code>LeaveOneOut</code> ä¹Ÿæœ‰æ˜æ˜¾çš„ç¼ºç‚¹ï¼Œå°±æ˜¯è®¡ç®—æˆæœ¬é«˜ï¼Œå½“åŸå§‹æ ·æœ¬æ•°å¾ˆå¤šæ—¶ï¼Œéœ€è¦èŠ±è´¹å¤§é‡çš„æ—¶é—´å»å®Œæˆç®—æ³•çš„è¿ç®—ä¸è¯„ä¼°ã€‚</p><h4 id="SVC-å‡½æ•°"><a href="#SVC-å‡½æ•°" class="headerlink" title="SVC() å‡½æ•°"></a><code>SVC()</code> å‡½æ•°</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sklearn.svm.SVC(C=<span class="number">1.0</span>, kernel=<span class="string">&#x27;rbf&#x27;</span>, degree=<span class="number">3</span>, gamma=<span class="string">&#x27;auto&#x27;</span>, coef0=<span class="number">0.0</span>, shrinking=<span class="literal">True</span>, probability=<span class="literal">False</span>,tol=<span class="number">0.001</span>, cache_size=<span class="number">200</span>, class_weight=<span class="literal">None</span>, verbose=<span class="literal">False</span>, max_iter=-<span class="number">1</span>, decision_function_shape=<span class="literal">None</span>,random_state=<span class="literal">None</span>)</span><br></pre></td></tr></table></figure><p>å‚æ•°è¯´æ˜ï¼š</p><ul><li><code>C</code>ï¼š<code>C-SVC</code> çš„æƒ©ç½šå‚æ•° <code>C</code>ï¼Œé»˜è®¤å€¼æ˜¯ <code>1.0</code>ã€‚<br>  <code>C</code> è¶Šå¤§ï¼Œç›¸å½“äºæƒ©ç½šæ¾å¼›å˜é‡ï¼Œå¸Œæœ›æ¾å¼›å˜é‡æ¥è¿‘ <code>0</code>ï¼Œå³å¯¹è¯¯åˆ†ç±»çš„æƒ©ç½šå¢å¤§ï¼Œè¶‹å‘äºå¯¹è®­ç»ƒé›†å…¨åˆ†å¯¹çš„æƒ…å†µï¼Œè¿™æ ·å¯¹è®­ç»ƒé›†æµ‹è¯•æ—¶å‡†ç¡®ç‡å¾ˆé«˜ï¼Œä½†æ³›åŒ–èƒ½åŠ›å¼±ã€‚<br>  <code>C</code> å€¼å°ï¼Œå¯¹è¯¯åˆ†ç±»çš„æƒ©ç½šå‡å°ï¼Œå…è®¸å®¹é”™ï¼Œå°†ä»–ä»¬å½“æˆå™ªå£°ç‚¹ï¼Œæ³›åŒ–èƒ½åŠ›è¾ƒå¼ºã€‚</li><li><code>kernel</code>ï¼šæ ¸å‡½æ•°ï¼Œé»˜è®¤æ˜¯ <code>rbf</code>ï¼Œå¯ä»¥æ˜¯ <code>linear</code>ã€ <code>poly</code>ã€ <code>rbf</code>ã€ <code>sigmoid</code>ã€ <code>precomputed</code><ul><li>çº¿æ€§ï¼š<code>u&#39;v</code></li><li>å¤šé¡¹å¼ï¼š<code>(gamma*u&#39;*v + coef0)^degree</code></li><li><code>RBF</code> å‡½æ•°ï¼š<code>exp(-gamma|u-v|^2)</code></li><li><code>sigmoid</code>ï¼š<code>tanh(gamma*u&#39;*v + coef0)</code></li></ul></li><li><code>degree</code>ï¼šå¤šé¡¹å¼ <code>poly</code> å‡½æ•°çš„ç»´åº¦ï¼Œé»˜è®¤æ˜¯ <code>3</code>ï¼Œé€‰æ‹©å…¶ä»–æ ¸å‡½æ•°æ—¶ä¼šè¢«å¿½ç•¥</li><li><code>gamma</code>ï¼š <code>rbf</code>ã€ <code>poly</code> å’Œ <code>sigmoid</code> çš„æ ¸å‡½æ•°å‚æ•°ï¼Œé»˜è®¤æ˜¯ <code>auto</code>ï¼Œåˆ™ä¼šé€‰æ‹© <code>1/n_features</code></li><li><code>coef0</code>ï¼šæ ¸å‡½æ•°çš„å¸¸æ•°é¡¹ï¼Œå¯¹äº <code>poly </code>å’Œ <code>sigmoid</code> æœ‰ç”¨</li><li><code>probability</code>ï¼šæ˜¯å¦é‡‡ç”¨æ¦‚ç‡ä¼°è®¡ï¼Œé»˜è®¤ä¸º <code>False</code></li><li><code>shrinking</code>ï¼šæ˜¯å¦é‡‡ç”¨ <code>shrinking heuristic</code> æ–¹æ³•ï¼Œé»˜è®¤ä¸º <code>True</code></li><li><code>tol</code>ï¼šåœæ­¢è®­ç»ƒçš„è¯¯å·®å€¼å¤§å°ï¼Œé»˜è®¤ä¸º <code>1e-3</code></li><li><code>cache_size</code>ï¼šæ ¸å‡½æ•° <code>cache</code> ç¼“å­˜å¤§å°ï¼Œé»˜è®¤ä¸º <code>200</code></li><li><code>class_weight</code>ï¼šç±»åˆ«çš„æƒé‡ï¼Œå­—å…¸å½¢å¼ä¼ é€’ã€‚è®¾ç½®ç¬¬å‡ ç±»çš„å‚æ•° <code>C</code> ä¸º <code>weight*C</code></li><li><code>verbose</code>ï¼šæ˜¯å¦å…è®¸å†—ä½™è¾“å‡º</li><li><code>max_iter</code>ï¼šæœ€å¤§è¿­ä»£æ¬¡æ•°ï¼Œ<code>-1</code> ä¸ºæ— é™åˆ¶</li><li><code>decision_function_shape</code>ï¼š<code>ovo</code>ã€ <code>ovr</code> æˆ–è€… <code>None</code>ï¼Œé»˜è®¤å€¼ä¸º <code>None</code></li><li><code>random_state</code>ï¼šæ•°æ®æ´—ç‰Œæ—¶çš„ç§å­å€¼</li></ul><p>ä¸»è¦è°ƒèŠ‚çš„å‚æ•°æœ‰ï¼š<code>C</code>ã€ <code>kernel</code>ã€ <code>degree</code>ã€ <code>gamma</code>ã€ <code>coef0</code>ã€‚</p><h4 id="confusion-matrix-å‡½æ•°"><a href="#confusion-matrix-å‡½æ•°" class="headerlink" title="confusion_matrix() å‡½æ•°"></a><code>confusion_matrix()</code> å‡½æ•°</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sklearn.metrics.confusion_matrix(y_true, y_pred, labels=<span class="literal">None</span>, sample_weight=<span class="literal">None</span>)</span><br></pre></td></tr></table></figure><p>å‚æ•°è¯´æ˜ï¼š</p><ul><li><code>y_true</code>ï¼šæ˜¯æ ·æœ¬çœŸå®åˆ†ç±»ç»“æœ</li><li><code>y_pred</code>ï¼šæ˜¯æ ·æœ¬é¢„æµ‹åˆ†ç±»ç»“æœ</li><li><code>labels</code>ï¼šæ˜¯æ‰€ç»™å‡ºçš„ç±»åˆ«ï¼Œé€šè¿‡è¿™ä¸ªå¯å¯¹ç±»åˆ«è¿›è¡Œé€‰æ‹© </li><li><code>sample_weight</code> : æ ·æœ¬æƒé‡</li></ul><h4 id="classification-report-é¢„æµ‹å‡†ç¡®ç‡"><a href="#classification-report-é¢„æµ‹å‡†ç¡®ç‡" class="headerlink" title="classification_report() é¢„æµ‹å‡†ç¡®ç‡"></a><code>classification_report()</code> é¢„æµ‹å‡†ç¡®ç‡</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sklearn.metrics.classification_report(y_true, y_pred, *, labels=<span class="literal">None</span>, target_names=<span class="literal">None</span>, sample_weight=<span class="literal">None</span>, digits=<span class="number">2</span>, output_dict=<span class="literal">False</span>, zero_division=<span class="string">&#x27;warn&#x27;</span>)</span><br></pre></td></tr></table></figure><p><img src="/ML%E5%AE%9E%E8%B7%B5-Pima-%E6%95%B0%E6%8D%AE%E9%9B%86/7.png" alt="7"><br>è¾“å‡ºè¯´æ˜ï¼š</p><ul><li><code>precision</code>: å‡†ç¡®ç‡ï¼Œ<code>TP/ (TP+FP) </code></li><li><code>recall</code>: å¬å›ç‡ï¼Œ<code>TP(TP + FN)</code></li><li><code>f1-score</code>: æ˜¯å‡†ç¡®ç‡ä¸å¬å›ç‡çš„ç»¼åˆï¼Œå¯ä»¥è®¤ä¸ºæ˜¯å¹³å‡ç»“æœï¼Œ<code>2*TP/(2*TP + FP + FN)</code><ul><li><code>TP</code>: é¢„æµ‹ä¸ºæ­£ï¼Œå®ç°ä¸ºæ­£</li><li><code>FP</code>: é¢„æµ‹ä¸ºæ­£ï¼Œå®ç°ä¸ºè´Ÿ</li><li><code>FN</code>: é¢„æµ‹ä¸ºè´Ÿï¼Œå®ç°ä¸ºæ­£</li><li><code>TN</code>: é¢„æµ‹ä¸ºè´Ÿï¼Œå®ç°ä¸ºè´Ÿ</li></ul></li></ul><h4 id="GridSearchCV"><a href="#GridSearchCV" class="headerlink" title="GridSearchCV()"></a><code>GridSearchCV()</code></h4><p><code>GridSearchCV()</code> å¯ä»¥æ‹†åˆ†ä¸ºä¸¤éƒ¨åˆ† <code>GridSearch</code> å’Œ <code>CV</code>ï¼Œå³ç½‘æ ¼æœç´¢å’Œäº¤å‰éªŒè¯ã€‚ç½‘æ ¼æœç´¢ï¼ŒæŒ‡çš„æ˜¯å‚æ•°ï¼Œå³åœ¨æŒ‡å®šçš„å‚æ•°èŒƒå›´å†…ï¼ŒæŒ‰æ­¥é•¿ä¾æ¬¡è°ƒæ•´å‚æ•°ï¼Œåˆ©ç”¨è°ƒæ•´çš„å‚æ•°è®­ç»ƒå­¦ä¹ å™¨ï¼Œä»æ‰€æœ‰çš„å‚æ•°ä¸­æ‰¾åˆ°åœ¨éªŒè¯é›†ä¸Šç²¾åº¦æœ€é«˜çš„å‚æ•°ï¼Œè¿™å…¶å®æ˜¯ä¸€ä¸ªè®­ç»ƒå’Œæ¯”è¾ƒçš„è¿‡ç¨‹ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sklearn.model_selection.GridSearchCV(estimator, param_grid, *, scoring=<span class="literal">None</span>, n_jobs=<span class="literal">None</span>, refit=<span class="literal">True</span>, cv=<span class="literal">None</span>, verbose=<span class="number">0</span>, pre_dispatch=<span class="string">&#x27;2*n_jobs&#x27;</span>, error_score=nan, return_train_score=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure><p>å‚æ•°è¯´æ˜ï¼š</p><ul><li><code>estimator</code>ï¼šé€‰æ‹©ä½¿ç”¨çš„åˆ†ç±»å™¨ï¼Œå¹¶ä¸”ä¼ å…¥é™¤éœ€è¦ç¡®å®šæœ€ä½³çš„å‚æ•°ä¹‹å¤–çš„å…¶ä»–å‚æ•°ã€‚å¹¶ä¸”æ¯ä¸€ä¸ªåˆ†ç±»å™¨éƒ½éœ€è¦ä¸€ä¸ª <code>scoring</code> å‚æ•°æˆ–è€… <code>score</code> æ–¹æ³•ã€‚</li><li><code>param_grid</code>ï¼šéœ€è¦æœ€ä¼˜åŒ–çš„å‚æ•°çš„å–å€¼ï¼Œå€¼ä¸ºå­—å…¸æˆ–è€…åˆ—è¡¨ã€‚</li><li><code>scoring=None</code>ï¼šæ¨¡å‹è¯„ä»·æ ‡å‡†ï¼Œé»˜è®¤ <code>None</code>ã€‚è¿™æ—¶éœ€è¦ä½¿ç”¨ <code>score</code> å‡½æ•°ï¼Œæ ¹æ®æ‰€é€‰æ¨¡å‹ä¸åŒï¼Œè¯„ä»·å‡†åˆ™ä¸åŒã€‚</li><li><code>n_jobs</code>ï¼šå¹¶è¡Œæ•°ï¼Œ<code>-1</code> è·Ÿ <code>CPU</code> æ ¸æ•°ä¸€è‡´ã€‚</li></ul><hr><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>æœºå™¨å­¦ä¹ æ€»ä½“æ¥è¯´ä¸åƒç¼–ç¨‹éœ€è¦å¾ˆå¼ºçš„è®¡ç®—æœºåŸºç¡€çŸ¥è¯†ï¼Œä½†é¢å¤–éœ€è¦äº†è§£ä¸šåŠ¡æ–¹é¢çš„çŸ¥è¯†ä»¥åŠå¯¹æ‰€ä½¿ç”¨åŒ…çš„ç†Ÿæ‚‰ç¨‹åº¦ï¼Œå› æ­¤è¿˜æ˜¯é‚£å¥è€è¯â€œ<strong>å®è·µå‡ºçœŸçŸ¥</strong>â€ã€‚</p><hr><h3 id="å¼•ç”¨"><a href="#å¼•ç”¨" class="headerlink" title="å¼•ç”¨"></a>å¼•ç”¨</h3><hr><h3 id="ä¸ªäººå¤‡æ³¨"><a href="#ä¸ªäººå¤‡æ³¨" class="headerlink" title="ä¸ªäººå¤‡æ³¨"></a>ä¸ªäººå¤‡æ³¨</h3><p><strong>æ­¤åšå®¢å†…å®¹å‡ä¸ºä½œè€…å­¦ä¹ æ‰€åšç¬”è®°ï¼Œä¾µåˆ ï¼</strong><br><strong>è‹¥è½¬ä½œå…¶ä»–ç”¨é€”ï¼Œè¯·æ³¨æ˜æ¥æºï¼</strong></p>]]></content>
    
    
    <summary type="html">&lt;h3 id=&quot;æ•°æ®ç®€ä»‹&quot;&gt;&lt;a href=&quot;#æ•°æ®ç®€ä»‹&quot; class=&quot;headerlink&quot; title=&quot;æ•°æ®ç®€ä»‹&quot;&gt;&lt;/a&gt;æ•°æ®ç®€ä»‹&lt;/h3&gt;&lt;p&gt;è¯¥æ•°æ®é›†æœ€åˆæ¥è‡ªç³–å°¿ç—…&amp;#x2F;æ¶ˆåŒ–&amp;#x2F;è‚¾è„ç–¾ç—…ç ”ç©¶æ‰€ï¼Œæ­¤&lt;a href=&quot;https://www.kaggle.com/datasets/uciml/pima-indians-diabetes-database&quot;&gt;æ•°æ®é›†&lt;/a&gt;çš„ç›®æ ‡æ˜¯åŸºäºæ•°æ®é›†ä¸­åŒ…å«çš„æŸäº›èº«ä½“æŒ‡æ ‡æ¥è¯Šæ–­æ€§çš„é¢„æµ‹æ‚£è€…æ˜¯å¦æ‚£æœ‰ç³–å°¿ç—…ã€‚&lt;br&gt;æ•°æ®é›†ç”±å¤šä¸ªåŒ»å­¦æŒ‡æ ‡å’Œä¸€ä¸ªç›®æ ‡å˜é‡ &lt;code&gt;Outcome&lt;/code&gt; ç»„æˆï¼ŒåŒ»å­¦æŒ‡æ ‡åŒ…å«æ‚£è€…çš„æ€€å­•æ¬¡æ•°ã€&lt;code&gt;BMI&lt;/code&gt; æŒ‡æ•°ã€èƒ°å²›ç´ æ°´å¹³ã€å¹´é¾„ã€è¡€å‹ç­‰ã€‚&lt;/p&gt;</summary>
    
    
    
    
    <category term="ML" scheme="https://blog.vgbhfive.cn/tags/ML/"/>
    
  </entry>
  
  <entry>
    <title>Docker install jupyter-notebook</title>
    <link href="https://blog.vgbhfive.cn/Docker-install-jupyter-notebook/"/>
    <id>https://blog.vgbhfive.cn/Docker-install-jupyter-notebook/</id>
    <published>2023-06-23T03:31:59.000Z</published>
    <updated>2023-06-23T04:13:23.268Z</updated>
    
    <content type="html"><![CDATA[<h3 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h3><p><code>Jupyter Notebook</code> æ˜¯ä¸€ä¸ªå¼€æºçš„ <code>Web</code> åº”ç”¨ç¨‹åºï¼Œå…è®¸ç”¨æˆ·åˆ›å»ºå’Œå…±äº«åŒ…å«ä»£ç ã€æ–¹ç¨‹å¼ã€å¯è§†åŒ–å’Œæ–‡æœ¬çš„æ–‡æ¡£ã€‚ä¸»è¦ç”¨äº <strong>æ•°æ®æ¸…ç†å’Œè½¬æ¢</strong>ã€<strong>æ•°å€¼æ¨¡æ‹Ÿ</strong>ã€<strong>ç»Ÿè®¡å»ºæ¨¡</strong>ã€<strong>æ•°æ®å¯è§†åŒ–</strong>ã€<strong>æœºå™¨å­¦ä¹ </strong> ç­‰ç­‰ã€‚<br>å…·æœ‰ä»¥ä¸‹ä¼˜åŠ¿ï¼š</p><ul><li>å¯é€‰æ‹©è¯­è¨€ï¼šæ”¯æŒè¶…è¿‡ <code>40</code> ç§ç¼–ç¨‹è¯­è¨€ï¼ŒåŒ…æ‹¬ <code>Python</code>ã€<code>R</code>ã€<code>Julia</code>ã€<code>Scala</code> ç­‰ã€‚</li><li>åˆ†äº«ç¬”è®°æœ¬ï¼šå¯ä»¥ä½¿ç”¨ç”µå­é‚®ä»¶ã€<code>Dropbox</code>ã€<code>GitHub</code> å’Œ <code>Jupyter Notebook Viewer</code> ä¸ä»–äººå…±äº«ã€‚</li><li>äº¤äº’å¼è¾“å‡ºï¼šä»£ç å¯ä»¥ç”Ÿæˆä¸°å¯Œçš„äº¤äº’å¼è¾“å‡ºï¼ŒåŒ…æ‹¬ <code>HTML</code>ã€å›¾åƒã€è§†é¢‘ã€<code>LaTeX</code> ç­‰ç­‰ã€‚</li><li>å¤§æ•°æ®æ•´åˆï¼šé€šè¿‡ <code>Python</code>ã€<code>R</code>ã€<code>Scala</code> ç¼–ç¨‹è¯­è¨€ä½¿ç”¨ <code>Apache Spark</code> ç­‰å¤§æ•°æ®æ¡†æ¶å·¥å…·ã€‚æ”¯æŒä½¿ç”¨ <code>pandas</code>ã€<code>scikit-learn</code>ã€<code>ggplot2</code>ã€<code>TensorFlow</code> æ¥æ¢ç´¢åŒä¸€ä»½æ•°æ®ã€‚</li></ul><span id="more"></span><hr><h3 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h3><h4 id="æŸ¥æ‰¾é•œåƒ"><a href="#æŸ¥æ‰¾é•œåƒ" class="headerlink" title="æŸ¥æ‰¾é•œåƒ"></a>æŸ¥æ‰¾é•œåƒ</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">docker search jupyter</span></span><br><span class="line">NAME                                 DESCRIPTION                                     STARS     OFFICIAL   AUTOMATED</span><br><span class="line">jupyter/scipy-notebook               Scientific Jupyter Notebook Python Stack froâ€¦   404</span><br><span class="line">jupyter/tensorflow-notebook          Scientific Jupyter Notebook Python Stack w/ â€¦   344</span><br><span class="line">jupyter/all-spark-notebook           Python, Scala, R and Spark Jupyter Notebook â€¦   417</span><br><span class="line">jupyter/pyspark-notebook             Python and Spark Jupyter Notebook Stack fromâ€¦   277</span><br><span class="line">jupyter/datascience-notebook         Data Science Jupyter Notebook Python Stack fâ€¦   1027</span><br><span class="line">jupyterhub/singleuser                single-user docker images for use with Jupytâ€¦   45                   [OK]</span><br><span class="line">jupyterhub/jupyterhub                JupyterHub: multi-user Jupyter notebook servâ€¦   326                  [OK]</span><br><span class="line">jupyter/minimal-notebook             Minimal Jupyter Notebook Python Stack from hâ€¦   183</span><br><span class="line">jupyter/base-notebook                Base image for Jupyter Notebook stacks from â€¦   203</span><br><span class="line">jupyterhub/k8s-hub                                                                   22</span><br><span class="line">jupyterhub/k8s-network-tools                                                         2</span><br><span class="line">jupyterhub/configurable-http-proxy   node-http-proxy + REST API                      6                    [OK]</span><br><span class="line">jupyter/nbviewer                     Jupyter Notebook Viewer                         32                   [OK]</span><br><span class="line">jupyterhub/k8s-singleuser-sample                                                     10</span><br><span class="line">jupyter/r-notebook                   R Jupyter Notebook Stack from https://githubâ€¦   54</span><br><span class="line">jupyterhub/k8s-image-awaiter                                                         2</span><br><span class="line">jupyter/repo2docker                  Turn git repositories into Jupyter enabled Dâ€¦   21</span><br><span class="line">jupyterhub/k8s-secret-sync                                                           1</span><br><span class="line">jupyterhub/jupyterhub-onbuild        onbuild version of JupyterHub images            6</span><br><span class="line">jupyter/demo                         (DEPRECATED) Demo of the IPython/Jupyter Notâ€¦   16</span><br><span class="line">bitnami/jupyter-base-notebook                                                        39</span><br><span class="line">jupyterhub/k8s-image-cleaner                                                         1</span><br><span class="line">jupyterhub/k8s-binderhub                                                             3</span><br><span class="line">jupyterhub/k8s-pre-puller                                                            1</span><br><span class="line">bitnami/jupyterhub                                                                   18</span><br></pre></td></tr></table></figure><h4 id="æ‹‰å–é•œåƒ"><a href="#æ‹‰å–é•œåƒ" class="headerlink" title="æ‹‰å–é•œåƒ"></a>æ‹‰å–é•œåƒ</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">dockcer pull jupyter/datascience-notebook</span></span><br><span class="line">Using default tag: latest</span><br><span class="line">latest: Pulling from jupyter/datascience-notebook</span><br><span class="line">d5fd17ec1767: Pull complete </span><br><span class="line">9288915018bc: Pull complete </span><br><span class="line">ad895732ee5c: Pull complete </span><br><span class="line">4f4fb700ef54: Pull complete </span><br><span class="line">7b053b0d567d: Pull complete </span><br><span class="line">577d6f3bb6f4: Pull complete </span><br><span class="line">1d18b5a5f242: Pull complete </span><br><span class="line">ffc9ad0a0b36: Pull complete </span><br><span class="line">75f3e04b1547: Pull complete </span><br><span class="line">e9036ae1aec3: Pull complete </span><br><span class="line">8016e50184c6: Pull complete </span><br><span class="line">55f4c93ee7b8: Pull complete </span><br><span class="line">17c3e54db24b: Pull complete </span><br><span class="line">e8c81a9b6c9a: Pull complete</span><br><span class="line">530f1db1e9d7: Pull complete </span><br><span class="line">44fa9360bdc5: Pull complete </span><br><span class="line">6f59df66069f: Pull complete </span><br><span class="line">a8c1c1bcf1d4: Pull complete </span><br><span class="line">5784e3ca1d66: Pull complete </span><br><span class="line">60e2c9b0e0a4: Pull complete </span><br><span class="line">4866b0f6598a: Pull complete </span><br><span class="line">613fc67c0714: Pull complete </span><br><span class="line">2a41639ceb55: Pull complete </span><br><span class="line">fa391f2a4b79: Pull complete </span><br><span class="line">Digest: sha256:acd52864dd364e2e5c494ccefa661e6f58f551c9006ec7263d7b5afd5d1852e9</span><br><span class="line">Status: Downloaded newer image for jupyter/datascience-notebook:latest</span><br><span class="line">docker.io/jupyter/datascience-notebook:latest</span><br></pre></td></tr></table></figure><h4 id="å¯åŠ¨é•œåƒ"><a href="#å¯åŠ¨é•œåƒ" class="headerlink" title="å¯åŠ¨é•œåƒ"></a>å¯åŠ¨é•œåƒ</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">docker run -d -p 8000:8888 â€“name jupyter-notebook jupyter/datascience-notebook</span></span><br><span class="line">xxxxxxxxx</span><br></pre></td></tr></table></figure><h4 id="éƒ¨ç½²ä»£ç†"><a href="#éƒ¨ç½²ä»£ç†" class="headerlink" title="éƒ¨ç½²ä»£ç†"></a>éƒ¨ç½²ä»£ç†</h4><p>æœåŠ¡éƒ¨ç½²å®Œæ¯•åï¼Œé€šè¿‡ <code>Nginx</code> åå‘ä»£ç†åˆ°å…¬ç½‘è®¿é—®ï¼Œä¸‹é¢æ˜¯ç¤ºä¾‹é…ç½®ã€‚</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    listen          80;</span><br><span class="line">    server_name     jupyter.vgbhfive.com;</span><br><span class="line">    index           index.html;</span><br><span class="line"></span><br><span class="line">    location / &#123;</span><br><span class="line">        proxy_pass      http://127.0.0.1:8000;</span><br><span class="line">        proxy_set_header Host http://127.0.0.1:8000;</span><br><span class="line">        proxy_set_header X-Real-IP $remote_addr;</span><br><span class="line">        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    location ~ /api/kernels/ &#123;</span><br><span class="line">        proxy_pass            http://127.0.0.1:8000;</span><br><span class="line">        proxy_set_header      Host $host;</span><br><span class="line"></span><br><span class="line">        proxy_http_version    1.1;  # websocket support</span><br><span class="line">        proxy_set_header      Upgrade &quot;websocket&quot;;</span><br><span class="line">        proxy_set_header      Connection &quot;Upgrade&quot;;</span><br><span class="line">        proxy_read_timeout    86400;</span><br><span class="line">    &#125;</span><br><span class="line">    location ~ /terminals/ &#123;</span><br><span class="line">        proxy_pass            http://127.0.0.1:8000;</span><br><span class="line">        proxy_set_header      Host $host;</span><br><span class="line"></span><br><span class="line">        proxy_http_version    1.1;  # websocket support</span><br><span class="line">        proxy_set_header      Upgrade &quot;websocket&quot;;</span><br><span class="line">        proxy_set_header      Connection &quot;Upgrade&quot;;</span><br><span class="line">        proxy_read_timeout    86400;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="é¡µé¢è®¿é—®"><a href="#é¡µé¢è®¿é—®" class="headerlink" title="é¡µé¢è®¿é—®"></a>é¡µé¢è®¿é—®</h4><img src="/Docker-install-jupyter-notebook/docker-1111.png" class="" title="docker-1111"><p>ç¬¬ä¸€æ¬¡è®¿é—®å»ºè®®é€šè¿‡ <code>Token</code> è®¿é—®å¹¶è®¾ç½®ï¼Œä¹‹åå°±åªéœ€è¦å¯†ç å³å¯è¿›å…¥ã€‚</p><hr><h3 id="ç–‘é—®"><a href="#ç–‘é—®" class="headerlink" title="ç–‘é—®"></a>ç–‘é—®</h3><h4 id="403-GET-api-kernels"><a href="#403-GET-api-kernels" class="headerlink" title="403 GET /api/kernels"></a><code>403 GET /api/kernels</code></h4><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[W 2023-06-21 08:28:50.567 ServerApp] 403 GET /api/contents/demo.ipynb/checkpoints?1687335545679 (@172.17.0.1) 1.28ms referer=http://jupyter.vgbhfive.com/lab/tree/demo.ipynb</span><br><span class="line">[I 2023-06-21 08:32:19.956 ServerApp] Connecting to kernel 66e74bf7-4e19-40cc-8437-1eb43b35e208.</span><br><span class="line">[I 2023-06-21 08:32:19.956 ServerApp] Restoring connection for 66e74bf7-4e19-40cc-8437-1eb43b35e208:35bb8ace-627e-4574-b476-08fae23ccaa5</span><br><span class="line">[W 2023-06-21 08:33:49.957 ServerApp] WebSocket ping timeout after 90000 ms.</span><br><span class="line">[I 2023-06-21 08:33:54.961 ServerApp] Starting buffering for 66e74bf7-4e19-40cc-8437-1eb43b35e208:35bb8ace-627e-4574-b476-08fae23ccaa5</span><br><span class="line">[W 2023-06-21 08:34:04.639 ServerApp] wrote error: &#x27;Forbidden&#x27;</span><br><span class="line">    Traceback (most recent call last):</span><br><span class="line">      File &quot;/opt/conda/lib/python3.11/site-packages/tornado/web.py&quot;, line 1784, in _execute</span><br><span class="line">        result = method(*self.path_args, **self.path_kwargs)</span><br><span class="line">                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^</span><br><span class="line">      File &quot;/opt/conda/lib/python3.11/site-packages/tornado/web.py&quot;, line 3278, in wrapper</span><br><span class="line">        url = self.get_login_url()</span><br><span class="line">              ^^^^^^^^^^^^^^^^^^^^</span><br><span class="line">      File &quot;/opt/conda/lib/python3.11/site-packages/jupyter_server/base/handlers.py&quot;, line 753, in get_login_url</span><br><span class="line">        raise web.HTTPError(403)</span><br><span class="line">    tornado.web.HTTPError: HTTP 403: Forbidden</span><br></pre></td></tr></table></figure><p>æ ¹æ® <code>403</code> çŠ¶æ€ç çš„è§£é‡Šï¼ŒæœåŠ¡å™¨å·²ç»è§£æè¯·æ±‚ä½†æ²¡æœ‰æƒé™è®¿é—®èµ„æºï¼Œé‚£ä¹ˆé—®é¢˜å°±æ¥äº†ï¼Œåœ¨æŸ¥äº†æ— æ•°èµ„æ–™ä¹‹åï¼Œçœ‹åˆ°äº†è¿™ä¸ªä¸œè¥¿ï¼š</p><img src="/Docker-install-jupyter-notebook/docker-2222.png" class="" title="docker-2222"><p>è¯¥é—®é¢˜æ˜¯ç”±äºåœ¨ <code>Nginx</code> ä»£ç†è¯·æ±‚æ—¶ï¼Œå°†æ‰€æœ‰çš„è¯·æ±‚ä»£ç†ä¸º <code>HTTP</code> è¯·æ±‚ï¼Œè€Œ <code>Jupyter Notebook</code> çš„éƒ¨åˆ†è¯·æ±‚ä¸º <code>WebSocket</code>ï¼Œä»è€Œå¯¼è‡´è¯·æ±‚å¼‚å¸¸ï¼Œä¿®æ”¹ <code>Nginx</code> ä»£ç†ä¹‹åé—®é¢˜å°±è¿åˆƒè€Œè§£ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">location ~ /api/kernels/ &#123;</span><br><span class="line">    proxy_pass            http://127.0.0.1:8000;</span><br><span class="line">    proxy_set_header      Host $host;</span><br><span class="line"></span><br><span class="line">    proxy_http_version    1.1;  # websocket support</span><br><span class="line">    proxy_set_header      Upgrade &quot;websocket&quot;;</span><br><span class="line">    proxy_set_header      Connection &quot;Upgrade&quot;;</span><br><span class="line">    proxy_read_timeout    86400;</span><br><span class="line">&#125;</span><br><span class="line">location ~ /terminals/ &#123;</span><br><span class="line">    proxy_pass            http://127.0.0.1:8000;</span><br><span class="line">    proxy_set_header      Host $host;</span><br><span class="line"></span><br><span class="line">    proxy_http_version    1.1;  # websocket support</span><br><span class="line">    proxy_set_header      Upgrade &quot;websocket&quot;;</span><br><span class="line">    proxy_set_header      Connection &quot;Upgrade&quot;;</span><br><span class="line">    proxy_read_timeout    86400;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h3 id="å¼•ç”¨"><a href="#å¼•ç”¨" class="headerlink" title="å¼•ç”¨"></a>å¼•ç”¨</h3><p><a href="https://stackoverflow.com/questions/76094881/jupyter-docker-image-kernel-disconnected-400-apache-proxy">Jupyter Docker Image Kernel Disconnected 400 Apache Proxy</a></p><hr><h3 id="ä¸ªäººå¤‡æ³¨"><a href="#ä¸ªäººå¤‡æ³¨" class="headerlink" title="ä¸ªäººå¤‡æ³¨"></a>ä¸ªäººå¤‡æ³¨</h3><p><strong>æ­¤åšå®¢å†…å®¹å‡ä¸ºä½œè€…å­¦ä¹ æ‰€åšç¬”è®°ï¼Œä¾µåˆ ï¼</strong><br><strong>è‹¥è½¬ä½œå…¶ä»–ç”¨é€”ï¼Œè¯·æ³¨æ˜æ¥æºï¼</strong></p>]]></content>
    
    
    <summary type="html">&lt;h3 id=&quot;ç®€ä»‹&quot;&gt;&lt;a href=&quot;#ç®€ä»‹&quot; class=&quot;headerlink&quot; title=&quot;ç®€ä»‹&quot;&gt;&lt;/a&gt;ç®€ä»‹&lt;/h3&gt;&lt;p&gt;&lt;code&gt;Jupyter Notebook&lt;/code&gt; æ˜¯ä¸€ä¸ªå¼€æºçš„ &lt;code&gt;Web&lt;/code&gt; åº”ç”¨ç¨‹åºï¼Œå…è®¸ç”¨æˆ·åˆ›å»ºå’Œå…±äº«åŒ…å«ä»£ç ã€æ–¹ç¨‹å¼ã€å¯è§†åŒ–å’Œæ–‡æœ¬çš„æ–‡æ¡£ã€‚ä¸»è¦ç”¨äº &lt;strong&gt;æ•°æ®æ¸…ç†å’Œè½¬æ¢&lt;/strong&gt;ã€&lt;strong&gt;æ•°å€¼æ¨¡æ‹Ÿ&lt;/strong&gt;ã€&lt;strong&gt;ç»Ÿè®¡å»ºæ¨¡&lt;/strong&gt;ã€&lt;strong&gt;æ•°æ®å¯è§†åŒ–&lt;/strong&gt;ã€&lt;strong&gt;æœºå™¨å­¦ä¹ &lt;/strong&gt; ç­‰ç­‰ã€‚&lt;br&gt;å…·æœ‰ä»¥ä¸‹ä¼˜åŠ¿ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¯é€‰æ‹©è¯­è¨€ï¼šæ”¯æŒè¶…è¿‡ &lt;code&gt;40&lt;/code&gt; ç§ç¼–ç¨‹è¯­è¨€ï¼ŒåŒ…æ‹¬ &lt;code&gt;Python&lt;/code&gt;ã€&lt;code&gt;R&lt;/code&gt;ã€&lt;code&gt;Julia&lt;/code&gt;ã€&lt;code&gt;Scala&lt;/code&gt; ç­‰ã€‚&lt;/li&gt;
&lt;li&gt;åˆ†äº«ç¬”è®°æœ¬ï¼šå¯ä»¥ä½¿ç”¨ç”µå­é‚®ä»¶ã€&lt;code&gt;Dropbox&lt;/code&gt;ã€&lt;code&gt;GitHub&lt;/code&gt; å’Œ &lt;code&gt;Jupyter Notebook Viewer&lt;/code&gt; ä¸ä»–äººå…±äº«ã€‚&lt;/li&gt;
&lt;li&gt;äº¤äº’å¼è¾“å‡ºï¼šä»£ç å¯ä»¥ç”Ÿæˆä¸°å¯Œçš„äº¤äº’å¼è¾“å‡ºï¼ŒåŒ…æ‹¬ &lt;code&gt;HTML&lt;/code&gt;ã€å›¾åƒã€è§†é¢‘ã€&lt;code&gt;LaTeX&lt;/code&gt; ç­‰ç­‰ã€‚&lt;/li&gt;
&lt;li&gt;å¤§æ•°æ®æ•´åˆï¼šé€šè¿‡ &lt;code&gt;Python&lt;/code&gt;ã€&lt;code&gt;R&lt;/code&gt;ã€&lt;code&gt;Scala&lt;/code&gt; ç¼–ç¨‹è¯­è¨€ä½¿ç”¨ &lt;code&gt;Apache Spark&lt;/code&gt; ç­‰å¤§æ•°æ®æ¡†æ¶å·¥å…·ã€‚æ”¯æŒä½¿ç”¨ &lt;code&gt;pandas&lt;/code&gt;ã€&lt;code&gt;scikit-learn&lt;/code&gt;ã€&lt;code&gt;ggplot2&lt;/code&gt;ã€&lt;code&gt;TensorFlow&lt;/code&gt; æ¥æ¢ç´¢åŒä¸€ä»½æ•°æ®ã€‚&lt;/li&gt;
&lt;/ul&gt;</summary>
    
    
    
    
    <category term="Docker" scheme="https://blog.vgbhfive.cn/tags/Docker/"/>
    
    <category term="Day" scheme="https://blog.vgbhfive.cn/tags/Day/"/>
    
  </entry>
  
  <entry>
    <title>åŒ—äº¬åŒä»åŒ»é™¢éªŒå…‰æ”»ç•¥</title>
    <link href="https://blog.vgbhfive.cn/%E5%8C%97%E4%BA%AC%E5%90%8C%E4%BB%81%E5%8C%BB%E9%99%A2%E9%AA%8C%E5%85%89%E6%94%BB%E7%95%A5/"/>
    <id>https://blog.vgbhfive.cn/%E5%8C%97%E4%BA%AC%E5%90%8C%E4%BB%81%E5%8C%BB%E9%99%A2%E9%AA%8C%E5%85%89%E6%94%BB%E7%95%A5/</id>
    <published>2023-06-22T04:33:02.000Z</published>
    <updated>2023-06-23T03:31:28.743Z</updated>
    
    <content type="html"><![CDATA[<h3 id="å‰è¦ç®€ä»‹"><a href="#å‰è¦ç®€ä»‹" class="headerlink" title="å‰è¦ç®€ä»‹"></a>å‰è¦ç®€ä»‹</h3><ol><li>é¦–éƒ½åŒ»ç§‘å¤§å­¦é™„å±åŒ—äº¬åŒä»åŒ»é™¢å§‹å»ºäº <code>1886</code> å¹´ï¼Œæ˜¯ä¸€æ‰€ä»¥çœ¼ç§‘å­¦ã€è€³é¼»å’½å–‰ç§‘å­¦ä¸ºå›½å®¶é‡ç‚¹å­¦ç§‘çš„å¤§å‹ç»¼åˆä¸‰ç”²åŒ»é™¢ï¼Œå¯¹äºçœ¼ç§‘ç›¸å…³ç»å¯¹æ˜¯æƒå¨ä¸“ä¸šã€‚</li><li>ä¸€èˆ¬çš„çœ¼é•œåº—å¯¹äºåªéªŒå…‰ä¸é…é•œçš„é¡¾å®¢æœ‰å¤šå¤šå°‘å°‘çš„æŠµè§¦ã€‚</li><li>é•œç‰‡å’Œé•œæ¡†éœ€è¦å•ç‹¬åœ¨ç½‘ä¸Šè´­ä¹°ï¼Œæ¥ç€æ‰¾çœ¼é•œåº—å¸®å¿™ç»„è£…ï¼Œå¯ä»¥æœ€å¤§åŒ–ä¿è¯é’±èŠ±åœ¨åˆ€åˆƒä¸Šã€‚</li></ol><span id="more"></span><hr><h3 id="é¢„çº¦æŒ‚å·"><a href="#é¢„çº¦æŒ‚å·" class="headerlink" title="é¢„çº¦æŒ‚å·"></a>é¢„çº¦æŒ‚å·</h3><ol><li><p>å¾®ä¿¡å…¬ä¼—å·æœç´¢ <strong>åŒ—äº¬åŒä»éªŒå…‰é…é•œä¸­å¿ƒæœåŠ¡å·</strong> å¹¶å…³æ³¨ï¼Œè¯¥æœºæ„æ˜¯åŒä»åŒ»é™¢ä¸‹å±çš„è¥ä¸šæ€§æœºæ„ï¼Œå…¶ä¸“ä¸šæ€§å’Œè§„èŒƒæ€§ç”±åŒä»åŒ»é™¢ä¿è¯ï¼Œå¯ä»¥æ”¾å¿ƒã€‚</p></li><li><p>ç‚¹å‡»å…¬ä¼—å·çš„å³ä¸‹è§’ <strong>éªŒå…‰æœåŠ¡</strong>ï¼Œé¦–æ¬¡é¢„çº¦ä¼šå…ˆå¡«ä¸€ä¸ªé¢„çº¦äººçš„ä¿¡æ¯ï¼Œå¡«å†™å®Œæ¯•åé€‰æ‹©å¯¹åº”çš„é¢„çº¦äººï¼Œæ¥ä¸‹æ¥å°±æ˜¯é€‰æ‹©åº—é“ºï¼Œæ¨è <strong>ä¸­å¿ƒåº—</strong> å³å¯ã€‚</p></li><li><p>ç´§è·Ÿç€æ ¹æ®è‡ªå·±çš„æ—¥æœŸè§„åˆ’é€‰æ‹©å¯¹åº”çš„ <strong>è§†å…‰æœåŠ¡è´¹W</strong>ï¼Œåœ¨å®Œæˆç¼´è´¹åå³é¢„çº¦æˆåŠŸã€‚</p></li></ol><hr><h3 id="è¡Œç¨‹"><a href="#è¡Œç¨‹" class="headerlink" title="è¡Œç¨‹"></a>è¡Œç¨‹</h3><p>ç›®çš„åœ°ä½äº <code>2</code> å·çº¿å’Œ <code>5</code> å·çº¿çš„æ¢ä¹˜åœ°é“ç«™ <strong>å´‡æ–‡é—¨åœ°é“ç«™</strong>ï¼Œåˆ°ç«™åä» <strong><code>E</code></strong> å£å‡ºæˆ˜ï¼Œå‡ºç«™å <strong>ç«™å£æ–¹å‘è¿‡é©¬è·¯ï¼ˆä¸è¿‡å¤©æ¡¥ï¼‰ç›´è¡Œ <code>100</code> ç±³</strong> å°±æ˜¯ç›®çš„åœ°ã€‚</p><img src="/%E5%8C%97%E4%BA%AC%E5%90%8C%E4%BB%81%E5%8C%BB%E9%99%A2%E9%AA%8C%E5%85%89%E6%94%BB%E7%95%A5/111.png" class="" title="111.png"><hr><h3 id="éªŒå…‰æµç¨‹"><a href="#éªŒå…‰æµç¨‹" class="headerlink" title="éªŒå…‰æµç¨‹"></a>éªŒå…‰æµç¨‹</h3><ol><li><p>å–å·<br>è¿›é—¨ä¹‹ååƒæ˜¯ä¸€ä¸ªçœ¼é•œåº—ï¼Œæ­¤æ—¶ä¸è¦æ…Œï¼Œåœ¨é—¨å£å·¦ä¾§å’Œæ­£é¢å‡æœ‰ä¸€å° <strong>å–å·æœº</strong>ï¼Œä½¿ç”¨å…¬ä¼—å·å‘ç»™ä½ çš„äºŒç»´ç å–å·å³å¯ã€‚</p></li><li><p>åˆæ­¥æµ‹è¯•<br>åœ¨æµ‹è¯•å®Œæˆåï¼Œåœ¨è¿›é—¨çš„å·¦ä¾§æœ‰ä¸€ä¸ª <strong>æœåŠ¡å°</strong>ï¼Œåˆ°è¾¾æœåŠ¡å°å°†å·ç ç»™å·¥ä½œäººå‘˜ï¼Œå¯¹æ–¹ä¼šè®©ä½ å»éªŒä¸€ä¸‹ <strong>çœ¼é•œåº¦æ•°</strong> å’Œ <strong>åˆæ­¥æœºå™¨éªŒå…‰æµ‹è¯•</strong>ï¼Œè¿™é‡Œæ ¹æ®æµç¨‹èµ°å°±å¯ä»¥ã€‚</p></li><li><p>äººå·¥éªŒå…‰<br>åœ¨å®Œæˆä¸Šè¿°æµ‹è¯•åï¼Œä¼šæœ‰å·¥ä½œäººå‘˜ç»™ä½ ä¸€ä¸ªå·ç ï¼Œæ‹¿ç€å·ç åˆ°éªŒå…‰å¤„ç­‰åˆ°å«å·å³å¯ã€‚<br><strong>äººå·¥éªŒå…‰</strong> ä¼šæŒç»­å¤§æ¦‚ <code>20~30</code> åˆ†é’Ÿå·¦å³ï¼Œä¼šç®€å•è¯¢é—®ä¸‹ä¸ªäººæƒ…å†µã€ç”¨çœ¼ä¹ æƒ¯ã€ç”¨çœ¼åœºæ™¯ç­‰æƒ…å†µï¼ŒæŒ‰ç…§ä¸ªäººæƒ…å†µå¦‚å®è¯´æ˜å³å¯ï¼Œå¦‚æœçœ¼ç›æœ‰ç›¸å…³å°±è¯Šç»å†ä¹Ÿå¯ä»¥è¯´æ˜ã€‚</p></li><li><p>å®Œæˆ<br>åœ¨éªŒå…‰å®Œæˆåï¼Œå¯¹æ–¹ä¼šç»™ä½ ä¸€ä¸ªå•å­ï¼Œç„¶åå‘ŠçŸ¥ä½ é…é•œçš„æ³¨æ„äº‹é¡¹ï¼Œåœ¨æ‹¿åˆ°å•å­åå°±å¯ä»¥èµ°äººäº†ã€‚</p></li></ol>]]></content>
    
    
    <summary type="html">&lt;h3 id=&quot;å‰è¦ç®€ä»‹&quot;&gt;&lt;a href=&quot;#å‰è¦ç®€ä»‹&quot; class=&quot;headerlink&quot; title=&quot;å‰è¦ç®€ä»‹&quot;&gt;&lt;/a&gt;å‰è¦ç®€ä»‹&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;é¦–éƒ½åŒ»ç§‘å¤§å­¦é™„å±åŒ—äº¬åŒä»åŒ»é™¢å§‹å»ºäº &lt;code&gt;1886&lt;/code&gt; å¹´ï¼Œæ˜¯ä¸€æ‰€ä»¥çœ¼ç§‘å­¦ã€è€³é¼»å’½å–‰ç§‘å­¦ä¸ºå›½å®¶é‡ç‚¹å­¦ç§‘çš„å¤§å‹ç»¼åˆä¸‰ç”²åŒ»é™¢ï¼Œå¯¹äºçœ¼ç§‘ç›¸å…³ç»å¯¹æ˜¯æƒå¨ä¸“ä¸šã€‚&lt;/li&gt;
&lt;li&gt;ä¸€èˆ¬çš„çœ¼é•œåº—å¯¹äºåªéªŒå…‰ä¸é…é•œçš„é¡¾å®¢æœ‰å¤šå¤šå°‘å°‘çš„æŠµè§¦ã€‚&lt;/li&gt;
&lt;li&gt;é•œç‰‡å’Œé•œæ¡†éœ€è¦å•ç‹¬åœ¨ç½‘ä¸Šè´­ä¹°ï¼Œæ¥ç€æ‰¾çœ¼é•œåº—å¸®å¿™ç»„è£…ï¼Œå¯ä»¥æœ€å¤§åŒ–ä¿è¯é’±èŠ±åœ¨åˆ€åˆƒä¸Šã€‚&lt;/li&gt;
&lt;/ol&gt;</summary>
    
    
    
    
    <category term="Day" scheme="https://blog.vgbhfive.cn/tags/Day/"/>
    
  </entry>
  
  <entry>
    <title>Hadoop-HBase</title>
    <link href="https://blog.vgbhfive.cn/Hadoop-HBase/"/>
    <id>https://blog.vgbhfive.cn/Hadoop-HBase/</id>
    <published>2023-05-28T04:31:42.000Z</published>
    <updated>2023-06-21T14:56:16.038Z</updated>
    
    <content type="html"><![CDATA[<h3 id="åŸºç¡€"><a href="#åŸºç¡€" class="headerlink" title="åŸºç¡€"></a>åŸºç¡€</h3><p><code>HBase</code> æ˜¯ä¸€ä¸ªåœ¨ <code>HDFS</code> ä¸Šå¼€å‘çš„<strong>é¢å‘åˆ—</strong>çš„<strong>åˆ†å¸ƒå¼æ•°æ®åº“</strong>ï¼Œå¦‚æœä½ éœ€è¦å®æ—¶è®¿é—®è¶…å¤§è§„æ¨¡çš„æ•°æ®é›†ï¼Œé‚£ä¹ˆä½¿ç”¨ <code>HBase</code> å°±å¯¹äº†ã€‚</p><p><code>HBase</code> <strong>è‡ªåº•è€Œä¸Š</strong>åœ°è¿›è¡Œæ„å»ºï¼Œå¯ä»¥ç®€å•çš„é€šè¿‡<strong>å¢åŠ èŠ‚ç‚¹æ¥çº¿æ€§æ‰©å±•</strong>ã€‚å…¶å¹¶ä¸æ˜¯å…³ç³»å‹æ•°æ®åº“ï¼Œå¹¶ä¸”ä¹Ÿä¸æ”¯æŒ <code>SQL</code>ï¼Œåœ¨ç‰¹å®šçš„ç©ºé—´é‡Œï¼Œèƒ½å¤Ÿåš <code>RDBMS</code> ä¸èƒ½åšçš„äº‹ï¼Œå³åœ¨å»‰ä»·çš„ç¡¬ä»¶æ„æˆçš„é›†ç¾¤ä¸Šç®¡ç†è¶…å¤§è§„æ¨¡çš„ç¨€ç–è¡¨ã€‚</p><span id="more"></span><h4 id="æ¦‚å¿µ"><a href="#æ¦‚å¿µ" class="headerlink" title="æ¦‚å¿µ"></a>æ¦‚å¿µ</h4><p>åº”ç”¨å°†æ•°æ®æ”¾åˆ°å¸¦æœ‰æ ‡ç­¾çš„è¡¨ä¸­ã€‚è€Œè¡¨æœ‰è¡Œå’Œåˆ—ç»„æˆï¼Œè¡¨çš„ <em>å•å…ƒæ ¼</em> ç”±è¡Œå’Œåˆ—çš„äº¤å‰å†³å®šï¼Œå…¶æ˜¯æœ‰ç‰ˆæœ¬çš„ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œç‰ˆæœ¬å·è‡ªåŠ¨åˆ†é…ï¼Œä¸º <code>HBase</code> æ’å…¥å•å…ƒæ ¼æ—¶çš„æ—¶é—´æˆ³ï¼Œå•å…ƒæ ¼çš„å†…å®¹æ˜¯æœªè§£é‡Šçš„å­—èŠ‚æ•°ç»„ã€‚</p><p>è¡¨ä¸­çš„è¡Œä¹Ÿæ˜¯å­—èŠ‚æ•°ç»„ï¼Œå› æ­¤ç†è®ºä¸Šä»»ä½•ä¸œè¥¿éƒ½å¯ä»¥é€šè¿‡è¡¨ç¤ºæˆå­—èŠ‚æ•°ç»„æˆ–è€…å°†äºŒè¿›åˆ¶å½¢å¼è½¬æ¢ä¸ºé•¿æ•´å‹æˆ–ç›´æ¥å¯¹æ•°æ®ç»“æ„è¿›è¡Œåºåˆ—åŒ–æ¥ä½œä¸ºé”®å€¼ã€‚è¡¨ä¸­çš„è¡Œæ ¹æ®è¡Œçš„é”®å€¼è¿›è¡Œæ’åºï¼Œæ’åºæ ¹æ®å­—èŠ‚åºè¿›è¡Œï¼Œæ‰€æœ‰å¯¹è¡¨çš„è®¿é—®éƒ½éœ€è¦é€šè¿‡è¡¨çš„ä¸»é”®ã€‚</p><img src="/Hadoop-HBase/hadoop-HBase-2.jpg" class="" title="Hadoop-HBase"><p>è¡Œä¸­çš„åˆ—è¢«åˆ†ä¸º<strong>åˆ—æ—ï¼ˆ<code>column family</code>ï¼‰</strong>ï¼ŒåŒä¸€ä¸ªåˆ—æ—çš„æ‰€æœ‰æˆå‘˜å…·æœ‰ç›¸åŒçš„å‰ç¼€ã€‚åˆ—æ—çš„å‰ç¼€å¿…é¡»ç”± <em>å¯æ‰“å°çš„</em> å­—ç¬¦ç»„æˆï¼Œè€Œä¿®é¥°æ€§çš„ç»“å°¾å­—ç¬¦ï¼Œå³åˆ—æ—ä¿®é¥°ç¬¦ï¼Œå¯ä»¥ä¸ºä»»æ„å­—èŠ‚ã€‚åˆ—æ—å’Œä¿®é¥°ç¬¦ä¹‹é—´å§‹ç»ˆä»¥å†’å·ï¼ˆ<code>:</code>ï¼‰åˆ†éš”ã€‚<br>ä¸€ä¸ªè¡¨çš„åˆ—æ—å¿…é¡»ä½œä¸ºè¡¨æ¨¡å¼å®šä¹‰çš„ä¸€éƒ¨åˆ†é¢„å…ˆç»™å‡ºï¼Œä½†æ˜¯æ–°çš„åˆ—æ—æˆå‘˜å¯ä»¥éšåæŒ‰éœ€åŠ å…¥ã€‚</p><p>åœ¨ç‰©ç†ä¸Šæ‰€æœ‰çš„åˆ—æ—æˆå‘˜éƒ½ä¸€èµ·å­˜æ”¾åœ¨æ–‡ä»¶ç³»ç»Ÿä¸­ï¼Œå› æ­¤ç»“åˆå‰é¢çš„å°† <code>HBase</code> æè¿°ä¸ºä¸€ä¸ªé¢å‘åˆ—çš„å­˜å‚¨å™¨ï¼Œå…¶æœ¬è´¨ä¸Šæ›´å‡†ç¡®çš„æ˜¯é¢å‘åˆ—æ—çš„å­˜å‚¨å™¨ã€‚<br>ä½†ç”±äºè°ƒä¼˜å’Œå­˜å‚¨éƒ½æ˜¯åœ¨åˆ—æ—è¿™ä¸ªç»´åº¦ä¸Šè¿›è¡Œï¼Œæ‰€ä»¥æ‰€æœ‰çš„åˆ—æ—æˆå‘˜å…·æœ‰ç›¸åŒçš„è®¿é—®æ¨¡å¼å’Œå¤§å°ç‰¹å¾æ˜¯æœ€ä¼˜è§£ã€‚å¯¹äºå­˜å‚¨è¾ƒå¤§å­—èŠ‚çš„æ•°æ®å’Œè¾ƒå°å­—èŠ‚çš„æ•°æ®æœ€å¥½åˆ†åˆ«å­˜å‚¨åœ¨ä¸åŒçš„åˆ—æ—ä¸­ã€‚</p><p>ç®€è€Œè¨€ä¹‹ï¼Œ<code>HBase</code> çš„è¡¨å’Œ <code>RDBMS</code> çš„è¡¨ç±»ä¼¼ï¼Œåªä¸è¿‡å…¶å•å…ƒæ ¼æœ‰ç‰ˆæœ¬ï¼›è¡Œæ˜¯æ’åºçš„ï¼›åªè¦åˆ—æ—æ˜¯é¢„å…ˆå­˜åœ¨çš„ï¼Œå®¢æˆ·ç«¯éšæ—¶å¯ä»¥å°†åˆ—æ·»åŠ è¿›å»ã€‚</p><h5 id="åŒºåŸŸ"><a href="#åŒºåŸŸ" class="headerlink" title="åŒºåŸŸ"></a>åŒºåŸŸ</h5><p><code>HBase</code> è‡ªåŠ¨å°†è¡¨æ°´å¹³åˆ’åˆ†ä¸º<strong>åŒºåŸŸï¼ˆ<code>region</code>ï¼‰</strong>ï¼Œæ¯ä¸ªåŒºåŸŸç”±è¡¨ä¸­è¡Œçš„å­é›†æ„æˆï¼Œæ¯ä¸ªåŒºåŸŸç”±æ‰€å±è¡¨ã€æ‰€åŒ…å«çš„ç¬¬ä¸€è¡ŒåŠæœ€åä¸€è¡Œæ¥è¡¨ç¤ºã€‚<br>ä»è¡¨å»ºç«‹ä¹‹åˆï¼Œä¸€ä¸ªè¡¨åªæœ‰ä¸€ä¸ªåŒºåŸŸï¼Œä½†éšç€æ•°æ®å¢å¤šï¼Œå…¶åŒºåŸŸä¹Ÿä¼šå¢å¤§ï¼ŒçŸ¥é“åŒºåŸŸè¶…è¿‡é˜ˆå€¼çš„ç•Œé™ï¼Œå°±ä¼šåœ¨æŸè¡Œçš„è¾¹ç•Œä¸Šå°†è¡¨åŒºåˆ†ä¸ºä¸¤ä¸ªå¤§å°ç›¸åŒçš„æ–°åˆ†åŒºã€‚</p><p>åŒºåŸŸæ˜¯ <code>HBase</code> é›†ç¾¤ä¸Šåˆ†å¸ƒæ•°æ®çš„æœ€å°å•ä½ï¼Œä½¿ç”¨è¿™ç§æ–¹å¼ä¸ä¼šå› ä¸ºæ•°æ®å¤ªå¤§è€Œæ— æ³•æ”¾ç½®åœ¨å•ä¸ªæœºå™¨ä¸Šçš„è¡¨ä¼šè¢«æ”¾åˆ°é›†ç¾¤ä¸­ï¼Œå…¶ä¸­é›†ç¾¤ä¸­çš„æ¯ä¸ªæœºå™¨è´Ÿè´£ç®¡ç†è¡¨æ‰€æœ‰åŒºåŸŸçš„ä¸€ä¸ªå­é›†ã€‚è€Œè¡¨çš„åŠ è½½ä¹Ÿæ˜¯ä½¿ç”¨è¿™ç§æ–¹æ³•å°†æ•°æ®åˆ†å¸ƒåˆ°å„ä¸ªèŠ‚ç‚¹ï¼Œé›†ç¾¤ä¸­æ‰€æœ‰çš„æœºå™¨ä¸Šçš„èŠ‚ç‚¹æŒ‰æ¬¡åºæ’åˆ—ä¹Ÿå°±æ„æˆäº†è¡¨çš„æ‰€æœ‰å†…å®¹ã€‚</p><h5 id="åŠ é”"><a href="#åŠ é”" class="headerlink" title="åŠ é”"></a>åŠ é”</h5><p>æ— è®ºå¯¹è¡Œè¿›è¡Œè®¿é—®çš„äº‹åŠ¡ç‰µæ¶‰åˆ°å¤šå°‘è¡Œï¼Œå¯¹è¡Œçš„æ›´æ–°éƒ½æ˜¯ <em>åŸå­çº§åˆ«</em>ã€‚</p><h4 id="ç‰¹æ€§"><a href="#ç‰¹æ€§" class="headerlink" title="ç‰¹æ€§"></a>ç‰¹æ€§</h4><ul><li><strong>æ²¡æœ‰çœŸæ­£çš„ç´¢å¼•</strong><br>  è¡Œæ˜¯é¡ºåºå­˜å‚¨çš„ï¼Œæ¯è¡Œä¸­çš„åˆ—ä¹Ÿæ˜¯ï¼Œæ‰€ä»¥ä¸å­˜åœ¨ç´¢å¼•è†¨èƒ€çš„é—®é¢˜ï¼Œè€Œä¸”æ’å…¥æ€§èƒ½å’Œè¡¨çš„å¤§å°æ— å…³ã€‚</li><li><strong>è‡ªåŠ¨åˆ†åŒº</strong><br>  åœ¨è¡¨å¢é•¿çš„æ—¶å€™ï¼Œè¡¨ä¼šè‡ªåŠ¨åˆ†è£‚æˆåŒºåŸŸï¼Œå¹¶åˆ†å¸ƒåˆ°å¯ç”¨çš„èŠ‚ç‚¹ä¸Šã€‚</li><li><strong>çº¿æ€§æ‰©å±•å’Œå¯¹äºæ–°èŠ‚ç‚¹çš„è‡ªåŠ¨å¤„ç†</strong><br>  å¢åŠ ä¸€ä¸ªèŠ‚ç‚¹å°†å®ƒæŒ‡å‘ç°æœ‰é›†ç¾¤å¹¶è¿è¡Œ <code>regionserver</code>ã€‚åŒºåŸŸä¼šè‡ªåŠ¨é‡æ–°è¿›è¡Œå¹³è¡¡ï¼Œè´Ÿè½½å‡åŒ€åˆ†å¸ƒã€‚</li><li>æ™®é€šå•†ç”¨ç¡¬ä»¶æ”¯æŒ</li><li><strong>å®¹é”™</strong><br>  å¤§é‡èŠ‚ç‚¹æ„å‘³ç€æ¯ä¸ªèŠ‚ç‚¹çš„é‡è¦æ€§å¹¶ä¸çªå‡ºï¼Œä¸ç”¨æ‹…å¿ƒå•ä¸ªèŠ‚ç‚¹å¤±æ•ˆã€‚</li><li><strong>æ‰¹å¤„ç†</strong><br>  <code>MapReduce</code> é›†æˆåŠŸèƒ½ä½¿ç”¨å…¨å¹¶è¡Œçš„åˆ†å¸ƒå¼ä½œä¸šæ ¹æ®æ•°æ®ä½ç½®æ¥å¤„ç†å®ƒä»¬ã€‚</li></ul><h4 id="ä¸ä¼ ç»Ÿ-RDBMS-æ¯”è¾ƒ"><a href="#ä¸ä¼ ç»Ÿ-RDBMS-æ¯”è¾ƒ" class="headerlink" title="ä¸ä¼ ç»Ÿ RDBMS æ¯”è¾ƒ"></a>ä¸ä¼ ç»Ÿ <code>RDBMS</code> æ¯”è¾ƒ</h4><p><code>HBase</code> æ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼çš„ã€é¢å‘åˆ—çš„æ•°æ®å­˜å‚¨ç³»ç»Ÿï¼Œé€šè¿‡åœ¨ <code>HDFS</code> ä¸Šæä¾›éšæœºè¯»&#x2F;å†™æ¥è§£å†³ <code>Hadoop</code> ä¸èƒ½å¤„ç†çš„é—®é¢˜ã€‚<code>HBase</code> è‡ªåº•å±‚è®¾è®¡å¼€å§‹å³èšé›†äºå„ç§å¯ä¼¸ç¼©æ€§é—®é¢˜ï¼šè¡¨å¯ä»¥å¾ˆ<em>é«˜</em>ï¼ˆæ•°åäº¿ä¸ªæ•°æ®è¡Œï¼‰ï¼›è¡¨å¯ä»¥å¾ˆ<em>å®½</em>ï¼ˆæ•°ç™¾ä¸‡ä¸ªåˆ—ï¼‰ï¼›æ°´å¹³åˆ†åŒºå¹¶åœ¨ä¸Šåƒä¸ªæ™®é€šæœºå™¨ä¸Šè‡ªåŠ¨å¤åˆ¶ã€‚è¡¨çš„æ¨¡å¼æ˜¯ç‰©ç†å­˜å‚¨çš„ç›´æ¥åæ˜ ï¼Œä½¿ç³»ç»Ÿæœ‰å¯èƒ½æä¾›é«˜æ•ˆçš„æ•°æ®ç»“æ„çš„åºåˆ—åŒ–ã€å­˜å‚¨å’Œæ£€ç´¢ï¼Œå› æ­¤ç¨‹åºçš„å¼€å‘è€…å°±å¿…é¡»é€‰æ‹©ä»¥æ­£ç¡®çš„æ–¹å¼ä½¿ç”¨è¿™ç§å­˜å‚¨å’Œæ£€ç´¢æ–¹å¼ã€‚</p><p>ä¸¥æ ¼æ¥è¯´ <code>RDBMS</code> æ˜¯ä¸€ä¸ªéµå¾ª <strong><code>Codd</code> çš„ <code>12</code> æ¡å‡†åˆ™</strong>çš„æ•°æ®åº“ã€‚æ ‡å‡†çš„ <code>RDBMS</code> æ˜¯æ¨¡å¼å›ºå®šã€é¢å‘è¡Œçš„æ•°æ®åº“ä¸”å…·æœ‰ <code>ACID</code> æ€§è´¨å’Œå¤æ‚çš„ <code>SQL</code> æŸ¥è¯¢å¤„ç†å¼•æ“ã€‚<code>RDBMS</code> å¼ºè°ƒäº‹åŠ¡çš„<em>å¼ºä¸€è‡´æ€§</em>ã€å‚ç…§å®Œæ•´æ€§ã€æ•°æ®æŠ½è±¡å’Œç‰©ç†å­˜å‚¨å±‚ç›¸å¯¹ç‹¬ç«‹ï¼Œä»¥åŠåŸºäº <code>SQL</code> è¯­è¨€çš„å¤æ‚æŸ¥è¯¢æ”¯æŒã€‚åœ¨ <code>RDBMS</code> ä¸­ï¼Œå¯ä»¥éå¸¸å®¹æ˜“åœ°å»ºç«‹ <em>äºŒçº§ç´¢å¼•</em>ï¼Œæ‰§è¡Œå¤æ‚çš„å†…è¿æ¥å’Œå¤–è¿æ¥ï¼Œæ‰§è¡Œè®¡æ•°ã€æ±‚å’Œã€æ’åºã€åˆ†ç»„ç­‰æ“ä½œï¼Œæˆ–å¯¹è¡¨ã€è¡Œå’Œåˆ—ä¸­çš„æ•°æ®è¿›è¡Œåˆ†é¡µå­˜æ”¾ã€‚</p><hr><h3 id="æ¶æ„"><a href="#æ¶æ„" class="headerlink" title="æ¶æ„"></a>æ¶æ„</h3><p>æ­£å¦‚ <code>HDFS</code> å’Œ <code>YARN</code> æ˜¯ç”±å®¢æˆ·ç«¯ã€<code>slave</code> å’Œ <code>master</code> ç»„æˆï¼Œ<code>HBase</code> ä¹Ÿé‡‡ç”¨äº†ç›¸åŒçš„æ¶æ„ï¼Œä½¿ç”¨ä¸€ä¸ª <code>master</code> èŠ‚ç‚¹åè°ƒç®¡ç†ä¸€ä¸ªæˆ–å¤šä¸ª <code>regionserver</code>ã€‚<code>HBase</code> çš„ <code>master</code> èŠ‚ç‚¹è´Ÿè´£å¯åŠ¨ä¸€ä¸ªæ–°çš„é›†ç¾¤ï¼Œå°†åŒºåŸŸåˆ†é…ä¸ªæ³¨å†Œçš„ <code>regionserver</code>ï¼Œæ¢å¤ <code>regionserver</code> çš„æ•…éšœã€‚<br><code>regionserver</code> è´Ÿè´£é›¶ä¸ªæˆ–å¤šä¸ªåŒºåŸŸçš„ç®¡ç†ä»¥åŠç›¸åº”å®¢æˆ·ç«¯çš„è¯»å†™è¯·æ±‚ï¼Œè¿˜è´Ÿè´£åŒºåŸŸçš„åˆ’åˆ†å¹¶é€šçŸ¥ <code>master</code> æœ‰äº†æ–°çš„å­åŒºåŸŸï¼Œå› æ­¤ <code>master</code> å°±å¯ä»¥å°†çˆ¶åŒºåŸŸè®¾ç½®ä¸ºç¦»çº¿ï¼Œå¹¶ç”¨å­åŒºåŸŸæ›¿ä»£çˆ¶åŒºåŸŸã€‚</p><img src="/Hadoop-HBase/hadoop-hbase.jpeg" class="" title="Hadoop-HBase"><p><code>HBase</code> ä¾èµ–äº <code>ZooKeeper</code>ï¼Œé»˜è®¤æƒ…å†µä¸‹ç®¡ç†ç€ä¸€ä¸ª <code>ZooKeeper</code> å®ä¾‹ï¼Œä½œä¸ºé›†ç¾¤çš„ <em>æƒå¨æœºæ„</em>ï¼Œå…¶è¿˜è´Ÿè´£ç®¡ç† <code>hbase:meta</code> ç›®å½•è¡¨çš„ä½ç½®ä»¥åŠå½“å‰é›†ç¾¤ä¸»æ§åœ°å€ç­‰é‡è¦ä¿¡æ¯ã€‚<br>å¦‚æœåœ¨åŒºåŸŸçš„åˆ†é…è¿‡ç¨‹ä¸­æœ‰æœåŠ¡å™¨å´©æºƒï¼Œå°±å¯ä»¥é€šè¿‡ <code>ZooKeeper</code> æ¥è¿›è¡Œåˆ†é…çš„åè°ƒã€‚<br>åœ¨å¯åŠ¨ä¸€ä¸ªå®¢æˆ·ç«¯åˆ° <code>HBase</code> é›†ç¾¤çš„è¿æ¥æ—¶ï¼Œå®¢æˆ·ç«¯å¿…é¡»è‡³å°‘æ‹¿åˆ°é›†ç¾¤æ‰€ä¼ é€’çš„ <code>ZooKeeper</code> é›†åˆä½“çš„ä½ç½®ï¼Œè¿™æ ·å®¢æˆ·ç«¯æ‰èƒ½è®¿é—® <code>ZooKeeper</code> çš„å±‚æ¬¡ç»“æ„ï¼Œä»è€Œäº†è§£é›†ç¾¤çš„å±æ€§ã€‚</p><p><code>regionserver</code> ä»èŠ‚ç‚¹åˆ—è¡¨å¯ä»¥åœ¨ <code>HBase</code> çš„ <code>conf/regionservers</code> æ–‡ä»¶ä¸­çœ‹åˆ°ï¼Œä¸ <code>Hadoop</code> çš„ä¸€è‡´ã€‚<br>é›†ç¾¤çš„ç«™ç‚¹é…ç½®åœ¨ <code>HBase</code> çš„ <code>conf/hbase-site.xml</code> å’Œ <code>conf/hbase-env.sh</code> ä¸­ï¼Œä»–ä»¬çš„æ ¼å¼å’Œ <code>Hadoop</code> çˆ¶é¡¹ç›®ä¸­å¯¹åº”çš„æ ¼å¼ç›¸åŒã€‚</p><p>å¤§éƒ¨åˆ†äººéƒ½æ˜¯ä½¿ç”¨ <code>HDFS</code> æ¥è¿è¡Œ <code>HBase</code>ï¼Œè€Œ <code>HBase</code> é€šè¿‡ <code>Hadoop</code> æ–‡ä»¶ç³»ç»Ÿ <code>API</code> æ¥æŒä¹…åŒ–å­˜å‚¨æ•°æ®ã€‚ä½†åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œ<code>HBase</code> ä¼šå°†å­˜å‚¨å†™å…¥æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿã€‚</p><h4 id="ä½¿ç”¨ä¸­çš„-HBase"><a href="#ä½¿ç”¨ä¸­çš„-HBase" class="headerlink" title="ä½¿ç”¨ä¸­çš„ HBase"></a>ä½¿ç”¨ä¸­çš„ <code>HBase</code></h4><p><code>HBase</code> å†…éƒ¨ä¿ç•™ç€åä¸º <strong><code>hbase:meta</code> çš„ç‰¹æ®Šç›®å½•è¡¨ï¼ˆ<code>catalog table</code>ï¼‰</strong>ï¼Œä»–ä»¬ç»´æŠ¤ç€å½“å‰é›†ç¾¤ä¸Šæ‰€æœ‰åŒºåŸŸçš„åˆ—è¡¨ã€çŠ¶æ€å’Œä½ç½®ã€‚<code>hbase:meta</code> è¡¨ä¸­çš„é¡¹ä½¿ç”¨åŒºåŸŸåä½œä¸ºé”®ï¼ŒåŒºåŸŸåç”± <em>æ‰€å±çš„è¡¨å</em>ã€<em>åŒºåŸŸçš„èµ·å§‹è¡Œ</em>ã€<em>åŒºåŸŸçš„åˆ›å»ºæ—¶é—´</em> ä»¥åŠå¯¹å…¶æ•´ä½“è¿›è¡Œçš„ <em><code>MD5</code> å“ˆå¸Œå€¼ï¼ˆå³å¯¹è¡¨åã€èµ·å§‹è¡Œã€åˆ›å»ºçš„æ—¶é—´æˆ³è¿›è¡Œå“ˆå¸Œåçš„ç»“æœï¼‰</em> ç»„æˆã€‚ç¤ºä¾‹å¦‚ä¸‹ï¼š</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># è¡¨åã€èµ·å§‹è¡Œã€æ—¶é—´æˆ³ä½¿ç”¨é€—å·éš”å¼€ï¼Œè€Œ MD5 å“ˆå¸Œå€¼åˆ™ä½¿ç”¨ä¸¤ä¸ªå¥å·åŒ…å›´</span><br><span class="line">TestTable,xyz,1279753346289.8hjffu7fhsis6f638hf6sjf67jd9sj3g.</span><br></pre></td></tr></table></figure><p>å¦‚å‰æ‰€å±ï¼Œè¡Œçš„é”®éƒ½æ˜¯æ’åºçš„ï¼Œå› æ­¤æƒ³è¦æŸ¥æ‰¾ä¸€ä¸ªç‰¹å®šè¡Œæ‰€åœ¨çš„åŒºåŸŸåªè¦åœ¨ç›®å½•è¡¨ä¸­æ‰¾åˆ°ç¬¬ä¸€ä¸ªé”®å¤§äºæˆ–ç­‰äºç»™å®šè¡Œé”®çš„é¡¹å³å¯ã€‚è€Œå½“åŒºåŸŸå˜åŒ–æ—¶ï¼Œç›®å½•è¡¨ä¹Ÿä¼šè¿›è¡Œå¯¹åº”çš„æ›´æ–°ï¼Œé›†ç¾¤ä¸Šæ‰€æœ‰åŒºåŸŸçš„çŠ¶æ€ä¿¡æ¯éƒ½èƒ½ä¿æŒæ›´æ–°ã€‚<br>æ¯ä¸ªè¡Œæ“ä½œå¯èƒ½è¦è®¿é—®ä¸‰æ¬¡è¿œç¨‹èŠ‚ç‚¹ï¼Œè€Œä¸ºäº†èŠ‚çœä»£ä»·ï¼Œé€šå¸¸éƒ½ä¼šç¼“å­˜ <code>hbase:meta</code> ä¿¡æ¯ï¼Œå…¶ä¸­ç¼“å­˜çš„å†…å®¹åŒ…å«ä½ç½®ä¿¡æ¯ã€ç”¨æˆ·ç©ºé—´åŒºåŸŸçš„å¼€å§‹è¡Œå’Œç»“æŸè¡Œã€‚å½“ä½¿ç”¨ç¼“å­˜ä¸­çš„æ•°æ®å‘ç”Ÿå¼‚å¸¸æ—¶ï¼Œå³åŒºåŸŸè¢«ç§»åŠ¨äº†ï¼Œå®¢æˆ·ç«¯ä¼šå»æŸ¥çœ‹ <code>hbase:meta</code> è·å–åŒºåŸŸçš„æ–°ä½ç½®ï¼Œå¦‚æœ <code>hbase:meta</code> ä¹Ÿè¢«ç§»åŠ¨äº†ï¼Œé‚£å®¢æˆ·ç«¯ä¹Ÿä¼šé‡æ–°å¯»æ‰¾ã€‚<br>å½“æ–°çš„å®¢æˆ·ç«¯è¿æ¥åˆ° <code>ZooKeeper</code> æ—¶ä¼šé¦–å…ˆæŸ¥æ‰¾ <code>hbase:meta</code> çš„ä½ç½®ï¼Œç„¶åé€šè¿‡å¯»æ‰¾åˆé€‚çš„åŒºåŸŸæ¥è·å–ç”¨æˆ·ç©ºé—´åŒºåŸŸæ‰€åœ¨çš„èŠ‚ç‚¹å’Œä½ç½®ï¼Œæ¥ä¸‹æ¥å°±æ˜¯å®¢æˆ·ç«¯ç›´æ¥ä¸ç®¡ç†å¯¹åº”åŒºåŸŸçš„ <code>regionserver</code> è¿›è¡Œäº¤äº’ã€‚</p><p>åˆ°è¾¾ <code>Regionserver</code> çš„å†™æ“ä½œé¦–å…ˆè¿½åŠ åˆ° <em>æäº¤æ—¥å¿—ï¼ˆ<code>commit log</code>ï¼‰</em> ä¸­ï¼Œç„¶ååŠ å…¥å†…å­˜ä¸­çš„ <code>metastore</code>ï¼Œè‹¥æ˜¯ <code>metastore</code> å·²æ»¡ï¼Œåˆ™ä¼šå°†å†…å®¹ <em>åˆ·å…¥ï¼ˆ<code>flash</code>ï¼‰</em> æ–‡ä»¶ç³»ç»Ÿã€‚<br>æäº¤æ—¥å¿—å­˜æ”¾åœ¨ <code>HDFS</code> ä¸­ï¼Œå½“å‘ç°æŸä¸ª <code>Regionserver</code> å´©æºƒæ—¶ï¼Œ<code>master</code> èŠ‚ç‚¹ä¼šæ ¹æ®åŒºåŸŸå¯¹å´©æºƒçš„ <code>Regionserver</code> çš„æäº¤æ—¥å¿—è¿›è¡Œåˆ†å‰²ï¼Œæ‰¾åˆ°è¿˜æ²¡æœ‰è¢«æŒä¹…åŒ–å­˜å‚¨çš„æ›´æ–°ï¼Œç„¶åè¿™éƒ¨åˆ†è¢« <em>é‡åšï¼ˆ<code>replay</code>ï¼‰</em> ä»¥ä½¿åŒºåŸŸæ¢å¤åˆ°å´©æºƒä¹‹å‰çš„çŠ¶æ€ã€‚<br>è€Œåœ¨è¯»çš„æ—¶å€™ä¼šæ£€æŸ¥åŒºåŸŸçš„ <code>metastore</code>ï¼Œå¦‚æœåœ¨å…¶ä¸­æ‰¾åˆ°äº†éœ€è¦çš„ç‰ˆæœ¬åˆ™æŸ¥è¯¢è‡³æ­¤ç»“æŸã€‚å¦åˆ™å°±éœ€è¦æŒ‰ç…§æ¬¡åºä»æ–°é“æ—§æ£€æŸ¥ <em>åˆ·æ–°æ–‡ä»¶ï¼ˆ<code>flash</code>ï¼‰</em>ï¼Œç›´åˆ°æ‰¾åˆ°ä»¬ç»„æŸ¥è¯¢çš„ç‰ˆæœ¬ï¼Œæˆ–è€…æ‰€æœ‰åˆ·æ–°æ–‡ä»¶éƒ½å¤„ç†å®Œä¸ºæ­¢ã€‚</p><p>ä¹‹å‰è¯´åˆ°çš„ <em>åˆ·æ–°æ–‡ä»¶ï¼ˆ<code>flash</code>ï¼‰</em> ä¼šæœ‰ä¸€ä¸ªåå°è¿›ç¨‹åœ¨å…¶ä¸ªæ•°è¾¾åˆ°é˜ˆå€¼æ—¶å‹ç¼©ä»–ä»¬ï¼Œå°†å¤šä¸ªæ–‡ä»¶é‡æ–°å†™å…¥ä¸€ä¸ªæ–‡ä»¶ï¼Œåœ¨æ‰§è¡Œå‹ç¼©æ“ä½œæ—¶ï¼Œè¿›ç¨‹ä¼šæ¸…ç†æ‰è¶…å‡ºæ¨¡å¼æ‰€è®¾æœ€å¤§å€¼çš„ç‰ˆæœ¬ä»¥åŠåˆ é™¤å•å…ƒæ ¼æˆ–æ ‡è¯†å•å…ƒæ ¼ä¸ºè¿‡æœŸã€‚<br>è€Œåœ¨ <code>Regionserver</code> ä¸Šä¼šæœ‰å¦å¤–ä¸€ä¸ªè¿›ç¨‹ç›‘æ§ç€åˆ·æ–°æ–‡ä»¶çš„å¤§å°ï¼Œä¸€æ—¦å¤§å°è¶…è¿‡é¢„å…ˆè®¾å®šçš„æœ€å¤§å€¼ï¼Œä¾¿ä¼šå¯¹åŒºåŸŸè¿›è¡Œåˆ†å‰²ã€‚</p><hr><h3 id="æ—¥å¸¸é—®é¢˜"><a href="#æ—¥å¸¸é—®é¢˜" class="headerlink" title="æ—¥å¸¸é—®é¢˜"></a>æ—¥å¸¸é—®é¢˜</h3><h4 id="HDFS"><a href="#HDFS" class="headerlink" title="HDFS"></a><code>HDFS</code></h4><p><code>HBase</code> ä½¿ç”¨ <code>HDFS</code> çš„æ–¹å¼ä¸ <code>MapReduce</code> çš„ä½¿ç”¨æ–¹å¼æˆªç„¶ä¸åŒã€‚åœ¨ <code>HBase</code> ä¸­æ•°æ®æ–‡ä»¶åœ¨å¯åŠ¨æ—¶å°±è¢«æ‰“å¡ï¼Œå¹¶åœ¨å¤„ç†è¿‡ç¨‹ä¸­å§‹ç»ˆä¿æŒæ‰“å¼€çŠ¶æ€ï¼Œè¿™æ˜¯ä¸ºäº†èŠ‚çœæ¯æ¬¡è®¿é—®æ“ä½œæ‰“å¼€æ–‡ä»¶æ‰€éœ€çš„ä»£ä»·ã€‚</p><ol><li><p>æ–‡ä»¶æè¿°ç¬¦ç”¨å®Œ<br>ç”±äºåœ¨è¿æ¥çš„é›†ç¾¤ä¸Šå§‹ç»ˆä¿æŒæ–‡ä»¶çš„æ‰“å¼€çŠ¶æ€ï¼Œå› æ­¤å¯èƒ½ä¼šè¾¾åˆ°ç³»ç»Ÿå’Œ <code>HDFS</code> è®¾å®šçš„é™åˆ¶ã€‚<br>å…¶ä¸­ä¸€ä¸ªè¿›ç¨‹é»˜è®¤çš„æ–‡ä»¶æè¿°ç¬¦é™åˆ¶æ˜¯ <code>1024</code>ï¼Œå½“ä½¿ç”¨çš„æè¿°ç¬¦ä¸ªæ•°è¶…è¿‡æ–‡ä»¶ç³»ç»Ÿçš„ <code>ulimit</code> å€¼ï¼Œå°±ä¼šåœ¨æ—¥å¿—ä¸­çœ‹åˆ°å¼‚å¸¸ä¿¡æ¯ <code>Too many open files</code>ï¼Œä¸è¿‡åœ¨å‡ºç°å¼‚å¸¸ä¿¡æ¯ä¹‹å‰ï¼Œå¾€å¾€ <code>HBase</code> å°±å·²ç»å‡ºç°é—®é¢˜äº†ã€‚</p></li><li><p><code>datanode</code> ä¸­çš„çº¿ç¨‹ç”¨å®Œ<br>ä¸ä¸Šè¿°çš„æƒ…å†µç±»ä¼¼ï¼Œ<code>datanode</code> ä¸Šé™åˆ¶è¿è¡Œçš„çº¿ç¨‹æ•°ä¸èƒ½è¶…è¿‡ <code>256</code>ï¼Œå¯ä»¥é€šè¿‡åœ¨ <code>hdfs-site.xml</code> ä¸­é…ç½® <code>dfs.datanode.max.transfer.threads</code> æ¥æ›´æ”¹è®¾ç½®ã€‚</p></li></ol><h4 id="ç”¨æˆ·ç•Œé¢"><a href="#ç”¨æˆ·ç•Œé¢" class="headerlink" title="ç”¨æˆ·ç•Œé¢"></a>ç”¨æˆ·ç•Œé¢</h4><p><code>HBase</code> åœ¨ <code>master</code> èŠ‚ç‚¹æœºå™¨ä¸Šè¿è¡Œäº† <code>Web</code> æœåŠ¡ï¼Œæä¾›äº†è¿è¡Œä¸­é›†ç¾¤çš„çŠ¶æ€è§†å›¾ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œå…¶ç›‘å¬ <code>60010</code> ç«¯å£ï¼Œä¸»ç•Œé¢æ˜¾ç¤ºåŸºæœ¬çš„å±æ€§ï¼ˆåŒ…å«è½¯ä»¶ç‰ˆæœ¬ã€é›†ç¾¤è´Ÿè½½ã€è¯·æ±‚é¢‘ç‡ã€é›†ç¾¤è¡¨çš„åˆ—è¡¨ï¼‰å’ŒåŠ å…¥çš„ <code>Regionserver</code> ç­‰ã€‚<br>åœ¨ä¸»ç•Œé¢ä¸Šç‚¹å‡»é€‰ä¸­çš„ <code>Regionserver</code> å°±ä¼šå±•ç¤ºå¯¹åº”çš„ <code>Web</code> æœåŠ¡å™¨ï¼Œå±•ç¤ºè¯¥æœåŠ¡å™¨ä¸Šæ‰€æœ‰åŒºåŸŸçš„åˆ—è¡¨åŠå…¶ä»–åŸºæœ¬çš„å±æ€§å€¼ã€‚</p><h4 id="åº¦é‡-Metric"><a href="#åº¦é‡-Metric" class="headerlink" title="åº¦é‡ Metric"></a>åº¦é‡ <code>Metric</code></h4><p><code>Hadoop</code> æœ‰ä¸€ä¸ª<strong>åº¦é‡ <code>Metric</code></strong> ç³»ç»Ÿï¼Œä¼šåœ¨æ¯éš”ä¸€æ®µæ—¶é—´è·å–ç³»ç»Ÿé‡è¦ç»„ä»¶çš„ä¿¡æ¯ï¼Œå¹¶å°†å…¶è¾“å‡ºåˆ°ä¸Šä¸‹æ–‡ä¸­ã€‚å¯ç”¨è¯¥ç³»ç»Ÿå¯ä»¥å°†ä¿¡æ¯å¯¼å‡ºåˆ° <code>JMX</code>ï¼Œä»è€Œå±•ç¤ºé›†ç¾¤ä¸Šæ­£åœ¨å’Œè¿‡å»çš„è¯·æ±‚è§†å›¾ã€‚</p><h4 id="è®¡æ•°å™¨"><a href="#è®¡æ•°å™¨" class="headerlink" title="è®¡æ•°å™¨"></a>è®¡æ•°å™¨</h4><p><code>Htable</code> æä¾›çš„ <strong><code>incrementColumnValue()</code></strong> æ–¹æ³•å¯ä»¥å®ç°è®¡æ•°å™¨æ¯ç§’æ•°åƒæ¬¡çš„æ›´æ–°ï¼Œè§£å†³ä¹‹å‰è®¡æ•°å™¨å­˜å‚¨åœ¨ <code>MySQL</code> ä¸­çš„æ›´æ–°é¢‘ç¹é—®é¢˜ã€‚</p><hr><h3 id="å¼•ç”¨"><a href="#å¼•ç”¨" class="headerlink" title="å¼•ç”¨"></a>å¼•ç”¨</h3><hr><h3 id="ä¸ªäººå¤‡æ³¨"><a href="#ä¸ªäººå¤‡æ³¨" class="headerlink" title="ä¸ªäººå¤‡æ³¨"></a>ä¸ªäººå¤‡æ³¨</h3><p><strong>æ­¤åšå®¢å†…å®¹å‡ä¸ºä½œè€…å­¦ä¹ æ‰€åšç¬”è®°ï¼Œä¾µåˆ ï¼</strong><br><strong>è‹¥è½¬ä½œå…¶ä»–ç”¨é€”ï¼Œè¯·æ³¨æ˜æ¥æºï¼</strong></p>]]></content>
    
    
    <summary type="html">&lt;h3 id=&quot;åŸºç¡€&quot;&gt;&lt;a href=&quot;#åŸºç¡€&quot; class=&quot;headerlink&quot; title=&quot;åŸºç¡€&quot;&gt;&lt;/a&gt;åŸºç¡€&lt;/h3&gt;&lt;p&gt;&lt;code&gt;HBase&lt;/code&gt; æ˜¯ä¸€ä¸ªåœ¨ &lt;code&gt;HDFS&lt;/code&gt; ä¸Šå¼€å‘çš„&lt;strong&gt;é¢å‘åˆ—&lt;/strong&gt;çš„&lt;strong&gt;åˆ†å¸ƒå¼æ•°æ®åº“&lt;/strong&gt;ï¼Œå¦‚æœä½ éœ€è¦å®æ—¶è®¿é—®è¶…å¤§è§„æ¨¡çš„æ•°æ®é›†ï¼Œé‚£ä¹ˆä½¿ç”¨ &lt;code&gt;HBase&lt;/code&gt; å°±å¯¹äº†ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;HBase&lt;/code&gt; &lt;strong&gt;è‡ªåº•è€Œä¸Š&lt;/strong&gt;åœ°è¿›è¡Œæ„å»ºï¼Œå¯ä»¥ç®€å•çš„é€šè¿‡&lt;strong&gt;å¢åŠ èŠ‚ç‚¹æ¥çº¿æ€§æ‰©å±•&lt;/strong&gt;ã€‚å…¶å¹¶ä¸æ˜¯å…³ç³»å‹æ•°æ®åº“ï¼Œå¹¶ä¸”ä¹Ÿä¸æ”¯æŒ &lt;code&gt;SQL&lt;/code&gt;ï¼Œåœ¨ç‰¹å®šçš„ç©ºé—´é‡Œï¼Œèƒ½å¤Ÿåš &lt;code&gt;RDBMS&lt;/code&gt; ä¸èƒ½åšçš„äº‹ï¼Œå³åœ¨å»‰ä»·çš„ç¡¬ä»¶æ„æˆçš„é›†ç¾¤ä¸Šç®¡ç†è¶…å¤§è§„æ¨¡çš„ç¨€ç–è¡¨ã€‚&lt;/p&gt;</summary>
    
    
    
    
    <category term="Hadoop" scheme="https://blog.vgbhfive.cn/tags/Hadoop/"/>
    
  </entry>
  
  <entry>
    <title>to_2023-05-15</title>
    <link href="https://blog.vgbhfive.cn/to-2023-05-15/"/>
    <id>https://blog.vgbhfive.cn/to-2023-05-15/</id>
    <published>2023-05-15T13:02:52.000Z</published>
    <updated>2023-06-21T14:57:29.330Z</updated>
    
    <content type="html"><![CDATA[<p>ä»Šå¤©æ˜¯ <code>2023</code> å¹´ <code>5</code> æœˆ <code>15</code> æ—¥ï¼Œè·ç¦»æˆ‘ç¬¬ä¸€æ¬¡æ¥åŒ—äº¬å·¥ä½œçš„æ—¶é—´åˆšå¥½è·¨è¿‡äº†æ•´æ•´ä¸‰å¹´ï¼Œå…³äºè¿™ä¸ªæ—¶é—´æˆ‘ä¹Ÿæ˜¯åœ¨è·Ÿæœ‹å‹çš„é—²èŠä¸­æ‰å‘ç°åŸæ¥æˆ‘å·²ç»æ¥åŒ—äº¬åŒ—æ¼‚ä¸‰å¹´äº†ã€‚</p><span id="more"></span><p>å›æƒ³èµ·ä¸‰å¹´å‰çš„è‡ªå·±ï¼Œåˆšæ‰å­¦æ ¡æ¯•ä¸šä¸åˆ°ä¸€å¹´ï¼Œå·¥ä½œåœ¨è¥¿å®‰çš„ä¸€å®¶è¡¨é¢ä¸Šè¿˜çœ‹å¾—è¿‡å»çš„å…¬å¸ï¼ŒæŒ£æ‰åœ¨ä¸å‰å¥³å‹çš„å›å¿†ä¸­ï¼Œèº«ä½“ä¸è®°å¿†ç›¸äº’æ‹‰æ‰¯ï¼Œä¸çŸ¥é“æ˜å¤©çš„è·¯è¯¥æ€ä¹ˆèµ°ï¼Œæ—¢ä¸æ•¢è¾èŒï¼Œä¹Ÿä¸æ•¢å’Œæœ‹å‹è¯´ï¼Œå¹¸äºæœ‰å¤§å­¦çš„èˆå‹åœ¨åŒä¸€å®¶å…¬å¸ä¸Šç­ï¼Œä¸é«˜ä¸ä½çš„ç»­å‘½åˆ°æ¯•ä¸šçš„ç¬¬äºŒå¹´ã€‚<br>é¢†å¯¼åœ¨ç‰¹åˆ«çªç„¶çš„ä¸€å¤©è¯¢é—®æˆ‘çš„å·¥ä½œè§„åˆ’å’Œä»¥åçš„å®‰æ’ï¼Œè°ˆè¯ä¸­æˆ‘æ„Ÿè§‰åˆ°äº†ä¸å¦™çš„æ°”æ°›ï¼Œæœä¸å…¶ç„¶æˆ‘è¦è¢«å®‰æ’é•¿æœŸé©»åœºå‡ºå·®äº†ï¼Œå»åŸæœ¬å°±å®šå¥½çš„åŒ—äº¬ï¼Œé¢†å¯¼ç»™äº†ä¸¤å¤©çš„æ—¶é—´è®©æˆ‘æ”¶æ‹¾å®¶é‡Œçš„äº‹æƒ…ï¼Œå…¶å®æˆ‘æ˜ç™½è¿™æ˜¯é¢†å¯¼ç»™æˆ‘çš„è€ƒè™‘æ—¶é—´ï¼Œä¸åŒæ„é‚£å°±ç¦»èŒï¼ŒåŒæ„å°±å»åŒ—äº¬å‡ºå·®ã€‚<br>æˆ‘å›åˆ°è‡ªå·±ç»„çš„æˆ¿å­é‡Œï¼Œæ€è€ƒäº†ä¸€æ™šï¼Œæˆ‘è¯´æœäº†è‡ªå·±ï¼Œæˆ‘è¦è·Ÿä¹‹å‰çš„ç”Ÿæ´»å‘Šåˆ«ï¼Œé‚£æœ€å¥½çš„æ–¹å¼å°±æ˜¯å»ä¸€ä¸ªé™Œç”Ÿçš„åœ°æ–¹ï¼Œå¼€å¯ä¸€æ®µé™Œç”Ÿçš„ç”Ÿæ´»ã€‚</p><p>ä¸¤å¤©åï¼Œåœ¨å¤§å­¦èˆå‹çš„é€åˆ«ä¹‹ä¸‹ï¼Œæˆ‘è¸ä¸Šäº†å¼€å¾€åŒ—äº¬çš„åŠ¨è½¦ï¼Œä»è¥¿å®‰å¼€å¾€åŒ—äº¬ï¼Œæ—¶é—´èŠ±è´¹äº† <code>5</code> å°æ—¶ <code>35</code> åˆ†é’Ÿï¼Œå…¨ç¨‹æˆ‘æ²¡æœ‰ç¡è§‰ï¼Œæ²¡æœ‰ç©æ‰‹æœºï¼Œæˆ‘å°±é™é™åœ°çœ‹ç€çª—å¤–ï¼Œæˆ‘çš„å†…å¿ƒå‘Šè¯‰æˆ‘æ–°çš„ç”Ÿæ´»åœ¨å‘æˆ‘æ‹›æ‰‹ï¼Œè€Œæˆ‘ä¹Ÿå³å°†å¼€å§‹æ–°çš„ç”Ÿæ´»ã€‚<br>æ­£å¦‚é¢„æµ‹çš„é‚£æ ·ï¼Œåˆšåˆ°åŒ—äº¬çš„ä¸€ä¸ªæœˆä½åœ¨å…¬å¸ç§Ÿçš„æˆ¿å­é‡Œï¼Œå¼€å§‹è·ŸåŒäº‹äº†è§£é©»åœºå¼€å‘çš„æ‰€æœ‰ç›¸å…³å†…å®¹ï¼Œä¸€ä¸ªæœˆåæˆ‘å¼€å§‹è‡ªå·±ç‹¬ç«‹ç§Ÿæˆ¿å­ï¼Œä¹°äº†é”…ç¢—ç“¢ç›†è‡ªå·±åšé¥­ã€‚å¹¸è€Œé‡åˆ°ä¸€ä¸ªè¿˜ç®—ä¸é”™çš„ç»„é•¿ï¼Œåœ¨å·¥ä½œå®Œæˆä¹‹åï¼Œä»–è¿˜å…è®¸æˆ‘è‡ªå·±çœ‹ä¹¦å­¦ä¹ ï¼›åŠå¤œç†¬å¤œåˆ‡æ¢æ¼”ç»ƒåï¼Œç¬¬äºŒå¤©å°±ç»™æˆ‘ä¸€å¤©å‡æœŸï¼Œè®©æˆ‘å¥½å¥½ä¼‘æ¯ï¼›å…¶ä»–é¡¹ç›®ç»„çš„æœ‹å‹ï¼Œæˆ‘ä»¬ä¼šä¸€èµ·ä¹°æ°´æœï¼Œä¸€èµ·åœ¨æ°´æˆ¿è¾¹èŠå¤©è¾¹åƒã€‚åˆç§Ÿçš„å®¤å‹é‡åˆ°ç‰¹åˆ«å¥½çš„ä¸¤ä¸ªé¥­æ­å­ã€æ‰‘å…‹ç‰Œæ­å­ã€æ¸¸ç©æ­å­ï¼Œé‚£æ˜¯ä¸€æ®µç‰¹åˆ«å¼€å¿ƒçš„æ—¥å­ï¼Œæœ‰æ—¶å€™ç«Ÿç„¶å¯ä»¥èŠåˆ°å‡Œæ™¨çš„ä¸¤ç‚¹é’Ÿï¼Œå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆã€‚<br>è¿™äº›å¿«ä¹çš„æ—¶å…‰è®©æˆ‘é€æ¸æ‰¾å›è‡ªå·±ï¼Œæ¯å¤©éƒ½åœ¨å­¦ä¹ æ–°çš„æŠ€æœ¯ã€å°è¯•åšæ–°çš„èœã€äº¤å¾€æ–°çš„æœ‹å‹ã€å¹»æƒ³éª‘ç€è‡ªå·±ä¹°çš„æ‘©æ‰˜è½¦ï¼Œåˆ°ç°åœ¨ä¸çŸ¥ä¸è§‰æ¥åˆ°åŒ—äº¬å·²ç»ä¸‰å¹´äº†ï¼ŒåŸºæœ¬ä¸Šéƒ½æ˜¯å¿«ä¹çš„æ—¥å­ï¼Œå¸Œæœ›åœ¨æœªæ¥çš„æ—¥å­é‡Œå¯ä»¥å¤šå¤šæŒ£é’±ï¼Œå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆã€‚</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;ä»Šå¤©æ˜¯ &lt;code&gt;2023&lt;/code&gt; å¹´ &lt;code&gt;5&lt;/code&gt; æœˆ &lt;code&gt;15&lt;/code&gt; æ—¥ï¼Œè·ç¦»æˆ‘ç¬¬ä¸€æ¬¡æ¥åŒ—äº¬å·¥ä½œçš„æ—¶é—´åˆšå¥½è·¨è¿‡äº†æ•´æ•´ä¸‰å¹´ï¼Œå…³äºè¿™ä¸ªæ—¶é—´æˆ‘ä¹Ÿæ˜¯åœ¨è·Ÿæœ‹å‹çš„é—²èŠä¸­æ‰å‘ç°åŸæ¥æˆ‘å·²ç»æ¥åŒ—äº¬åŒ—æ¼‚ä¸‰å¹´äº†ã€‚&lt;/p&gt;</summary>
    
    
    
    
    <category term="Myx&amp;Lyl" scheme="https://blog.vgbhfive.cn/tags/Myx-Lyl/"/>
    
  </entry>
  
  <entry>
    <title>2023 ä½ç”Ÿäº§åŠ› PC è£…æœºæŠ¥å‘Š</title>
    <link href="https://blog.vgbhfive.cn/2023-%E4%BD%8E%E7%94%9F%E4%BA%A7%E5%8A%9B-PC-%E8%A3%85%E6%9C%BA%E6%8A%A5%E5%91%8A/"/>
    <id>https://blog.vgbhfive.cn/2023-%E4%BD%8E%E7%94%9F%E4%BA%A7%E5%8A%9B-PC-%E8%A3%85%E6%9C%BA%E6%8A%A5%E5%91%8A/</id>
    <published>2023-05-11T13:17:18.000Z</published>
    <updated>2023-06-14T14:03:40.400Z</updated>
    
    <content type="html"><![CDATA[<h3 id="é…ç½®åˆ—è¡¨"><a href="#é…ç½®åˆ—è¡¨" class="headerlink" title="é…ç½®åˆ—è¡¨"></a>é…ç½®åˆ—è¡¨</h3><p><code>CPU</code>ï¼š<code>Intel i5-12400</code> æ•£ç‰‡<br>ä¸»æ¿ï¼šå¾®æ˜Ÿ <code>MAG B660 MORTAR WIFI DDR4</code><br>å†…å­˜ï¼šå…‰å¨ å¤©ç­–ç³»åˆ— <code>16G * 2</code> å¥—æ¡<br>å›ºæ€ï¼šå®åŸºæ å¤ºè€… <code>GM7000 PCIe4.0 NVMe</code><br>ç”µæºï¼šé•¿åŸ <code>650w</code> é‡‘ç‰Œå…¨æ¨¡<br>æ•£çƒ­ï¼šä¹å·é£ç¥ ç„å†° <code>400V5</code>ï¼ˆå››çƒ­ç®¡ï¼‰<br>æœºç®±ï¼šå…ˆé©¬ å¹³å¤´å“¥ <code>M2</code>ï¼ˆäº”é£æ‰‡ä½ï¼Œä¾§å¤´ç»ç’ƒï¼‰<br>ç³»ç»Ÿï¼š<code>Windows 10</code> ä¸“ä¸šç‰ˆ</p><span id="more"></span><p>ä¸Šé¢è¿™å°æœºå™¨ä»è´­ä¹°ç»„è£…å®Œå†åˆ°ç°åœ¨ï¼Œå·²ç»æœ‰äº†åŠä¸ªæœˆçš„æ—¶é—´ï¼Œå¯ä»¥åŸºæœ¬ä¸Šæ»¡è¶³ç±»ä¼¼ <code>DNF</code>ã€ åŸç¥ã€ <code>IDEA</code>ã€ <code>VS Code</code> è¿™ç±»ä½ç”Ÿäº§ã€ä½æ¸¸æˆçš„æ—¥å¸¸ PC æœºéœ€æ±‚ã€‚</p><hr><h3 id="ä¼˜ç¼ºç‚¹"><a href="#ä¼˜ç¼ºç‚¹" class="headerlink" title="ä¼˜ç¼ºç‚¹"></a>ä¼˜ç¼ºç‚¹</h3><h4 id="ä¼˜ç‚¹"><a href="#ä¼˜ç‚¹" class="headerlink" title="ä¼˜ç‚¹"></a>ä¼˜ç‚¹</h4><ol><li>æ²¡æœ‰æ˜¾å¡ï¼Œä½¿ç”¨æ ¸æ˜¾ï¼Œå¯¹äºéæ¸¸æˆç©å®¶æ¥è¯´å®Œç¾é€‚é…ã€‚åç»­è‹¥æƒ³åŠ æ˜¾å¡ï¼Œç”µæºã€ä¸»æ¿å‡å¯ä»¥å®Œç¾é€‚é…ã€‚</li><li>æ•´ä½“é…ç½®ä¸­è§„ä¸­çŸ©ï¼Œä¹Ÿå°±æ„å‘³ç€ä¸å‡ºé”™ã€ä¸å®Œç¾ã€‚</li><li>ä¸»æ¿å’Œæœºç®±æ”¯æŒå¤šç£ç›˜æ‰©å±•ï¼Œæ•£çƒ­ã€é¢œå€¼åœ¨çº¿ã€‚</li><li>æ”¯æŒå›½äº§å“ç‰Œï¼Œå‘æŒ¥è‡ªå·±çš„ä¸€ä»½åŠ›ã€‚</li></ol><h4 id="ç¼ºç‚¹"><a href="#ç¼ºç‚¹" class="headerlink" title="ç¼ºç‚¹"></a>ç¼ºç‚¹</h4><ol><li>æ²¡æœ‰ç‹¬æ˜¾ï¼Œå¯¹äºä¸­è½»åº¦æ¸¸æˆç©å®¶ä¸æ˜¯å¾ˆå‹å¥½ï¼Œæ¸¸æˆä½“éªŒæŠ˜æ‰£è¾ƒå¤§ã€‚</li><li>æ²¡æœ‰å…‰æ±¡æŸ“ï¼Œå¯¹äºå¸¸å¹´ä¸å…³æœºç©å®¶æœ‰è¾ƒå¥½çš„ä½“éªŒã€‚</li><li>å¦‚æœæ²¡æœ‰åç»­æ‰©å±•çš„éœ€æ±‚ï¼Œå¯ä»¥ä½¿ç”¨ <code>MATX-mini</code> æœºç®±è¿›ä¸€æ­¥å‹ç¼©å ç”¨é¢ç§¯ã€‚</li></ol><hr><h3 id="ä¼˜åŒ–é…ç½®"><a href="#ä¼˜åŒ–é…ç½®" class="headerlink" title="ä¼˜åŒ–é…ç½®"></a>ä¼˜åŒ–é…ç½®</h3><p>æœºç®±ï¼šå°å–†ä¼˜å“ <code>C2P</code><br>æ•£çƒ­ï¼šä¹”æ€ä¼¯<code> CR-1400</code><br>æœºç®±é£æ‰‡ï¼šåˆ©æ°‘ <code>C12C * 3</code></p><p><small>è¿™é‡Œçš„ä¼˜åŒ–é…ç½®å€¾å‘äºå‹ç¼©æœºç®±å ç”¨é¢ç§¯ï¼Œè€Œä¸æ˜¯å‡å°‘èŠ±è´¹çš„é‡‘é¢ï¼Œæ¯•ç«Ÿä¸€åˆ†é’±ä¸€åˆ†è´§ã€‚</small></p><hr><h3 id="åæ§½"><a href="#åæ§½" class="headerlink" title="åæ§½"></a>åæ§½</h3><p>ä¸Šé¢è¯¦ç»†å®¢è§‚çš„æè¿°äº†è¿™å°æœºå™¨çš„æƒ…å†µå’Œéœ€è¦ä¼˜åŒ–çš„åœ°æ–¹ï¼Œé‚£ä¸‹é¢å°±æ˜¯åæ§½çš„å†…å®¹ã€‚<br>å› ä¸ºä¸€ç›´æ˜¯ <code>JD</code> çš„æ·±åº¦ç”¨æˆ·ï¼ŒåŸºæœ¬ä¸Šå¤§å¤§å°å°çš„ç”µå­äº§å“éƒ½æ˜¯åœ¨å®˜æ–¹ç›´è¥ä¹°çš„ï¼Œä½†æ˜¯æˆ‘å´åœ¨è¿™æ¬¡ä¹°ä¸»æ¿çš„æ—¶å€™é‡åˆ°äº†<strong>â€œå¤§å‘â€</strong> ã€‚åº—é“ºå®¢æœå‘Šè¯‰æˆ‘ä»–ä»¬æ˜¯å®˜æ–¹å®¢æœï¼Œç¬¬ä¸€æ—¶é—´æˆ‘è¿˜æ²¡æœ‰ç†è§£è¿™ä¸ªæ„æ€ï¼Œç„¶åæˆ‘å°±é—®äº†ä¸€å˜´ï¼Œé‚£æ˜¯äº¬ä¸œå®˜æ–¹å—ï¼Ÿï¼ˆæˆ‘æƒ³å¾ˆå¤šäººåœ¨äº¬ä¸œä¹°ç”µå­äº§å“éƒ½æ˜¯å¯¹äº¬ä¸œå®˜æ–¹å”®åæœ‰ä¿éšœæ‰å»çš„å§ï¼‰<br>åè½¬æ¥äº†ï¼Œå®¢æœè¯´ï¼šä»–ä»¬ä¸æ˜¯ï¼ï¼ï¼ä»–ä»¬æ˜¯å®˜æ–¹ã€å®˜æ–¹ã€å®˜æ–¹å®¢æœï¼Œè¿™æ˜¯æ‰“ç€äº¬ä¸œè‡ªè¥çš„æ‹›ç‰Œï¼Œè€Œæ˜¯ä¸»æ¿å®˜æ–¹æ——èˆ°åº—ï¼Ÿï¼Ÿï¼Ÿ</p><p>è‡³äºæˆ‘ä¸ºä»€ä¹ˆä¼šè·Ÿå®¢æœèŠè¿™ä¹ˆå¤šå‘¢ï¼Ÿæ˜¯å› ä¸ºè£…æœºä¹‹åï¼Œæ¿å­çš„è“ç‰™æ—¶æ–­æ—¶ç»­ï¼Œç”¨ä¸€ä¼šå°±è‡ªå·±æ–­å¼€è¿æ¥äº†ï¼Œæˆ‘é‡æ–°è¿æ¥å†è¿‡ä¸€ä¼šå°±åˆä¼šæ–­å¼€ï¼›è‡ªå·±å°è¯•è¿‡å„ç§å„æ ·çš„è§£å†³æ–¹æ¡ˆï¼šåˆ· <code>BIOS</code>ã€æŠ  <code>BIOS</code> ç”µæ± ã€é‡è£…è“ç‰™é©±åŠ¨ï¼Œè‡ªå·±æ— æ³•è§£å†³ï¼Œå°±å»æ‰¾äº†åº—é“ºå®¢æœã€‚<br>æ­¤æ—¶æˆ‘çœ‹åˆ°ä¸€è¡Œå°å­—<strong>â€œ180å¤©åªæ¢ä¸ä¿®â€</strong> ï¼Œæˆ‘å°±é—®å®¢æœå•Šï¼Œæ˜¯çœŸçš„åªæ¢ä¸ä¿®å—ï¼Ÿæˆ‘è¿™æƒ…å†µå¯ä»¥åªæ¢ä¸ä¿®å—ï¼Ÿå®¢æœè¯´ï¼šè¡Œï¼Œé‚£ä½ å¯„å›æ¥å§ã€‚<br>æˆ‘åˆæ˜¯ä¸€é€šæŠ˜è…¾ï¼Œä¸»æ¿æ‹†äº†ä¸‹æ¥ï¼Œæˆ‘è¿˜ä¸“é—¨å½•åƒäº†ï¼Œç‰¹åˆ«æ˜¯é‡è¦çš„åœ°æ–¹ï¼š<code>CPU</code> æ¥å£ã€é›¶é…ä»¶ã€ç›–æ¿éƒ½æçš„å¥½å¥½çš„ï¼Œè‡ªæˆ‘æ„Ÿè§‰éƒ½å¯ä»¥äºŒæ¬¡é”€å”®äº†ï¼ˆå½•åƒæ˜¯æ‹…å¿ƒæœ‰æ‰¯çš®çš„äº‹æƒ…å‡ºç°ï¼‰ã€‚ç¬¬äºŒå¤©å®˜æ–¹æ”¶åˆ°æ¿å­ï¼Œé€Ÿåº¦å¾ˆå¿«å¦ä¸€å—æ¿å­å°±ä¸Šè·¯äº†ï¼Œå¥½å®¶ä¼™ï¼è¿™é€Ÿåº¦æ æ çš„ã€‚ç¬¬ä¸‰å¤©æ—©ä¸Šå¿«é€’å°±æ‰“ç”µè¯å–Šæˆ‘å»å–å¿«é€’ï¼Œä¸è¿‡å½“æ—¶åœ¨ä¸Šç­å°±å–Šèˆå‹å¸®å¿™å–äº†ä¸€ä¸‹ï¼Œæ™šä¸Šæˆ‘å›å®¶åˆæ˜¯ä¸€é€šæŠ˜è…¾ï¼Œè£…æœºã€æ•´çº¿ã€é‡è£…ç³»ç»Ÿï¼Œä¸€ç›´æåˆ°å‡Œæ™¨ä¸€ç‚¹å¤šã€‚<br>è¿™å…¶ä¸­æ›´æœ‰æ„æ€çš„æ¥äº†ï¼Œå› ä¸ºæˆ‘å½•äº†å¼€ç®±è§†é¢‘ï¼Œå°±å‘ç°äº†å‡ ä¸ªé—®é¢˜ï¼šæ–°çš„ä¸»æ¿å¤–åŒ…è£…æ²¡æœ‰å¡‘å°ï¼Œæ„Ÿè§‰åƒæ˜¯ç»´ä¿®åçš„ï¼›æˆ‘åœ¨æ‰¾è¯´æ˜ä¹¦çš„æ—¶å€™ï¼Œå‘ç°ä»–çš„ä¿ä¿®å¡è¢«äººæ’•äº†ä¸€è§’ï¼Œè¿™è®©æˆ‘æ›´åŠ è§‰å¾—æ˜¯ç»´ä¿®åçš„ä¸»æ¿ã€‚å½“æ—¶ç”±äºå½“æ—¶ç€æ€¥è£…æœºï¼Œæˆ‘å°±æ²¡ç®¡è¿™äº›ï¼Œæ¿å­èƒ½ç”¨å°±å¥½å•Šï¼Œå…¶ä»–çš„éƒ½æ˜¯å°äº‹ã€‚é‚£ä¹ˆæ›´å¤§çš„åè½¬åˆæ¥äº†ï¼<br>å°±åœ¨æˆ‘å†™è¿™ç¯‡åšå®¢çš„ä»Šå¤©ï¼Œæ„Ÿè§‰ä¹‹å‰ä¹°çš„å†…å­˜æ¡ä¸æ˜¯å¾ˆå¥½ï¼Œæƒ³çœ‹çœ‹æ¿å­æ”¯ä¸æ”¯æŒ <code>DDR5</code>ï¼Œæˆ‘è®°å¾—ä¹‹å‰é—®è¿‡å®¢æœï¼Œå°±å»ç¿»äº†ä¹‹å‰çš„èŠå¤©è®°å½•ï¼Œæ­¤æ—¶æˆ‘å‘ç°äº†<strong>å¤§ <code>BUG</code></strong> ï¼Œåº—é“ºå®˜æ–¹å®¢æœè¯´<strong>â€œ180å¤©åªæ¢ä¸ä¿®â€</strong> ï¼Œæ›´æ¢çš„æ˜¯<strong>è‰¯å“</strong>ï¼›è€Œæˆ‘å»å’¨è¯¢äº¬ä¸œå®˜æ–¹å®¢æœï¼Œå¥¹ä»¬è¯´<strong>â€œ180å¤©åªæ¢ä¸ä¿®â€</strong> ï¼Œæ›´æ¢çš„æ˜¯<strong>æ–°å“</strong>ã€‚<br>ä½ å“å“è¿™å…¶ä¸­çš„å·®è·ï¼Œä¸€å­—ä¹‹å·®ï¼Œå°±æ˜¯å¤©ç¿»åœ°è¦†çš„å·®è·ï¼è€Œæˆ‘ç°åœ¨å‘¢ï¼Œè¢«å®¢æœç•™äº†è”ç³»æ–¹å¼ï¼Œè¯´æ˜¯ <code>24</code>å°æ—¶å†…ç»™æˆ‘å›ç”µï¼Œ<code>emmmm....</code> æ€ä¹ˆè¯´å‘¢ï¼Ÿ<br>æˆ‘å¥½åƒæ— è¯å¯è¯´ï¼Œåæ­£æˆ‘æ˜¯åŸºæœ¬å‘Šåˆ« <code>JD</code> äº†ã€‚</p><hr><h3 id="åç»­"><a href="#åç»­" class="headerlink" title="åç»­"></a>åç»­</h3><p>ä»Šå¤©æ˜¯ <code>2023-06-15</code>ï¼Œä¸Šè¿°çš„åæ§½ç»è¿‡ <code>12315</code> æ²¡æœ‰ä»»ä½•è§£å†³æ–¹æ¡ˆï¼Œå°±æ˜¯ä¸€ç›´æ‹–ç€ã€‚<br>æ— å¥ˆï¼Œæˆ‘æ¥å—äº†è§£å†³æ–¹æ¡ˆï¼šå”®åç»´ä¿®å†åŠ ä¸¤ç™¾å—çš„è¡¥å¿ã€‚è¯´å®è¯çœŸçš„å¾ˆæ— å¥ˆï¼Œå¾—ä¸åˆ°ä»»ä½•çš„è§£é‡Šï¼Œä¹Ÿæ²¡æœ‰ä»»ä½•è¯´æ˜ï¼Œåæ­£å°±æ˜¯æ‹¿é’±åŠäº‹ï¼Œå¯¹æ­¤æˆ‘åªèƒ½è¯´<strong>è¿™äº‹åŠçš„æ¼‚äº®</strong>ã€‚</p><hr><h3 id="å¼•ç”¨"><a href="#å¼•ç”¨" class="headerlink" title="å¼•ç”¨"></a>å¼•ç”¨</h3><hr><h3 id="ä¸ªäººå¤‡æ³¨"><a href="#ä¸ªäººå¤‡æ³¨" class="headerlink" title="ä¸ªäººå¤‡æ³¨"></a>ä¸ªäººå¤‡æ³¨</h3><p><strong>æ­¤åšå®¢å†…å®¹å‡ä¸ºä½œè€…å­¦ä¹ æ‰€åšç¬”è®°ï¼Œä¾µåˆ ï¼</strong><br><strong>è‹¥è½¬ä½œå…¶ä»–ç”¨é€”ï¼Œè¯·æ³¨æ˜æ¥æºï¼</strong></p>]]></content>
    
    
    <summary type="html">&lt;h3 id=&quot;é…ç½®åˆ—è¡¨&quot;&gt;&lt;a href=&quot;#é…ç½®åˆ—è¡¨&quot; class=&quot;headerlink&quot; title=&quot;é…ç½®åˆ—è¡¨&quot;&gt;&lt;/a&gt;é…ç½®åˆ—è¡¨&lt;/h3&gt;&lt;p&gt;&lt;code&gt;CPU&lt;/code&gt;ï¼š&lt;code&gt;Intel i5-12400&lt;/code&gt; æ•£ç‰‡&lt;br&gt;ä¸»æ¿ï¼šå¾®æ˜Ÿ &lt;code&gt;MAG B660 MORTAR WIFI DDR4&lt;/code&gt;&lt;br&gt;å†…å­˜ï¼šå…‰å¨ å¤©ç­–ç³»åˆ— &lt;code&gt;16G * 2&lt;/code&gt; å¥—æ¡&lt;br&gt;å›ºæ€ï¼šå®åŸºæ å¤ºè€… &lt;code&gt;GM7000 PCIe4.0 NVMe&lt;/code&gt;&lt;br&gt;ç”µæºï¼šé•¿åŸ &lt;code&gt;650w&lt;/code&gt; é‡‘ç‰Œå…¨æ¨¡&lt;br&gt;æ•£çƒ­ï¼šä¹å·é£ç¥ ç„å†° &lt;code&gt;400V5&lt;/code&gt;ï¼ˆå››çƒ­ç®¡ï¼‰&lt;br&gt;æœºç®±ï¼šå…ˆé©¬ å¹³å¤´å“¥ &lt;code&gt;M2&lt;/code&gt;ï¼ˆäº”é£æ‰‡ä½ï¼Œä¾§å¤´ç»ç’ƒï¼‰&lt;br&gt;ç³»ç»Ÿï¼š&lt;code&gt;Windows 10&lt;/code&gt; ä¸“ä¸šç‰ˆ&lt;/p&gt;</summary>
    
    
    
    
    <category term="Electron" scheme="https://blog.vgbhfive.cn/tags/Electron/"/>
    
  </entry>
  
  <entry>
    <title>Hadoop-Hive</title>
    <link href="https://blog.vgbhfive.cn/Hadoop-Hive/"/>
    <id>https://blog.vgbhfive.cn/Hadoop-Hive/</id>
    <published>2023-04-12T14:31:45.000Z</published>
    <updated>2023-05-28T04:36:06.235Z</updated>
    
    <content type="html"><![CDATA[<h3 id="åŸºç¡€"><a href="#åŸºç¡€" class="headerlink" title="åŸºç¡€"></a>åŸºç¡€</h3><p><strong><code>Hive</code></strong> æ˜¯ä¸€ä¸ªæ„å»ºåœ¨ <code>Hadoop</code> ä¹‹ä¸Šçš„<strong>æ•°æ®ä»“åº“æ¡†æ¶</strong>ï¼Œå…¶è®¾è®¡ç›®çš„åœ¨äºè®©ç²¾é€š <code>SQL</code> ä½†ç¼–ç¨‹æŠ€èƒ½è¾ƒå¼±çš„è¿è¥äººå‘˜èƒ½å¤Ÿå¯¹å­˜æ”¾åœ¨ <code>HDFS</code> ä¸­çš„å¤§è§„æ¨¡æ•°æ®é›†æ‰§è¡ŒæŸ¥è¯¢ã€‚<br>ä½†æ˜¯ç”±äºå…¶åº•å±‚ä¾èµ–çš„ <code>Hadoop</code> å’Œ <code>HDFS</code> è®¾è®¡æœ¬èº«çº¦æŸå’Œå±€é™æ€§ï¼Œé™åˆ¶ <code>Hive</code> ä¸æ”¯æŒè®°å½•çº§åˆ«çš„æ›´æ–°ã€æ’å…¥æˆ–è€…åˆ é™¤æ“ä½œï¼Œä¸è¿‡å¯ä»¥é€šè¿‡æŸ¥è¯¢ç”Ÿæˆæ–°è¡¨æˆ–å°†æŸ¥è¯¢ç»“æœå¯¼å…¥æ–‡ä»¶ä¸­æ¥å®ç°ã€‚åŒæ—¶ç”±äº <code>MapReduce</code> ä»»åŠ¡çš„å¯åŠ¨è¿‡ç¨‹éœ€è¦æ¶ˆè€—è¾ƒé•¿çš„æ—¶é—´ï¼Œæ‰€ä»¥æŸ¥è¯¢å»¶æ—¶æ¯”è¾ƒä¸¥é‡ã€‚</p><span id="more"></span><img src="/Hadoop-Hive/mmexport1684155627591.jpg" class="" title="mmexport1684155627591"><p><code>Hive</code> å‘è¡Œç‰ˆæœ¬ä¸­åŒ…å« <strong><code>CLI</code></strong> ã€ <strong><code>HWI</code></strong> ï¼ˆä¸€ä¸ªç®€å•çš„ç½‘é¡µç•Œé¢ï¼‰ä»¥åŠå¯é€šè¿‡ <strong><code>JDBC</code></strong> ã€ <strong><code>ODBC</code></strong> å’Œä¸€ä¸ª <strong><code>Thrift</code> æœåŠ¡å™¨</strong>è¿›è¡Œç¼–ç¨‹è®¿é—®çš„å‡ ä¸ªæ¨¡å—ã€‚<br>æ‰€æœ‰çš„å‘½ä»¤å’ŒæŸ¥è¯¢éƒ½ä¼šè¿›å…¥ <strong><code>Driver</code>ï¼ˆé©±åŠ¨æ¨¡å—ï¼‰</strong>ï¼Œé€šè¿‡è¯¥æ¨¡å—å¯¹è¾“å…¥è¿›è¡Œè§£æç¼–è¯‘ï¼Œå¯¹éœ€æ±‚çš„è®¡ç®—è¿›è¡Œä¼˜åŒ–ï¼Œç„¶åæŒ‰ç…§æŒ‡å®šçš„æ­¥éª¤æ‰§è¡Œï¼ˆé€šå¸¸æ˜¯å¯åŠ¨å¤šä¸ª <code>MapReduce</code> ä»»åŠ¡ <code>job</code> æ¥æ‰§è¡Œï¼‰ã€‚å½“éœ€è¦å¯åŠ¨å¯åŠ¨ <code>MapReduce</code> ä»»åŠ¡ï¼ˆ<code>job</code>ï¼‰æ—¶ï¼Œ<code>Hive</code> æœ¬èº«æ˜¯ä¸ä¼šç”Ÿæˆ <code>MapReduce</code> ç®—æ³•ç¨‹åºï¼Œç›¸å <code>Hive</code> ä¼šé€šè¿‡ä¸€ä¸ª <code>XML</code> æ–‡ä»¶çš„ <strong><code>job</code> æ‰§è¡Œè®¡åˆ’</strong>é©±åŠ¨æ‰§è¡Œå†…ç½®çš„ã€åŸç”Ÿçš„ <code>Mapper</code> å’Œ <code>Reduce</code> æ¨¡å—ï¼Œå³è¿™äº›é€šç”¨çš„æ¨¡å—å‡½æ•°ç±»ä¼¼äºå¾®å‹çš„è¯­è¨€ç¿»è¯‘ç¨‹åºï¼Œè€Œé©±åŠ¨æ­¤ç¿»è¯‘ç¨‹åºçš„å°±æ˜¯ <code>XML</code> æ–‡ä»¶ã€‚<br><code>Hive</code> é€šè¿‡å’Œ <strong><code>JobTracker</code> é€šä¿¡æ¥åˆå§‹åŒ– <code>MapReduce</code> ä»»åŠ¡</strong>ï¼Œè€Œä¸å¿…éƒ¨ç½²åœ¨ <code>JobTracker</code> æ‰€åœ¨çš„ç®¡ç†èŠ‚ç‚¹ä¸Šæ‰§è¡Œã€‚<br><strong><code>Metastore</code>ï¼ˆå…ƒæ•°æ®å­˜å‚¨ï¼‰</strong>æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„å…³ç³»å‹æ•°æ®åº“ï¼Œ<code>Hive</code> ä¼šåœ¨å…¶ä¸­ä¿å­˜è¡¨æ¨¡å¼å’Œå…¶ä»–ç³»ç»Ÿå…ƒæ•°æ®ã€‚</p><h4 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h4><p><code>Hive</code> ä¸€èˆ¬è¿è¡Œåœ¨å·¥ä½œç«™ä¸Šï¼Œå°† <code>SQL</code> æŸ¥è¯¢è½¬æ¢ä¸ºä¸€ç³»åˆ—åœ¨ <code>Hadoop</code> é›†ç¾¤ä¸Šè¿è¡Œçš„ä½œä¸šã€‚<code>Hive</code> æŠŠæ•°æ®ç»„ç»‡ä¸ºè¡¨ï¼Œé€šè¿‡è¿™ç§æ–¹å¼ä¸ºå­˜å‚¨åœ¨ <code>HDFS</code> ä¸Šçš„æ•°æ®ç»“æ„èµ‹äºˆç»“æ„ï¼Œå…ƒæ•°æ®ï¼ˆè¡¨æ¨¡å¼ç­‰ï¼‰å­˜å‚¨åœ¨ <code>metastore</code> æ•°æ®åº“ä¸­ã€‚</p><p><code>Hive</code> çš„å®‰è£…éå¸¸ç®€å•ï¼Œé¦–å…ˆå¿…é¡»å®‰è£…ç›¸åŒç‰ˆæœ¬çš„ <code>Hadoop</code>ã€‚ æ¥ä¸‹æ¥ä¸‹è½½ç›¸åŒç‰ˆæœ¬çš„ <code>Hive</code>ï¼Œç„¶åæŠŠå‹ç¼©åŒ…è§£å‹ç¼©åˆ°åˆé€‚çš„ç›®å½•ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">% </span><span class="language-bash">tar xzf apache-hive-x.y.z-bin.tar.gz</span></span><br></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥å°±æ˜¯å°† <code>Hive</code> åŠ å…¥åˆ°å…¨å±€æ–‡ä»¶ä¸­ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">% </span><span class="language-bash"><span class="built_in">export</span> HIVE_HOME=~/apache-hive-x.y.z-bin</span></span><br><span class="line"><span class="meta prompt_">% </span><span class="language-bash"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$HIVE_HOME</span>/bin</span></span><br></pre></td></tr></table></figure><p>æœ€åå°±æ˜¯å¯åŠ¨ <code>Hive</code> çš„ <code>shell</code> ç¯å¢ƒï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">% </span><span class="language-bash">hive</span></span><br><span class="line"><span class="meta prompt_">hive&gt;</span></span><br></pre></td></tr></table></figure><h4 id="ç¯å¢ƒé…ç½®"><a href="#ç¯å¢ƒé…ç½®" class="headerlink" title="ç¯å¢ƒé…ç½®"></a>ç¯å¢ƒé…ç½®</h4><p>ä¸ <code>Hadoop</code> ç±»ä¼¼ï¼Œ<code>Hive</code> ç”¨ <code>XML</code> é…ç½®è¿›è¡Œè®¾ç½®ï¼Œé…ç½®æ–‡ä»¶ä¸º <code>hive-site.xml</code>ï¼Œä½äºåœ¨ <code>Hive</code> çš„ <code>conf</code> ç›®å½•ä¸‹ã€‚é€šè¿‡è¯¥æ–‡ä»¶å¯ä»¥è®¾ç½®æ¯æ¬¡è¿è¡Œ <code>Hive</code> æ—¶å¸Œæœ›ä½¿ç”¨çš„é…ç½®é¡¹ï¼Œè¯¥ç›®å½•ä¸‹è¿˜åŒ…å« <code>hive-default.xml</code> ï¼ˆå…¶ä¸­è®°å½•ç€ <code>Hive</code> çš„é€‰é¡¹åŠé»˜è®¤å€¼ï¼‰ã€‚</p><p><code>hive-site.xml</code> æ–‡ä»¶æœ€é€‚åˆå­˜æ”¾è¯¦ç»†çš„é›†ç¾¤è¿æ¥ä¿¡æ¯ï¼Œå¯ä»¥ä½¿ç”¨ <code>Hadoop</code> å±æ€§ <code>fa.defaultFS</code> å’Œ <code>yarn.resourcemanager.address</code> æ¥æŒ‡å®šæ–‡ä»¶ç³»ç»Ÿå’Œèµ„æºç®¡ç†å™¨ã€‚é»˜è®¤å€¼ä¸ºæœ¬åœ°æ–‡ä»¶ç³»ç»Ÿå’Œæœ¬åœ°ä½œä¸šè¿è¡Œå™¨ï¼ˆ<code>job runner</code>ï¼‰ã€‚</p><p>ä¼ é€’ <code>--config</code> é€‰é¡¹å‚æ•°ç»™ <code>hive</code> å‘½ä»¤ï¼Œå¯ä»¥é€šè¿‡è¿™ç§æ–¹å¼é‡æ–°å®šä¹‰ <code>Hive</code> æŸ¥æ‰¾ <code>hive-site.xml</code> æ–‡ä»¶çš„ç›®å½•ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">% </span><span class="language-bash">hive --config /Users/home/hive-conf</span></span><br></pre></td></tr></table></figure><p>ä¼ é€’ <code>-hiveconf</code> é€‰é¡¹æ¥ä¸ºå•ä¸ªä¼šè¯ï¼ˆ<code>pre-session</code>ï¼‰è®¾ç½®å±æ€§ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">% </span><span class="language-bash">hive -hiveconf fs.defaultFS=hdfs://localhost -hiveconf mapper.framework.name=yarn</span></span><br></pre></td></tr></table></figure><p>è¿˜å¯ä»¥åœ¨ä¸€ä¸ªä¼šè¯ä¸­ä½¿ç”¨ <code>SET</code> å‘½ä»¤æ›´æ”¹è®¾ç½®ï¼Œè¿™å¯¹äºæŸä¸ªç‰¹å®šçš„æŸ¥è¯¢ä¿®æ”¹ <code>Hive</code> è®¾ç½®éå¸¸æœ‰ç”¨ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">hive&gt; </span><span class="language-bash">SET mapper.framework.name=yarn</span></span><br><span class="line"><span class="meta prompt_">hive&gt; </span><span class="language-bash">SET mapper.framework.name</span></span><br><span class="line">mapper.framework.name=yarn</span><br></pre></td></tr></table></figure><p>è®¾ç½®å±æ€§æœ‰ä¸€ä¸ªä¼˜å…ˆçº§å±‚æ¬¡ï¼Œè¶Šå°çš„å€¼è¡¨ç¤ºä¼˜å…ˆçº§è¶Šé«˜ï¼š</p><ul><li><strong><code>Hive SET</code> å‘½ä»¤</strong> ã€‚</li><li><strong>å‘½ä»¤è¡Œ <code>-hiveconf</code> é€‰é¡¹</strong> ã€‚</li><li><strong><code>hive-site.xml</code> å’Œ <code>Hadoop</code> ç«™ç‚¹æ–‡ä»¶</strong>ï¼ˆ<code>core-site.xml</code>ã€<code>hdfs-site.xml</code>ã€<code>mapper-site.xml</code>ã€<code>yarn-site.xml</code>ï¼‰ã€‚</li><li><strong><code>Hive</code> é»˜è®¤å€¼å’Œ <code>Hadoop</code> é»˜è®¤æ–‡ä»¶</strong>ï¼ˆ<code>core-default.xml</code>ã€<code>hadfs-default.xml</code>ã€<code>mapper-default.xml</code>ã€<code>yarn-default.xml</code>ï¼‰ã€‚</li></ul><h4 id="åŸºæœ¬ä½¿ç”¨"><a href="#åŸºæœ¬ä½¿ç”¨" class="headerlink" title="åŸºæœ¬ä½¿ç”¨"></a>åŸºæœ¬ä½¿ç”¨</h4><h5 id="ç”¨æˆ·æ¥å£"><a href="#ç”¨æˆ·æ¥å£" class="headerlink" title="ç”¨æˆ·æ¥å£"></a>ç”¨æˆ·æ¥å£</h5><ol><li><p><strong><code>CLI</code></strong><br><code>Shell</code> ç»ˆç«¯å‘½ä»¤è¡Œï¼ˆ<code>Command Line Interface</code>ï¼‰ï¼Œäº¤äº’å½¢å¼ä½¿ç”¨ <code>Hive</code> å‘½ä»¤è¡Œä¸ <code>Hive</code> è¿›è¡Œäº¤äº’ã€‚</p></li><li><p><strong><code>JDBC/ODBC</code></strong><br><code>Hive</code> åŸºäº <code>JDBC</code> æ“ä½œæä¾›çš„å®¢æˆ·ç«¯ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡è¿æ¥æ¥è®¿é—® <code>Hive Server</code> æœåŠ¡ã€‚</p></li><li><p><strong><code>Web UI</code></strong><br>é€šè¿‡æµè§ˆå™¨è®¿é—® <code>Hive</code>ã€‚</p></li></ol><h5 id="Thrift-Server"><a href="#Thrift-Server" class="headerlink" title="Thrift Server"></a><code>Thrift Server</code></h5><p>è½»é‡çº§ã€è·¨è¯­è¨€çš„è¿œç¨‹æœåŠ¡è°ƒç”¨æ¡†æ¶ï¼Œ<code>Hive</code> é›†æˆè¯¥æœåŠ¡ä¾¿äºä¸åŒçš„ç¼–ç¨‹è¯­è¨€è°ƒç”¨ <code>Hive</code> çš„æ¥å£ã€‚</p><h5 id="Metastore"><a href="#Metastore" class="headerlink" title="Metastore"></a><code>Metastore</code></h5><p><code>Metastore</code> æ˜¯ <code>Hive</code> å…ƒæ•°æ®çš„é›†ä¸­å­˜æ”¾åœ°ï¼Œé€šå¸¸åŒ…å«ä¸¤éƒ¨åˆ†ï¼šæœåŠ¡å’Œå…ƒæ•°æ®çš„å­˜å‚¨ã€‚å…ƒæ•°æ®åŒ…å«ï¼š<strong>è¡¨çš„åå­—</strong>ã€<strong>è¡¨çš„åˆ—å’Œåˆ†åŒºåŠå±æ€§</strong>ã€<strong>è¡¨çš„å±æ€§ï¼ˆå†…éƒ¨è¡¨å’Œå¤–éƒ¨è¡¨ï¼‰</strong>ã€<strong>è¡¨æ•°æ®æ‰€åœ¨ç›®å½•</strong>ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œ<code>metastore</code> æœåŠ¡å’Œ <code>Hive</code> æœåŠ¡è¿è¡Œåœ¨åŒä¸€ä¸ª <code>JVM</code> ä¸­ï¼ŒåŒ…å«ä¸€ä¸ªå†…åµŒçš„ä»¥æœ¬åœ°ç£ç›˜ä½œä¸ºå­˜å‚¨çš„ <code>Derby</code> æ•°æ®åº“å®ä¾‹ï¼Œè¢«ç§°ä¸ºå†…åµŒ <code>metastore</code> é…ç½®ï¼ˆ<code>embedded metastore configuration</code>ï¼‰ã€‚</p><p>å¦‚æœè¦æ”¯æŒå¤šä¼šè¯ï¼ˆä»¥åŠå¤šç”¨æˆ·ï¼‰ï¼Œéœ€è¦ä½¿ç”¨ä¸€ä¸ªç‹¬ç«‹çš„æ•°æ®åº“ã€‚è¿™æ˜¯å› ä¸º <code>MetaStore</code> é€šå¸¸å­˜å‚¨åœ¨å…¶è‡ªå¸¦çš„ <code>Derby</code> æ•°æ®åº“ä¸­ï¼Œç¼ºç‚¹æ˜¯è·Ÿéš <code>Hive</code> éƒ¨ç½²ï¼Œæ•°æ®ç›®å½•ä¸å›ºå®šï¼Œä¸”ä¸æ”¯æŒå¤šç”¨æˆ·æ“ä½œã€‚å¦å¤–ç°åœ¨æ”¯æŒå¤–éƒ¨ <code>MySQL</code> ä¸ <code>Hive</code> äº¤äº’ç”¨äºå­˜å‚¨å…ƒæ•°æ®ä¿¡æ¯ã€‚<br>å¯ä»¥é€šè¿‡æŠŠ <code>hive.metastore.uris</code> è®¾ä¸º <code>metastore</code> æœåŠ¡å™¨ <code>URI</code>ï¼ˆå¦‚æœæœ‰å¤šä¸ªæœåŠ¡å™¨ï¼Œå„ä¸ª <code>URI</code> ä¹‹é—´ä½¿ç”¨é€—å·åˆ†éš”ï¼‰ï¼ŒæŠŠ <code>Hive</code> æœåŠ¡è®¾ä¸ºä½¿ç”¨è¿œç¨‹ <code>metastore</code>ã€‚<code>metastore</code> æœåŠ¡å™¨ <code>URI</code> çš„å½¢å¼ä¸º <code>thrift://host:port</code>ã€‚</p><p><img src="/Hadoop-Hive/hadoop_metastore_1.jpg" alt="hadoop_metastore_1"></p><p>é‡è¦çš„ <code>metastore</code> é…ç½®å±æ€§ï¼š</p><table><thead><tr><th>å±æ€§åç§°</th><th>ç±»å‹ <div style="width: 70px"></th><th>é»˜è®¤å€¼</th><th>æè¿°</th></tr></thead><tbody><tr><td><code>hive.metastore.warehouse.dir</code></td><td><code>URI</code></td><td><code>/user/hive/warehouse</code></td><td>ç›¸å½“äº <code>fs.default.name</code> çš„ç›®å½•ï¼Œæ‰˜ç®¡è¡¨å°±å­˜å‚¨åœ¨è¿™é‡Œ</td></tr><tr><td><code>hive.metastore.uris</code></td><td>é€—å·åˆ†éš”çš„ <code>URI</code></td><td>æœªè®¾å®š</td><td>å¦‚æœæœªè®¾ç½®åˆ™ä½¿ç”¨å½“å‰çš„ <code>metastore</code>ï¼Œå¦åˆ™è¿æ¥åˆ°ç”± <code>URI</code> åˆ—è¡¨æŒ‡å®šè¦è¿æ¥çš„è¿œç¨‹ <code>metastore</code> æœåŠ¡å™¨ã€‚</td></tr><tr><td><code>javax.jddo.option.ConnectionURL</code></td><td><code>URI</code></td><td><code>jdbc:derby:;databaseName=metastoredb;create=true</code></td><td><code>metastore</code> æ•°æ®åº“çš„ <code>JDBC URL</code></td></tr><tr><td><code>javax.jddo.option.ConnectionDriveName</code></td><td>å­—ç¬¦ä¸²</td><td><code>org.apache.derby.jdbc.EmbeddedDriver</code></td><td><code>JDBC</code> é©±åŠ¨å™¨çš„ç±»å</td></tr><tr><td><code>javax.jddo.option.ConnectionUserName</code></td><td>å­—ç¬¦ä¸²</td><td><code>APP</code></td><td><code>JDBC</code> ç”¨æˆ·å</td></tr><tr><td><code>javax.jddo.option.ConnectionPassword</code></td><td>å­—ç¬¦ä¸²</td><td><code>mine</code></td><td><code>JDBC</code> å¯†ç </td></tr></tbody></table><hr><h3 id="ç‰¹æ€§"><a href="#ç‰¹æ€§" class="headerlink" title="ç‰¹æ€§"></a>ç‰¹æ€§</h3><h4 id="è®¡ç®—å¼•æ“"><a href="#è®¡ç®—å¼•æ“" class="headerlink" title="è®¡ç®—å¼•æ“"></a>è®¡ç®—å¼•æ“</h4><p>ç›®å‰ <code>Hive</code> æ”¯æŒ <strong><code>MapReduce</code></strong> ã€ <strong><code>Tez</code></strong> å’Œ <strong><code>Spark</code></strong> ä¸‰ç§è®¡ç®—å¼•æ“ã€‚</p><ol><li><p><strong><code>MapReduce</code></strong> è®¡ç®—å¼•æ“<br>è¯·å‚è€ƒä¹‹å‰çš„åšå®¢å†…å®¹ã€‚</p></li><li><p><strong><code>Spark</code></strong> è®¡ç®—å¼•æ“<br>è¯·å‚è€ƒä¹‹å‰çš„åšå®¢å†…å®¹ã€‚</p></li><li><p><strong><code>Tez</code></strong> è®¡ç®—å¼•æ“<br><code>Apache Tez</code> æ˜¯è¿›è¡Œå¤§è§„æ¨¡æ•°æ®å¤„ç†ä¸”æ”¯æŒ <code>DAG</code> ä½œä¸šçš„è®¡ç®—æ¡†æ¶ï¼Œå®ƒç›´æ¥æºäº <code>MapReduce</code> æ¡†æ¶ï¼Œé™¤äº†èƒ½å¤Ÿæ”¯æŒ <code>MapReduce</code> ç‰¹æ€§ä¹‹å¤–ï¼Œè¿˜æ”¯æŒæ–°çš„ä½œä¸šå½¢å¼ï¼Œå¹¶å…è®¸ä¸åŒç±»å‹çš„ä½œä¸šèƒ½å¤Ÿåœ¨ä¸€ä¸ªé›†ç¾¤ä¸­è¿è¡Œã€‚</p><p> <code>Tez</code> å°†åŸæœ‰çš„ <code>Map</code> å’Œ <code>Reduce</code> ä¸¤ä¸ªæ“ä½œç®€åŒ–ä¸ºä¸€ä¸ªæ–°çš„æ¦‚å¿µ **<code>Vertex</code>**ï¼Œå¹¶å°†åŸæœ‰çš„è®¡ç®—å¤„ç†èŠ‚ç‚¹æ‹†åˆ†æˆå¤šä¸ªç»„æˆéƒ¨åˆ†ï¼š <strong><code>Vertex Input</code></strong> ã€ <strong><code>Vertex Output</code></strong> ã€ <strong><code>Sorting</code></strong>  <strong><code>Shuffling</code></strong> å’Œ <strong><code>Merging</code></strong> ã€‚è®¡ç®—èŠ‚ç‚¹ä¹‹é—´çš„æ•°æ®é€šä¿¡è¢«ç»Ÿç§°ä¸º <strong><code>Edge</code></strong> ï¼Œè¿™äº›åˆ†è§£åçš„å…ƒæ“ä½œå¯ä»¥ä»»æ„çµæ´»ç»„åˆï¼Œäº§ç”Ÿæ–°çš„æ“ä½œï¼Œè¿™äº›æ“ä½œç»è¿‡ä¸€äº›æ§åˆ¶ç¨‹åºç»„è£…åï¼Œå¯å½¢æˆä¸€ä¸ªå¤§çš„ <strong><code>DAG</code></strong> ä½œä¸šã€‚<br> é€šè¿‡å…è®¸ <code>Apache Hive</code> è¿è¡Œæ›´åŠ å¤æ‚çš„ <code>DAG</code> ä»»åŠ¡ï¼Œä¹‹å‰éœ€è¦å¤šä¸ª <code>MR jobs</code>ï¼Œä½†ç°åœ¨è¿è¡Œä¸€ä¸ª <code>Tez</code> ä»»åŠ¡ä¸­ã€‚</p> <img src="/Hadoop-Hive/hadoop_mapreduce-tez.jpg" class="" title="hadoop_mapreduce-tez"><p> <code>Tez</code> å’Œ <code>MapReduce</code> ä½œä¸šçš„æ¯”è¾ƒï¼š</p><ul><li><code>Tez</code> ç»•è¿‡ <code>MapReduce</code> å¾ˆå¤šä¸å¿…è¦çš„ä¸­é—´çš„æ•°æ®å­˜å‚¨å’Œè¯»å–çš„è¿‡ç¨‹ï¼Œç›´æ¥åœ¨ä¸€ä¸ªä½œä¸šä¸­è¡¨è¾¾äº† <code>MapReduce</code> éœ€è¦å¤šä¸ªä½œä¸šå…±åŒåä½œæ‰èƒ½å®Œæˆçš„äº‹æƒ…ã€‚</li><li><code>Tez</code> å’Œ <code>MapReduce</code> ä¸€æ ·éƒ½ä½¿ç”¨ <code>YARN</code> ä½œä¸ºèµ„æºè°ƒåº¦å’Œç®¡ç†ã€‚ä½†ä¸ <code>MapReduce on YARN</code> ä¸åŒï¼Œ<code>Tez on YARN</code> å¹¶ä¸æ˜¯å°†ä½œä¸šæäº¤åˆ° <code>ResourceManager</code>ï¼Œè€Œæ˜¯æäº¤åˆ° <code>AMPoolServer</code> çš„æœåŠ¡ä¸Šï¼Œ<code>AMPoolServer</code> å­˜æ”¾ç€è‹¥å¹²ä¸ªå·²ç»é¢„å…ˆå¯åŠ¨çš„ <code>ApplicationMaster</code> æœåŠ¡ã€‚</li><li>å½“ç”¨æˆ·æäº¤ä¸€ä¸ª <code>Tez</code> ä½œä¸šä¸Šæ¥åï¼Œ<code>AMPoolServer</code> ä»ä¸­é€‰æ‹©ä¸€ä¸ª <code>ApplicationMaster</code> ç”¨äºç®¡ç†ç”¨æˆ·æäº¤ä¸Šæ¥çš„ä½œä¸šï¼Œè¿™æ ·æ—¢å¯ä»¥èŠ‚çœ <code>ResourceManager</code> åˆ›å»º <code>ApplicationMaster</code> çš„æ—¶é—´ï¼Œè€Œåˆèƒ½å¤Ÿé‡ç”¨æ¯ä¸ª <code>ApplicationMaster</code> çš„èµ„æºï¼ŒèŠ‚çœäº†èµ„æºé‡Šæ”¾å’Œåˆ›å»ºæ—¶é—´ã€‚</li></ul><p> <code>Tez</code> ç›¸æ¯”äº <code>MapReduce</code> æœ‰ä»¥ä¸‹å‡ ç‚¹é‡å¤§æ”¹è¿›ï¼š</p><ul><li>å½“æŸ¥è¯¢éœ€è¦æœ‰å¤šä¸ª <code>Reduce</code> é€»è¾‘æ—¶ï¼Œ<code>Hive</code> çš„ <code>MapReduce</code> å¼•æ“ä¼šå°†è®¡åˆ’åˆ†è§£ï¼Œæ¯ä¸ª <code>Redcue</code> æäº¤ä¸€ä¸ª <code>MapReduce</code> ä½œä¸šã€‚è¿™ä¸ªé“¾ä¸­çš„æ‰€æœ‰ <code>MR</code> ä½œä¸šéƒ½éœ€è¦é€ä¸ªè°ƒåº¦ï¼Œæ¯ä¸ªä½œä¸šéƒ½å¿…é¡»ä» <code>HDFS</code> ä¸­é‡æ–°è¯»å–ä¸Šä¸€ä¸ªä½œä¸šçš„è¾“å‡ºå¹¶é‡æ–°æ´—ç‰Œã€‚è€Œåœ¨ <code>Tez</code> ä»»åŠ¡ä¸­ï¼Œå‡ ä¸ª <code>Reduce</code> æ¥æ”¶å™¨å¯ä»¥ç›´æ¥è¿æ¥ï¼Œæ•°æ®å¯ä»¥æµæ°´çº¿ä¼ è¾“ï¼Œè€Œä¸éœ€è¦ä¸´æ—¶ <code>HDFS</code> æ–‡ä»¶ï¼Œè¿™ç§æ¨¡å¼ç§°ä¸º <strong><code>MRRï¼ˆMap-reduce-reduceï¼‰</code></strong> ã€‚</li><li><code>Tez</code> è¿˜å…è®¸ä¸€æ¬¡å‘é€æ•´ä¸ªæŸ¥è¯¢è®¡åˆ’ï¼Œå®ç°åº”ç”¨ç¨‹åºåŠ¨æ€è§„åˆ’ï¼Œä»è€Œä½¿æ¡†æ¶èƒ½å¤Ÿæ›´æ™ºèƒ½åœ°åˆ†é…èµ„æºï¼Œå¹¶é€šè¿‡å„ä¸ªé˜¶æ®µæµæ°´çº¿ä¼ è¾“æ•°æ®ã€‚å¯¹äºæ›´å¤æ‚çš„æŸ¥è¯¢æ¥è¯´ï¼Œè¿™æ˜¯ä¸€ä¸ªå·¨å¤§çš„æ”¹è¿›ï¼Œå› ä¸ºå®ƒæ¶ˆé™¤äº† <code>IO/sync</code> éšœç¢å’Œå„ä¸ªé˜¶æ®µä¹‹é—´çš„è°ƒåº¦å¼€é”€ã€‚</li><li>åœ¨ <code>MapReduce</code> è®¡ç®—å¼•æ“ä¸­ï¼Œæ— è®ºæ•°æ®å¤§å°ï¼Œåœ¨æ´—ç‰Œé˜¶æ®µéƒ½ä»¥ç›¸åŒçš„æ–¹å¼æ‰§è¡Œï¼Œå°†æ•°æ®åºåˆ—åŒ–åˆ°ç£ç›˜ï¼Œå†ç”±ä¸‹æ¸¸çš„ç¨‹åºå»æ‹‰å–ï¼Œå¹¶ååºåˆ—åŒ–ã€‚<code>Tez</code> å¯ä»¥å…è®¸å°æ•°æ®é›†å®Œå…¨åœ¨å†…å­˜ä¸­å¤„ç†ï¼Œè€Œ <code>MapReduce</code> ä¸­æ²¡æœ‰è¿™æ ·çš„ä¼˜åŒ–ã€‚ä»“åº“æŸ¥è¯¢ç»å¸¸éœ€è¦åœ¨å¤„ç†å®Œå¤§é‡çš„æ•°æ®åå¯¹å°å‹æ•°æ®é›†è¿›è¡Œæ’åºæˆ–èšåˆï¼Œå› æ­¤ <code>Tez</code> çš„ä¼˜åŒ–ä¹Ÿèƒ½æå¤§åœ°æå‡æ•ˆç‡ã€‚</li></ul></li></ol><h4 id="å­˜å‚¨æ ¼å¼"><a href="#å­˜å‚¨æ ¼å¼" class="headerlink" title="å­˜å‚¨æ ¼å¼"></a>å­˜å‚¨æ ¼å¼</h4><p><code>Hive</code> æ”¯æŒçš„å­˜å‚¨æ•°çš„æ ¼å¼ä¸»è¦æœ‰ï¼š <strong><code>TEXTFILE</code>ï¼ˆè¡Œå¼å­˜å‚¨ï¼‰</strong>ã€ <strong><code>SEQUENCEFILE</code>ï¼ˆè¡Œå¼å­˜å‚¨ï¼‰</strong>ã€ <strong><code>ORC</code>ï¼ˆåˆ—å¼å­˜å‚¨ï¼‰</strong>ã€ <strong><code>PARQUET</code>ï¼ˆåˆ—å¼å­˜å‚¨ï¼‰</strong>ã€‚</p><p>è¡Œå­˜å‚¨çš„ç‰¹ç‚¹ï¼š æŸ¥è¯¢æ»¡è¶³æ¡ä»¶çš„<strong>ä¸€æ•´è¡Œæ•°æ®</strong>çš„æ—¶å€™ï¼Œåˆ—å­˜å‚¨åˆ™éœ€è¦å»æ¯ä¸ªèšé›†çš„å­—æ®µæ‰¾åˆ°å¯¹åº”çš„æ¯ä¸ªåˆ—çš„å€¼ï¼Œè¡Œå­˜å‚¨åªéœ€è¦æ‰¾åˆ°å…¶ä¸­ä¸€ä¸ªå€¼ï¼Œå…¶ä½™çš„å€¼éƒ½åœ¨ç›¸é‚»åœ°æ–¹ï¼Œæ‰€ä»¥æ­¤æ—¶è¡Œå­˜å‚¨æŸ¥è¯¢çš„é€Ÿåº¦æ›´å¿«ã€‚</p><p>åˆ—å­˜å‚¨çš„ç‰¹ç‚¹ï¼š å› ä¸ºæ¯ä¸ªå­—æ®µçš„æ•°æ®èšé›†å­˜å‚¨ï¼Œåœ¨æŸ¥è¯¢åªéœ€è¦<strong>å°‘æ•°å‡ ä¸ªå­—æ®µ</strong>çš„æ—¶å€™ï¼Œèƒ½å¤§å¤§å‡å°‘è¯»å–çš„æ•°æ®é‡ï¼›æ¯ä¸ªå­—æ®µçš„æ•°æ®ç±»å‹ä¸€å®šæ˜¯ç›¸åŒçš„ï¼Œåˆ—å¼å­˜å‚¨å¯ä»¥é’ˆå¯¹æ€§çš„è®¾è®¡æ›´å¥½çš„è®¾è®¡å‹ç¼©ç®—æ³•ã€‚</p><h5 id="TEXTFILE"><a href="#TEXTFILE" class="headerlink" title="TEXTFILE"></a><code>TEXTFILE</code></h5><p>é»˜è®¤æ ¼å¼ï¼Œæ•°æ®ä¸åšå‹ç¼©ï¼Œç£ç›˜å¼€é”€å¤§ï¼Œæ•°æ®è§£æä¹Ÿå¼€é”€å¤§ã€‚å¯ç»“åˆ <code>Gzip</code>ã€<code>Bzip2</code> ä½¿ç”¨ï¼ˆç³»ç»Ÿè‡ªåŠ¨æ£€æŸ¥ï¼Œæ‰§è¡ŒæŸ¥è¯¢æ—¶è‡ªåŠ¨è§£å‹ï¼‰ï¼Œä½†ä½¿ç”¨è¿™ç§æ–¹å¼ï¼Œ<code>Hive</code> å°±ä¸ä¼šå¯¹æ•°æ®è¿›è¡Œåˆ‡åˆ†ï¼Œä»è€Œæ— æ³•å¯¹æ•°æ®è¿›è¡Œå¹¶è¡Œæ“ä½œã€‚</p><h5 id="ORC-æ ¼å¼"><a href="#ORC-æ ¼å¼" class="headerlink" title="ORC æ ¼å¼"></a><code>ORC</code> æ ¼å¼</h5><p><code>ORC (Optimized Row Columnar)</code> æ˜¯ <code>Hive 0.11</code> å¼•å…¥çš„æ–°çš„å­˜å‚¨æ ¼å¼ã€‚å…¶å¯ä»¥çœ‹åˆ°æ¯ä¸ª <code>ORC</code> æ–‡ä»¶ç”± <code>1</code> ä¸ªæˆ–å¤šä¸ª <code>Stripe</code> ç»„æˆï¼Œæ¯ä¸ª <code>stripe</code> ä¸º <code>250MB</code> å¤§å°ã€‚<br><small><code>Stripe</code> å®é™…ç›¸å½“äº <code>RowGroup</code> æ¦‚å¿µï¼Œä¸è¿‡å¤§å°ç”± <code>4MB-&gt;250MB</code>ï¼Œè¿™æ ·èƒ½æå‡é¡ºåºè¯»çš„ååç‡ã€‚</small><br>æ¯ä¸ª <code>Stripe</code> é‡Œæœ‰ä¸‰éƒ¨åˆ†ç»„æˆï¼Œåˆ†åˆ«æ˜¯ï¼š</p><ul><li><code>Index Data</code><br> ä¸€ä¸ªè½»é‡çº§çš„ <code>index</code>ï¼Œé»˜è®¤æ˜¯æ¯éš” <code>1W</code> è¡Œåšä¸€ä¸ªç´¢å¼•ã€‚è¿™é‡Œåšçš„ç´¢å¼•åªæ˜¯è®°å½•æŸè¡Œçš„å„å­—æ®µåœ¨ <code>Row Data</code> ä¸­çš„ <code>offset</code> åç§»é‡ã€‚</li><li><code>RowData</code><br> å­˜å‚¨çš„æ˜¯å…·ä½“çš„æ•°æ®ï¼Œå…ˆå–éƒ¨åˆ†è¡Œï¼Œç„¶åå¯¹è¿™äº›è¡ŒæŒ‰åˆ—è¿›è¡Œå­˜å‚¨ã€‚å¯¹æ¯ä¸ªåˆ—è¿›è¡Œäº†ç¼–ç ï¼Œåˆ†æˆå¤šä¸ª <code>Stream</code> æ¥å­˜å‚¨ã€‚</li><li><code>Stripe Footer</code><br> å­˜çš„æ˜¯å„ä¸ªstripeçš„å…ƒæ•°æ®ä¿¡æ¯ã€‚æ¯ä¸ªæ–‡ä»¶æœ‰ä¸€ä¸ª <code>File Footer</code>ï¼Œè¿™é‡Œé¢å­˜çš„æ˜¯æ¯ä¸ª <code>Stripe</code> çš„è¡Œæ•°ï¼Œæ¯ä¸ª<code>Column</code> çš„æ•°æ®ç±»å‹ä¿¡æ¯ç­‰ï¼›æ¯ä¸ªæ–‡ä»¶çš„å°¾éƒ¨æ˜¯ä¸€ä¸ª <code>PostScript</code>ï¼Œè®°å½•äº†æ•´ä¸ªæ–‡ä»¶çš„å‹ç¼©ç±»å‹ä»¥åŠ <code>FileFooter</code> çš„é•¿åº¦ä¿¡æ¯ç­‰ã€‚<br> åœ¨è¯»å–æ–‡ä»¶æ—¶ï¼Œä¼š <code>seek</code> åˆ°æ–‡ä»¶å°¾éƒ¨è¯» <code>PostScript</code>ï¼Œä»é‡Œé¢è§£æåˆ° <code>File Footer</code> é•¿åº¦ï¼Œå†è¯» <code>FileFooter</code>ï¼Œä»é‡Œé¢è§£æåˆ°å„ä¸ª <code>Stripe</code> ä¿¡æ¯ï¼Œå†è¯»å„ä¸ª <code>Stripe</code>ï¼Œå³ä»åå¾€å‰è¯»ã€‚</li></ul><h5 id="PARQUET-æ ¼å¼"><a href="#PARQUET-æ ¼å¼" class="headerlink" title="PARQUET æ ¼å¼"></a><code>PARQUET</code> æ ¼å¼</h5><p><code>Parquet</code> æ˜¯é¢å‘åˆ†æå‹ä¸šåŠ¡çš„åˆ—å¼å­˜å‚¨æ ¼å¼ï¼Œä»¥äºŒè¿›åˆ¶æ–¹å¼å­˜å‚¨çš„ï¼Œå› æ­¤æ˜¯ä¸å¯ä»¥ç›´æ¥è¯»å–çš„ï¼Œæ–‡ä»¶ä¸­åŒ…æ‹¬è¯¥æ–‡ä»¶çš„æ•°æ®å’Œå…ƒæ•°æ®ï¼Œæ‰€ä»¥ <code>Parquet</code> æ ¼å¼æ–‡ä»¶æ˜¯è‡ªè§£æçš„ã€‚</p><p>é€šå¸¸æƒ…å†µä¸‹ï¼Œåœ¨å­˜å‚¨ <code>Parquet</code> æ•°æ®çš„æ—¶å€™ä¼šæŒ‰ç…§ <code>Block</code> å¤§å°è®¾ç½®è¡Œç»„çš„å¤§å°ï¼Œç”±äºä¸€èˆ¬æƒ…å†µä¸‹æ¯ä¸€ä¸ª <code>Mapper</code> ä»»åŠ¡å¤„ç†æ•°æ®çš„æœ€å°å•ä½æ˜¯ä¸€ä¸ª <code>Block</code>ï¼Œè¿™æ ·å¯ä»¥æŠŠæ¯ä¸€ä¸ªè¡Œç»„ç”±ä¸€ä¸ª <code>Mapper</code> ä»»åŠ¡å¤„ç†ï¼Œå¢å¤§ä»»åŠ¡æ‰§è¡Œå¹¶è¡Œåº¦ã€‚</p><p>è¯¥ <code>Parquet</code> æ–‡ä»¶çš„å†…å®¹ä¸­ï¼šä¸€ä¸ªæ–‡ä»¶ä¸­å¯ä»¥å­˜å‚¨å¤šä¸ªè¡Œç»„ï¼Œæ–‡ä»¶çš„é¦–ä½éƒ½æ˜¯è¯¥æ–‡ä»¶çš„ <code>Magic Code</code>ï¼Œç”¨äºæ ¡éªŒå®ƒæ˜¯å¦æ˜¯ä¸€ä¸ª <code>Parquet</code>æ–‡ä»¶ï¼›<code>Footer length</code> è®°å½•äº†æ–‡ä»¶å…ƒæ•°æ®çš„å¤§å°ï¼Œé€šè¿‡è¯¥å€¼å’Œæ–‡ä»¶é•¿åº¦å¯ä»¥è®¡ç®—å‡ºå…ƒæ•°æ®çš„åç§»é‡ï¼›æ–‡ä»¶çš„å…ƒæ•°æ®ä¸­åŒ…æ‹¬æ¯ä¸€ä¸ªè¡Œç»„çš„å…ƒæ•°æ®ä¿¡æ¯å’Œè¯¥æ–‡ä»¶å­˜å‚¨æ•°æ®çš„ <code>Schema</code> ä¿¡æ¯ï¼›é™¤äº†æ–‡ä»¶ä¸­æ¯ä¸€ä¸ªè¡Œç»„çš„å…ƒæ•°æ®ï¼Œæ¯ä¸€é¡µçš„å¼€å§‹éƒ½ä¼šå­˜å‚¨è¯¥é¡µçš„å…ƒæ•°æ®ã€‚</p><p>åœ¨Parquetä¸­ï¼Œæœ‰ä¸‰ç§ç±»å‹çš„é¡µï¼š</p><ul><li><strong>æ•°æ®é¡µ</strong><br>  æ•°æ®é¡µç”¨äºå­˜å‚¨å½“å‰è¡Œç»„ä¸­è¯¥åˆ—çš„å€¼ã€‚</li><li><strong>å­—å…¸é¡µ</strong><br>  å­—å…¸é¡µå­˜å‚¨è¯¥åˆ—å€¼çš„ç¼–ç å­—å…¸ï¼Œæ¯ä¸€ä¸ªåˆ—å—ä¸­æœ€å¤šåŒ…å«ä¸€ä¸ªå­—å…¸é¡µã€‚</li><li><strong>ç´¢å¼•é¡µ</strong><br>  ç´¢å¼•é¡µç”¨æ¥å­˜å‚¨å½“å‰è¡Œç»„ä¸‹è¯¥åˆ—çš„ç´¢å¼•ï¼Œç›®å‰ <code>Parquet</code> ä¸­è¿˜ä¸æ”¯æŒç´¢å¼•é¡µã€‚</li></ul><h4 id="å‹ç¼©æ ¼å¼"><a href="#å‹ç¼©æ ¼å¼" class="headerlink" title="å‹ç¼©æ ¼å¼"></a>å‹ç¼©æ ¼å¼</h4><p>åœ¨ <code>Hive</code> ä¸­å¤„ç†æ•°æ®ï¼Œä¸€èˆ¬éƒ½éœ€è¦ç»è¿‡å‹ç¼©ï¼Œé€šè¿‡å‹ç¼©æ¥èŠ‚çœç½‘ç»œå¸¦å®½ã€‚</p><table><thead><tr><th>å‹ç¼©æ ¼å¼</th><th>å·¥å…·</th><th>ç®—æ³•</th><th>æ–‡ä»¶æ‰©å±•å</th><th>æ˜¯å¦å¯åˆ‡åˆ†</th><th>å¯¹åº”çš„ç¼–è§£ç å™¨</th></tr></thead><tbody><tr><td><code>DEFAULT</code></td><td>æ— </td><td><code>DEFAULT</code></td><td><code>.deflate</code></td><td>å¦</td><td><code>org.apache.hadoop.io.compress.DefaultCodec</code></td></tr><tr><td><code>Gzip</code></td><td><code>gzip</code></td><td><code>DEFAULT</code></td><td><code>.gz</code></td><td>å¦</td><td><code>org.apache.hadoop.io.compress.GzipCodec</code></td></tr><tr><td><code>bzip2</code></td><td><code>bzip2</code></td><td><code>bzip2</code></td><td><code>.bz2</code></td><td>æ˜¯</td><td><code>org.apache.hadoop.io.compress.BZip2Codec</code></td></tr><tr><td><code>LZO</code></td><td><code>lzop</code></td><td><code>LZO</code></td><td><code>.lzo</code></td><td>å¦</td><td><code>com.hadoop.compression.lzo.LzopCodec</code></td></tr><tr><td><code>LZ4</code></td><td>æ— </td><td><code>LZ4</code></td><td><code>.lz4</code></td><td>å¦</td><td><code>org.apache.hadoop.io.compress.Lz4Codec</code></td></tr><tr><td><code>Snappy</code></td><td>æ— </td><td><code>Snappy</code></td><td><code>.snappy</code></td><td>å¦</td><td><code>org.apache.hadoop.io.compress.SnappyCodec</code></td></tr></tbody></table><h4 id="åº•å±‚æ‰§è¡ŒåŸç†"><a href="#åº•å±‚æ‰§è¡ŒåŸç†" class="headerlink" title="åº•å±‚æ‰§è¡ŒåŸç†"></a>åº•å±‚æ‰§è¡ŒåŸç†</h4><img src="/Hadoop-Hive/mmexport1684155646915.jpg" class="" title="mmexport1684155646915"><h5 id="Driver-è¿è¡Œå™¨"><a href="#Driver-è¿è¡Œå™¨" class="headerlink" title="Driver è¿è¡Œå™¨"></a><code>Driver</code> è¿è¡Œå™¨</h5><p><code>Driver</code> ç»„ä»¶å®Œæˆ <code>HQL</code> æŸ¥è¯¢è¯­å¥ä»è¯æ³•åˆ†æï¼Œè¯­æ³•åˆ†æï¼Œç¼–è¯‘ï¼Œä¼˜åŒ–ï¼Œä»¥åŠç”Ÿæˆé€»è¾‘æ‰§è¡Œè®¡åˆ’çš„ç”Ÿæˆã€‚ç”Ÿæˆçš„é€»è¾‘æ‰§è¡Œè®¡åˆ’å­˜å‚¨åœ¨ <code>HDFS</code> ä¸­ï¼Œå¹¶éšåç”± <code>MapReduce</code> è°ƒç”¨æ‰§è¡Œã€‚<br><code>Hive</code> çš„æ ¸å¿ƒæ˜¯é©±åŠ¨å¼•æ“ï¼Œ é©±åŠ¨å¼•æ“ç”±å››éƒ¨åˆ†ç»„æˆï¼š</p><ul><li><strong>è§£é‡Šå™¨</strong>ï¼šè§£é‡Šå™¨çš„ä½œç”¨æ˜¯å°† <code>HiveSQL</code> è¯­å¥è½¬æ¢ä¸ºæŠ½è±¡è¯­æ³•æ ‘ï¼ˆ<code>AST</code>ï¼‰ã€‚</li><li><strong>ç¼–è¯‘å™¨</strong>ï¼šç¼–è¯‘å™¨æ˜¯å°†è¯­æ³•æ ‘ç¼–è¯‘ä¸ºé€»è¾‘æ‰§è¡Œè®¡åˆ’ã€‚</li><li><strong>ä¼˜åŒ–å™¨</strong>ï¼šä¼˜åŒ–å™¨æ˜¯å¯¹é€»è¾‘æ‰§è¡Œè®¡åˆ’è¿›è¡Œä¼˜åŒ–ã€‚</li><li><strong>æ‰§è¡Œå™¨</strong>ï¼šæ‰§è¡Œå™¨æ˜¯è°ƒç”¨åº•å±‚çš„è¿è¡Œæ¡†æ¶æ‰§è¡Œé€»è¾‘æ‰§è¡Œè®¡åˆ’ã€‚</li></ul><h5 id="æ‰§è¡Œæµç¨‹"><a href="#æ‰§è¡Œæµç¨‹" class="headerlink" title="æ‰§è¡Œæµç¨‹"></a>æ‰§è¡Œæµç¨‹</h5><p><code>HiveQL</code> é€šè¿‡å‘½ä»¤è¡Œæˆ–è€…å®¢æˆ·ç«¯æäº¤ï¼Œç»è¿‡ <code>Compiler</code> ç¼–è¯‘å™¨ï¼Œè¿ç”¨ <code>MetaStore</code> ä¸­çš„å…ƒæ•°æ®è¿›è¡Œç±»å‹æ£€æµ‹å’Œè¯­æ³•åˆ†æï¼Œç”Ÿæˆä¸€ä¸ªé€»è¾‘æ–¹æ¡ˆ(<code>Logical Plan</code>)ï¼Œç„¶åé€šè¿‡çš„ä¼˜åŒ–å¤„ç†ï¼Œäº§ç”Ÿä¸€ä¸ª <code>MapReduce</code> ä»»åŠ¡ã€‚</p><img src="/Hadoop-Hive/hadoop_hive_driver.jpg" class="" title="hadoop_hive_driver"><h4 id="ä¸ä¼ ç»Ÿæ•°æ®åº“æ¯”è¾ƒ"><a href="#ä¸ä¼ ç»Ÿæ•°æ®åº“æ¯”è¾ƒ" class="headerlink" title="ä¸ä¼ ç»Ÿæ•°æ®åº“æ¯”è¾ƒ"></a>ä¸ä¼ ç»Ÿæ•°æ®åº“æ¯”è¾ƒ</h4><p><code>Hive</code> åœ¨å¾ˆå¤šæ–¹é¢ä¸ä¼ ç»Ÿçš„æ•°æ®åº“ç±»ä¼¼ï¼Œä½†ç”±äºéœ€è¦æ”¯æŒ <code>MapReduce</code> å’Œ <code>HDFS</code> å°±æ„å‘³ç€å…¶ä½“ç³»ç»“æ„æœ‰åˆ«äºä¼ ç»Ÿæ•°æ®åº“ï¼Œè€Œè¿™äº›åŒºåˆ«åˆå½±å“ç€ <code>Hive</code> æ‰€æ”¯æŒçš„ç‰¹æ€§ã€‚</p><h5 id="è¯»æ—¶æ¨¡å¼å’Œå†™æ—¶æ¨¡å¼"><a href="#è¯»æ—¶æ¨¡å¼å’Œå†™æ—¶æ¨¡å¼" class="headerlink" title="è¯»æ—¶æ¨¡å¼å’Œå†™æ—¶æ¨¡å¼"></a>è¯»æ—¶æ¨¡å¼å’Œå†™æ—¶æ¨¡å¼</h5><p>åœ¨åŠ è½½æ—¶å‘ç°æ•°æ®ä¸ç¬¦åˆæ¨¡å¼ï¼Œåˆ™æ‹’ç»åŠ è½½æ•°æ®ï¼Œå› ä¸ºæ•°æ®æ˜¯åœ¨å†™å…¥æ•°æ®åº“æ—¶å¯¹ç…§æ¨¡å¼è¿›è¡Œæ£€æŸ¥ï¼Œå› æ­¤è¿™ä¸€è®¾è®¡åˆè¢«ç§°ä¸º<strong>â€œå†™æ—¶æ¨¡å¼â€</strong> ã€‚è€Œ <code>Hive</code> å¯¹æ•°æ®çš„éªŒè¯å¹¶ä¸åœ¨åŠ è½½æ•°æ®æ—¶è¿›è¡Œï¼Œè€Œæ˜¯åœ¨æŸ¥è¯¢æ—¶è¿›è¡Œï¼Œè¢«ç§°ä¸º<strong>â€œè¯»æ—¶æ¨¡å¼â€</strong> ã€‚</p><p><strong>è¯»æ—¶æ¨¡å¼</strong>ä¸éœ€è¦è¯»å–æ•°æ®æ¥è¿›è¡Œâ€œè§£æâ€ï¼Œå†è¿›è¡Œåºåˆ—åŒ–å¹¶ä»¥æ•°æ®åº“å†…éƒ¨æ ¼å¼å­˜å…¥ç£ç›˜ï¼Œå› æ­¤å¯ä»¥ä½¿æ•°æ®åŠ è½½éå¸¸è¿…é€Ÿã€‚<strong>å†™æ—¶æ¨¡å¼</strong>å¯ä»¥å¯¹åˆ—è¿›è¡Œç´¢å¼•ï¼Œå¹¶å¯¹æ•°æ®è¿›è¡Œå‹ç¼©ï¼Œä½†è¿™ä¹Ÿä¼šå¯¼è‡´åŠ è½½æ•°æ®ä¼šé¢å¤–è€—æ—¶ï¼Œç”±æ­¤æœ‰åˆ©äºæå‡æŸ¥è¯¢æ€§èƒ½ã€‚</p><h5 id="æ›´æ–°ã€äº‹åŠ¡å’Œç´¢å¼•"><a href="#æ›´æ–°ã€äº‹åŠ¡å’Œç´¢å¼•" class="headerlink" title="æ›´æ–°ã€äº‹åŠ¡å’Œç´¢å¼•"></a>æ›´æ–°ã€äº‹åŠ¡å’Œç´¢å¼•</h5><p>æ›´æ–°ã€ç´¢å¼•å’Œäº‹åŠ¡è¿™äº›æ˜¯ä¼ ç»Ÿæ•°æ®åº“æœ€è¦çš„ç‰¹æ€§ï¼Œä½† <code>Hive</code> å¹¶ä¸æ”¯æŒè¿™äº›ï¼Œå› ä¸ºéœ€è¦æ”¯æŒ <code>MapReduce</code> æ“ä½œ <code>HDFS</code> æ•°æ®ï¼Œå› æ­¤ <strong>â€œå…¨è¡¨æ‰«æâ€</strong> æ˜¯å¸¸æ€åŒ–æ“ä½œï¼Œè€Œè¡¨æ›´æ–°åˆ™æ˜¯å°†æ•°æ®å˜æ¢åæ”¾å…¥æ–°è¡¨å®ç°ã€‚</p><ol><li><p>æ›´æ–°<br><code>HDFS</code> ä¸æä¾›å°±åœ°æ–‡ä»¶æ›´æ–°ï¼Œå› æ­¤æ’å…¥ã€æ›´æ–°ã€åˆ é™¤ç­‰ä¸€ç³»åˆ—å¼•èµ·æ•°æ®å˜åŒ–çš„æ“ä½œéƒ½ä¼šè¢«ä¿å­˜åœ¨ä¸€ä¸ªè¾ƒå°çš„å¢é‡æ–‡ä»¶ä¸­ï¼Œç”± <code>metastore</code> åœ¨åå°è¿è¡Œçš„ <code>MapReduce</code> ä»»åŠ¡å®šæœŸå°†è¿™äº›å¢é‡æ–‡ä»¶åˆå¹¶åˆ°åŸºè¡¨æ–‡ä»¶ä¸­ã€‚<br><small>ä¸Šè¿°åŠŸèƒ½çš„æ”¯æŒå¿…é¡»å¯ç”¨äº‹åŠ¡ï¼Œä»¥ä¿è¯å¯¹è¡¨è¿›è¡Œè¯»å–æ“ä½œæ—¶å¯ä»¥çœ‹åˆ°è¡¨çš„ä¸€è‡´æ€§å¿«ç…§ã€‚</small></p></li><li><p>é”<br><code>Hive</code> å¼•å…¥äº†è¡¨çº§ï¼ˆ<code>table-level</code>ï¼‰å’Œåˆ†åŒºçº§ï¼ˆ<code>partition-level</code>ï¼‰çš„é”ï¼Œå› æ­¤å¯ä»¥é˜²æ­¢ä¸€ä¸ªè¿›ç¨‹åˆ é™¤æ­£åœ¨è¢«å¦ä¸€ä¸ªè¿›ç¨‹è¯»å–çš„è¡¨ã€‚è¯¥é”ç”± <code>ZooKeeper</code> é€æ˜ç®¡ç†ï¼Œå› æ­¤ç”¨æˆ·ä¸å¿…æ‰§è¡Œè·å–å’Œé‡Šæ”¾é”çš„æ“ä½œï¼Œä½†å¯ä»¥é€šè¿‡ <code>SHOW LOCKS</code> è¯­å¥è·å–å·²ç»è·å¾—äº†å“ªäº›é”çš„ä¿¡æ¯ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œæœªå¯ç”¨é”çš„åŠŸèƒ½ã€‚</p></li><li><p>ç´¢å¼•<br><code>Hive</code> çš„ç´¢å¼•ç›®å‰è¢«åˆ†ä¸ºä¸¤ç±»ï¼š<strong>ç´§å‡‘ç´¢å¼•ï¼ˆ<code>compact index</code>ï¼‰</strong>å’Œ<strong>ä½å›¾ç´¢å¼•ï¼ˆ<code>bitmap index</code>ï¼‰</strong>ã€‚<br>ç´§å‡‘ç´¢å¼•å­˜å‚¨æ¯ä¸ªå€¼çš„ <code>HDFS</code> å—å·ï¼Œè€Œä¸æ˜¯å­˜å‚¨æ–‡ä»¶å†…åç§»é‡ï¼Œå› æ­¤å­˜å‚¨ä¸ä¼šå ç”¨è¿‡å¤šçš„ç£ç›˜ç©ºé—´ï¼Œå¹¶ä¸”å¯¹äºå€¼è¢«èšç°‡ï¼ˆ<code>clustered</code>ï¼‰å­˜å‚¨äºç›¸è¿‘è¡Œçš„æƒ…å†µï¼Œç´¢å¼•ä»ç„¶èƒ½å¤Ÿæœ‰æ•ˆã€‚<br>ä½å›¾ç´¢å¼•ä½¿ç”¨å‹ç¼©çš„ä½é›†åˆï¼ˆ<code>bitset</code>ï¼‰æ¥é«˜æ•ˆå­˜å‚¨æŸä¸ªç‰¹æ®Šå€¼çš„è¡Œï¼Œè€Œè¿™ç§ç´¢å¼•ä¸€èˆ¬é€‚ç”¨äºè¾ƒå°‘å–å€¼çš„åˆ—ï¼ˆä¾‹å¦‚æ€§åˆ«å’Œå›½å®¶ï¼‰ã€‚</p></li></ol><h5 id="å…¶ä»–-SQL-on-hadoop"><a href="#å…¶ä»–-SQL-on-hadoop" class="headerlink" title="å…¶ä»– SQL-on-hadoop"></a>å…¶ä»– <code>SQL-on-hadoop</code></h5><p>é’ˆå¯¹ <code>Hive</code> çš„å±€é™æ€§ï¼Œä¹Ÿæœ‰å…¶ä»–çš„ <code>SQL-on-Hadoop</code> æŠ€æœ¯å‡ºç°ï¼Œé‚£ä¹ˆ <strong><code>Cloudera Impala</code></strong> å°±æ˜¯å…¶ä¸­çš„ä½¼ä½¼è€…ï¼Œä»–æ˜¯å¼€æºäº¤äº’å¼ <code>SQL</code> å¼•æ“ï¼Œ<code>Impala</code> åœ¨æ€§èƒ½ä¸Šè¦å¼ºäº <code>MapReduce</code> çš„ <code>Hive</code> é«˜ä¸€ä¸ªæ•°é‡çº§ã€‚<br><code>Impala</code> ä½¿ç”¨ä¸“é—¨çš„å®ˆæŠ¤è¿›ç¨‹ï¼Œè¿™äº›å®ˆæŠ¤è¿›ç¨‹è¿è¡Œåœ¨é›†ç¾¤ä¸­çš„æ¯ä¸ªæ•°æ®èŠ‚ç‚¹ä¸Šï¼Œå½“å®¢æˆ·ç«¯å‘èµ·æŸ¥è¯¢æ—¶ï¼Œä¼šé¦–å…ˆè”ç³»ä»»æ„ä¸€ä¸ªè¿è¡Œäº† <code>Impala</code> å®ˆæŠ¤è¿›ç¨‹çš„èŠ‚ç‚¹ï¼Œè¯¥èŠ‚ç‚¹ä¼šè¢«å½“ä½œè¯¥æŸ¥è¯¢çš„åè°ƒï¼ˆ<code>coordination</code>ï¼‰èŠ‚ç‚¹ã€‚åè°ƒèŠ‚ç‚¹å‘é›†ç¾¤ä¸­çš„å…¶ä»– <code>Impala</code> å®ˆæŠ¤è¿›ç¨‹åˆ†å‘å·¥ä½œï¼Œå¹¶æ”¶é›†ç»“æœä»¥å½¢æˆè¯¥æŸ¥è¯¢çš„å®Œæ•´ç»“æœé›†ã€‚<code>Impala</code> ä½¿ç”¨ <code>Hive</code> çš„ <code>Metastore</code> å¹¶æ”¯æŒ <code>Hive</code> æ ¼å¼å’Œç»å¤§å¤šæ•°çš„ <code>HiveQL</code> ç»“æ„ï¼Œå› æ­¤åœ¨å®é™…ä¸­è¿™ä¸¤è€…å¯ä»¥ç›´è§‚åœ°ç›¸äº’ç§»æ¤ï¼Œæˆ–è€…è¿è¡Œåœ¨åŒä¸€ä¸ªé›†ç¾¤ä¸Šã€‚</p><p>å½“ç„¶ä¹Ÿæœ‰ <code>Hortonworks</code> çš„ <strong><code>Stinger</code></strong> è®¡åˆ’æ”¯æŒ <code>Tez</code> ä½œä¸ºæ‰§è¡Œå¼•æ“ï¼Œå†åŠ ä¸ŠçŸ¢é‡åŒ–æŸ¥è¯¢å¼•æ“ç­‰å…¶ä»–æ”¹è¿›æŠ€æœ¯ï¼Œä½¿ <code>Hive</code> åœ¨æ€§èƒ½ä¸Šå¾—åˆ°å¾ˆå¤§çš„æå‡ã€‚</p><p><strong><code>Apache phoenix</code></strong> åˆ™é‡‡å–äº†å¦ä¸€ç§å®Œå…¨ä¸åŒçš„æ–¹å¼ï¼Œæä¾›åŸºäº <code>HBase</code> çš„ <code>SQL</code>ï¼Œé€šè¿‡ <code>JDBC</code> é©±åŠ¨å®ç° <code>SQL</code> è®¿é—®ï¼Œ<code>JDBC</code> é©±åŠ¨å°†æŸ¥è¯¢è½¬æ¢ä¸º <code>HBase</code> æ‰«æï¼Œå¹¶åˆ©ç”¨ <code>HBase</code> ååŒå¤„ç†å™¨æ¥æ‰§è¡ŒæœåŠ¡å™¨ç«¯çš„èšåˆï¼Œå½“ç„¶æ•°æ®ä¹Ÿå­˜å‚¨åœ¨ <code>HBase</code> ä¸­ã€‚ </p><hr> <h3 id="HiveQL"><a href="#HiveQL" class="headerlink" title="HiveQL"></a><code>HiveQL</code></h3><p><code>Hive</code> çš„ <code>SQL</code> è¢«ç§°ä¸º <code>HiveQL</code>ï¼Œæ˜¯ <code>SQL-92</code>ã€ <code>MySQL</code>ã€ <code>Oracle SQL</code> çš„æ··åˆä½“ã€‚å…¶æ¦‚è¦æ¯”è¾ƒå¦‚ä¸‹ï¼š</p><table><thead><tr><th>ç‰¹æ€§</th><th><code>SQL</code></th><th><code>HiveQL</code></th></tr></thead><tbody><tr><td>æ›´æ–°</td><td><code>UPDATE</code>ã€ <code>INSERT</code>ã€ <code>DELETE</code></td><td><code>UPDATE</code>ã€ <code>INSERT</code>ã€ <code>DELETE</code></td></tr><tr><td>äº‹åŠ¡</td><td>æ”¯æŒ</td><td>æœ‰é™æ”¯æŒ</td></tr><tr><td>ç´¢å¼•</td><td>æ”¯æŒ</td><td>æ”¯æŒ</td></tr><tr><td>å»¶è¿Ÿ</td><td>äºšç§’çº§</td><td>åˆ†é’Ÿçº§</td></tr><tr><td>æ•°æ®ç±»å‹</td><td>æ•´æ•°ã€æµ®ç‚¹æ•°ã€å®šç‚¹æ•°ã€æ–‡æœ¬å’ŒäºŒè¿›åˆ¶ä¸²ã€æ—¶é—´</td><td>å¸ƒå°”å‹ã€æ•´æ•°ã€æµ®ç‚¹æ•°ã€æ–‡æœ¬å’ŒäºŒè¿›åˆ¶ä¸²ã€æ—¶é—´æˆ³ã€æ•°ç»„ã€æ˜ å°„ã€ç»“æ„</td></tr><tr><td>å‡½æ•°</td><td>æ•°ç™¾ä¸ªå†…ç½®å‡½æ•°</td><td>æ•°ç™¾ä¸ªå†…ç½®å‡½æ•°</td></tr><tr><td>å¤šè¡¨æ’å…¥</td><td>ä¸æ”¯æŒ</td><td>æ”¯æŒ</td></tr><tr><td><code>CREATE TABLE AS SELECT</code></td><td><code>SQL-92</code> ä¸­ä¸æ”¯æŒï¼Œä½†æœ‰äº›æ•°æ®åº“æ”¯æŒ</td><td>æ”¯æŒ</td></tr><tr><td><code>SELECT</code></td><td><code>SQL-92</code></td><td><code>SQL-92</code>ã€‚æ”¯æŒååºçš„ <code>SORT BY</code>ï¼Œå¯é™åˆ¶è¿”å›æ•°é‡çš„ <code>LIMIT</code></td></tr><tr><td>è¿æ¥</td><td><code>SQL-92</code> æ”¯æŒæˆ–å˜ç›¸æ”¯æŒ</td><td>å†…è¿æ¥ã€å¤–è¿æ¥ã€åŠè¿æ¥ã€æ˜ å°„è¿æ¥ã€äº¤å‰è¿æ¥</td></tr><tr><td>å­æŸ¥è¯¢</td><td>åœ¨ä»»ä½•å­å¥ä¸­æ”¯æŒçš„æˆ–ä¸ç›¸å…³çš„</td><td>åªèƒ½åœ¨ <code>FROM</code>ã€ <code>WHERE</code> æˆ– <code>HAVING</code> å­å¥ä¸­</td></tr><tr><td>è§†å›¾</td><td>å¯æ›´æ–°</td><td>åªè¯»</td></tr><tr><td>æ‰©å±•ç‚¹</td><td>ç”¨æˆ·å®šä¹‰å‡½æ•°ã€å­˜å‚¨è¿‡ç¨‹</td><td>ç”¨æˆ·å®šä¹‰å‡½æ•°ã€<code>MapReduce</code> è„šæœ¬</td></tr></tbody></table><h4 id="æ•°æ®ç±»å‹"><a href="#æ•°æ®ç±»å‹" class="headerlink" title="æ•°æ®ç±»å‹"></a>æ•°æ®ç±»å‹</h4><p><code>Hive</code> æ”¯æŒåŸå­å’Œå¤æ‚æ•°æ®ç±»å‹ã€‚åŸå­æ•°æ®ç±»å‹åŒ…æ‹¬<strong>æ•°å€¼å‹</strong>ã€<strong>å¸ƒå°”å‹</strong>ã€<strong>å­—ç¬¦ä¸²ç±»å‹</strong>å’Œ<strong>æ—¶é—´æˆ³ç±»å‹</strong>ã€‚å¤æ‚æ•°æ®ç±»å‹åŒ…æ‹¬<strong>æ•°ç»„</strong>ã€<strong>æ˜ å°„</strong>å’Œ<strong>ç»“æ„</strong>ã€‚</p><p><code>Hive</code> æä¾›äº†æ™®é€š <code>SQL</code> æ“ä½œç¬¦ï¼ŒåŒ…æ‹¬ï¼š<strong>å…³ç³»æ“ä½œç¬¦</strong>ã€<strong>ç®—æœ¯æ“ä½œç¬¦</strong>å’Œ<strong>é€»è¾‘æ“ä½œç¬¦</strong>ã€‚</p><h4 id="è‡ªå®šä¹‰å‡½æ•°"><a href="#è‡ªå®šä¹‰å‡½æ•°" class="headerlink" title="è‡ªå®šä¹‰å‡½æ•°"></a>è‡ªå®šä¹‰å‡½æ•°</h4><p>ç”¨æˆ·è‡ªå®šä¹‰å‡½æ•°ï¼ˆ<code>UDF</code>ï¼‰æ˜¯ä¸€ä¸ªå…è®¸ç”¨æˆ·é€šè¿‡æ‰©å±• <code>HiveQL</code> çš„å¼ºå¤§åŠŸèƒ½ï¼Œç”¨æˆ·é€šè¿‡ <code>Java</code> ç¼–å†™è‡ªå·±çš„ <code>UDF</code>ï¼Œåœ¨å°†è‡ªå®šä¹‰å‡½æ•°åŠ å…¥ç”¨æˆ·ä¼šè¯åï¼Œå°±å¯ä»¥è·Ÿå†…ç½®å‡½æ•°ä¸€æ ·ä½¿ç”¨ã€‚<br><code>Hive</code> æä¾›äº†å¤šç§ç±»å‹çš„ç”¨æˆ·è‡ªå®šä¹‰å‡½æ•°ï¼Œæ¯ä¸€ç§éƒ½ä¼šé’ˆå¯¹è¾“å…¥æ•°æ®æ‰§è¡Œç‰¹å®šçš„è½¬æ¢è¿‡ç¨‹ï¼Œå…·ä½“ç±»å‹åŒ…å«ä»¥ä¸‹ä¸‰ç§ï¼š</p><ul><li><strong><code>UDF (User Defined Function)</code></strong> ï¼šä¸€è¿›ä¸€å‡ºã€‚ä¼ å…¥ä¸€ä¸ªå€¼ï¼Œé€»è¾‘è¿ç®—åè¿”å›ä¸€ä¸ªå€¼ï¼Œå¦‚å†…ç½®å‡½æ•°çš„ <code>floor</code>ã€<code>round</code> ç­‰ã€‚</li><li><strong><code>UDAF (User Defined Aggregation Funtion)</code></strong> ï¼šå¤šè¿›ä¸€å‡ºã€‚ä¼ å…¥å¤šè¡Œæ•°æ®ï¼Œæ ¹æ®é€‰å®šçš„å€¼ <code>group by</code> åè¿”å›ä¸€è¡Œç»“æœï¼Œç±»ä¼¼ <code>sum</code>ã€<code>count</code>ã€‚</li><li><strong><code>UDTF (User Defined Table Generating Functions)</code></strong> ï¼šä¸€è¿›å¤šå‡ºã€‚åŸºäºç‰¹å®šçš„ä¸€è¡Œå€¼è¾“å…¥ï¼Œè¿”å›å±•å¼€å¤šè¡Œè¾“å‡ºï¼Œç±»ä¼¼å†…ç½®å‡½æ•° <code>explode</code>ã€‚</li></ul><p>åˆ›å»ºè‡ªå®šä¹‰å‡½æ•°æ­¥éª¤å¦‚ä¸‹ï¼š</p><ul><li><strong>ç¼–å†™è‡ªå®šä¹‰å‡½æ•°</strong><br>  å¼•å…¥ä¾èµ–  <figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.hive<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>hive-exec<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><strong>ç¼–è¯‘éƒ¨ç½²</strong><br>  è‡ªå®šä¹‰å‡½æ•°ä»£ç ç¼–å†™å®Œæˆåï¼Œç¼–è¯‘æ‰“åŒ…ä¸º <code>jar</code> æ–‡ä»¶ã€‚<br>  éƒ¨ç½² <code>jar</code> æ–‡ä»¶è¦æ ¹æ®éƒ¨ç½²æ¨¡å¼è¿›è¡Œè°ƒæ•´ï¼Œæœ¬åœ°æ¨¡å¼åˆ™æ˜¯å°† <code>jar</code> æ–‡ä»¶é‡‡ç”¨æœ¬åœ°æ¨¡å¼éƒ¨ç½²ï¼Œè€Œéæœ¬åœ°æ¨¡å¼åˆ™æ˜¯å°† <code>jar</code> æ–‡ä»¶æ”¾ç½®åˆ°å…±äº«å­˜å‚¨ï¼ˆ<code>HHDFS</code>ï¼‰ä¸Šã€‚  <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æœ¬åœ°æ¨¡å¼</span></span><br><span class="line"><span class="meta prompt_">hive&gt; </span><span class="language-bash">ADD jar hive-jar-test-1.0.0.jar</span></span><br><span class="line">Added hive-jar-test-1.0.0.jar to class path</span><br><span class="line"><span class="meta prompt_">hive&gt; </span><span class="language-bash">list jars;</span></span><br><span class="line">hive-jar-test-1.0.0.jar</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">éæœ¬åœ°æ¨¡å¼</span></span><br><span class="line">hadoop fs -put hive-jar-test-1.0.0.jar /usr/home/hive-jar-test-1.0.0.jar</span><br></pre></td></tr></table></figure></li><li><strong><code>Hive</code> ä¸­æ³¨å†Œå‡½æ•°</strong><br>  æ³¨å†Œå‡½æ•°ä¹Ÿè¢«åˆ†ä¸ºä¸¤ç§ï¼š<strong>ä¸´æ—¶å‡½æ•°</strong>å’Œ<strong>æ°¸ä¹…å‡½æ•°</strong>ï¼Œä¸´æ—¶æ³¨å†Œå‡½æ•°ç”¨äºè§£å†³ä¸€äº›ä¸´æ—¶ç‰¹æ®Šçš„ä¸šåŠ¡éœ€æ±‚å¼€å‘çš„å‡½æ•°ï¼Œ<code>Hive</code> æ³¨å†Œçš„ä¸´æ—¶å‡½æ•°åªåœ¨å½“å‰ä¼šè¯ä¸­å¯ç”¨ï¼Œæ³¨å†Œå‡½æ•°æ—¶éœ€è¦ä½¿ç”¨ <code>temporary</code> å…³é”®å­—å£°æ˜ã€‚æ³¨å†Œå‡½æ•°æ—¶æœªä½¿ç”¨ä¸´æ—¶å…³é”®å­— <code>temporary</code> çš„éƒ½ä¸ºæ°¸ä¹…å‡½æ•°ï¼Œåœ¨æ‰€æœ‰ä¼šè¯ä¸­éƒ½å¯ç”¨ã€‚  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CREATE [temporary] FUNCTION [dbname.]function_name AS class_name [USING jar | file | archive &#x27;file_url&#x27;]</span><br></pre></td></tr></table></figure></li><li><strong>ä½¿ç”¨è‡ªå®šä¹‰å‡½æ•°</strong><br>  å‡½æ•°å…¨åä½¿ç”¨ <code>dbname.function_name</code> è¡¨ç¤ºï¼Œä½¿ç”¨çš„æ—¶å€™å¯ä»¥ç›´æ¥ç”¨å‡½æ•°å…¨åï¼Œä½†æŸ¥è¯¢å¦‚æœåœ¨å½“å‰åº“ä¸‹æ“ä½œï¼Œåˆ™ä½¿ç”¨å‡½æ•°åå³å¯ã€‚  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> id, test_udf_lower(content) <span class="keyword">FROM</span> test_table_1 LIMIT <span class="number">10</span>;</span><br></pre></td></tr></table></figure></li><li><strong>é”€æ¯è‡ªå®šä¹‰å‡½æ•°</strong>  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DROP [temporary] FUNCTION [dbname.]function_name AS class_name;</span><br></pre></td></tr></table></figure></li></ul><h5 id="UDF"><a href="#UDF" class="headerlink" title="UDF"></a><code>UDF</code></h5><p>ç¼–å†™ <code>UDF</code>ï¼Œéœ€è¦ç»§æ‰¿ <code>org.apache.hadoop.hive.ql.exec.UDF</code> å¹¶é‡å†™ <code>evaluate</code> å‡½æ•°ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> org.example;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hive.ql.exec.UDF;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.Text;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestUDF</span> <span class="keyword">extends</span> <span class="title class_">UDF</span> &#123;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è¿™é‡Œæ¥å—å‚æ•°çš„ç±»å‹å¿…é¡»æ˜¯ Hadoop æ”¯æŒçš„è¾“å…¥è¾“å‡ºç±»å‹</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> Test <span class="title function_">evaluate</span><span class="params">(<span class="keyword">final</span> Test x)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Text</span>(x.toString()).toLowerCase();</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><small><code>UDF</code> å¿…é¡»æœ‰è¿”å›ç±»å‹ï¼Œå¯ä»¥è¿”å› <code>null</code>ï¼Œä½†è¿”å›ç±»å‹ä¸èƒ½ä¸º <code>void</code>ã€‚</small></p><h5 id="UDAF"><a href="#UDAF" class="headerlink" title="UDAF"></a><code>UDAF</code></h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> org.example;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hive.ql.exec.UDFArgumentTypeException;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hive.ql.metadata.HiveException;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hive.ql.parse.SemanticException;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hive.ql.udf.generic.AbstractGenericUDAFResolver;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hive.ql.udf.generic.GenericUDAFEvaluator;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hive.serde2.objectinspector.ObjectInspector;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hive.serde2.objectinspector.ObjectInspectorFactory;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hive.serde2.objectinspector.PrimitiveObjectInspector;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.hive.serde2.typeinfo.TypeInfo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestUDAF</span> <span class="keyword">extends</span> <span class="title class_">AbstractGenericUDAFResolver</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> GenericUDAFEvaluator <span class="title function_">getEvaluator</span><span class="params">(TypeInfo[] parameters)</span></span><br><span class="line">            <span class="keyword">throws</span> SemanticException &#123;</span><br><span class="line">        <span class="keyword">if</span> (parameters.length != <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">UDFArgumentTypeException</span>(parameters.length - <span class="number">1</span>, <span class="string">&quot;Exactly one argument is expected.&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="type">ObjectInspector</span> <span class="variable">oi</span> <span class="operator">=</span> TypeInfoUtils.getStandardJavaObjectInspectorFromTypeInfo(parameters[<span class="number">0</span>]);</span><br><span class="line">        <span class="keyword">if</span> (oi.getCategory() != ObjectInspector.Category.PRIMITIVE)&#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">UDFArgumentTypeException</span>(<span class="number">0</span>, <span class="string">&quot;Argument must be PRIMITIVE, but &quot;</span> + oi.getCategory().name() + <span class="string">&quot; was passed.&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="type">PrimitiveObjectInspector</span> <span class="variable">inputOI</span> <span class="operator">=</span> (PrimitiveObjectInspector) oi;</span><br><span class="line">        <span class="keyword">if</span> (inputOI.getPrimitiveCategory() != PrimitiveObjectInspector.PrimitiveCategory.STRING)&#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">UDFArgumentTypeException</span>(<span class="number">0</span>, <span class="string">&quot;Argument must be String, but &quot;</span> + inputOI.getPrimitiveCategory().name() + <span class="string">&quot; was passed.&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">TotalNumOfLettersEvaluator</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">TotalNumOfLettersEvaluator</span> <span class="keyword">extends</span> <span class="title class_">GenericUDAFEvaluator</span> &#123;</span><br><span class="line">        PrimitiveObjectInspector inputOI;</span><br><span class="line">        ObjectInspector outputOI;</span><br><span class="line">        PrimitiveObjectInspector integerOI;</span><br><span class="line">        <span class="type">int</span> <span class="variable">total</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"> </span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> ObjectInspector <span class="title function_">init</span><span class="params">(Mode m, ObjectInspector[] parameters)</span> <span class="keyword">throws</span> HiveException &#123;</span><br><span class="line">            <span class="keyword">assert</span>(parameters.length == <span class="number">1</span>);</span><br><span class="line">            <span class="built_in">super</span>.init(m, parameters);</span><br><span class="line">           </span><br><span class="line">            <span class="comment">//mapé˜¶æ®µè¯»å–sqlåˆ—ï¼Œè¾“å…¥ä¸ºStringåŸºç¡€æ•°æ®æ ¼å¼</span></span><br><span class="line">            <span class="keyword">if</span> (m == Mode.PARTIAL1 || m == Mode.COMPLETE) &#123;</span><br><span class="line">                inputOI = (PrimitiveObjectInspector) parameters[<span class="number">0</span>];</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="comment">//å…¶ä½™é˜¶æ®µï¼Œè¾“å…¥ä¸ºIntegeråŸºç¡€æ•°æ®æ ¼å¼</span></span><br><span class="line">            integerOI = (PrimitiveObjectInspector) parameters[<span class="number">0</span>];</span><br><span class="line">            &#125;</span><br><span class="line"> </span><br><span class="line">            <span class="comment">// æŒ‡å®šå„ä¸ªé˜¶æ®µè¾“å‡ºæ•°æ®æ ¼å¼éƒ½ä¸ºIntegerç±»å‹</span></span><br><span class="line">            outputOI = ObjectInspectorFactory.getReflectionObjectInspector(Integer.class, ObjectInspectorOptions.JAVA);</span><br><span class="line">            <span class="keyword">return</span> outputOI;</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * å­˜å‚¨å½“å‰å­—ç¬¦æ€»æ•°çš„ç±»</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">LetterSumAgg</span> <span class="keyword">implements</span> <span class="title class_">AggregationBuffer</span> &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">sum</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(<span class="type">int</span> num)</span>&#123;</span><br><span class="line">            sum += num;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> AggregationBuffer <span class="title function_">getNewAggregationBuffer</span><span class="params">()</span> <span class="keyword">throws</span> HiveException &#123;</span><br><span class="line">            <span class="type">LetterSumAgg</span> <span class="variable">result</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">LetterSumAgg</span>();</span><br><span class="line">            <span class="keyword">return</span> result;</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">reset</span><span class="params">(AggregationBuffer agg)</span> <span class="keyword">throws</span> HiveException &#123;</span><br><span class="line">        <span class="type">LetterSumAgg</span> <span class="variable">myagg</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">LetterSumAgg</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">private</span> <span class="type">boolean</span> <span class="variable">warned</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line"> </span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">iterate</span><span class="params">(AggregationBuffer agg, Object[] parameters)</span> <span class="keyword">throws</span> HiveException &#123;</span><br><span class="line">            <span class="keyword">assert</span> (parameters.length == <span class="number">1</span>);</span><br><span class="line">            <span class="keyword">if</span> (parameters[<span class="number">0</span>] != <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="type">LetterSumAgg</span> <span class="variable">myagg</span> <span class="operator">=</span> (LetterSumAgg) agg;</span><br><span class="line">                <span class="type">Object</span> <span class="variable">p1</span> <span class="operator">=</span> ((PrimitiveObjectInspector) inputOI).getPrimitiveJavaObject(parameters[<span class="number">0</span>]);</span><br><span class="line">                myagg.add(String.valueOf(p1).length());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> Object <span class="title function_">terminatePartial</span><span class="params">(AggregationBuffer agg)</span> <span class="keyword">throws</span> HiveException &#123;</span><br><span class="line">            <span class="type">LetterSumAgg</span> <span class="variable">myagg</span> <span class="operator">=</span> (LetterSumAgg) agg;</span><br><span class="line">            total += myagg.sum;</span><br><span class="line">            <span class="keyword">return</span> total;</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">merge</span><span class="params">(AggregationBuffer agg, Object partial)</span> <span class="keyword">throws</span> HiveException &#123;</span><br><span class="line">            <span class="keyword">if</span> (partial != <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="type">LetterSumAgg</span> <span class="variable">myagg1</span> <span class="operator">=</span> (LetterSumAgg) agg;</span><br><span class="line">                <span class="type">Integer</span> <span class="variable">partialSum</span> <span class="operator">=</span> (Integer) integerOI.getPrimitiveJavaObject(partial);</span><br><span class="line">                <span class="type">LetterSumAgg</span> <span class="variable">myagg2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">LetterSumAgg</span>();</span><br><span class="line">                </span><br><span class="line">                myagg2.add(partialSum);</span><br><span class="line">                myagg1.add(myagg2.sum);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> Object <span class="title function_">terminate</span><span class="params">(AggregationBuffer agg)</span> <span class="keyword">throws</span> HiveException &#123;</span><br><span class="line">            <span class="type">LetterSumAgg</span> <span class="variable">myagg</span> <span class="operator">=</span> (LetterSumAgg) agg;</span><br><span class="line">            total = myagg.sum;</span><br><span class="line">            <span class="keyword">return</span> myagg.sum;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å‡½æ•°æ‰§è¡Œè¿‡ç¨‹ï¼š</p><ul><li><code>PARTIAL1</code>ï¼šä»åŸå§‹æ•°æ®åˆ°éƒ¨åˆ†èšåˆæ•°æ®çš„è¿‡ç¨‹ï¼Œä¼šè°ƒç”¨ <code>iterate()</code> å’Œ <code>terminatePartial()</code> æ–¹æ³•ã€‚<code>iterate()</code> å‡½æ•°è´Ÿè´£è§£æè¾“å…¥æ•°æ®ï¼Œè€Œ <code>terminatePartial()</code> è´Ÿè´£è¾“å‡ºå½“å‰ä¸´æ—¶èšåˆç»“æœã€‚è¯¥é˜¶æ®µå¯ä»¥ç†è§£ä¸ºå¯¹åº” <code>MapReduce</code> è¿‡ç¨‹ä¸­çš„ <code>Map</code> é˜¶æ®µã€‚</li><li><code>PARTIAL2</code>ï¼šä»éƒ¨åˆ†èšåˆæ•°æ®åˆ°éƒ¨åˆ†èšåˆæ•°æ®çš„è¿‡ç¨‹ï¼ˆå¤šæ¬¡èšåˆï¼‰ï¼Œä¼šè°ƒç”¨ <code>merge()</code> å’Œ <code>terminatePartial()</code> æ–¹æ³•ã€‚<code>merge()</code> å‡½æ•°è´Ÿè´£èšåˆ <code>Map</code> é˜¶æ®µ <code>terminatePartial()</code> å‡½æ•°è¾“å‡ºçš„éƒ¨åˆ†èšåˆç»“æœï¼Œ<code>terminatePartial()</code> è´Ÿè´£è¾“å‡ºå½“å‰ä¸´æ—¶èšåˆç»“æœã€‚é˜¶æ®µå¯ä»¥ç†è§£ä¸ºå¯¹åº” <code>MapReduce</code> è¿‡ç¨‹ä¸­çš„ <code>Combine</code> é˜¶æ®µã€‚</li><li><code>FINAL</code>: ä»éƒ¨åˆ†èšåˆæ•°æ®åˆ°å…¨éƒ¨èšåˆæ•°æ®çš„è¿‡ç¨‹ï¼Œä¼šè°ƒç”¨ <code>merge()</code> å’Œ <code>terminate()</code> æ–¹æ³•ã€‚<code>merge()</code> å‡½æ•°è´Ÿè´£èšåˆ <code>Map</code> é˜¶æ®µæˆ–è€… <code>Combine</code> é˜¶æ®µ <code>terminatePartial()</code> å‡½æ•°è¾“å‡ºçš„éƒ¨åˆ†èšåˆç»“æœã€‚<code>terminate()</code> æ–¹æ³•è´Ÿè´£è¾“å‡º <code>Reduce</code> é˜¶æ®µæœ€ç»ˆçš„èšåˆç»“æœã€‚è¯¥é˜¶æ®µå¯ä»¥ç†è§£ä¸ºå¯¹åº” <code>MapReduce</code> è¿‡ç¨‹ä¸­çš„ <code>Reduce</code> é˜¶æ®µã€‚</li><li><code>COMPLETE</code>: ä»åŸå§‹æ•°æ®ç›´æ¥åˆ°å…¨éƒ¨èšåˆæ•°æ®çš„è¿‡ç¨‹ï¼Œä¼šè°ƒç”¨ <code>iterate()</code> å’Œ <code>terminate()</code> æ–¹æ³•ã€‚å¯ä»¥ç†è§£ä¸º <code>MapReduce</code> è¿‡ç¨‹ä¸­çš„ç›´æ¥ <code>Map</code> è¾“å‡ºé˜¶æ®µï¼Œæ²¡æœ‰ <code>Reduce</code> é˜¶æ®µã€‚</li></ul><p><small>è¿˜æœ‰å¦å¤–ä¸€ç§å®ç°æ–¹å¼æ˜¯ç»§æ‰¿ <code>org.apache.hadoop.hive.ql.exec.UDAF</code>ï¼Œå¹¶ä¸”åŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªåµŒå¥—çš„ã€å®ç°äº† <code>org.apache.hadoop.hive.ql.UDAFEvaluator</code> çš„é™æ€ç±»ã€‚</small></p><hr> <h3 id="æ•°æ®åº“"><a href="#æ•°æ®åº“" class="headerlink" title="æ•°æ®åº“"></a>æ•°æ®åº“</h3><h4 id="è¡¨"><a href="#è¡¨" class="headerlink" title="è¡¨"></a>è¡¨</h4><p><code>Hive</code> çš„è¡¨åœ¨é€»è¾‘ä¸Šç”±å­˜å‚¨çš„æ•°æ®å’Œæè¿°è¡¨ä¸­æ•°æ®å½¢å¼çš„ç›¸å…³å…ƒæ•°æ®ç»„æˆã€‚æ•°æ®ä¸€èˆ¬å­˜æ”¾åœ¨ <code>HDFS</code> ä¸­ï¼Œä½†å®ƒä¹Ÿå¯ä»¥æ”¾åœ¨å…¶ä»–ä»»ä½• <code>Hadoop</code> æ–‡ä»¶ç³»ç»Ÿä¸­ï¼ŒåŒ…æ‹¬æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿæˆ– <code>S3</code>ã€‚<code>Hive</code> æŠŠå…ƒæ•°æ®å­˜æ”¾åœ¨å…³ç³»å‹æ•°æ®åº“ä¸­ï¼Œè€Œä¸æ˜¯æ”¾åœ¨ <code>HDFS</code> ä¸­ã€‚</p><h5 id="æ‰˜ç®¡è¡¨å’Œå¤–éƒ¨è¡¨"><a href="#æ‰˜ç®¡è¡¨å’Œå¤–éƒ¨è¡¨" class="headerlink" title="æ‰˜ç®¡è¡¨å’Œå¤–éƒ¨è¡¨"></a>æ‰˜ç®¡è¡¨å’Œå¤–éƒ¨è¡¨</h5><p>åœ¨ <code>Hive</code> ä¸­åˆ›å»ºè¡¨æ—¶ï¼Œé»˜è®¤æƒ…å†µä¸‹ç”± <code>Hive</code> è´Ÿè´£ç®¡ç†æ•°æ®ï¼Œè¿™ä¹Ÿå°±æ„å‘³ç€è¦å°†æ•°æ®ç§»å…¥ä»“åº“ç›®å½•ï¼Œè¢«ç§°ä¸º<strong>å†…éƒ¨è¡¨</strong>ã€‚è€Œå¦å¤–ä¸€ç§åˆ™æ˜¯<strong>å¤–éƒ¨è¡¨</strong>ï¼Œæ•°æ®å­˜æ”¾åœ¨ä»“åº“ç›®å½•ä»¥å¤–çš„åœ°æ–¹ã€‚</p><p>è¿™ä¸¤ç§è¡¨çš„åŒºåˆ«åœ¨äº <code>LOAD</code> å’Œ <code>DROP</code> å‘½ä»¤çš„è¯­ä¹‰ä¸Šï¼š</p><ul><li><code>LOAD</code><br>  æ‰˜ç®¡è¡¨ï¼š  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> test_table_1(content STRING);</span><br><span class="line">LOAD DATA INPATH <span class="string">&#x27;/usr/home/data.txt&#x27;</span> <span class="keyword">INTO</span> <span class="keyword">TABLE</span> test_table_1;</span><br></pre></td></tr></table></figure>  åŠ è½½æ•°æ®åˆ°æ‰˜ç®¡è¡¨æ—¶ï¼Œä¼šå°†æ•°æ®æ–‡ä»¶ç§»å…¥åˆ°ä»“åº“ç›®å½•ä¸‹ã€‚<br>  å¤–éƒ¨è¡¨ï¼š  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">EXTERNAL</span> <span class="keyword">TABLE</span> test_table_2 (content STRING) LOCATION <span class="string">&#x27;/usr/home/data.txt&#x27;</span>;</span><br><span class="line">LOAD DATA INPATH <span class="string">&#x27;/usr/home/data.txt&#x27;</span> <span class="keyword">INTO</span> <span class="keyword">TABLE</span> test_table_2;</span><br></pre></td></tr></table></figure></li><li><code>DROP</code><br>  æ‰˜ç®¡è¡¨ï¼š  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> test_table_1;</span><br></pre></td></tr></table></figure>  æ‰§è¡Œä¸Šè¿°æ“ä½œï¼Œä¼šå°†å…¶å…ƒæ•°æ®å’Œæ•°æ®ä¸€èµ·è¢«åˆ é™¤ï¼Œè¿™ä¹Ÿå°±æ˜¯ <strong>â€œæ‰˜ç®¡æ•°æ®â€</strong> çš„å«ä¹‰ã€‚<br>  å¤–éƒ¨è¡¨ï¼š  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> test_table_2;</span><br></pre></td></tr></table></figure>  åˆ é™¤å¤–éƒ¨è¡¨å¹¶ä¸ä¼šåˆ é™¤æ•°æ®ï¼Œä»…ä¼šåˆ é™¤å…ƒæ•°æ®ã€‚</li></ul><p>é‚£ä¹ˆå¦‚ä½•é€‰æ‹©å¹¶ä½¿ç”¨è¿™ä¸¤ç§ç±»å‹çš„è¡¨å‘¢ï¼Ÿ<br>æœ‰ä¸€ä¸ªç»éªŒæ³•åˆ™å°±æ˜¯ï¼Œå¦‚æœéœ€è¦æ‰€æœ‰çš„å¤„ç†éƒ½ç”± <code>Hive</code> å®Œæˆï¼Œé‚£ä¹ˆåº”è¯¥ä½¿ç”¨æ‰˜ç®¡è¡¨ã€‚å¦‚æœè¦ä½¿ç”¨å…¶ä»–çš„å·¥å…·æ¥å¤„ç†æ•°æ®é›†åˆ™ä½¿ç”¨å¤–éƒ¨è¡¨ã€‚</p><h5 id="åˆ†åŒºå’Œæ¡¶"><a href="#åˆ†åŒºå’Œæ¡¶" class="headerlink" title="åˆ†åŒºå’Œæ¡¶"></a>åˆ†åŒºå’Œæ¡¶</h5><p><code>Hive</code> å°†è¡¨ç»„ç»‡æˆ<strong>åˆ†åŒºï¼ˆ<code>partition</code>ï¼‰</strong>ï¼Œè¿™æ˜¯ä¸€ç§æ ¹æ®<strong>åˆ†åŒºåˆ—ï¼ˆ<code>partition column</code>ï¼‰</strong>çš„å€¼å¯¹è¡¨è¿›è¡Œç²—ç•¥åˆ’åˆ†çš„æœºåˆ¶ã€‚ä½¿ç”¨åˆ†åŒºå¯ä»¥åŠ å¿«æ•°æ®åˆ†ç‰‡ï¼ˆ<code>slice</code>ï¼‰çš„æŸ¥è¯¢é€Ÿåº¦ã€‚</p><p>è¡¨æˆ–åˆ†åŒºå¯ä»¥è¿›ä¸€æ­¥åˆ†ä¸º<strong>æ¡¶ï¼ˆ<code>bucket</code>ï¼‰</strong>ï¼Œä¼šä¸ºæ•°æ®æä¾›é¢å¤–çš„ç»“æ„ä»¥è·å¾—æ›´é«˜æ•ˆçš„æŸ¥è¯¢å¤„ç†ã€‚</p><ol><li><p>åˆ†åŒº<br>ä¸€ä¸ªè¡¨å¯ä»¥é€šè¿‡å¤šä¸ªç»´åº¦æ¥è¿›è¡Œåˆ†åŒºã€‚åˆ†åŒºæ˜¯åœ¨åˆ›å»ºè¡¨çš„æ—¶å€™ç”¨ <code>PARTITIONED BY</code> å­å¥å®šä¹‰çš„ï¼Œè¯¥å­å¥éœ€è¦å®šä¹‰åˆ—çš„åˆ—è¡¨ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> test_table_3 (ts <span class="type">INT</span>, line STRING)</span><br><span class="line">PARTITIONED <span class="keyword">BY</span> (dt STRING, country STRING);</span><br></pre></td></tr></table></figure><p>è€Œåœ¨æ–‡ä»¶ç³»ç»Ÿçº§åˆ«ï¼Œåˆ†åŒºåªæ˜¯è¡¨ç›®å½•ä¸‹åµŒå¥—çš„å­ç›®å½•ï¼Œå°†æ›´å¤šçš„æ–‡ä»¶åŠ è½½åˆ°è¡¨ç›®å½•ä¹‹åï¼Œç›®å½•ç»“æ„å¦‚ä¸‹ï¼š</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">/usr/home/warehouse/test_table_3</span><br><span class="line">dt=2023-05-16</span><br><span class="line">country=CN</span><br><span class="line">file1</span><br><span class="line">file2</span><br><span class="line">country=EU</span><br><span class="line">file5</span><br><span class="line">file6</span><br><span class="line">dt=2023-05-17</span><br><span class="line">country=CN</span><br><span class="line">file3</span><br><span class="line">file4</span><br></pre></td></tr></table></figure><p>ä¹‹åä½¿ç”¨ <code>SHOW PARTITIONS</code> å‘½ä»¤æ˜¾ç¤ºè¡¨ä¸­çš„åˆ†åŒºåˆ—è¡¨ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">hive<span class="operator">&gt;</span> <span class="keyword">SHOW</span> PARTITIONS test_table_3</span><br><span class="line">dt<span class="operator">=</span><span class="number">2023</span><span class="number">-05</span><span class="number">-16</span><span class="operator">/</span>country<span class="operator">=</span>CN</span><br><span class="line">dt<span class="operator">=</span><span class="number">2023</span><span class="number">-05</span><span class="number">-16</span><span class="operator">/</span>country<span class="operator">=</span>EU</span><br><span class="line">dt<span class="operator">=</span><span class="number">2023</span><span class="number">-05</span><span class="number">-17</span><span class="operator">/</span>country<span class="operator">=</span>CN</span><br></pre></td></tr></table></figure><p><small><code>PARTITIONED BY</code> å­å¥ä¸­çš„åˆ—å®šä¹‰æ˜¯è¡¨ä¸­æ­£å¼çš„åˆ—ï¼Œç§°ä¸º<strong>åˆ†åŒºåˆ—ï¼ˆ<code>partition column</code>ï¼‰</strong>ï¼Œä½†æ•°æ®ä¸­å¹¶ä¸åŒ…å«è¿™äº›åˆ—çš„å€¼ï¼Œè€Œæ˜¯æºäºç›®å½•åã€‚</small><br>åœ¨æ—¥å¸¸çš„æŸ¥è¯¢ä¸­ä»¥é€šå¸¸çš„æ–¹å¼ä½¿ç”¨åˆ†åŒºåˆ—ï¼Œ<code>Hive</code> ä¼šå¯¹è¾“å…¥è¿›è¡Œä¿®å‰ªï¼Œä»è€Œåªæ‰«æç›¸å…³åˆ†åŒºã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> ts <span class="keyword">FROM</span> test_table_3 <span class="keyword">where</span> country <span class="operator">=</span> <span class="string">&#x27;CN&#x27;</span>;</span><br></pre></td></tr></table></figure></li><li><p>æ¡¶<br>å°†è¡¨ï¼ˆæˆ–åˆ†åŒºï¼‰ç»„ç»‡æˆ<strong>æ¡¶ï¼ˆ<code>bucket</code>ï¼‰</strong>æœ‰ä»¥ä¸‹ä¼˜ç‚¹ï¼š</p><ul><li>è·å¾—æ›´é«˜çš„æŸ¥è¯¢å¤„ç†æ•ˆç‡ã€‚æ¡¶ä¸ºè¡¨å¢åŠ äº†é¢å¤–çš„ç»“æ„ï¼Œåœ¨å¤„ç†æŸ¥è¯¢æ—¶èƒ½å¤Ÿåˆ©ç”¨è¿™ä¸ªç»“æ„ï¼Œå…·ä½“ä¸ºè¿æ¥ä¸¤ä¸ªåœ¨ç›¸åŒåˆ—ä¸Šåˆ’åˆ†äº†æ¡¶çš„è¡¨ï¼Œå¯ä»¥ä½¿ç”¨ <code>map</code> ç«¯è¿æ¥é«˜æ•ˆåœ°å®ç°ã€‚</li><li>ä½¿å–æ ·æ›´åŠ é«˜æ•ˆã€‚åœ¨å¤„ç†å¤§è§„æ¨¡æ•°æ®é›†æ—¶ï¼Œèƒ½ä½¿ç”¨æ•°æ®çš„ä¸€éƒ¨åˆ†è¿›è¡ŒæŸ¥è¯¢ï¼Œä¼šå¸¦æ¥å¾ˆå¤šæ–¹ä¾¿ã€‚</li></ul><p> <code>Hive</code> ä½¿ç”¨ <code>CLUSTERED BY</code> å­å¥æ¥æŒ‡å®šåˆ’åˆ†æ¡¶æ‰€ç”¨çš„åˆ—å’Œè¦åˆ’åˆ†çš„æ¡¶çš„ä¸ªæ•°ï¼š<br> <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> test_table_4 (ts <span class="type">INT</span>, line STRING)</span><br><span class="line">CLUSTERED <span class="keyword">BY</span> (id) <span class="keyword">INTO</span> <span class="number">4</span> BUCKETS;</span><br></pre></td></tr></table></figure></p><p> åœ¨å®é™…ç‰©ç†å­˜å‚¨ä¸Šï¼Œæ¯ä¸ªæ¡¶å°±æ˜¯è¡¨ï¼ˆæˆ–åˆ†åŒºï¼‰ç›®å½•é‡Œçš„ä¸€ä¸ªæ–‡ä»¶ï¼Œå…¶æ–‡ä»¶åå¹¶ä¸é‡è¦ï¼Œä½†æ¡¶ <code>n</code> æ˜¯æŒ‰ç…§å­—å…¸åºæ’åˆ—çš„ç¬¬ <code>n</code> ä¸ªæ–‡ä»¶ã€‚äº‹å®ä¸Šæ¡¶å¯¹åº”äº <code>MapReduce</code> çš„è¾“å‡ºæ–‡ä»¶åˆ†åŒºï¼šä¸€ä¸ªä½œä¸šäº§ç”Ÿçš„æ¡¶å’Œ <code>reduce</code> ä»»åŠ¡ä¸ªæ•°ç›¸åŒã€‚<br> å¯ä»¥é€šè¿‡æŸ¥çœ‹åˆšæ‰åˆ›å»ºçš„ <code>bucketed_users</code> è¡¨çš„å¸ƒå±€æ¥äº†è§£è¿™ä¸€æƒ…å†µï¼š<br> <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">hive&gt; </span><span class="language-bash">dfs -<span class="built_in">ls</span> /usr/home/warehouse/bucketed_users;</span></span><br><span class="line">000000_0</span><br><span class="line">000001_0</span><br><span class="line">000002_0</span><br><span class="line">000003_0</span><br></pre></td></tr></table></figure></p><p> ä½¿ç”¨ <code>TABLESAMPLE</code> å­å¥å¯¹è¡¨è¿›è¡Œå–æ ·ï¼Œå¯ä»¥è·å¾—ç›¸åŒçš„ç»“æœï¼Œè¯¥å­å¥ä¼šæŸ¥è¯¢é™å®šåœ¨è¡¨çš„ä¸€éƒ¨åˆ†æ¡¶å†…ï¼Œè€Œä¸æ˜¯æ•´ä¸ªè¡¨ï¼š<br> <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">hive<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> bucketed_users <span class="keyword">TABLESAMPLE</span>(BUCKET <span class="number">1</span> <span class="keyword">OUT</span> <span class="keyword">OF</span> <span class="number">4</span> <span class="keyword">ON</span> id);</span><br><span class="line"><span class="number">4</span> Ann</span><br><span class="line"><span class="number">0</span> Nat</span><br><span class="line"><span class="number">2</span> Joe</span><br></pre></td></tr></table></figure></p></li></ol><h5 id="å¯¼å…¥æ•°æ®"><a href="#å¯¼å…¥æ•°æ®" class="headerlink" title="å¯¼å…¥æ•°æ®"></a>å¯¼å…¥æ•°æ®</h5><p>å‰é¢å·²ç»ä½¿ç”¨ <code>LOAD DATA</code> æ“ä½œï¼Œé€šè¿‡æŠŠæ–‡ä»¶å¤åˆ¶æˆ–ç§»åŠ¨åˆ°è¡¨çš„ç›®å½•ä¸­ï¼Œä»è€ŒæŠŠæ•°æ®å¯¼å…¥åˆ° <code>Hive</code> çš„è¡¨ï¼ˆæˆ–åˆ†åŒºï¼‰ã€‚ä¹Ÿå¯ä»¥ä½¿ç”¨ <code>INSERT</code> è¯­å¥æŠŠæ•°æ®ä»ä¸€ä¸ª <code>Hive</code> è¡¨å¡«å……åˆ°å¦ä¸€ä¸ªï¼Œæˆ–åœ¨æ–°å»ºè¡¨æ—¶ä½¿ç”¨ <strong><code>CTAS</code> ï¼ˆ<code>CREATE TABLE ... AS SELECT</code>ï¼‰</strong>ç»“æ„ã€‚</p><ol><li><p><code>INSERT</code></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> OVERWRITE <span class="keyword">TABLE</span> target [<span class="keyword">PARTITION</span>(dt)] <span class="keyword">SELECT</span> col1, col2 <span class="keyword">FROM</span> source;</span><br></pre></td></tr></table></figure><p><code>OVERWRITE</code> å…³é”®å­—æ„å‘³ç€ç›®æ ‡è¡¨ï¼ˆåˆ†åŒºï¼‰ä¸­çš„å†…å®¹ä¼šè¢«æ›¿æ¢æ‰ã€‚</p></li><li><p>å¤šè¡¨æ’å…¥</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> source</span><br><span class="line"><span class="keyword">INSERT</span> OVERWRITE <span class="keyword">TABLE</span> table_by_year <span class="keyword">SELECT</span> <span class="keyword">year</span>, <span class="built_in">COUNT</span>(<span class="keyword">DISTINCT</span> <span class="keyword">table</span>) <span class="keyword">GROUP</span> <span class="keyword">BY</span> <span class="keyword">year</span></span><br><span class="line"><span class="keyword">INSERT</span> OVERWRITE <span class="keyword">TABLE</span> table_by_month <span class="keyword">SELECT</span> <span class="keyword">month</span>, <span class="built_in">COUNT</span>(<span class="keyword">DISTINCT</span> <span class="keyword">table</span>) <span class="keyword">GROUP</span> <span class="keyword">BY</span> <span class="keyword">month</span></span><br></pre></td></tr></table></figure><p>è¿™ç§<strong>å¤šè¡¨æ’å…¥</strong>æ¯”ä½¿ç”¨å•ç‹¬çš„ <code>INSERT</code> æ•ˆç‡æ›´é«˜ï¼Œå› ä¸ºåªéœ€è¦æ‰«æä¸€éæºè¡¨å°±å¯ä»¥ç”Ÿæˆå¤šä¸ªä¸ç›¸äº¤çš„è¾“å‡ºã€‚</p></li><li><p><code>CTAS</code> è¯­å¥<br>å°† <code>Hive</code> æŸ¥è¯¢çš„ç»“æœè¾“å‡ºåˆ°ä¸€ä¸ªæ–°çš„è¡¨å†…æ˜¯éå¸¸æ–¹ä¾¿çš„ï¼Œæ–°è¡¨çš„åˆ—çš„å®šä¹‰æ˜¯ä» <code>SELECT</code> å­å¥æ‰€æ£€ç´¢çš„åˆ—å¯¼å‡ºçš„ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> target</span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> col1, col2 <span class="keyword">FROM</span> source;</span><br></pre></td></tr></table></figure></li></ol><h5 id="è¡¨çš„ä¿®æ”¹å’Œåˆ é™¤"><a href="#è¡¨çš„ä¿®æ”¹å’Œåˆ é™¤" class="headerlink" title="è¡¨çš„ä¿®æ”¹å’Œåˆ é™¤"></a>è¡¨çš„ä¿®æ”¹å’Œåˆ é™¤</h5><p>ç”±äº <code>Hive</code> ä½¿ç”¨<em>è¯»æ—¶æ¨¡å¼ï¼ˆ<code>schema on read</code>ï¼‰</em>ï¼Œæ‰€ä»¥è¡¨åœ¨åˆ›å»ºä¹‹åå¯ä»¥éå¸¸çµæ´»åœ°æ”¯æŒå¯¹è¡¨å®šä¹‰çš„ä¿®æ”¹ã€‚ä½¿ç”¨ <code>ALTER TABLE</code> è¯­å¥æ¥é‡å‘½åè¡¨ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> source RENAME <span class="keyword">TO</span> target;</span><br></pre></td></tr></table></figure><p><small>æ­¤å‘½ä»¤é™¤æ›´æ–°å…ƒæ•°æ®å¤–ï¼Œè¿˜ä¼šå°†è¡¨ç›®å½•ç§»åŠ¨åˆ°å¯¹åº”çš„ç›®å½•ä¸‹ã€‚</small><br>å¦å¤–ä¹Ÿæ”¯æŒä¿®æ”¹åˆ—çš„å®šä¹‰ï¼Œæ·»åŠ æ–°çš„åˆ—ï¼Œç”šè‡³ç”¨ä¸€ç»„æ–°çš„åˆ—æ›¿æ¢è¡¨å†…å·²æœ‰çš„åˆ—ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> target <span class="keyword">ADD</span> COLUMNS (col3 STRING);</span><br></pre></td></tr></table></figure><p><code>DROP TABLE</code> è¯­å¥ç”¨äºåˆ é™¤è¡¨çš„æ•°æ®å’Œå…ƒæ•°æ®ã€‚å¦‚æœæ˜¯å¤–éƒ¨è¡¨åˆ™åªåˆ é™¤å…ƒæ•°æ®ï¼Œæ•°æ®ä¸ä¼šå—åˆ°å½±å“ã€‚<br>ä½†è‹¥æ˜¯éœ€è¦ä»…åˆ é™¤è¡¨å†…çš„æ•°æ®ï¼Œä¿ç•™è¡¨çš„å®šä¹‰ï¼Œåˆ™éœ€è¦ä½¿ç”¨ <code>TRUNCATE TABLE</code> è¯­å¥ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">TRUNCATE</span> <span class="keyword">TABLE</span> target;</span><br></pre></td></tr></table></figure><h4 id="æŸ¥è¯¢æ•°æ®"><a href="#æŸ¥è¯¢æ•°æ®" class="headerlink" title="æŸ¥è¯¢æ•°æ®"></a>æŸ¥è¯¢æ•°æ®</h4><h5 id="æ’åºå’Œèšé›†"><a href="#æ’åºå’Œèšé›†" class="headerlink" title="æ’åºå’Œèšé›†"></a>æ’åºå’Œèšé›†</h5><p><code>Hive</code> ä¸­å¯ä»¥ä½¿ç”¨æ ‡å‡†çš„ <code>ORDER BY</code> å­å¥å¯¹æ•°æ®è¿›è¡Œæ’åºï¼Œ <strong><code>ORDER BY</code></strong> å°†å¯¹è¾“å…¥æ‰§è¡Œå¹¶è¡Œå…¨æ’åºã€‚</p><p>ä½†æ˜¯åœ¨å¾ˆå¤šæƒ…å†µä¸‹ï¼Œå¹¶ä¸éœ€è¦å¯¹ç»“æœå…¨å±€æ’åºï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨ <code>Hive</code> çš„éæ ‡å‡†çš„æ‰©å±• <strong><code>SORT BY</code></strong> ï¼Œ<code>SORT BY</code> ä¸ºæ¯ä¸€ä¸ª <code>reducer</code> æ–‡ä»¶äº§ç”Ÿä¸€ä¸ªæ’åºæ–‡ä»¶ã€‚<br><strong><code>DISTRIBUTE BY</code></strong> å­å¥å¯ä»¥æ§åˆ¶æŸä¸ªç‰¹å®šåˆ—åˆ° <code>reducer</code>ï¼Œé€šå¸¸æ˜¯ä¸ºäº†åç»­çš„èšé›†æ“ä½œã€‚å¦‚æœ <code>SORT BY</code> å’Œ <code>DISTRIBUTE BY</code> ä¸­æ‰€ä½¿ç”¨çš„åˆ—ç›¸åŒï¼Œå¯ä»¥ç¼©å†™ä¸º <strong><code>CLUSTER BY</code></strong> ä»¥ä¾¿åŒæ—¶æŒ‡å®šä¸¤è€…æ‰€ç”¨çš„åˆ—ã€‚</p><h5 id="MapReduce-è„šæœ¬"><a href="#MapReduce-è„šæœ¬" class="headerlink" title="MapReduce è„šæœ¬"></a><code>MapReduce</code> è„šæœ¬</h5><p>ä¸ <code>Hadoop Streaming</code> ç±»ä¼¼ï¼Œ<code>TRANSFORM</code>ã€ <code>MAP</code> å’Œ <code>REDUCE</code> å­å¥å¯ä»¥åœ¨ <code>Hive</code> ä¸­è°ƒç”¨å¤–éƒ¨è„šæœ¬æˆ–ç¨‹åºã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> sys.stdin:</span><br><span class="line">(year, temp, q) = line.strip().split()</span><br><span class="line"><span class="keyword">if</span> (temp != <span class="string">&quot;9999&quot;</span> <span class="keyword">and</span> re.<span class="keyword">match</span>(<span class="string">&quot;[01459]&quot;</span>, q)):</span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;%s\t%s&quot;</span> % (year, temp)</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">hive&gt; </span><span class="language-bash">ADD FILE /usr/home/ ./is_year.py</span></span><br><span class="line"><span class="meta prompt_">hive&gt; </span><span class="language-bash">FROM record SELECT TRANSFORM(year, temp, name) USING <span class="string">&#x27;is_year.py&#x27;</span> AS year, temp;</span></span><br><span class="line">1950 0</span><br><span class="line">1950 22</span><br><span class="line">1949 111</span><br></pre></td></tr></table></figure><h5 id="å­æŸ¥è¯¢"><a href="#å­æŸ¥è¯¢" class="headerlink" title="å­æŸ¥è¯¢"></a>å­æŸ¥è¯¢</h5><p>å­æŸ¥è¯¢æ˜¯å†…åµŒåœ¨å¦ä¸€ä¸ª <code>SQL</code> è¯­å¥ä¸­çš„ <code>SELECT</code> è¯­å¥ã€‚<code>Hive</code> å¯¹å­æŸ¥è¯¢çš„æ”¯æŒå¾ˆæœ‰é™ï¼Œä»–åªå…è®¸å­æŸ¥è¯¢å‡ºç°åœ¨ <code>SELECT</code> è¯­å¥çš„ <code>FROM</code> å­å¥ä¸­ ï¼Œæˆ–è€…æŸäº›æƒ…å†µä¸‹çš„ <code>WHERE</code> å­å¥ä¸­ã€‚</p><h5 id="è§†å›¾"><a href="#è§†å›¾" class="headerlink" title="è§†å›¾"></a>è§†å›¾</h5><p>è§†å›¾æ˜¯ä¸€ç§ç”¨ <code>SELECT</code> è¯­å¥å®šä¹‰çš„<strong>è™šè¡¨ï¼ˆ<code>virtual table</code>ï¼‰</strong>ã€‚è§†å›¾å¯ä»¥ç”¨æ¥ä»¥ä¸€ç§ä¸åŒäºç£ç›˜å®é™…å­˜å‚¨çš„å½¢å¼æŠŠæ•°æ®å‘ˆç°ç»™ç”¨æˆ·ï¼Œè§†å›¾ä¹Ÿå¯ä»¥ç”¨æ¥é™åˆ¶ç”¨æˆ·ï¼Œä½¿å…¶åªèƒ½è®¿é—®è¢«æˆæƒçš„å¯ä»¥çœ‹åˆ°çš„å­è¡¨ã€‚</p><p><code>Hive</code> åˆ›å»ºè§†å›¾æ—¶å¹¶ä¸æŠŠè§†å›¾ç‰©åŒ–å­˜å‚¨åœ¨ç£ç›˜ä¸Šï¼Œç›¸åè§†å›¾çš„ <code>SELECT</code> è¯­å¥åªæ˜¯åœ¨æ‰§è¡Œå¼•ç”¨è§†å›¾çš„è¯­å¥æ—¶æ‰æ‰§è¡Œã€‚<code>SHOW TABLES</code> å‘½ä»¤çš„è¾“å‡ºç»“æœé‡ŒåŒ…å«è§†å›¾ã€‚è¿˜å¯ä»¥ä½¿ç”¨ <code>DESCRIBE EXTENDED view_name</code> å‘½ä»¤æ¥æŸ¥çœ‹æŸä¸ªè§†å›¾çš„è¯¦ç»†ä¿¡æ¯ï¼ŒåŒ…æ‹¬ç”¨äºå®šä¹‰å®ƒçš„é‚£ä¸ªæŸ¥è¯¢ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> valid_table</span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> col1, col3 <span class="keyword">FROM</span> target <span class="keyword">WHERE</span> <span class="keyword">year</span> <span class="operator">!=</span> <span class="string">&#x27;2022&#x27;</span>;</span><br></pre></td></tr></table></figure><h5 id="EXPLAIN"><a href="#EXPLAIN" class="headerlink" title="EXPLAIN"></a><code>EXPLAIN</code></h5><p>åœ¨æŸ¥è¯¢è¯­å¥ä¹‹å‰åŠ ä¸Š <code>EXPLAIN</code> å…³é”®å­—ï¼Œå°±å¯ä»¥äº†è§£åˆ°æŸ¥è¯¢è®¡åˆ’å’Œå…¶ä»–çš„ä¿¡æ¯æ¥æ›´åŠ ç›´è§‚çš„å±•ç¤º <code>Hive</code> æ˜¯å¦‚ä½•å°†æŸ¥è¯¢ä»»åŠ¡è½¬åŒ–ä¸º <code>MapReduce</code> ä»»åŠ¡ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">hive&gt; </span><span class="language-bash">EXPLAIN SELECT <span class="built_in">sum</span>(col1) FROM target;</span></span><br></pre></td></tr></table></figure><p>é¦–å…ˆä¼šè¾“å‡ºæŠ½è±¡è¯­æ³•æ ‘ã€‚å…¶è¡¨æ˜ <code>Hive</code> æ˜¯å¦‚ä½•å°†æŸ¥è¯¢è§£æä¸º <code>token</code>ï¼ˆç¬¦å·ï¼‰å’Œ <code>literal</code>ï¼ˆå­—é¢å€¼ï¼‰çš„ï¼Œæ˜¯å°†æŸ¥è¯¢è½¬åŒ–åˆ°æœ€ç»ˆç»“æœçš„ä¸€éƒ¨åˆ†ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ABSTRACT SYNTAX TREE:</span><br><span class="line">(TOK_QUERY</span><br><span class="line">    (TOK_FROM (TOK_TABREF (TOK_TABNAME target)))</span><br><span class="line">    (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE))</span><br><span class="line">    (TOK_SELECT (TOK_SELEXPR (TOK_FUNCTION sum (TOK_TABLE_OR_COL number))))))</span><br></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥å¯ä»¥çœ‹åˆ°åˆ—æ˜ <code>col1</code>ã€ è¡¨æ˜ <code>target</code> è¿˜æœ‰ <code>sum</code> å‡½æ•°ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">STAGE DEPENDENCIES:</span><br><span class="line">    Stage-1 is a root stage</span><br><span class="line">    Stage-0 is a root stage</span><br></pre></td></tr></table></figure><p><small>ä¸€ä¸ª <code>Hive</code> ä»»åŠ¡ä¼šåŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ª <code>stage</code> é˜¶æ®µï¼Œä¸åŒçš„ <code>stage</code> é˜¶æ®µé—´ä¼šå­˜åœ¨ç€ä¾èµ–å…³ç³»ã€‚ä¸€ä¸ª <code>stage</code> å¯ä»¥æ˜¯ä¸€ä¸ª <code>MapReduce</code> ä»»åŠ¡ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªæŠ½æ ·é˜¶æ®µï¼Œæˆ–è€…ä¸€ä¸ªåˆå¹¶é˜¶æ®µï¼Œè¿˜å¯ä»¥æ˜¯ä¸€ä¸ª <code>limit</code> é˜¶æ®µï¼Œä»¥åŠ <code>Hive</code> éœ€è¦çš„å…¶ä»–ä»»åŠ¡çš„ä¸€ä¸ªé˜¶æ®µã€‚</small><br><small>é»˜è®¤æƒ…å†µä¸‹ï¼Œ<code>Hive</code> ä¸€æ¬¡åªæ‰§è¡Œä¸€ä¸ª <code>stage</code>ï¼ˆé˜¶æ®µï¼‰ã€‚</small></p><p>é™¤æ­¤ä¹‹å¤–è¿˜å¯ä»¥ä½¿ç”¨ <code>EXPLAIN EXTENDED</code> è¯­å¥äº§ç”Ÿæ›´å¤šçš„è¾“å‡ºä¿¡æ¯ã€‚</p><hr><h3 id="å¼•ç”¨"><a href="#å¼•ç”¨" class="headerlink" title="å¼•ç”¨"></a>å¼•ç”¨</h3><hr><h3 id="ä¸ªäººå¤‡æ³¨"><a href="#ä¸ªäººå¤‡æ³¨" class="headerlink" title="ä¸ªäººå¤‡æ³¨"></a>ä¸ªäººå¤‡æ³¨</h3><p><strong>æ­¤åšå®¢å†…å®¹å‡ä¸ºä½œè€…å­¦ä¹ æ‰€åšç¬”è®°ï¼Œä¾µåˆ ï¼</strong><br><strong>è‹¥è½¬ä½œå…¶ä»–ç”¨é€”ï¼Œè¯·æ³¨æ˜æ¥æºï¼</strong></p>]]></content>
    
    
    <summary type="html">&lt;h3 id=&quot;åŸºç¡€&quot;&gt;&lt;a href=&quot;#åŸºç¡€&quot; class=&quot;headerlink&quot; title=&quot;åŸºç¡€&quot;&gt;&lt;/a&gt;åŸºç¡€&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;&lt;code&gt;Hive&lt;/code&gt;&lt;/strong&gt; æ˜¯ä¸€ä¸ªæ„å»ºåœ¨ &lt;code&gt;Hadoop&lt;/code&gt; ä¹‹ä¸Šçš„&lt;strong&gt;æ•°æ®ä»“åº“æ¡†æ¶&lt;/strong&gt;ï¼Œå…¶è®¾è®¡ç›®çš„åœ¨äºè®©ç²¾é€š &lt;code&gt;SQL&lt;/code&gt; ä½†ç¼–ç¨‹æŠ€èƒ½è¾ƒå¼±çš„è¿è¥äººå‘˜èƒ½å¤Ÿå¯¹å­˜æ”¾åœ¨ &lt;code&gt;HDFS&lt;/code&gt; ä¸­çš„å¤§è§„æ¨¡æ•°æ®é›†æ‰§è¡ŒæŸ¥è¯¢ã€‚&lt;br&gt;ä½†æ˜¯ç”±äºå…¶åº•å±‚ä¾èµ–çš„ &lt;code&gt;Hadoop&lt;/code&gt; å’Œ &lt;code&gt;HDFS&lt;/code&gt; è®¾è®¡æœ¬èº«çº¦æŸå’Œå±€é™æ€§ï¼Œé™åˆ¶ &lt;code&gt;Hive&lt;/code&gt; ä¸æ”¯æŒè®°å½•çº§åˆ«çš„æ›´æ–°ã€æ’å…¥æˆ–è€…åˆ é™¤æ“ä½œï¼Œä¸è¿‡å¯ä»¥é€šè¿‡æŸ¥è¯¢ç”Ÿæˆæ–°è¡¨æˆ–å°†æŸ¥è¯¢ç»“æœå¯¼å…¥æ–‡ä»¶ä¸­æ¥å®ç°ã€‚åŒæ—¶ç”±äº &lt;code&gt;MapReduce&lt;/code&gt; ä»»åŠ¡çš„å¯åŠ¨è¿‡ç¨‹éœ€è¦æ¶ˆè€—è¾ƒé•¿çš„æ—¶é—´ï¼Œæ‰€ä»¥æŸ¥è¯¢å»¶æ—¶æ¯”è¾ƒä¸¥é‡ã€‚&lt;/p&gt;</summary>
    
    
    
    
    <category term="Hadoop" scheme="https://blog.vgbhfive.cn/tags/Hadoop/"/>
    
  </entry>
  
  <entry>
    <title>MySQL-Could not find first log file name in binary log index file</title>
    <link href="https://blog.vgbhfive.cn/MySQL-Could-not-find-first-log-file-name-in-binary-log-index-file/"/>
    <id>https://blog.vgbhfive.cn/MySQL-Could-not-find-first-log-file-name-in-binary-log-index-file/</id>
    <published>2023-04-02T12:32:07.000Z</published>
    <updated>2023-04-02T12:41:26.000Z</updated>
    
    <content type="html"><![CDATA[<h3 id="å¤ç°"><a href="#å¤ç°" class="headerlink" title="å¤ç°"></a>å¤ç°</h3><p>åœ¨ä¹‹å‰çš„åšå®¢ä¸­è¯´æ˜è¿‡ï¼Œæˆ‘è´Ÿè´£çš„ä¸šåŠ¡æœ‰æ•°æ®åŒæ­¥çš„éœ€æ±‚ï¼Œæ˜¯ä» <code>MySQL</code> å®æ—¶åŒæ­¥æ•°æ®åˆ° <code>ClickHouse</code>ï¼Œä¸ºæ­¤æˆ‘ä»¬ä½¿ç”¨äº†ä¸€ä¸ªå·¥å…· <code>clickhouse-mysql-data-reader</code>ï¼Œè¯¥å·¥å…·çš„åº•å±‚æ˜¯é€šè¿‡ç›‘å¬ <code>MySQL</code> çš„ <code>bin log</code> æ¥å®ç°å®æ—¶åŒæ­¥æ•°æ®ã€‚</p><p>å°±åœ¨ä»Šæ—©ï¼Œæ•°æ®åŒæ­¥ä¸çŸ¥ä¸ºä½•åœæ­¢äº†ï¼Œå½“å‘ç°é—®é¢˜é‡æ–°æ‹‰èµ·åŒæ­¥ä»»åŠ¡æ—¶ï¼Œå°±å‘ç°åŒæ­¥è„šæœ¬å‡ºç°äº†å¼‚å¸¸ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Could not find first log file name in binary log index file</span><br></pre></td></tr></table></figure><span id="more"></span><hr><h3 id="æ€è€ƒé—®é¢˜"><a href="#æ€è€ƒé—®é¢˜" class="headerlink" title="æ€è€ƒé—®é¢˜"></a>æ€è€ƒé—®é¢˜</h3><p>åœ¨çœ‹è¿‡å¼‚å¸¸æŠ¥é”™ä¿¡æ¯ä¹‹åï¼Œå…¶å¤§è‡´æ˜¯å› ä¸ºåŒæ­¥è„šæœ¬åœæ­¢äº†åŒæ­¥ä»»åŠ¡ï¼Œä¹‹åå°±æ²¡æœ‰æ›´æ–°æœ¬åœ°çš„ <code>bin log</code> ç´¢å¼•ï¼Œæ­¤æ—¶ç­‰å¾…æˆ‘å†æ‹‰èµ·åŒæ­¥ä»»åŠ¡æ—¶ï¼ŒåŒæ­¥è„šæœ¬ä½¿ç”¨æœ¬åœ°æœªä¿®æ”¹çš„ <code>bin log</code> ç´¢å¼•å» <code>MySQL</code> æ‹‰å–æ•°æ®æ—¶ï¼Œ<code>MySQL</code> çš„ <code>bin log</code> ç´¢å¼•ç»è¿‡ä¸šåŠ¡æ•°æ®çš„å†™å…¥å·²ç»è¦†ç›–äº†ä¹‹å‰çš„ç´¢å¼•ï¼ŒåŒæ­¥è„šæœ¬æ²¡æœ‰æ‰¾åˆ°å¯¹åº”çš„ç´¢å¼•å°±æŠ›å‡ºå¼‚å¸¸ã€‚</p><hr><h3 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h3><p>é‚£ä¹ˆå°±ä¸‹æ¥çš„é—®é¢˜å°±æ˜¯å¦‚ä½•æŸ¥æ‰¾æ­£ç¡®çš„ <code>bin log</code> ç´¢å¼•ï¼Œç„¶åä¿®æ”¹åŒæ­¥è„šæœ¬çš„ <code>bin log</code> ç´¢å¼•å³å¯æ¢å¤åŒæ­¥æ•°æ®ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show binary logs;</span><br></pre></td></tr></table></figure><p>ä¸Šè¿°å‘½ä»¤å¯ä»¥å¸®åŠ©ä½ æŸ¥çœ‹åˆ° <code>MySQL</code> æœ€æ–°çš„ <code>bin log</code> ç´¢å¼•ï¼Œä¹‹ååŒæ­¥ä¿®æ”¹è„šæœ¬çš„ <code>bin log</code> ç´¢å¼•å³å¯ã€‚</p><p><small>é‚£ä¹ˆå…³äºä¸¤æ¬¡ç´¢å¼•ä¹‹é—´çš„æ•°æ®å¦‚ä½•åŒæ­¥å‘¢ï¼Ÿå¯ä»¥é€šè¿‡æ·»åŠ  <code>where case</code> é‡‡ç”¨ <code>select</code> çš„å½¢å¼åŒæ­¥æ•°æ®ï¼Œæ›´å¤šçš„æ“ä½œå¯ä»¥å‚è€ƒåŒæ­¥å·¥å…·çš„ä½¿ç”¨æ–‡æ¡£ã€‚</small></p><hr><h3 id="å¼•ç”¨"><a href="#å¼•ç”¨" class="headerlink" title="å¼•ç”¨"></a>å¼•ç”¨</h3><hr><h3 id="ä¸ªäººå¤‡æ³¨"><a href="#ä¸ªäººå¤‡æ³¨" class="headerlink" title="ä¸ªäººå¤‡æ³¨"></a>ä¸ªäººå¤‡æ³¨</h3><p><strong>æ­¤åšå®¢å†…å®¹å‡ä¸ºä½œè€…å­¦ä¹ æ‰€åšç¬”è®°ï¼Œä¾µåˆ ï¼</strong><br><strong>è‹¥è½¬ä½œå…¶ä»–ç”¨é€”ï¼Œè¯·æ³¨æ˜æ¥æºï¼</strong></p>]]></content>
    
    
    <summary type="html">&lt;h3 id=&quot;å¤ç°&quot;&gt;&lt;a href=&quot;#å¤ç°&quot; class=&quot;headerlink&quot; title=&quot;å¤ç°&quot;&gt;&lt;/a&gt;å¤ç°&lt;/h3&gt;&lt;p&gt;åœ¨ä¹‹å‰çš„åšå®¢ä¸­è¯´æ˜è¿‡ï¼Œæˆ‘è´Ÿè´£çš„ä¸šåŠ¡æœ‰æ•°æ®åŒæ­¥çš„éœ€æ±‚ï¼Œæ˜¯ä» &lt;code&gt;MySQL&lt;/code&gt; å®æ—¶åŒæ­¥æ•°æ®åˆ° &lt;code&gt;ClickHouse&lt;/code&gt;ï¼Œä¸ºæ­¤æˆ‘ä»¬ä½¿ç”¨äº†ä¸€ä¸ªå·¥å…· &lt;code&gt;clickhouse-mysql-data-reader&lt;/code&gt;ï¼Œè¯¥å·¥å…·çš„åº•å±‚æ˜¯é€šè¿‡ç›‘å¬ &lt;code&gt;MySQL&lt;/code&gt; çš„ &lt;code&gt;bin log&lt;/code&gt; æ¥å®ç°å®æ—¶åŒæ­¥æ•°æ®ã€‚&lt;/p&gt;
&lt;p&gt;å°±åœ¨ä»Šæ—©ï¼Œæ•°æ®åŒæ­¥ä¸çŸ¥ä¸ºä½•åœæ­¢äº†ï¼Œå½“å‘ç°é—®é¢˜é‡æ–°æ‹‰èµ·åŒæ­¥ä»»åŠ¡æ—¶ï¼Œå°±å‘ç°åŒæ­¥è„šæœ¬å‡ºç°äº†å¼‚å¸¸ï¼š&lt;/p&gt;
&lt;figure class=&quot;highlight plaintext&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;Could not find first log file name in binary log index file&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;</summary>
    
    
    
    
    <category term="MySQL" scheme="https://blog.vgbhfive.cn/tags/MySQL/"/>
    
    <category term="ClickHouse" scheme="https://blog.vgbhfive.cn/tags/ClickHouse/"/>
    
    <category term="Day" scheme="https://blog.vgbhfive.cn/tags/Day/"/>
    
  </entry>
  
  <entry>
    <title>Hadoop-Spark</title>
    <link href="https://blog.vgbhfive.cn/Hadoop-Spark/"/>
    <id>https://blog.vgbhfive.cn/Hadoop-Spark/</id>
    <published>2023-03-12T03:06:30.000Z</published>
    <updated>2023-04-18T14:06:05.388Z</updated>
    
    <content type="html"><![CDATA[<h3 id="å¼•å…¥"><a href="#å¼•å…¥" class="headerlink" title="å¼•å…¥"></a>å¼•å…¥</h3><p><code>Spark</code> æ˜¯ç”¨äº<strong>å¤„ç†å¤§æ•°æ®çš„é›†ç¾¤è®¡ç®—æ¡†æ¶</strong> ï¼Œä¸å…¶ä»–å¤§å¤šæ•°æ•°æ®å¤„ç†æ¡†æ¶ä¸åŒä¹‹å¤„åœ¨äº <code>Spark</code> æ²¡æœ‰ä»¥ <code>MapReduce</code> ä½œä¸ºæ‰§è¡Œå¼•æ“ï¼Œè€Œæ˜¯ä½¿ç”¨å®ƒè‡ªå·±çš„<strong>åˆ†å¸ƒå¼è¿è¡Œç¯å¢ƒ</strong>åœ¨é›†ç¾¤ä¸Šæ‰§è¡Œå·¥ä½œã€‚å¦å¤– <code>Spark</code> ä¸ <code>Hadoop</code> åˆç´§å¯†é›†æˆï¼Œ<code>Spark</code> å¯ä»¥åœ¨ <code>YARN</code> ä¸Šè¿è¡Œï¼Œå¹¶æ”¯æŒ <code>Hadoop</code> æ–‡ä»¶æ ¼å¼åŠå…¶å­˜å‚¨åç«¯ï¼ˆä¾‹å¦‚ <code>HDFS</code>ï¼‰ã€‚</p><p><code>Spark</code> æœ€çªå‡ºçš„è¡¨ç°åœ¨äºå…¶èƒ½å°† <strong>ä½œä¸šä¸ä½œä¸šä¹‹é—´çš„å¤§è§„æ¨¡çš„å·¥ä½œæ•°æ®é›†å­˜å‚¨åœ¨å†…å­˜ä¸­</strong>ã€‚è¿™ç§èƒ½åŠ›ä½¿å¾—åœ¨æ€§èƒ½ä¸Šè¿œè¶… <code>MapReduce</code> å¥½å‡ ä¸ªæ•°é‡çº§ï¼ŒåŸå› å°±åœ¨äº <code>MapReduce</code> æ•°æ®éƒ½æ˜¯ä»ç£ç›˜ä¸ŠåŠ è½½ã€‚æ ¹æ® <code>Spark</code> çš„å¤„ç†æ¨¡å‹æœ‰ä¸¤ç±»åº”ç”¨è·ç›Šæœ€å¤§ï¼Œåˆ†åˆ«æ˜¯ <strong>è¿­ä»£ç®—æ³•ï¼ˆå³å¯¹ä¸€ä¸ªæ•°æ®é›†é‡å¤åº”ç”¨æŸä¸ªå‡½æ•°ï¼Œç›´è‡³æ»¡è¶³é€€å‡ºæ¡ä»¶ï¼‰</strong>å’Œ <strong>äº¤äº’å¼åˆ†æï¼ˆç”¨æˆ·å‘æ•°æ®é›†å‘å‡ºä¸€ç³»åˆ—ä¸“ç”¨çš„æ¢ç´¢æ€§æŸ¥è¯¢ï¼‰</strong> ã€‚<br>å¦å¤– <code>Spark</code> è¿˜å› ä¸ºå…¶å…·æœ‰çš„ <strong><code>DAG</code> å¼•æ“</strong>æ›´å…·å¸å¼•åŠ›ï¼ŒåŸå› åœ¨äº <code>DAG</code> å¼•æ“å¯ä»¥å¤„ç†ä»»æ„æ“ä½œæµæ°´çº¿ï¼Œå¹¶ä¸ºç”¨æˆ·å°†å…¶è½¬åŒ–ä¸ºå•ä¸ªä»»åŠ¡ã€‚</p><span id="more"></span><hr><h3 id="åŸºç¡€"><a href="#åŸºç¡€" class="headerlink" title="åŸºç¡€"></a>åŸºç¡€</h3><h4 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h4><p>ä»å®˜æ–¹é¡µé¢ä¸‹è½½ä¸€ä¸ªç¨³å®šç‰ˆæœ¬çš„ <code>Spark</code> äºŒè¿›åˆ¶å‘è¡ŒåŒ…ï¼ˆé€‰æ‹©ä¸å½“å‰ä½¿ç”¨ <code>Hadoop</code> åŒ¹é…çš„ç‰ˆæœ¬ï¼‰ï¼Œç„¶ååœ¨åˆé€‚çš„ä½ç½®è§£å‹æ–‡ä»¶åŒ…ï¼Œå¹¶å°† <code>Spark</code> çš„è§£å‹è·¯å¾„æ·»åŠ åˆ° <code>PATH</code> ä¸­ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">tar -xzvf spark-x.y.z.tgz</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">export</span> PATH=~/spark-x.y.z/bin:<span class="variable">$PATH</span></span></span><br></pre></td></tr></table></figure><h4 id="ä½œä¸š"><a href="#ä½œä¸š" class="headerlink" title="ä½œä¸š"></a>ä½œä¸š</h4><p><code>Spark</code> åƒ <code>MapReduce</code> ä¸€æ ·ä¹Ÿæœ‰ <strong>ä½œä¸šï¼ˆ<code>job</code>ï¼‰</strong>çš„æ¦‚å¿µï¼Œåªä¸è¿‡ <code>Spark</code> çš„ä½œä¸šç›¸æ¯” <code>MapReduce</code> æ›´åŠ é€šç”¨ï¼Œå› ä¸º <code>Spark</code> ä½œä¸šå¯ä»¥ç”±ä»»æ„çš„<strong>å¤šé˜¶æ®µï¼ˆ<code>stages</code>ï¼‰æœ‰å‘æ— ç¯å›¾ï¼ˆ<code>DAG</code>ï¼‰</strong>æ„æˆï¼Œå…¶ä¸­æ¯ä¸ªé˜¶æ®µå¤§è‡´ç›¸å½“äº <code>MapReduce</code> ä¸­çš„ <code>map</code> é˜¶æ®µæˆ– <code>reduce</code> é˜¶æ®µã€‚<br>è¿™äº›é˜¶æ®µåˆè¢« <code>Spark</code> è¿è¡Œç¯å¢ƒåˆ†è§£ä¸ºå¤šä¸ªä»»åŠ¡ï¼ˆ<code>tash</code>ï¼‰ï¼Œä»»åŠ¡å¹¶è¡Œè¿è¡Œåœ¨åˆ†å¸ƒå¼é›†ç¾¤ä¸­çš„ <code>RDD</code> åˆ†åŒºä¸Šï¼Œç±»ä¼¼äº <code>MapReduce</code> ä¸­çš„ä»»åŠ¡ã€‚</p><p><code>Spark</code> ä½œä¸šå§‹ç»ˆè¿è¡Œåœ¨åº”ç”¨ï¼ˆ<code>application</code>ï¼‰ä¸Šä¸‹æ–‡ä¸­ï¼Œå®ƒæä¾›äº† <code>RDD</code> åˆ†ç»„ä»¥åŠå…±äº«å˜é‡ã€‚ä¸€ä¸ªåº”ç”¨å¯ä»¥ä¸²è¡Œæˆ–å¹¶è¡Œåœ°è¿è¡Œå¤šä¸ªä½œä¸šï¼Œå¹¶ä¸ºè¿™äº›ä½œä¸šæä¾›è®¿é—®ç”±åŒä¸€åº”ç”¨çš„å…ˆå‰ä½œä¸šæ‰€ç¼“å­˜çš„ <code>RDD</code> çš„æœºåˆ¶ã€‚</p><h4 id="RDD"><a href="#RDD" class="headerlink" title="RDD"></a><code>RDD</code></h4><p><code>RDD</code> åˆç§°<strong>å¼¹æ€§åˆ†å¸ƒå¼æ•°æ®é›†ï¼ˆ<code>Resilient Distributed Dataset</code>ï¼Œç®€ç§° <code>RDD</code>ï¼‰</strong>æ˜¯ <code>Spark</code> æœ€æ ¸å¿ƒçš„æ¦‚å¿µï¼Œä»–æ˜¯åœ¨<strong>é›†ç¾¤ä¸­è·¨å¤šä¸ªæœºå™¨åˆ†åŒºå­˜å‚¨çš„ä¸€ä¸ªåªè¯»çš„å¯¹è±¡é›†åˆ</strong> ï¼Œåœ¨ <code>Spark</code> åº”ç”¨ä¸­é¦–å…ˆä¼šåŠ è½½ä¸€ä¸ªæˆ–å¤šä¸ª <code>RDD</code>ï¼Œä»–ä»¬ä½œä¸ºè¾“å…¥é€šè¿‡ä¸€ç³»åˆ—è½¬æ¢å¾—åˆ°ä¸€ç»„ç›®æ ‡ <code>RDD</code>ï¼Œç„¶åå¯¹è¿™äº›ç›®æ ‡ <code>RDD</code> æ‰§è¡Œä¸€ä¸ªåŠ¨ä½œã€‚<br><small>å¼¹æ€§åˆ†å¸ƒå¼æ•°æ®é›†ä¸­çš„â€œå¼¹æ€§â€æ˜¯æŒ‡ <code>Spark</code> å¯ä»¥é€šè¿‡é‡æ–°å®‰æ’è®¡ç®—æ¥è‡ªåŠ¨é‡å»ºä¸¢å¤±çš„åˆ†åŒºã€‚</small></p><p><code>RDD</code> æ˜¯ <code>Spark</code> æœ€åŸºæœ¬çš„æŠ½è±¡ï¼Œ<code>RDD</code> å…³è”ç€ä¸‰ä¸ªè‡³å…³é‡è¦çš„å±æ€§ï¼š</p><ul><li>ä¾èµ–å…³ç³»ã€‚</li><li>åˆ†åŒºï¼ˆåŒ…æ‹¬ä¸€äº›ä½ç½®ä¿¡æ¯ï¼‰</li><li>è®¡ç®—å‡½æ•°ï¼š<code>Partition =&gt; Iterator[T]</code></li></ul><p>è¿™ä¸‰å¤§å±æ€§å¯¹äºç®€å•çš„ <code>RDD</code> æ˜¯ä¸å¯æˆ–ç¼ºçš„ï¼Œå…¶ä»–æ›´é«˜å±‚çš„åŠŸèƒ½ä¹Ÿéƒ½æ˜¯åŸºäºè¿™å¥—æ¨¡å‹æ„å»ºçš„ã€‚é¦–å…ˆï¼Œä¾èµ–å…³ç³»åˆ—è¡¨ä¼šå‘Šè¯‰ <code>Spark</code> å¦‚ä½•ä»å¿…è¦çš„è¾“å…¥æ„å»º <code>RDD</code>ã€‚å…¶æ¬¡ï¼Œåˆ†åŒºå…è®¸ <code>Spark</code> å°†å·¥ä½œä»¥åˆ†åŒºä¸ºå•ä½ï¼Œåˆ†é…åˆ°å¤šä¸ªæ‰§è¡Œå™¨ä¸Šå¹¶è¡Œè®¡ç®—ã€‚æœ€åï¼Œæ¯ä¸ª <code>RDD</code> éƒ½æ˜¯ä¸€ä¸ªè®¡ç®—å‡½æ•° <code>compute</code>ï¼Œå¯ç”¨äºç”Ÿæˆ <code>RDD</code> æ‰€è¡¨ç¤ºæ•°æ®çš„ <code>Iterator[T]</code> å¯¹è±¡ã€‚</p><p>åˆ›å»º <code>RDD</code> å…±æœ‰ä¸‰ç§æ–¹å¼ï¼š</p><ul><li>æ¥è‡ªä¸€ä¸ªå†…å­˜ä¸­çš„å¯¹è±¡é›†åˆï¼ˆä¹Ÿç§°ä¸ºå¹¶è¡ŒåŒ–ä¸€ä¸ªé›†åˆï¼‰ã€‚é€‚ç”¨äºå¯¹å°‘é‡çš„è¾“å…¥æ•°æ®è¿›è¡Œå¹¶è¡Œçš„ <code>CPU</code> å¯†é›†å‹è®¡ç®—ã€‚</li><li>ä½¿ç”¨å¤–éƒ¨å­˜å‚¨å™¨ï¼ˆä¾‹å¦‚ <code>HDFS</code>ï¼‰ä¸­çš„æ•°æ®é›†ã€‚åˆ›å»ºä¸€ä¸ªå¤–éƒ¨æ•°æ®é›†çš„å¼•ç”¨ã€‚</li><li>å¯¹ç°æœ‰çš„ <code>RDD</code> è¿›è¡Œè½¬æ¢ã€‚</li></ul><h4 id="çª„ä¾èµ–å’Œå®½ä¾èµ–"><a href="#çª„ä¾èµ–å’Œå®½ä¾èµ–" class="headerlink" title="çª„ä¾èµ–å’Œå®½ä¾èµ–"></a>çª„ä¾èµ–å’Œå®½ä¾èµ–</h4><p>åœ¨å¯¹æ¯ä¸€ä¸ª <code>RDD</code> æ“ä½œæ—¶ï¼Œéƒ½ä¼šå¾—åˆ°ä¸€ä¸ªæ–°çš„ <code>RDD</code>ï¼Œé‚£ä¹ˆå‰åçš„ä¸¤ä¸ª <code>RDD</code> å°±æœ‰äº†æŸç§è”ç³»ï¼Œå³æ–°çš„ <code>child RDD</code> ä¼šä¾èµ–æ—§çš„ <code>parent RDD</code>ã€‚ç›®å‰è¿™äº›ä¾èµ–å…³ç³»è¢«åˆ†ä¸ºï¼š <strong>çª„ä¾èµ–ï¼ˆ<code>NarrowDependency</code>ï¼‰</strong>å’Œ <strong>å®½ä¾èµ–ï¼ˆ<code>ShuffleDependency</code>ï¼‰</strong>ã€‚</p><ol><li><p><strong>çª„ä¾èµ–</strong><br>å®˜æ–¹è§£é‡Šä¸ºï¼š<code>child RDD</code> ä¸­çš„æ¯ä¸ªåˆ†åŒºéƒ½ä¾èµ– <code>parent RDD</code> ä¸­çš„ä¸€å°éƒ¨åˆ†åˆ†åŒºã€‚</p><p> <img src="https://s2.loli.net/2023/04/17/OyXb2IrHGMF3z5J.jpg" alt="hadoop_spark_10.jpg"></p><p> ä¸Šå›¾åŒ…æ‹¬äº†æœ‰å…³çª„ä¾èµ–çš„å„ç§ä¾èµ–æƒ…å†µï¼š</p><ul><li><strong>ä¸€å¯¹ä¸€ä¾èµ–</strong>ï¼š<code>child RDD</code> ä¸­çš„æ¯ä¸ªåˆ†åŒºéƒ½åªä¾èµ– <code>parent RDD</code> ä¸­çš„ä¸€ä¸ªåˆ†åŒºï¼Œå¹¶ä¸” <code>child RDD</code> çš„åˆ†åŒºæ•°å’Œ <code>parent RDD</code> çš„åˆ†åŒºæ•°ç›¸åŒã€‚å±äºè¿™ç§ä¾èµ–å…³ç³»çš„è½¬æ¢ç®—å­æœ‰ <code>map()</code>ã€<code>flatMap()</code>ã€<code>filter()</code> ç­‰ã€‚</li><li><strong>èŒƒå›´ä¾èµ–</strong>ï¼š<code>child RDD</code> å’Œ <code>parent RDD</code> çš„åˆ†åŒºç»è¿‡åˆ’åˆ†ï¼Œæ¯ä¸ªèŒƒå›´å†…çš„çˆ¶å­ <code>RDD</code> çš„åˆ†åŒºéƒ½ä¸ºä¸€ä¸€å¯¹åº”çš„å…³ç³»ã€‚å±äºè¿™ç§ä¾èµ–å…³ç³»çš„è½¬æ¢ç®—å­æœ‰ <code>union()</code> ç­‰ã€‚</li><li><strong>çª„ä¾èµ–</strong>ï¼šçª„ä¾èµ–å¯ä»¥ç†è§£ä¸ºä¸€å¯¹ä¸€ä¾èµ–å’ŒèŒƒå›´ä¾èµ–çš„ç»„åˆä½¿ç”¨ã€‚å±äºè¿™ç§ä¾èµ–å…³ç³»çš„è½¬æ¢ç®—å­æœ‰ <code>join()</code>ã€<code>cartesian()</code>ã€<code>cogroup()</code> ç­‰ã€‚</li></ul></li><li><p><strong>å®½ä¾èµ–</strong><br>å®½ä¾èµ–å®˜æ–¹è§£é‡Šä¸ºéœ€è¦ä¸¤ä¸ª <code>shuffle</code> çš„ä¸¤ä¸ª <code>stage</code> çš„ä¾èµ–ã€‚</p><p> <img src="https://s2.loli.net/2023/04/17/BzWSR42FvDLtMql.jpg" alt="hadoop_spark_11.jpg"></p><p> <code>child RDD</code> çš„ä¸€ä¸ªåˆ†åŒºä¾èµ–çš„æ˜¯ <code>parent RDD</code> ä¸­å„ä¸ªåˆ†åŒºçš„æŸä¸€éƒ¨åˆ†ï¼Œå³ <code>child RDD</code> çš„ä¸¤ä¸ªåˆ†åŒºåˆ†åˆ«åªä¾èµ– <code>parent RDD</code> ä¸­çš„éƒ¨åˆ†ï¼Œè€Œè®¡ç®—å‡ºæŸä¸ªéƒ¨åˆ†çš„è¿‡ç¨‹ï¼Œä»¥åŠ <code>child RDD</code> åˆ†åˆ«è¯»å–æŸä¸ªéƒ¨åˆ†çš„è¿‡ç¨‹ï¼ˆ<code>shuffle write/shuffle read</code>ï¼‰ï¼Œæ­¤è¿‡ç¨‹æ­£æ˜¯ <code>shuffle</code> å¼€é”€æ‰€åœ¨ã€‚</p></li></ol><h4 id="è½¬æ¢å’ŒåŠ¨ä½œ"><a href="#è½¬æ¢å’ŒåŠ¨ä½œ" class="headerlink" title="è½¬æ¢å’ŒåŠ¨ä½œ"></a>è½¬æ¢å’ŒåŠ¨ä½œ</h4><p><code>Spark</code> å¯¹ <code>RDD</code> æä¾›äº†ä¸¤å¤§æ“ä½œï¼š<strong>è½¬æ¢ï¼ˆ<code>transformation</code>ï¼‰</strong> å’Œ <strong>åŠ¨ä½œï¼ˆ<code>action</code>ï¼‰</strong> ã€‚è½¬æ¢æ˜¯ä»ç°æœ‰ <code>RDD</code> ç”Ÿæˆæ–°çš„ <code>RDD</code>ï¼Œè€ŒåŠ¨ä½œåˆ™è§¦å‘å¯¹ <code>RDD</code> çš„è®¡ç®—å¹¶å¯¹è®¡ç®—ç»“æœæ‰§è¡ŒæŸç§æ“ä½œï¼Œè¦ä¹ˆè¿”å›ç»™ç”¨æˆ·ï¼Œè¦ä¹ˆä¿å­˜åˆ°å¤–éƒ¨å­˜å‚¨å™¨ä¸­ã€‚</p><p>åŠ è½½ <code>RDD</code> æˆ–è€…æ‰§è¡Œè½¬æ¢å¹¶ä¸ä¼šç«‹å³è§¦å‘ä»»ä½•æ•°æ®å¤„ç†çš„æ“ä½œï¼Œåªä¸è¿‡æ˜¯åˆ›å»ºäº†ä¸€ä¸ªè®¡åˆ’ï¼Œåªæœ‰å½“å¯¹ <code>RDD</code> æ‰§è¡ŒæŸä¸ªåŠ¨ä½œæ—¶æ‰ä¼šè§¦å‘çœŸæ­£çš„è®¡ç®—ã€‚<br><small>å¦‚æœæƒ³åˆ¤æ–­ä¸€ä¸ªæ“ä½œæ˜¯è½¬æ¢è¿˜æ˜¯åŠ¨ä½œï¼Œå¯ä»¥é€šè¿‡è§‚å¯Ÿå…¶è¿”å›ç±»å‹ï¼šå¦‚æœè¿”å›çš„ç±»å‹æ˜¯ <code>RDD</code>ï¼Œé‚£ä¹ˆä»–æ˜¯ä¸€ä¸ªè½¬æ¢å¦åˆ™å°±æ˜¯ä¸€ä¸ªåŠ¨ä½œã€‚</small></p><p>åœ¨ <code>Spark</code>åº“ä¸­åŒ…å«äº†ä¸°å¯Œçš„æ“ä½œï¼ŒåŒ…å«æ˜ å°„ã€åˆ†ç»„ã€èšåˆã€é‡æ–°åˆ†åŒºã€é‡‡æ ·ã€è¿æ¥ <code>RDD</code> ä»¥åŠæŠŠ <code>RDD</code> ä½œä¸ºé›†åˆæ¥å¤„ç†çš„å„ç§è½¬æ¢ï¼ŒåŒæ—¶è¿˜åŒ…æ‹¬å°† <code>RDD</code> ç‰©åŒ–ä¸ºé›†åˆï¼›å¯¹ <code>RDD</code> è¿›è¡Œç»Ÿè®¡æ•°æ®çš„è®¡ç®—ï¼›ä»ä¸€ä¸ª <code>RDD</code> ä¸­é‡‡æ ·å›ºå®šæ•°é‡çš„å…ƒç´ ï¼›ä»¥åŠå°† <code>RDD</code> ä¿å­˜åˆ°å¤–éƒ¨å­˜å‚¨å™¨ç­‰å„ç§åŠ¨ä½œã€‚</p><h4 id="Lineage-æœºåˆ¶"><a href="#Lineage-æœºåˆ¶" class="headerlink" title="Lineage æœºåˆ¶"></a><code>Lineage</code> æœºåˆ¶</h4><p>ç›¸æ¯”å…¶ä»–ç³»ç»Ÿçš„ç»†é¢—ç²’åº¦çš„å†…å­˜æ•°æ®æ›´æ–°çº§åˆ«çš„å¤‡ä»½æˆ–è€… <code>LOG</code> æœºåˆ¶ï¼Œ<code>RDD</code> çš„ <strong><code>Lineage</code> è®°å½•çš„æ˜¯ç²—é¢—ç²’åº¦çš„ç‰¹å®šæ•°æ®çš„ <code>Transformation</code> æ“ä½œ</strong>ï¼ˆå¦‚ <code>filter</code>ã€<code>map</code>ã€<code>join</code> ç­‰ï¼‰è¡Œä¸ºã€‚<br>å½“æŸä¸ª <code>RDD</code> çš„éƒ¨åˆ†åˆ†åŒºæ•°æ®ä¸¢å¤±æ—¶ï¼Œå®ƒå¯ä»¥é€šè¿‡ <code>Lineage</code> è®°å½•è·å–è¶³å¤Ÿçš„ä¿¡æ¯æ¥é‡æ–°è¿ç®—å’Œæ¢å¤ä¸¢å¤±çš„æ•°æ®åˆ†åŒºï¼Œè¯¥è®°å½•çš„å†…å®¹å°±æ˜¯å‰é¢æåˆ°çš„ <code>RDD</code> ä¹‹é—´çš„ä¾èµ–å…³ç³»ã€‚</p><h4 id="æŒä¹…åŒ–"><a href="#æŒä¹…åŒ–" class="headerlink" title="æŒä¹…åŒ–"></a>æŒä¹…åŒ–</h4><p><code>Spark</code> å¯ä»¥åœ¨è·¨é›†ç¾¤çš„å†…å­˜ä¸­<strong>ç¼“å­˜æ•°æ®</strong> ï¼Œä¹Ÿå°±æ„å‘³ç€å¯¹æ•°æ®é›†æ‰€åšçš„ä»»ä½•è®¡ç®—éƒ½ä¼šéå¸¸å¿«ã€‚ç›¸æ¯”è¾ƒè€Œè¨€ï¼Œ<code>MapReduce</code> åœ¨æ‰§è¡Œå¦ä¸€ä¸ªè®¡ç®—æ—¶å¿…é¡»ä»ç£ç›˜é‡æ–°åŠ è½½è¾“å…¥æ•°æ®é›†ï¼Œå³ä½¿ä»–ä»¬å¯ä»¥ä½¿ç”¨ä¸­é—´æ•°æ®é›†ä½œä¸ºè¾“å…¥ï¼Œä½†ä¹Ÿæ— æ³•æ‘†è„±å§‹ç»ˆä»ç£ç›˜åŠ è½½æ•°æ®çš„äº‹å®ï¼Œä¹Ÿå¿…ç„¶å½±å“å…¶æ‰§è¡Œé€Ÿåº¦ã€‚<br><small>è¢«ç¼“å­˜çš„ <code>RDD</code> åªèƒ½ç”±åŒä¸€åº”ç”¨çš„ä½œä¸šæ¥è¯»å–ã€‚åŒç†ï¼Œåº”ç”¨ç»ˆæ­¢æ—¶ï¼Œä½œä¸šæ‰€ç¼“å­˜çš„ <code>RDD</code> éƒ½ä¼šè¢«é”€æ¯ï¼Œé™¤éè¿™äº› <code>RDD</code> å·²ç»è¢«æŒä¹…åŒ–ä¿å­˜ï¼Œå¦åˆ™æ— æ³•è®¿é—®ã€‚</small></p><p>é»˜è®¤çš„æŒä¹…åŒ–çº§åˆ«å…±åˆ†ä¸ºä¸¤ç±»ï¼š <strong><code>MEMORY_ONLY</code></strong> æ˜¯é»˜è®¤æŒä¹…åŒ–çº§åˆ«ï¼Œä½¿ç”¨å¯¹è±¡åœ¨å†…å­˜ä¸­çš„å¸¸è§„è¡¨ç¤ºæ–¹å¼ï¼› <strong><code>MEMORY_ONLY_SER</code></strong> æ˜¯ä¸€ç§æ›´åŠ ç´§å‡‘çš„è¡¨ç¤ºæ–¹æ³•ï¼Œé€šè¿‡æŠŠåˆ†åŒºä¸­çš„å…ƒç´ åºåˆ—åŒ–ä¸ºå­—èŠ‚æ•°ç»„æ¥å®ç°çš„ã€‚<br><code>MEMORY_ONLY_SER</code> ç›¸æ¯” <code>MEMORY_ONLY</code> å¤šäº†ä¸€ç¬” <code>CPU</code> çš„å¼€é”€ï¼Œä½†è‹¥æ˜¯ç”Ÿæˆçš„åºåˆ—åŒ– <code>RDD</code> åˆ†åŒºçš„å¤§å°é€‚åˆè¢«ä¿å­˜åœ¨å†…å­˜ä¸­ï¼Œè€Œé»˜è®¤çš„æŒä¹…åŒ–æ–¹å¼æ— æ³•åšåˆ°ï¼Œé‚£å°±è¯´æ˜é¢å¤–çš„å¼€é”€æ˜¯å€¼å¾—ã€‚å¦å¤– <code>MEMORY_ONLY_SER</code> è¿˜å¯ä»¥å‡å°‘åƒåœ¾å›æ”¶çš„å‹åŠ›ï¼Œå› ä¸ºæ¯ä¸ª <code>RDD</code> è¢«å­˜å‚¨ä¸ºä¸€ä¸ªå­—èŠ‚æ•°ç»„è€Œä¸æ˜¯å¤§é‡çš„å¯¹è±¡ã€‚</p><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œ<code>RDD</code> åˆ†åŒºçš„åºåˆ—åŒ–ä½¿ç”¨çš„æ˜¯ <code>Kryo</code> åºåˆ—åŒ–æ–¹æ³•ï¼Œé€šè¿‡å‹ç¼©åºåˆ—åŒ–åˆ†åŒºå¯ä»¥è¿›ä¸€æ­¥èŠ‚çœç©ºé—´ï¼Œè€Œè¿™é€šå¸¸æ˜¯æ›´å¥½çš„é€‰æ‹©ã€‚<br><small>å°† <code>spark.rdd.compress</code> å±æ€§è®¾ç½®ä¸º <code>true</code>ï¼Œå¹¶ä¸”å¯é€‰åœ°è®¾ç½® <code>spark.io.compression.codec</code> å±æ€§ã€‚</small></p><h4 id="åºåˆ—åŒ–"><a href="#åºåˆ—åŒ–" class="headerlink" title="åºåˆ—åŒ–"></a>åºåˆ—åŒ–</h4><p>åœ¨ä½¿ç”¨ <code>Spark</code> çš„åºåˆ—åŒ–æ—¶ï¼Œéœ€è¦ä»ä¸¤ä¸ªæ–¹é¢æ¥è€ƒè™‘ï¼š</p><ul><li><strong>æ•°æ®åºåˆ—åŒ–</strong></li><li><strong>å‡½æ•°åºåˆ—åŒ–ï¼ˆé—­åŒ…å‡½æ•°ï¼‰</strong></li></ul><h5 id="æ•°æ®"><a href="#æ•°æ®" class="headerlink" title="æ•°æ®"></a>æ•°æ®</h5><p>æ•°æ®åºåˆ—åŒ–åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œ<code>Spark</code> åœ¨é€šè¿‡ç½‘ç»œå°†æ•°æ®ä»ä¸€ä¸ª <code>executor</code> å‘é€åˆ°å¦ä¸€ä¸ª <code>executor</code> æ—¶ï¼Œæˆ–è€…ä»¥åºåˆ—åŒ–çš„å½¢å¼ç¼“å­˜ï¼ˆæŒä¹…åŒ–ï¼‰æ•°æ®æ—¶ï¼Œæ‰€ä½¿ç”¨çš„éƒ½æ˜¯ <code>Java</code> åºåˆ—åŒ–æœºåˆ¶ã€‚<br>ä½¿ç”¨ <code>Kryo</code> åºåˆ—åŒ–æœºåˆ¶å¯¹äºå¤§å¤šæ•° <code>Spark</code> åº”ç”¨éƒ½æ˜¯æ›´å¥½çš„é€‰æ‹©ï¼Œ<code>Kryo</code> æ˜¯ä¸€ä¸ªé«˜æ•ˆçš„é€šç”¨ <code>Java</code> åºåˆ—åŒ–åº“ï¼Œè¦æƒ³ä½¿ç”¨ <code>Kryo</code> åºåˆ—åŒ–æœºåˆ¶ï¼Œéœ€è¦åœ¨åº”ç”¨ä¸­çš„ <code>SparkConf</code> ä¸­è®¾ç½® <code>spark.serializer</code> å±æ€§ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conf.set(&quot;spark.serializer&quot;, &quot;org.apache.spark.serializer.KryoSerializer&quot;)</span><br></pre></td></tr></table></figure><p><strong><code>Kryo</code></strong> ä¸è¦æ±‚è¢«åºåˆ—åŒ–çš„ç±»å®ç°æŸä¸ªç‰¹æ€§çš„çš„æ¥å£ï¼Œå› æ­¤å¦‚æœæ—§çš„å¯¹è±¡éœ€è¦ä½¿ç”¨ <code>Kryo</code> åºåˆ—åŒ–ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œåœ¨é…ç½®å¯ç”¨ <code>Kryo</code> åºåˆ—åŒ–ä¹‹åå°±å¯ä»¥ä½¿ç”¨äº†ï¼Œä¸è¿‡è¯è™½å¦‚æ­¤ï¼Œè‹¥æ˜¯ä½¿ç”¨å‰å¯ä»¥åœ¨ <code>Kryo</code> ä¸­å¯¹è¿™äº›ç±»è¿›è¡Œæ³¨å†Œï¼Œé‚£ä¹ˆå°±å¯ä»¥æé«˜å…¶æ€§èƒ½ã€‚è¿™æ˜¯å› ä¸º <code>Kryo</code> éœ€è¦å†™è¢«åºåˆ—åŒ–å¯¹è±¡çš„ç±»çš„å¼•ç”¨ï¼Œå¦‚æœå·²ç»å¼•ç”¨å·²ç»æ³¨å†Œçš„ç±»ï¼Œé‚£ä¹ˆå¼•ç”¨æ ‡è¯†å°±åªæ˜¯ä¸€ä¸ªæ•´æ•°ï¼Œå¦åˆ™å°±æ˜¯å®Œæ•´çš„ç±»åã€‚<br>åœ¨ <code>Kryo</code> æ³¨å†Œç±»å¾ˆç®€å•ï¼Œåˆ›å»ºä¸€ä¸ª <code>KryoRegistrator</code> å­ç±»ï¼Œé‡å†™ <code>registerClasses()</code> æ–¹æ³•ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">CustomKryoRegistrator</span> <span class="keyword">extends</span> <span class="title class_">KryoRegistrator</span> &#123;</span><br><span class="line">   <span class="meta">@Override</span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">registerClasses</span><span class="params">(Kryo kryo)</span> &#123;</span><br><span class="line">      kryo.register(Object.class);</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æœ€ååœ¨ <code>driver</code> åº”ç”¨ä¸­å°† <code>spark.kryo.registrator</code> å±æ€§è®¾ç½®ä¸ºä½ çš„ <code>KryoRegistrator</code> å®ç°çš„å®Œå…¨é™å®šç±»åï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conf.set(&quot;spark.kryo.registrator&quot;, &quot;CustomKryoRegistrator&quot;)</span><br></pre></td></tr></table></figure><h5 id="å‡½æ•°"><a href="#å‡½æ•°" class="headerlink" title="å‡½æ•°"></a>å‡½æ•°</h5><p>é€šå¸¸å‡½æ•°çš„åºåˆ—åŒ–éƒ½ä¼š<strong>è°¨å®ˆæœ¬åˆ†</strong>ï¼Œå¯¹äº <code>Spark</code> æ¥è¯´ï¼Œå³ä½¿åœ¨æœ¬åœ°æ¨¡å¼ä¸‹ï¼Œä¹Ÿéœ€è¦åºåˆ—åŒ–å‡½æ•°ï¼Œå‡è‹¥å¼•å…¥ä¸€ä¸ªä¸å¯åºåˆ—åŒ–çš„å‡½æ•°ï¼Œé‚£ä¹ˆåº”è¯¥åœ¨å¼€å‘æœŸé—´å°±åº”è¯¥å‘ç°ã€‚</p><h4 id="å…±äº«å˜é‡"><a href="#å…±äº«å˜é‡" class="headerlink" title="å…±äº«å˜é‡"></a>å…±äº«å˜é‡</h4><p><code>Spark</code> åº”ç”¨å¯èƒ½ä¼šä½¿ç”¨ä¸€äº›ä¸å±äº <code>RDD</code> çš„æ•°æ®ï¼Œè¿™äº›æ•°æ®ä¼šè¢«ä½œä¸ºé—­åŒ…å‡½æ•°çš„ä¸€éƒ¨åˆ†è¢«åºåˆ—åŒ–åä¼ é€’ç»™ä¸‹ä¸€ä¸ªåŠ¨ä½œï¼Œè¿™å¯ä»¥ä¿è¯åº”ç”¨æ­£å¸¸æ‰§è¡Œï¼Œä½†ä½¿ç”¨å¹¿æ’­å˜é‡å¯ä»¥è·Ÿé«˜æ•ˆçš„å®Œæˆç›¸åŒçš„å·¥ä½œã€‚</p><h5 id="å¹¿æ’­å˜é‡"><a href="#å¹¿æ’­å˜é‡" class="headerlink" title="å¹¿æ’­å˜é‡"></a>å¹¿æ’­å˜é‡</h5><p><strong>å¹¿æ’­å˜é‡ï¼ˆ<code>broadcast variable</code>ï¼‰</strong>åœ¨ç»è¿‡åºåˆ—åŒ–åè¢«å‘é€ç»™å„ä¸ª <code>executor</code>ï¼Œç„¶åç¼“å­˜åœ¨é‚£é‡Œï¼Œä»¥ä¾¿åæœŸä»»åŠ¡å¯ä»¥åœ¨éœ€è¦æ—¶è®¿é—®å®ƒã€‚å®ƒä¸å¸¸è§„å˜é‡ä¸åŒï¼Œå¸¸è§„å˜é‡æ˜¯ä½œä¸ºé—­åŒ…å‡½æ•°çš„ä¸€éƒ¨åˆ†è¢«åºåˆ—åŒ–çš„ï¼Œå› æ­¤ä»–ä»¬åœ¨æ¯ä¸ªä»»åŠ¡ä¸­éƒ½è¦é€šè¿‡ç½‘ç»œè¢«ä¼ è¾“ä¸€æ¬¡ã€‚<br>å¹¿æ’­å˜é‡çš„ä½œç”¨ç±»ä¼¼äº <code>MapReduce</code> ä¸­çš„åˆ†å¸ƒå¼ç¼“å­˜ï¼Œä¸¤è€…çš„ä¸åŒä¹‹å¤„åœ¨äº <code>Spark</code> å°†æ•°æ®ä¿å­˜åˆ°å†…å­˜ä¸­ï¼Œåªæœ‰åœ¨å†…å­˜è€—å°½æ—¶æ‰ä¼šæº¢å‡ºåˆ°ç£ç›˜ä¸Šã€‚</p><h5 id="ç´¯åŠ å™¨"><a href="#ç´¯åŠ å™¨" class="headerlink" title="ç´¯åŠ å™¨"></a>ç´¯åŠ å™¨</h5><p><strong>ç´¯åŠ å™¨ï¼ˆ<code>accumulator</code>ï¼‰</strong>æ˜¯åœ¨ä»»åŠ¡ä¸­åªèƒ½å¯¹å®ƒåšåŠ æ³•çš„å…±äº«å˜é‡ï¼Œç±»ä¼¼äº <code>MapReduce</code> ä¸­çš„è®¡æ•°å™¨ã€‚å½“ä½œä¸šå®Œæˆå <code>driver</code> ç¨‹åºå¯ä»¥æ£€ç´¢ç´¯åŠ å™¨çš„æœ€ç»ˆå€¼ã€‚</p><hr><h3 id="ä½œä¸šè¿è¡Œæœºåˆ¶"><a href="#ä½œä¸šè¿è¡Œæœºåˆ¶" class="headerlink" title="ä½œä¸šè¿è¡Œæœºåˆ¶"></a>ä½œä¸šè¿è¡Œæœºåˆ¶</h3><p>åœ¨ <code>Spark</code> ä½œä¸šçš„æœ€é«˜å±‚ï¼Œä»–æœ‰ä¸¤ä¸ªç‹¬ç«‹çš„å®ä½“ï¼š <strong><code>driver</code></strong> å’Œ <strong><code>executor</code></strong> ã€‚<code>driver</code> è´Ÿè´£æ‰˜ç®¡åº”ç”¨ï¼ˆ<code>SparkContext</code>ï¼‰å¹¶ä¸ºä½œä¸šè°ƒåº¦ä»»åŠ¡ã€‚<code>executor</code> ä¸“å±äºåº”ç”¨ï¼Œä»–åœ¨åº”ç”¨è¿è¡ŒæœŸé—´è¿è¡Œï¼Œå¹¶æ‰§è¡Œè¯¥åº”ç”¨çš„ä»»åŠ¡ã€‚é€šå¸¸ <code>driver</code> ä½œä¸ºä¸€ä¸ªä¸ç”±é›†ç¾¤ç®¡ç†å™¨ï¼ˆ<code>cluster manager</code>ï¼‰ç®¡ç†çš„å®¢æˆ·ç«¯æ¥è¿è¡Œï¼Œè€Œ <code>executor</code> åˆ™è¿è¡Œåœ¨é›†ç¾¤çš„è®¡ç®—æœºä¸Šã€‚ </p><h4 id="æäº¤"><a href="#æäº¤" class="headerlink" title="æäº¤"></a>æäº¤</h4><p>å½“å¯¹ <code>RDD</code> æ‰§è¡Œä¸€ä¸ªåŠ¨ä½œæ—¶ï¼Œä¼šè‡ªåŠ¨æäº¤ä¸€ä¸ª <code>Spark</code> ä½œä¸šã€‚ä»å†…éƒ¨çœ‹å¯¼è‡´å¯¹ <code>SparkContext</code> è°ƒç”¨ <code>runJob()</code> æ–¹æ³•ï¼Œç„¶åå°†è°ƒç”¨ä¼ é€’ç»™ä½œä¸º <code>driver</code> çš„ä¸€éƒ¨åˆ†è¿è¡Œçš„è°ƒåº¦ç¨‹åºã€‚è°ƒåº¦ç¨‹åºç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼š <strong><code>DAG</code> è°ƒç”¨ç¨‹åº</strong> å’Œ <strong>ä»»åŠ¡è°ƒåº¦ç¨‹åº</strong> ã€‚<code>DAG</code> è°ƒåº¦ç¨‹åºæŠŠä½œä¸šåˆ†è§£ä¸ºè‹¥å¹²é˜¶æ®µï¼Œå¹¶ç”±è¿™äº›é˜¶æ®µç»„æˆä¸€ä¸ª <code>DAG</code>ã€‚ä»»åŠ¡è°ƒåº¦ç¨‹åºåˆ™è´Ÿè´£æŠŠæ¯ä¸ªé˜¶æ®µä¸­çš„ä»»åŠ¡æäº¤åˆ°é›†ç¾¤ã€‚</p><p><img src="https://s2.loli.net/2023/04/10/z1HoGR53NuTWdbI.jpg" alt="hadoop_spark_1.jpg"></p><h4 id="DAG-æ„å»º"><a href="#DAG-æ„å»º" class="headerlink" title="DAG æ„å»º"></a><code>DAG</code> æ„å»º</h4><p>è¦æƒ³äº†è§£ä¸€ä¸ªä½œä¸šå¦‚ä½•è¢«åˆ’åˆ†ä¸ºé˜¶æ®µï¼Œé¦–å…ˆéœ€è¦äº†è§£åœ¨é˜¶æ®µä¸­è¿è¡Œçš„ä»»åŠ¡çš„ç±»å‹ã€‚æœ‰ä¸¤ç§ç±»å‹çš„ä»»åŠ¡ï¼š <strong><code>shuffle map</code> ä»»åŠ¡</strong> å’Œ <strong><code>result</code> ä»»åŠ¡</strong> ï¼Œä»ä»»åŠ¡ç±»å‹çš„åç§°å¯ä»¥çœ‹å‡º <code>Spark</code> ä¼šæ€æ ·å¤„ç†ä»»åŠ¡çš„è¾“å‡ºã€‚</p><ul><li><code>shuffle map</code> ä»»åŠ¡ã€‚<br> é¡¾åæ€ä¹‰ <code>shuffle map</code> ä»»åŠ¡ç±»ä¼¼äº <code>MapReduce</code> ä¸­ <code>shuffle</code> çš„ <code>map</code> ç«¯éƒ¨åˆ†ã€‚æ¯ä¸ª <code>shuffle map</code> ä»»åŠ¡åœ¨ä¸€ä¸ª <code>RDD</code> åˆ†åŒºä¸Šè¿è¡Œè®¡ç®—ï¼Œå¹¶æ ¹æ®åˆ†åŒºå‡½æ•°æŠŠè¾“å‡ºå†™å…¥åˆ°ä¸€ç»„æ–°çš„åˆ†åŒºä¸­ï¼Œä»¥å…è®¸åœ¨åé¢çš„é˜¶æ®µä¸­å–ç”¨ï¼ˆåé¢çš„é˜¶æ®µå¯èƒ½ç”± <code>shuffle map</code> ä»»åŠ¡ç»„æˆï¼Œä¹Ÿå¯èƒ½ç”± <code>result</code> ä»»åŠ¡ç»„æˆï¼‰ï¼Œ<code>shuffle map</code> ä»»åŠ¡è¿è¡Œåœ¨é™¤æœ€ç»ˆé˜¶æ®µä¹‹å¤–çš„å…¶ä»–æ‰€æœ‰é˜¶æ®µä¸­ã€‚</li><li><code>result</code> ä»»åŠ¡ã€‚<br> <code>result</code> ä»»åŠ¡è¿è¡Œåœ¨æœ€ç»ˆé˜¶æ®µï¼Œå¹¶å°†ç»“æœè¿”å›ç»™ç”¨æˆ·ç¨‹åºã€‚æ¯ä¸ª <code>result</code> ä»»åŠ¡åœ¨ä»–è‡ªå·±çš„ <code>RDD</code> åˆ†åŒºä¸Šè¿è¡Œè®¡ç®—ï¼Œç„¶åæŠŠç»“æœå‘é€å› <code>driver</code>ï¼Œå†ç”± <code>driver</code> å°†æ¯ä¸ªåˆ†åŒºçš„è®¡ç®—ç»“æœæ±‡é›†æˆæœ€ç»ˆç»“æœã€‚</li></ul><p>æœ€ç®€å•çš„ <code>Spark</code> ä½œä¸šä¸éœ€è¦ä½¿ç”¨ <code>shuffle</code>ï¼Œå› æ­¤å®ƒåªæœ‰ä¸€ä¸ªç”± <code>result</code> ä»»åŠ¡æ„æˆé˜¶æ®µï¼Œå°±åƒæ˜¯ <code>MapReduce</code> ä¸­ä»…æœ‰ <code>map</code> ä¸€æ ·ã€‚è€Œæ¯”è¾ƒå¤æ‚çš„ä½œä¸šè¦æ¶‰åŠåˆ°åˆ†ç»„æ“ä½œï¼Œå¹¶ä¸”è¦æ±‚ä¸€ä¸ªæˆ–å¤šä¸ª <code>shuffle</code> é˜¶æ®µã€‚</p><p>å¦‚æœ <code>RDD</code> å·²ç»è¢«åŒä¸€åº”ç”¨ï¼ˆ<code>SparkContext</code>ï¼‰ä¸­å…ˆå‰çš„ä½œä¸šæŒä¹…åŒ–ä¿å­˜ï¼Œé‚£ä¹ˆ <code>DAG</code> è°ƒåº¦ç¨‹åºå°†ä¼šçœæ‰ä¸€äº›ä»»åŠ¡ï¼Œä¸ä¼šå†åˆ›å»ºä¸€äº›é˜¶æ®µæ¥é‡æ–°è®¡ç®—ï¼ˆæˆ–è€…å®ƒçš„çˆ¶ <code>RDD</code>ï¼‰ã€‚</p><p><code>DAG</code> è°ƒåº¦ç¨‹åºè´Ÿè´£å°†ä¸€ä¸ªé˜¶æ®µåˆ†è§£ä¸ºè‹¥å¹²ä»»åŠ¡ä»¥æäº¤ç»™ä»»åŠ¡è°ƒåº¦ç¨‹åºã€‚å¦å¤– <code>DAG</code> è°ƒåº¦ç¨‹åºä¼šä¸ºæ¯ä¸ªä»»åŠ¡èµ‹äºˆä¸€ä¸ªä½ç½®åå¥½ï¼ˆ<code>placement preference</code>ï¼‰ï¼Œä»¥å…è®¸ä»»åŠ¡è°ƒåº¦ç¨‹åºå……åˆ†åˆ©ç”¨æ•°æ®æœ¬åœ°åŒ–ï¼ˆ<code>data locality</code>ï¼‰ã€‚</p><h4 id="è°ƒåº¦"><a href="#è°ƒåº¦" class="headerlink" title="è°ƒåº¦"></a>è°ƒåº¦</h4><p>å½“ä»»åŠ¡é›†åˆè¢«å‘é€åˆ°ä»»åŠ¡è°ƒåº¦ç¨‹åºåï¼Œä»»åŠ¡è°ƒåº¦ç¨‹åºç”¨è¯¥åº”ç”¨è¿è¡Œçš„ <code>executor</code> çš„åˆ—è¡¨ï¼Œåœ¨æ–Ÿé…Œä½ç½®åå¥½çš„åŒæ—¶æ„å»ºä»»åŠ¡åˆ° <code>executor</code> çš„æ˜ å°„ã€‚æ¥ç€ä»»åŠ¡è°ƒåº¦ç¨‹åºå°†ä»»åŠ¡åˆ†é…ç»™å…·æœ‰å†…æ ¸çš„ <code>executor</code>ï¼Œå¹¶ä¸”åœ¨ <code>executor</code> å®Œæˆè¿è¡Œä»»åŠ¡æ—¶ç»§ç»­åˆ†é…æ›´å¤šçš„ä»»åŠ¡ï¼Œç›´åˆ°ä»»åŠ¡é›†åˆå…¨éƒ¨å®Œæˆã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œæ¯ä¸ªä»»åŠ¡åˆ°åˆ†é…ä¸€ä¸ªå†…æ ¸ï¼Œä¸è¿‡ä¹Ÿå¯ä»¥é€šè¿‡è®¾ç½® <code>spark.task.cpus</code> æ¥æ›´æ”¹ã€‚<br><small>ä»»åŠ¡è°ƒåº¦ç¨‹åºåœ¨ä¸ºæŸä¸ª <code>executor</code> åˆ†é…ä»»åŠ¡æ—¶ï¼Œé¦–å…ˆåˆ†é…çš„æ˜¯è¿›ç¨‹æœ¬åœ°åŒ–ï¼ˆ<code>process-local</code>ï¼‰ä»»åŠ¡ï¼Œå†åˆ†é…èŠ‚ç‚¹æœ¬åœ°ï¼ˆ<code>node-local</code>ï¼‰ä»»åŠ¡ï¼Œç„¶ååˆ†é…æœºæ¶æœ¬åœ°ï¼ˆ<code>rack-local</code>ï¼‰ä»»åŠ¡ï¼Œæœ€ååˆ†é…ä»»æ„ï¼ˆéæœ¬åœ°ï¼‰ä»»åŠ¡æˆ–è€…æ¨æµ‹ä»»åŠ¡ï¼ˆ<code>speculative task</code>ï¼‰ã€‚</small></p><p>è¿™äº›è¢«åˆ†é…çš„ä»»åŠ¡é€šè¿‡è°ƒåº¦ç¨‹åºåç«¯å¯åŠ¨ã€‚è°ƒåº¦ç¨‹åºåç«¯å‘ <code>executor</code> åç«¯å‘é€è¿œç¨‹å¯åŠ¨ä»»åŠ¡çš„æ¶ˆæ¯ï¼Œä»¥å‘ŠçŸ¥ <code>executor</code> å¼€å§‹è¿è¡Œä»»åŠ¡ã€‚</p><p>å½“ä»»åŠ¡æˆåŠŸå®Œæˆæˆ–è€…å¤±è´¥æ—¶ï¼Œ<code>executor</code> éƒ½ä¼šå‘ <code>driver</code> å‘é€çŠ¶æ€æ›´æ–°ä¿¡æ¯ã€‚å¦‚æœå¤±è´¥ä»»åŠ¡è°ƒåº¦ç¨‹åºå°†åœ¨å¦ä¸€ä¸ª <code>executor</code> ä¸Šé‡æ–°æäº¤ä»»åŠ¡ã€‚è‹¥æ˜¯å¯ç”¨æ¨æµ‹ä»»åŠ¡ï¼ˆé»˜è®¤æƒ…å†µä¸‹ä¸å¯ç”¨ï¼‰ï¼Œå®ƒè¿˜ä¼šä¸ºè¿è¡Œç¼“æ…¢çš„ä»»åŠ¡å¯åŠ¨æ¨æµ‹ä»»åŠ¡ã€‚</p><h4 id="æ‰§è¡Œ"><a href="#æ‰§è¡Œ" class="headerlink" title="æ‰§è¡Œ"></a>æ‰§è¡Œ</h4><p><code>executor</code> é¦–å…ˆç¡®ä¿ä»»åŠ¡çš„ <code>JAR</code> åŒ…å’Œæ–‡ä»¶ä¾èµ–å…³ç³»éƒ½æ˜¯æœ€æ–°çš„ï¼Œ<code>executor</code> åœ¨æœ¬åœ°é«˜é€Ÿç¼“å­˜ä¸­ä¿ç•™äº†å…ˆå‰ä»»åŠ¡å·²ä½¿ç”¨çš„æ‰€æœ‰ä¾èµ–ï¼Œå› æ­¤åªæœ‰åœ¨æ›´æ–°çš„æƒ…å†µä¸‹æ‰ä¼šé‡æ–°ä¸‹è½½ã€‚æ¥ä¸‹æ¥ç”±äºä»»åŠ¡ä»£ç æ˜¯ä»¥å¯åŠ¨ä»»åŠ¡æ¶ˆæ¯çš„ä¸€éƒ¨åˆ†è€Œå‘é€çš„åºåˆ—åŒ–å­—èŠ‚ï¼Œå› æ­¤éœ€è¦ååºåˆ—åŒ–ä»»åŠ¡ä»£ç ï¼ˆåŒ…æ‹¬ç”¨æˆ·è‡ªå·±çš„å‡½æ•°ï¼‰ã€‚æœ€åæ‰§è¡Œä»»åŠ¡ä»£ç ï¼Œä¸è¿‡éœ€è¦æ³¨æ„çš„æ˜¯å› ä¸ºè¿è¡Œä»»åŠ¡åœ¨äº <code>executor</code> ç›¸åŒçš„ <code>JVM</code> ä¸­ï¼Œå› æ­¤ä»»åŠ¡çš„å¯åŠ¨æ²¡æœ‰è¿›ç¨‹å¼€é”€ã€‚</p><p>ä»»åŠ¡å¯ä»¥å‘ <code>driver</code> è¿”å›æ‰§è¡Œç»“æœï¼Œè¿™äº›æ‰§è¡Œç»“æœè¢«åºåˆ—åŒ–å¹¶å‘é€åˆ° <code>executor</code> åç«¯ï¼Œç„¶åä»¥çŠ¶æ€æ›´æ–°æ¶ˆæ¯çš„å½¢å¼è¿”å› <code>driver</code>ã€‚<code>shuffle map</code> ä»»åŠ¡è¿”å›çš„æ˜¯ä¸€äº›å¯ä»¥è®©ä¸‹ä¸€ä¸ªé˜¶æ®µæ£€ç´¢å…¶è¾“å‡ºåˆ†åŒºçš„æ¶ˆæ¯ï¼Œè€Œ <code>result</code> ä»»åŠ¡åˆ™è¿”å›å…¶è¿è¡Œçš„åˆ†åŒºçš„ç»“æœå€¼ï¼Œ<code>driver</code> å°†è¿™äº›ç»“æœå€¼æ”¶é›†èµ·æ¥ï¼Œå¹¶æŠŠæœ€ç»ˆç»“æœè¿”å›ç»™ç”¨æˆ·çš„ç¨‹åºã€‚</p><h4 id="é›†ç¾¤ç®¡ç†"><a href="#é›†ç¾¤ç®¡ç†" class="headerlink" title="é›†ç¾¤ç®¡ç†"></a>é›†ç¾¤ç®¡ç†</h4><p><code>Spark</code> å¦‚ä½•ä¾é  <code>executor</code> æ¥è¿è¡Œæ„æˆ <code>Spark</code> ä½œä¸šçš„ä»»åŠ¡ï¼Œè´Ÿè´£ç®¡ç† <code>executor</code> ç”Ÿå‘½å‘¨æœŸçš„æ˜¯é›†ç¾¤ç®¡ç†å™¨ï¼ˆ<code>cluster manager</code>ï¼‰ï¼ŒåŒæ—¶ <code>Spark</code> æä¾›äº†å¤šç§å…·æœ‰ä¸åŒç‰¹æ€§çš„é›†ç¾¤ç®¡ç†å™¨ï¼š</p><ul><li>æœ¬åœ°æ¨¡å¼<br> åœ¨ä½¿ç”¨æœ¬åœ°æ¨¡å¼æ—¶ï¼Œæœ‰ä¸€ä¸ª <code>executor</code> ä¸ <code>driver</code> è¿è¡Œåœ¨åŒä¸€ä¸ª <code>JVM</code> ä¸­ã€‚æ­¤æ¨¡å¼å¯¹äºæµ‹è¯•æˆ–è¿è¡Œå°è§„æ¨¡ä½œä¸šéå¸¸æœ‰ç”¨ã€‚</li><li>ç‹¬ç«‹æ¨¡å¼<br> ç‹¬ç«‹æ¨¡å¼çš„é›†ç¾¤ç®¡ç†å™¨æ˜¯ä¸€ä¸ªç®€å•çš„åˆ†å¸ƒå¼å®ç°ï¼Œå®ƒè¿è¡Œäº†ä¸€ä¸ª <code>master</code> ä»¥åŠä¸€ä¸ªæˆ–å¤šä¸ª <code>worker</code>ã€‚å½“ <code>Spark</code> åº”ç”¨å¯åŠ¨æ—¶ï¼Œ<code>master</code> è¦æ±‚ <code>worker</code> ä»£è¡¨åº”ç”¨ç”Ÿæˆå¤šä¸ª <code>executor</code> è¿›ç¨‹ï¼Œè¿™ç§æ¨¡å¼çš„ä¸» <code>URL</code> ä¸º <code>spark://host:port</code>ã€‚</li><li><strong><code>Mesos</code> æ¨¡å¼</strong><br> <code>Apache Mesos</code> æ˜¯ä¸€ä¸ªé€šç”¨çš„é›†ç¾¤èµ„æºç®¡ç†å™¨ï¼Œå®ƒå…è®¸æ ¹æ®ç»„ç»‡ç­–ç•¥åœ¨ä¸åŒçš„åº”ç”¨ä¹‹é—´ç»†åŒ–èµ„æºå…±äº«ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ˆç»†ç²’åº¦æ¨¡å¼ï¼‰æ¯ä¸ª <code>Spark</code> ä»»åŠ¡è¢«å½“ä½œæ˜¯ä¸€ä¸ª <code>Mesos</code> ä»»åŠ¡è¿è¡Œï¼Œè¿™æ ·åšå¯ä»¥æ›´æœ‰æ•ˆåœ°ä½¿ç”¨é›†ç¾¤èµ„æºï¼Œä½†æ˜¯ä»¥é¢å¤–çš„è¿›ç¨‹å¯åŠ¨å¼€é”€ä¸ºä»£ä»·ã€‚åœ¨ç²—ç²’åº¦æ¨¡å¼ä¸‹ <code>executor</code> åœ¨è¿›ç¨‹ä¸­è¿è¡Œä»»åŠ¡ï¼Œå› æ­¤åœ¨ <code>Spark</code> åº”ç”¨è¿è¡ŒæœŸé—´çš„é›†ç¾¤èµ„æºç”± <code>executor</code> è¿›ç¨‹æ¥æŒç®¡ï¼Œè¿™ç§æ¨¡å¼çš„ä¸» <code>URL</code> ä¸º <code>mesos://host:port</code>ã€‚</li><li><strong><code>YARN</code> æ¨¡å¼</strong><br> <code>YARN</code> æ˜¯ <code>Hadoop</code> ä¸­ä½¿ç”¨çš„èµ„æºç®¡ç†å™¨ï¼Œæ¯ä¸ªè¿è¡Œçš„ <code>Spark</code> åº”ç”¨å¯¹åº”äºä¸€ä¸ª <code>YARN</code> åº”ç”¨å®ä¾‹ï¼Œæ¯ä¸ª <code>executor</code> åœ¨è‡ªå·±çš„ <code>YARN</code> å®¹å™¨ä¸­è¿è¡Œï¼Œè¿™ç§æ¨¡å¼çš„ä¸» <code>URL</code> ä¸º <code>yarn-client</code> æˆ– <code>yarn-cluster</code>ã€‚<br> <small><code>YARN</code> æ˜¯å”¯ä¸€ä¸€ä¸ªèƒ½å¤Ÿä¸ <code>Hadoop</code> çš„ <code>Kerberos</code> å®‰å…¨æœºåˆ¶é›†æˆçš„é›†ç¾¤ç®¡ç†å™¨ã€‚</small></li></ul><h5 id="è¿è¡Œåœ¨-YARN-ä¸Šçš„-Spark"><a href="#è¿è¡Œåœ¨-YARN-ä¸Šçš„-Spark" class="headerlink" title="è¿è¡Œåœ¨ YARN ä¸Šçš„ Spark"></a>è¿è¡Œåœ¨ <code>YARN</code> ä¸Šçš„ <code>Spark</code></h5><p>åœ¨ <code>YARN</code> ä¸Šè¿è¡Œ <code>Spark</code> æä¾›äº†ä¸å…¶ä»– <code>Hadoop</code> ç»„ä»¶æœ€ç´§å¯†çš„é›†æˆï¼Œä¸ºäº†åœ¨ <code>YARN</code> ä¸Šè¿è¡Œï¼Œ<code>Spark</code> æä¾›äº†ä¸¤ç§éƒ¨ç½²æ¨¡å¼ï¼š <strong><code>YARN</code> å®¢æˆ·ç«¯æ¨¡å¼</strong>å’Œ <strong><code>YARN</code> é›†ç¾¤æ¨¡å¼</strong>ã€‚<code>YARN</code> å®¢æˆ·ç«¯æ¨¡å¼çš„ <code>driver</code> åœ¨å®¢æˆ·ç«¯è¿è¡Œï¼Œè€Œ <code>YARN</code> é›†ç¾¤æ¨¡å¼çš„ <code>driver</code> åœ¨ <code>YARN</code> çš„ <code>application master</code> é›†ç¾¤ä¸Šè¿è¡Œã€‚</p><p>å¯¹äºå…·æœ‰ä»»ä½•äº¤äº’å¼ç»„ä»¶çš„ç¨‹åºéƒ½å¿…é¡»ä½¿ç”¨ <code>YARN</code> å®¢æˆ·ç«¯æ¨¡å¼ï¼Œåœ¨äº¤äº’å¼ç»„ä»¶ä¸Šçš„ä»»ä½•è°ƒè¯•éƒ½æ˜¯ç«‹å³å¯è§çš„ã€‚<br>å¦ä¸€æ–¹é¢ <code>YARN</code> é›†ç¾¤æ¨¡å¼é€‚ç”¨äºç”Ÿæˆä½œä¸šï¼ˆ<code>production job</code>ï¼‰ï¼Œå› ä¸ºæ•´ä¸ªåº”ç”¨åœ¨é›†ç¾¤ä¸Šè¿è¡Œï¼Œè¿™æ ·æ›´æ˜“äºä¿ç•™æ—¥å¿—æ–‡ä»¶ï¼ˆåŒ…æ‹¬æ¥è‡ª <code>driver</code> çš„æ—¥å¿—æ–‡ä»¶ï¼‰ä»¥ä¾›ç¨åæ£€æŸ¥ã€‚å¦‚æœ <code>application master</code> å‡ºç°æ•…éšœï¼Œ<code>YARN</code> è¿˜å¯ä»¥å°è¯•é‡æ–°è¿è¡Œè¯¥åº”ç”¨ã€‚</p><ol><li><p><code>YARN</code> å®¢æˆ·ç«¯æ¨¡å¼<br>åœ¨ <code>YARN</code> å®¢æˆ·ç«¯æ¨¡å¼ä¸‹ï¼Œå½“ <code>driver</code> æ„å»ºæ–°çš„ <code>SparkContext</code> å®ä¾‹æ—¶å°±ä¼šå¯åŠ¨ä¸ <code>YARN</code> ä¹‹é—´çš„äº¤äº’ï¼Œè¯¥ <code>SparkContext</code> å‘ <code>YARN</code> èµ„æºç®¡ç†å™¨æäº¤ä¸€ä¸ª <code>YARN</code> åº”ç”¨ï¼Œè€Œ <code>YARN</code> èµ„æºç®¡ç†å™¨åˆ™å¯åŠ¨é›†ç¾¤èŠ‚ç‚¹ç®¡ç†å™¨ä¸Šçš„ <code>YARN</code> å®¹å™¨ï¼Œå¹¶åœ¨å…¶ä¸­è¿è¡Œä¸€ä¸ªåä¸º <code>SparkExecutorLauncher</code> çš„ <code>application master</code>ã€‚è¯¥ <code>ExecutorLauncher</code> çš„å·¥ä½œæ˜¯å¯åŠ¨ <code>YARN</code> å®¹å™¨ä¸­çš„ <code>executor</code>ï¼Œä¸ºäº†åšåˆ°è¿™ä¸€ç‚¹ <code>ExecutorLauncher</code> è¦å‘èµ„æºç®¡ç†å™¨è¯·æ±‚èµ„æºï¼Œç„¶åå¯åŠ¨ <code>ExecutorBackend</code> è¿›ç¨‹ä½œä¸ºåˆ†é…ç»™å®ƒçš„å®¹å™¨ã€‚</p><p><img src="https://s2.loli.net/2023/04/10/A4U8BWLM21ix9a5.jpg" alt="hadoop_spark_2.jpg"></p><p>æ¯ä¸ª <code>executor</code> åœ¨å¯åŠ¨æ—¶éƒ½ä¼šè¿æ¥å› <code>SparkContext</code>ï¼Œå¹¶æ³¨å†Œè‡ªèº«ã€‚å› æ­¤è¿™å°±å‘ <code>SparkContext</code> æä¾›äº†å…³äºå¯ç”¨äºè¿è¡Œä»»åŠ¡çš„ <code>executor</code> çš„æ•°é‡åŠå…¶ä½ç½®çš„ä¿¡æ¯ï¼Œä¹‹åè¿™äº›ä¿¡æ¯ä¼šè¢«ç”¨åœ¨ä»»åŠ¡çš„ä½ç½®åå¥½ç­–è·¯ä¸­ã€‚</p><p><code>YARN</code> èµ„æºç®¡ç†å™¨çš„åœ°å€å¹¶æ²¡æœ‰åœ¨ä¸» <code>URL</code> ä¸­æŒ‡å®š(è¿™ä¸ä½¿ç”¨ç‹¬ç«‹æ¨¡å¼æˆ– <code>Mesos</code> æ¨¡å¼çš„é›†ç¾¤ç®¡ç†å™¨ä¸åŒ)ï¼Œè€Œæ˜¯ä» <code>HADOOP_CONF_DIR</code> ç¯å¢ƒå˜é‡æŒ‡å®šçš„ç›®å½•ä¸­çš„ <code>Hadoop</code> é…ç½®ä¸­é€‰å–ã€‚</p></li><li><p><code>YARN</code> é›†ç¾¤æ¨¡å¼<br>åœ¨ <code>YARN</code> é›†ç¾¤æ¨¡å¼ä¸‹ï¼Œç”¨æˆ·çš„ <code>driver</code> ç¨‹åºåœ¨ <code>YARN</code> çš„ <code>application master</code> è¿›ç¨‹ä¸­è¿è¡Œï¼Œ<code>spark-submit</code> å®¢æˆ·ç«¯å°†ä¼šå¯åŠ¨ <code>YARN</code> åº”ç”¨ï¼Œä½†æ˜¯å®ƒä¸ä¼šè¿è¡Œä»»ä½•ç”¨æˆ·ä»£ç ã€‚å‰©ä½™è¿‡ç¨‹ä¸å®¢æˆ·ç«¯æ¨¡å¼ç›¸åŒï¼Œé™¤äº† <code>application master</code> åœ¨ä¸º <code>executor</code> åˆ†é…èµ„æºä¹‹å‰å…ˆå¯åŠ¨ <code>driver</code> ç¨‹åºå¤–ã€‚</p><p><img src="https://s2.loli.net/2023/04/10/sMCpmWhGg5qeiV1.jpg" alt="hadoop_spark_3.jpg"></p></li></ol><p>åœ¨è¿™ä¸¤ç§ <code>YARN</code> æ¨¡å¼ä¸‹ï¼Œ<code>executor</code> éƒ½æ˜¯åœ¨è¿˜æ²¡æœ‰ä»»ä½•æœ¬åœ°æ•°æ®ä½ç½®ä¿¡æ¯ä¹‹å‰å…ˆå¯åŠ¨çš„ï¼Œå› æ­¤æœ€ç»ˆæœ‰å¯èƒ½ä¼šå¯¼è‡´ <code>executor</code> ä¸å­˜æœ‰ä½œä¸šæ‰€å¸Œæœ›è®¿åŒæ–‡ä»¶çš„ <code>datanode</code> ä¸åœ¨ä¸€èµ·ã€‚è€Œè¿™äº›å¯¹äºäº¤äº’å¼ä¼šè¯æ˜¯å¯ä»¥æ¥å—çš„ï¼Œç‰¹åˆ«æ˜¯å› ä¸ºä¼šè¯å¼€å§‹ä¹‹å‰å¯èƒ½å¼€ä¸çŸ¥é“éœ€è¦è®¿é—®å“ªäº›æ•°æ®é›†ã€‚ä½†æ˜¯å¯¹äºç”Ÿæˆä½œä¸šæ¥è¯´æƒ…å†µå¹¶éå¦‚æ­¤ï¼Œæ‰€ä»¥ <code>Spark</code> æä¾›äº†ä¸€ç§æ–¹æ³•ï¼Œå¯ä»¥åœ¨ <code>YARN</code> ç¾¤é›†æ¨¡å¼ä¸‹è¿è¡Œæ—¶æä¾›ä¸€äº›æœ‰å…³ä½ç½®çš„æç¤ºï¼Œä»¥æé«˜æ•°æ®æœ¬åœ°æ€§ã€‚</p><p><code>sparkContext</code> æ„é€ å‡½æ•°å¯ä»¥ä½¿ç”¨ç¬¬äºŒä¸ªå‚æ•°æ¥ä¼ é€’ä¸€ä¸ªä¼˜é€‰ä½ç½®ï¼Œè¯¥ä¼˜é€‰ä½ç½®æ˜¯åˆ©ç”¨ <code>InputFormatInfo</code> è¾…åŠ©ç±»æ ¹æ®è¾“äººæ ¼å¼å’Œè·¯å¾„è®¡ç®—å¾—åˆ°çš„ã€‚å› æ­¤å½“å‘èµ„æºç®¡ç†å™¨è¯·æ±‚åˆ†é…æ—¶ <code>application master</code> éœ€è¦ç”¨åˆ°è¿™ä¸ªä¼˜é€‰ä½ç½®ã€‚</p><hr><h3 id="æ•°æ®ç»“æ„åŒ–-DataFrame"><a href="#æ•°æ®ç»“æ„åŒ–-DataFrame" class="headerlink" title="æ•°æ®ç»“æ„åŒ– DataFrame"></a>æ•°æ®ç»“æ„åŒ– <code>DataFrame</code></h3><p><code>Spark</code> çš„ <strong><code>DataFrame</code> æ˜¯ç»“æ„åŒ–çš„ã€æœ‰æ ¼å¼çš„</strong> ï¼Œä¸”æ”¯æŒä¸€äº›ç‰¹å®šçš„æ“ä½œï¼Œå°±åƒåˆ†å¸ƒå¼å†…å­˜ä¸­çš„è¡¨é‚£æ ·ï¼Œæ¯åˆ—éƒ½æœ‰åå­—ï¼Œæœ‰è¡¨ç»“æ„å®šä¹‰ï¼Œæ¯åˆ—éƒ½æœ‰ç‰¹å®šçš„æ•°æ®ç±»å‹ï¼šæ•´æ•°ã€å­—ç¬¦ä¸²å‹ã€æ•°ç»„ã€æ˜ å°„è¡¨ã€å®æ•°ã€æ—¥æœŸã€æ—¶é—´æˆ³ç­‰ã€‚å¦å¤– <code>DataFrame</code> ä¸­çš„æ•°æ®æ˜¯ä¸å¯å˜çš„ï¼Œ<code>Spark</code> è®°å½•ç€æ‰€æœ‰è½¬åŒ–æ“ä½œçš„è¡€ç¼˜å…³ç³»ã€‚å¯ä»¥æ·»åŠ åˆ—æˆ–è€…æ”¹å˜å·²æœ‰åˆ—çš„åå­—å’Œæ•°æ®ç±»å‹ï¼Œè¿™äº›æ“ä½œéƒ½ä¼šåˆ›å»ºæ–°çš„ <code>DataFrame</code> ï¼ŒåŸæœ‰çš„ <code>DataFrame</code> åˆ™ä¼šä¿ç•™ã€‚åœ¨ <code>DataFrame</code> ä¸­ï¼Œä¸€åˆ—ä¸å…¶åå­—å’Œå¯¹åº”çš„ <code>Spark</code> æ•°æ®ç±»å‹éƒ½åœ¨è¡¨ç»“æ„ä¸­å®šä¹‰ã€‚</p><h4 id="æ•°æ®ç±»å‹"><a href="#æ•°æ®ç±»å‹" class="headerlink" title="æ•°æ®ç±»å‹"></a>æ•°æ®ç±»å‹</h4><p>åŸºæœ¬æ•°æ®ç±»å‹ï¼š</p><ul><li><code>ByteType</code></li><li><code>ShortType</code></li><li><code>IntegerType</code></li><li><code>LongType</code></li><li><code>FloatType</code></li><li><code>DoubleType</code></li><li><code>StringType</code></li><li><code>BooleanType</code></li><li><code>DecimalType</code></li></ul><p>å¤æ‚æ•°æ®ç±»å‹ï¼š</p><ul><li><code>BinaryType</code></li><li><code>TimestampType</code></li><li><code>DateType</code></li><li><code>ArrayType</code></li><li><code>MapType</code></li><li><code>StructType</code></li><li><code>StructField</code></li></ul><h4 id="è¡¨ç»“æ„"><a href="#è¡¨ç»“æ„" class="headerlink" title="è¡¨ç»“æ„"></a>è¡¨ç»“æ„</h4><p><code>Spark</code> ä¸­çš„è¡¨ç»“æ„ä¸º <code>DataFrame</code> å®šä¹‰äº†å„åˆ—çš„åå­—å’Œå¯¹åº”çš„æ•°æ®ç±»å‹ã€‚ä»å¤–éƒ¨æ•°æ®æºè¯»å–ç»“æ„åŒ–æ•°æ®æ—¶ï¼Œè¡¨ç»“æ„å°±ä¼šæ´¾ä¸Šç”¨åœºã€‚ç›¸è¾ƒäºåœ¨è¯»å–æ•°æ®æ—¶ç¡®å®šæ•°æ®ç»“æ„ï¼Œæå‰å®šä¹‰è¡¨ç»“æ„æœ‰å¦‚ä¸‹ä¼˜ç‚¹ï¼š</p><ul><li>å¯ä»¥é¿å… <code>Spark</code> <strong>æ¨æ–­æ•°æ®ç±»å‹çš„é¢å¤–å¼€é”€</strong>ã€‚</li><li>å¯ä»¥é˜²æ­¢ <code>Spark</code> ä¸ºå†³å®šè¡¨ç»“æ„è€Œå•ç‹¬åˆ›å»ºä¸€ä¸ªä½œä¸šæ¥ä»æ•°æ®æ–‡ä»¶è¯»å–å¾ˆå¤§ä¸€éƒ¨åˆ†å†…å®¹ï¼Œå¯¹äºè¾ƒå¤§çš„æ•°æ®æ–‡ä»¶è€Œè¨€ï¼Œå…¶<strong>è€—æ—¶ç›¸å½“é•¿</strong> ã€‚</li><li>å¯ä»¥<strong>å°½æ—©å‘ç°æ•°æ®ä¸è¡¨ç»“æ„ä¸åŒ¹é…</strong> ã€‚</li></ul><p>å®šä¹‰è¡¨ç»“æ„æœ‰ä¸¤ç§æ–¹å¼ï¼š</p><ul><li>ç¼–ç¨‹çš„æ–¹å¼ã€‚<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">schema = StructType([StructField(<span class="string">&quot;author&quot;</span>, StringType(), <span class="literal">False</span>),</span><br><span class="line">   StructField(<span class="string">&quot;title&quot;</span>, StringType(), <span class="literal">False</span>),</span><br><span class="line">   StructField(<span class="string">&quot;pages&quot;</span>, IntegerType(), <span class="literal">False</span>)])</span><br></pre></td></tr></table></figure></li><li>ä½¿ç”¨æ•°æ®å®šä¹‰è¯­è¨€ï¼ˆ<code>data definition language, DDL</code>ï¼‰ã€‚<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">schema = &quot;author STRING, title STRING, pages INT&quot;</span><br></pre></td></tr></table></figure></li></ul><h4 id="è¡Œä¸åˆ—"><a href="#è¡Œä¸åˆ—" class="headerlink" title="è¡Œä¸åˆ—"></a>è¡Œä¸åˆ—</h4><p><code>DataFrame</code> ä¸­çš„å…·ååˆ—ä¸ <code>Pandas</code> ä¸­çš„ <code>DataFrame</code> å¯¹è±¡çš„å…·ååˆ—ï¼Œä»¥åŠå…³ç³»æ•°æ®åº“è¡¨çš„åˆ—çš„æ¦‚å¿µä¸Šæ˜¯ç±»ä¼¼çš„ï¼šæè¿°çš„éƒ½æ˜¯ä¸€ç§å­—æ®µã€‚<br><small><code>Spark</code> çš„æ–‡æ¡£å¯¹åˆ—æœ‰ <code>col</code> å’Œ <code>Column</code> ä¸¤ç§è¡¨ç¤ºã€‚<code>Column</code> æ˜¯åˆ—å¯¹è±¡çš„ç±»åï¼Œè€Œ <code>col()</code> æ˜¯æ ‡å‡†çš„å†…å»ºå‡½æ•°ï¼Œè¿”å›ä¸€ä¸ª <code>Column</code> å¯¹è±¡ã€‚</small><br><code>DataFrame</code> ä¸­çš„ <code>Column</code> å¯¹è±¡ä¸èƒ½å•ç‹¬å­˜åœ¨ï¼Œåœ¨ä¸€æ¡è®°å½•ä¸­ï¼Œæ¯ä¸€åˆ—éƒ½æ˜¯è¡Œçš„ä¸€éƒ¨åˆ†ï¼Œæ‰€æœ‰çš„è¡Œå…±åŒç»„æˆæ•´ä¸ª <code>DataFrame</code>ã€‚</p><p><code>Spark</code> ä¸­çš„è¡Œæ˜¯ç”¨ <code>Row</code> å¯¹è±¡æ¥è¡¨ç¤ºçš„ï¼Œå®ƒåŒ…å«ä¸€åˆ—æˆ–å¤šåˆ—ï¼Œå„åˆ—æ—¢å¯ä»¥æ˜¯ç›¸åŒçš„ç±»å‹ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸åŒçš„ç±»å‹ã€‚ç”±äº <code>Row</code> æ˜¯ <code>Spark</code> ä¸­çš„å¯¹è±¡ï¼Œè¡¨ç¤ºä¸€ç³»åˆ—å­—æ®µçš„æœ‰åºé›†åˆï¼Œå› æ­¤å¯ä»¥åœ¨ç¼–ç¨‹ä¸­å¾ˆå®¹æ˜“çš„å®ä¾‹åŒ– <code>Row</code> å¯¹è±¡ï¼Œå¹¶ç”¨è‡ª <code>0</code> å¼€å§‹çš„ä¸‹æ ‡è®¿é—®è¯¥å¯¹è±¡çš„å„å­—æ®µã€‚</p><h4 id="è¡¨ä¸è§†å›¾"><a href="#è¡¨ä¸è§†å›¾" class="headerlink" title="è¡¨ä¸è§†å›¾"></a>è¡¨ä¸è§†å›¾</h4><p>è¡¨å­˜æ”¾æ•°æ®ï¼Œ<code>Spark</code> ä¸­çš„æ¯å¼ è¡¨éƒ½å…³è”æœ‰ç›¸åº”çš„å…ƒæ•°æ®ï¼Œè€Œè¿™äº›å…ƒæ•°æ®æ˜¯è¡¨åŠå…¶æ•°æ®çš„ä¸€äº›ä¿¡æ¯ï¼ŒåŒ…æ‹¬è¡¨ç»“æ„ã€æè¿°ã€è¡¨åã€æ•°æ®åº“åã€åˆ—åã€åˆ†åŒºã€å®é™…æ•°æ®æ‰€åœ¨çš„ç‰©ç†ä½ç½®ç­‰ï¼Œè¿™äº›å…¨éƒ½å­˜æ”¾åœ¨ä¸­å¿ƒåŒ–çš„å…ƒæ•°æ®åº“ä¸­ã€‚<br><code>Spark</code> æ²¡æœ‰ä¸“é—¨çš„å…ƒæ•°æ®åº“ï¼Œ<strong>é»˜è®¤ä½¿ç”¨ <code>Apache Hive</code> çš„å…ƒæ•°æ®åº“æ¥ä¿å­˜è¡¨çš„æ‰€æœ‰æ•°æ®</strong> ï¼Œä»“åº“è·¯å¾„ä½äº <code>/user/hive/warehouse</code>ã€‚å¦‚æœæƒ³è¦æƒ³è¦ä¿®æ”¹é»˜è®¤è·¯å¾„ï¼Œå¯ä»¥ä¿®æ”¹ <code>Spark</code> é…ç½®å˜é‡ <code>spark.sql.warehouse.dir</code> ä¸ºåˆ«çš„è·¯å¾„ï¼Œè¿™ä¸ªè·¯å¾„æ—¢å¯ä»¥æ˜¯æœ¬åœ°è·¯å¾„ï¼Œä¹Ÿå¯ä»¥æ˜¯å¤–éƒ¨çš„åˆ†å¸ƒå¼å­˜å‚¨ã€‚</p><h5 id="ç®¡ç†è¡¨"><a href="#ç®¡ç†è¡¨" class="headerlink" title="ç®¡ç†è¡¨"></a>ç®¡ç†è¡¨</h5><p><code>Spark</code> å…è®¸åˆ›å»ºä¸¤ç§è¡¨ï¼š</p><ul><li><strong>æœ‰ç®¡ç†è¡¨</strong><br><code>Spark</code> æ—¢ç®¡ç†å…ƒæ•°æ®ï¼Œä¹Ÿç®¡ç†æ–‡ä»¶å­˜å‚¨ä¸Šçš„æ•°æ®ã€‚è¿™é‡Œçš„æ–‡ä»¶å­˜å‚¨å¯ä»¥ç†è§£ä¸ºæœ¬åœ°æ–‡ä»¶ç³»ç»Ÿæˆ– <code>HDFS</code>ï¼Œä¹Ÿå¯ä»¥æ˜¯å¤–éƒ¨çš„å¯¹è±¡å­˜å‚¨ç³»ç»Ÿã€‚</li><li><strong>æ— ç®¡ç†è¡¨</strong><br><code>Spark</code> åªç®¡ç†å…ƒæ•°æ®ï¼Œéœ€è¦è‡ªè¡Œç®¡ç†å¤–éƒ¨æ•°æ®æºä¸­çš„æ•°æ®ã€‚</li></ul><h5 id="åŸºæœ¬æ“ä½œ"><a href="#åŸºæœ¬æ“ä½œ" class="headerlink" title="åŸºæœ¬æ“ä½œ"></a>åŸºæœ¬æ“ä½œ</h5><ol><li><p>åˆ›å»ºæ•°æ®åº“å’Œè¡¨</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> DATABASE demo_db;</span><br><span class="line">USE demo_db;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> demo_table_1 (<span class="type">date</span> STRING, delay <span class="type">INT</span>, distance <span class="type">INT</span>);</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> demo_table_2 (<span class="type">date</span> STRING, delay <span class="type">INT</span>, distance <span class="type">INT</span>) <span class="keyword">USING</span> csv OPTIONS (PATH <span class="string">&#x27;/data/learing/data.csv&#x27;</span>);</span><br></pre></td></tr></table></figure></li><li><p>æ–°å¢è§†å›¾</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">OR</span> REPLACE TEMP <span class="keyword">VIEW</span> [global_temp.]test_view <span class="keyword">AS</span> <span class="keyword">SELECT</span> <span class="type">date</span>, delay, distance <span class="keyword">FROM</span> demo_table_1 <span class="keyword">WHERE</span> distance <span class="operator">=</span> <span class="number">2</span>;</span><br></pre></td></tr></table></figure></li><li><p>ç¼“å­˜ <code>SQL</code> è¡¨</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">CACHE [LAZY] <span class="keyword">TABLE</span> <span class="operator">&lt;</span><span class="keyword">table</span><span class="operator">-</span>name<span class="operator">&gt;</span></span><br><span class="line">UNCACHE <span class="keyword">TABLE</span> <span class="operator">&lt;</span><span class="keyword">table</span><span class="operator">-</span>name<span class="operator">&gt;</span></span><br></pre></td></tr></table></figure></li></ol><h4 id="æ•°æ®æº"><a href="#æ•°æ®æº" class="headerlink" title="æ•°æ®æº"></a>æ•°æ®æº</h4><h5 id="DataFrameReader"><a href="#DataFrameReader" class="headerlink" title="DataFrameReader"></a><code>DataFrameReader</code></h5><p><code>DataFrameReader</code> æ˜¯ä»æ•°æ®æºè¯»å–æ•°æ®åˆ° <code>DataFrame</code> æ‰€ç”¨åˆ°çš„æ ¸å¿ƒç»“æ„ã€‚ç”¨æ³•æœ‰å›ºå®šçš„æ ¼å¼å’Œæ¨èçš„ä½¿ç”¨æ¨¡å¼ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DataFrameReader.format(args).option(&quot;key&quot;, &quot;value&quot;).schema(args).load()</span><br></pre></td></tr></table></figure><p>è¿™ç§å°†ä¸€ä¸²æ–¹æ³•ä¸²è”èµ·æ¥ä½¿ç”¨çš„æ¨¡å¼åœ¨ <code>Spark</code> ä¸­å¾ˆå¸¸è§ï¼Œå¯è¯»æ€§ä¹Ÿä¸é”™ã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯åªèƒ½é€šè¿‡ <code>SparkSession</code> å®ä¾‹è®¿é—® <code>DataFrameReader</code>ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸èƒ½è‡ªè¡Œåˆ›å»º <code>DataFrameReader</code> å®ä¾‹ï¼Œè·å–è¯¥å®ä¾‹çš„æ–¹æ³•å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SparkSession.read // è¿”å› DataFrameReader ä»é™æ€æ•°æ®æºè¯»å– DataFrame</span><br><span class="line">SparkSession.readStream // è¿”å›çš„å®ä¾‹ç”¨äºè¯»å–æµå¼æ•°æ®æº</span><br></pre></td></tr></table></figure><p><code>DataFrameReader</code> çš„å…¬æœ‰æ–¹æ³•å¦‚ä¸‹ï¼š</p><table><thead><tr><th>æ–¹æ³•</th><th>å‚æ•°</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>format()</code></td><td><code>&quot;parquet&quot;</code>ã€ <code>&quot;csv&quot;</code>ã€ <code>&quot;txt&quot;</code>ã€ <code>&quot;json&quot;</code>ã€ <code>&quot;orc&quot;</code>ã€ <code>&quot;avro&quot;</code></td><td>å¦‚æœä¸æŒ‡å®šæ–¹æ³•çš„æ ¼å¼ï¼Œåˆ™ä½¿ç”¨ <code>spark.sql.sources.default</code> æ‰€æŒ‡å®šçš„é»˜è®¤æ ¼å¼</td></tr><tr><td><code>option()</code></td><td><code>(&quot;mode&quot;, [PERMISSIVE FAILFAST DROPMALFORMAD])</code> ã€ <code>(&quot;inferSchema&quot;, [true false])</code>ã€<code>(&quot;path&quot;, &quot;path_file_data_source&quot;)</code></td><td>ä¸€ç³»åˆ—é”®å€¼å¯¹ï¼Œ<code>Spark</code> æ–‡æ¡£ä¸­è§£é‡Šäº†ä¸åŒæ¨¡å¼ä¸‹çš„å¯¹åº”è¡Œä¸º</td></tr><tr><td><code>schema()</code></td><td><code>DDL</code> å­—ç¬¦ä¸²æˆ– <code>StructType</code> å¯¹è±¡</td><td>å¯¹äº <code>JSON</code> æˆ–è€… <code>CSV</code> æ ¼å¼ï¼Œå¯ä»¥ä½¿ç”¨ <code>option()</code> æ–¹æ³•è‡ªè¡Œæ¨æ–­è¡¨ç»“æ„</td></tr><tr><td><code>load()</code></td><td><code>/path/source</code></td><td>è¦è¯»å–çš„æ•°æ®æºè·¯å¾„</td></tr></tbody></table><p><small>ä»é™æ€çš„ <code>Parquet</code> æ•°æ®æºè¯»å–æ•°æ®ä¸éœ€è¦æä¾›æ•°æ®ç»“æ„ï¼Œå› ä¸º <code>Parquet</code> æ–‡ä»¶çš„å…ƒæ•°æ®é€šå¸¸åŒ…å«è¡¨ç»“æ„ä¿¡æ¯ã€‚ä¸è¿‡å¯¹äºæµå¼æ•°æ®æºï¼Œè¡¨ç»“æ„ä¿¡æ¯æ˜¯éœ€è¦æä¾›çš„ã€‚</small></p><h5 id="DataFrameWriter"><a href="#DataFrameWriter" class="headerlink" title="DataFrameWriter"></a><code>DataFrameWriter</code></h5><p><code>DataFrameWriter</code> æ˜¯ <code>DataFrameReader</code> çš„åé¢ï¼Œå°†æ•°æ®ä¿å­˜æˆ–å†™å…¥ç‰¹å®šçš„æ•°æ®æºã€‚ä¸ <code>DataFrameReader</code> ä¸åŒï¼Œ<code>DataFrameWriter</code> éœ€è¦ä»ä¿å­˜çš„ <code>DataFrame</code> è·å–ï¼Œæ¨èçš„ä½¿ç”¨æ¨¡å¼å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">DataFrameWriter.format(args).option(args).bucketBy(args).partitionBy(args).save(path)</span><br><span class="line">DataFrameWriter.format(args).option(args).sortBy(args).saveAsTable(table)</span><br></pre></td></tr></table></figure><p><code>DataFrameWriter</code> çš„å…¬æœ‰æ–¹æ³•å¦‚ä¸‹ï¼š</p><table><thead><tr><th>æ–¹æ³•</th><th>å‚æ•°</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>format()</code></td><td><code>&quot;parquet&quot;</code>ã€ <code>&quot;csv&quot;</code>ã€ <code>&quot;txt&quot;</code>ã€ <code>&quot;json&quot;</code>ã€ <code>&quot;orc&quot;</code>ã€ <code>&quot;avro&quot;</code></td><td>å¦‚æœä¸æŒ‡å®šæ–¹æ³•çš„æ ¼å¼ï¼Œåˆ™ä½¿ç”¨ <code>spark.sql.sources.default</code> æ‰€æŒ‡å®šçš„é»˜è®¤æ ¼å¼</td></tr><tr><td><code>option()</code></td><td><code>(&quot;mode&quot;, append [overwrite ignore error])</code>ã€ <code>(&quot;path&quot;, &quot;path_to_write_to&quot;)</code></td><td>ä¸€ç³»åˆ—é”®å€¼å¯¹ï¼Œ<code>Spark</code> æ–‡æ¡£ä¸­è§£é‡Šäº†ä¸åŒæ¨¡å¼ä¸‹çš„å¯¹åº”è¡Œä¸º</td></tr><tr><td><code>bucketBy()</code></td><td><code>(numBuckets, col, ..., coln)</code></td><td>æŒ‰æ¡¶å†™å…¥æ—¶ï¼ŒæŒ‡å®šæ¡¶æ•°é‡å’Œåˆ†æ¡¶æ‰€ä¾æ®å­—æ®µçš„åå­—åˆ—è¡¨</td></tr><tr><td><code>save()</code></td><td><code>&quot;/path/source&quot;</code></td><td>å†™å…¥çš„è·¯å¾„</td></tr><tr><td><code>saveAsTable()</code></td><td><code>&quot;table_name&quot;</code></td><td>å†™å…¥çš„è¡¨å</td></tr></tbody></table><h5 id="æ–‡ä»¶ç±»å‹"><a href="#æ–‡ä»¶ç±»å‹" class="headerlink" title="æ–‡ä»¶ç±»å‹"></a>æ–‡ä»¶ç±»å‹</h5><ol><li><p><strong><code>Parquet</code></strong><br><code>Spark</code> çš„é»˜è®¤æ•°æ®æºï¼Œå¾ˆå¤šå¤§æ•°æ®æ¡†æ¶å’Œå¹³å°éƒ½æ”¯æŒï¼Œå®ƒæ˜¯ä¸€ç§å¼€æºçš„åˆ—å¼å­˜å‚¨æ–‡ä»¶æ ¼å¼ï¼Œæä¾›å¤šç§ <code>I/O</code> ä¼˜åŒ–æªæ–½ï¼ˆæ¯”å¦‚å‹ç¼©ï¼Œä»¥èŠ‚çœå­˜å‚¨ç©ºé—´ï¼Œæ”¯æŒå¿«é€Ÿè®¿é—®æ•°æ®åˆ—ï¼‰ã€‚</p></li><li><p><code>JSON</code><br><code>JSON</code> çš„å…¨ç§°ä¸º <code>JavaScript Object Notation</code>ï¼Œå®ƒ æ˜¯ä¸€ç§å¸¸è§çš„æ•°æ®æ ¼å¼ã€‚<code>JSON</code> æœ‰ä¸¤ç§è¡¨ç¤ºæ ¼å¼ï¼šå•è¡Œæ¨¡å¼å’Œå¤šè¡Œæ¨¡å¼ã€‚</p></li><li><p><code>CSV</code><br><code>CSV</code> æ ¼å¼åº”ç”¨éå¸¸å®˜æ–¹ï¼Œæ˜¯ä¸€ç§å°†æ‰€æœ‰æ•°æ®å­—æ®µç”¨é€—å·éš”å¼€çš„æ–‡æœ¬æ–‡ä»¶æ ¼å¼ã€‚åœ¨è¿™äº›ç”¨é€—å·éš”å¼€çš„å­—æ®µä¸­ï¼Œæ¯è¡Œè¡¨ç¤ºä¸€æ¡è®°å½•ã€‚ï¼ˆè¿™é‡Œçš„é€—å·åˆ†éš”ç¬¦å·æ˜¯å¯ä»¥è¢«ä¿®æ”¹çš„ï¼‰</p></li><li><p><strong><code>Avro</code></strong><br><code>Avro</code> æ ¼å¼æœ‰å¾ˆå¤šä¼˜ç‚¹ï¼ŒåŒ…æ‹¬ç›´æ¥æ˜ å°„ <code>JSON</code>ã€å¿«é€Ÿä¸”é«˜æ•ˆã€æ”¯æŒå¤šç§ç¼–ç¨‹è¯­è¨€ã€‚</p></li><li><p><strong><code>ORC</code></strong><br>ä½œä¸ºå¦ä¸€ç§ä¼˜åŒ–åçš„åˆ—å¼å­˜å‚¨æ–‡ä»¶æ ¼å¼ï¼Œ<code>Spark</code> æ”¯æŒ <code>ORC</code> çš„å‘é‡åŒ–è¯»ã€‚å‘é‡åŒ–è¯»é€šå¸¸ä¼šæˆå—ï¼ˆï¼‰è¯»å…¥æ•°æ®ï¼Œè€Œä¸ä¿—ä¸€æ¬¡è¯»ä¸€è¡Œï¼ŒåŒæ—¶æ“ä½œä¼šä¸²èµ·æ¥ï¼Œé™ä½æ‰«æã€è¿‡æ»¤ã€èšåˆã€è¿æ¥ç­‰é›†ä¸­æ“ä½œæ—¶çš„ <code>CPU</code> ä½¿ç”¨ç‡ã€‚</p></li></ol><h4 id="é«˜é˜¶å‡½æ•°"><a href="#é«˜é˜¶å‡½æ•°" class="headerlink" title="é«˜é˜¶å‡½æ•°"></a>é«˜é˜¶å‡½æ•°</h4><p>å¤æ‚æ•°æ®ç±»å‹ç”±ç®€å•æ•°æ®ç±»å‹ç»„åˆè€Œæˆï¼Œè€Œå®é™…åˆ™æ˜¯ç»å¸¸ç›´æ¥æ“ä½œå¤æ‚æ•°æ®ç±»å‹ï¼Œæ“ä½œå¤æ‚æ•°æ®ç±»å‹çš„æ–¹å¼æœ‰ä»¥ä¸‹ä¸¤ç§:</p><ul><li>å°†åµŒå¥—çš„ç»“æ„æ‰“æ•£åˆ°å¤šè¡Œï¼Œè°ƒç”¨æŸä¸ªå‡½æ•°ï¼Œç„¶åé‡å»ºåµŒå¥—ç»“æ„ã€‚</li><li>æ„å»ºç”¨æˆ·è‡ªå®šä¹‰å‡½æ•°ã€‚</li></ul><p>è¿™ä¸¤ç§æ–¹å¼éƒ½æœ‰åŠ©äºä»¥è¡¨æ ¼æ ¼å¼å¤„ç†é—®é¢˜ï¼Œä¸€èˆ¬ä¼šæ¶‰åŠåˆ° <code>get_json_object()</code>ã€<code>from_json()</code>ã€<code>to_json()</code>ã€<code>explode()</code> å’Œ <code>selectExpr()</code> ç­‰å·¥å…·å‡½æ•°ã€‚</p><h5 id="æ‰“æ•£å†é‡ç»„"><a href="#æ‰“æ•£å†é‡ç»„" class="headerlink" title="æ‰“æ•£å†é‡ç»„"></a>æ‰“æ•£å†é‡ç»„</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">SELECT id, collect_list(value + 1) AS values</span><br><span class="line">FROM (</span><br><span class="line">   SELECT id, EXPLODE(values) AS value</span><br><span class="line">   FROM table</span><br><span class="line">) x</span><br><span class="line">GROUP BY id</span><br></pre></td></tr></table></figure><p>ä¸Šè¿°çš„åµŒå¥—çš„ <code>SQL</code> è¯­å¥ä¸­ï¼Œå…ˆæ‰§è¡Œ <code>EXPLODE(values)</code>ï¼Œä¼šä¸ºæ¯ä¸€ä¸ª <code>value</code> åˆ›å»ºæ–°çš„ä¸€è¡Œï¼ˆåŒ…æ‹¬ <code>id</code> å­—æ®µï¼‰ã€‚<code>collect_list()</code> è¿”å›çš„æ˜¯æœªå»é‡çš„å¯¹è±¡åˆ—è¡¨ï¼Œç”±äº <code>GROUP BY</code> è¯­å¥ä¼šè§¦å‘æ•°æ®æ··æ´—æ“ä½œï¼Œå› æ­¤é‡æ–°ç»„åˆçš„æ•°ç»„é¡ºåºå’ŒåŸæ•°ç»„ä¸ä¸€å®šç›¸åŒã€‚ </p><h5 id="è‡ªå®šä¹‰å‡½æ•°"><a href="#è‡ªå®šä¹‰å‡½æ•°" class="headerlink" title="è‡ªå®šä¹‰å‡½æ•°"></a>è‡ªå®šä¹‰å‡½æ•°</h5><p>è¦æƒ³è‡ªè¡Œä¸Šè¿°ç­‰ä»·çš„ä»»åŠ¡ï¼Œä¹Ÿå¯ä»¥åˆ›å»º <code>UDF</code>ï¼Œç”¨ <code>map()</code> è¿­ä»£å„ä¸ªå…ƒç´ å¹¶æ‰§è¡Œé¢å¤–çš„æ“ä½œã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">val = plusOneInt = (values: Array[Int] =&gt; &#123;</span><br><span class="line">   values.map(value =&gt; value + 1)</span><br><span class="line">&#125;)</span><br><span class="line">spark.udf.register(&quot;plusOneInt&quot;, plusOneInt)</span><br></pre></td></tr></table></figure><p>ç„¶åå¯ä»¥åœ¨ <code>Spark SQL</code> ä¸­ä½¿ç”¨è¿™ä¸ª <code>UDF</code>ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">spark.sql(&quot;SELECT id, plusOneInt(values) AS values FROM table&quot;).show()</span><br></pre></td></tr></table></figure><p>ç”±äºæ²¡æœ‰é¡ºåºé—®é¢˜ï¼Œè¿™ç§æ–¹æ³•æ¯”ä½¿ç”¨ <code>explode()</code> å’Œ <code>collect_list()</code> å¥½ä¸€äº›ï¼Œä½†åºåˆ—åŒ–å’Œååºåˆ—åŒ–è¿‡ç¨‹æœ¬èº«å¼€é”€å¾ˆå¤§ã€‚</p><h5 id="å¤æ‚ç±»å‹çš„å†…å»ºå‡½æ•°"><a href="#å¤æ‚ç±»å‹çš„å†…å»ºå‡½æ•°" class="headerlink" title="å¤æ‚ç±»å‹çš„å†…å»ºå‡½æ•°"></a>å¤æ‚ç±»å‹çš„å†…å»ºå‡½æ•°</h5><p><code>Spark</code> ä¸“é—¨ä¸ºå¤æ‚æ•°æ®ç±»å‹å‡†å¤‡çš„å†…å»ºå‡½æ•°ï¼Œå®Œæ•´åˆ—è¡¨å¯ä»¥å‚è€ƒå®˜æ–¹æ–‡æ¡£ã€‚</p><h5 id="é«˜é˜¶å‡½æ•°-1"><a href="#é«˜é˜¶å‡½æ•°-1" class="headerlink" title="é«˜é˜¶å‡½æ•°"></a>é«˜é˜¶å‡½æ•°</h5><p>é™¤äº†ä¸Šè¿°çš„å†…å»ºå‡½æ•°å¤–ï¼Œè¿˜æœ‰éƒ¨åˆ†é«˜é˜¶å‡½æ•°æ¥å—åŒ¿å <code>lambda</code> å‡½æ•°ä½œä¸ºå‚æ•°ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># transform å‡½æ•°æ¥å—ä¸€ä¸ªæ•°ç»„å’ŒåŒ¿åå‡½æ•°ä½œä¸ºè¾“å…¥ï¼Œé€šè¿‡å¯¹æ•°ç»„çš„æ¯ä¸ªå…ƒç´ åº”ç”¨åŒ¿åå‡½æ•°ï¼Œè¯¥å‡½æ•°å°†ç»“æœèµ‹å€¼åˆ°è¾“å‡ºæ•°ç»„ï¼Œé€æ˜åœ°åˆ›å»ºå‡ºä¸€ä¸ªæ–°æ•°ç»„ã€‚</span><br><span class="line">transform(<span class="keyword">values</span>, <span class="keyword">values</span> <span class="operator">-</span><span class="operator">&gt;</span> lambda expression)</span><br></pre></td></tr></table></figure><ol><li><p><code>transform()</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">transform(array&lt;T&gt;, function&lt;T, U&gt;): array&lt;U&gt;</span><br></pre></td></tr></table></figure><p>é€šè¿‡å¯¹è¾“å…¥æ•°ç»„çš„æ¯ä¸ªå…ƒç´ ä½¿ç”¨ä¸€ä¸ªå‡½æ•°ï¼Œ<code>transform()</code> å‡½æ•°ä¼šç”Ÿæˆæ–°çš„æ•°ç»„ã€‚ </p></li><li><p><code>filter()</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">filter(array&lt;T&gt;, function&lt;T, Boolean&gt;): array&lt;T&gt;</span><br></pre></td></tr></table></figure><p><code>filter()</code> å‡½æ•°è¾“å‡ºçš„æ•°ç»„ä»…åŒ…å«è¾“å…¥æ•°ç»„ä¸­è®©å¸ƒå°”è¡¨è¾¾å¼ç»“æœä¸º <code>true</code> çš„å…ƒç´ ã€‚</p></li><li><p><code>exists()</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">exists(array&lt;T&gt;, function&lt;T, V, Boolean&gt;): Boolean</span><br></pre></td></tr></table></figure><p>å½“è¾“å…¥æ•°ç»„ä¸­æœ‰ä»»æ„ä¸€å…ƒç´ æ»¡è¶³å¸ƒå°”å‡½æ•°æ—¶ï¼Œ<code>exists()</code> å‡½æ•°è¿”å› <code>true</code>ã€‚</p></li><li><p><code>reduce()</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reduce(array&lt;T&gt;, B, function&lt;B, T, B&gt;, function&lt;B, R&gt;)</span><br></pre></td></tr></table></figure><p>é€šè¿‡å‡½æ•° <code>function&lt;B, T, B&gt;</code>ï¼Œ<code>reduce()</code> å‡½æ•°å¯ä»¥å°†æ•°ç»„çš„å…ƒç´ åˆå¹¶åˆ°ç¼“å†²åŒº <code>B</code>ï¼Œæœ€åå¯¹æœ€ç»ˆç¼“å†²åŒºä½¿ç”¨æœ€ç»ˆå‡½æ•° <code>function&lt;B, R&gt;</code>ï¼Œå¹¶å°†æ•°ç»„å½’çº¦ä¸ºå•ä¸ªå€¼ã€‚</p></li></ol><h5 id="é«˜é˜¶æ“ä½œ"><a href="#é«˜é˜¶æ“ä½œ" class="headerlink" title="é«˜é˜¶æ“ä½œ"></a>é«˜é˜¶æ“ä½œ</h5><ol><li><p>è”åˆ<br>å°†å…·æœ‰ç›¸åŒè¡¨ç»“æ„çš„ <code>DataFrame</code> è”åˆèµ·æ¥ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è”åˆä¸¤ç§è¡¨</span></span><br><span class="line">bar = deplays.union(foo)</span><br><span class="line">bar.createOrReplaceTempView(<span class="string">&quot;bar&quot;</span>)</span><br><span class="line"><span class="comment"># å±•ç¤ºè”åˆç»“æœ</span></span><br><span class="line">bar.filtyer(expr(<span class="string">&quot;origin == &#x27;SEA&#x27; AND destination == &#x27;SFO&#x27; AND date LIKE &#x27;0010%&#x27; AND deplay &gt; 0&quot;</span>)).show()</span><br></pre></td></tr></table></figure></li><li><p>è¿æ¥<br>è¿æ¥ä¸¤ä¸ª <code>DataFrame</code> æ˜¯å¸¸ç”¨æ“ä½œä¹‹ä¸€ã€‚<br>é»˜è®¤æƒ…å†µä¸‹è¿æ¥ä¸º <code>inner join</code>ï¼Œå¯é€‰çš„ç§ç±»åŒ…å« <code>inner</code>ã€ <code>cross</code>ã€ <code>outer</code>ã€ <code>full</code>ã€ <code>full_outer</code>ã€ <code>left</code>ã€ <code>left_outer</code>ã€ <code>right</code>ã€ <code>right_outer</code>ã€ <code>left_semi</code> å’Œ <code>left_anti</code>ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">foo.join(ports, ports.IATA == foo.origin).select(<span class="string">&quot;City&quot;</span>, <span class="string">&quot;date&quot;</span>, <span class="string">&quot;deplay&quot;</span>, <span class="string">&quot;distance&quot;</span>).show()</span><br></pre></td></tr></table></figure></li><li><p>çª—å£<br>çª—å£å‡½æ•°ä½¿ç”¨çª—å£ï¼ˆä¸€ä¸ªèŒƒå›´å†…çš„è¾“å…¥è¡Œï¼‰ä¸­å„è¡Œçš„å€¼è®¡ç®—å‡ºä¸€ç»„å€¼æ¥è¿”å›ï¼Œè¿”å›çš„ä¸€èˆ¬æ˜¯æ–°çš„ä¸€è¡Œã€‚é€šè¿‡ä½¿ç”¨çª—å£å‡½æ•°å¯ä»¥åœ¨æ¯æ¬¡æ“ä½œä¸€ç»„çš„åŒæ—¶ï¼Œè¿”å›çš„è¡Œæ•°ä»ç„¶å’Œè¾“å…¥è¡Œæ•°ä¸€ä¸€å¯¹åº”ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> origin, destiation, TotalDelays, rank</span><br><span class="line"><span class="keyword">FROM</span> (<span class="keyword">SELECT</span> origin, destiation, TotalDelays, <span class="built_in">dense_rank</span>() <span class="keyword">OVER</span> (<span class="keyword">PARTITION</span> <span class="keyword">BY</span> origin <span class="keyword">ORDER</span> <span class="keyword">BY</span> TotalDelays <span class="keyword">DESC</span>) <span class="keyword">as</span> rank) t</span><br><span class="line"><span class="keyword">WHERE</span> rank <span class="operator">&lt;=</span> <span class="number">3</span></span><br></pre></td></tr></table></figure></li><li><p>ä¿®æ”¹<br>å¯¹ <code>DataFrame</code> è¿›è¡Œä¿®æ”¹ï¼Œ<code>DataFrame</code> æœ¬èº«ä¸å…è®¸è¢«ä¿®æ”¹ï¼Œä¸è¿‡å¯ä»¥é€šè¿‡æ–°å»º <code>DataFrame</code> çš„æ–¹å¼æ¥å®ç°ä¿®æ”¹ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¢åŠ æ–°åˆ—</span></span><br><span class="line">foo2 = (foo.withColumn(<span class="string">&quot;status&quot;</span>, expr(<span class="string">&quot;CASE WHEN delay &lt;= 10 THEN &#x27;On-time&#x27; ELSE &#x27;Delayed&#x27; END&quot;</span>)))</span><br><span class="line">foo2.show()</span><br><span class="line"><span class="comment"># åˆ é™¤åˆ—</span></span><br><span class="line">foo3 = foo2.drop(<span class="string">&quot;delay&quot;</span>)</span><br><span class="line">foo3.show()</span><br><span class="line"><span class="comment"># ä¿®æ”¹åˆ—å</span></span><br><span class="line">foo4 = foo3.withColumnRenamed(<span class="string">&quot;status&quot;</span>, <span class="string">&quot;flight_status&quot;</span>)</span><br><span class="line">foo4.show()</span><br><span class="line"><span class="comment"># è½¬ç½®ï¼ˆå°†è¡Œä¸åˆ—æ•°æ®äº’æ¢ï¼‰</span></span><br><span class="line">SELECT * FROM (</span><br><span class="line">   SELECT destination, CAST(SUBSTRING(date, <span class="number">0</span>, <span class="number">2</span>) AS <span class="built_in">int</span>) AS month, delay FROM departureDelays WHERE origin = <span class="string">&#x27;SEA&#x27;</span></span><br><span class="line">)</span><br><span class="line">PIVOT (</span><br><span class="line">   CAST(AVG(delay) AS DECIMAL(<span class="number">4</span>, <span class="number">2</span>)) AS AvgDelay, MAX(delay) AS MaxDelay FOR month IN (<span class="number">1</span> JAN, <span class="number">2</span> FEB)</span><br><span class="line">)</span><br><span class="line">ORDER BY destination</span><br></pre></td></tr></table></figure></li></ol><hr><h3 id="æ•°æ®ç»“æ„åŒ–-Dataset"><a href="#æ•°æ®ç»“æ„åŒ–-Dataset" class="headerlink" title="æ•°æ®ç»“æ„åŒ– Dataset"></a>æ•°æ®ç»“æ„åŒ– <code>Dataset</code></h3><p>å‰é¢çœ‹è¿‡äº† <code>DataFrame</code>ï¼Œé‚£ä¹ˆä½ åŸºæœ¬ä¸Šå°±ç†è§£äº† <code>Dataset</code>ï¼Œä¸è¿‡è¿˜æ˜¯æœ‰é‚£ä¹ˆä¸€äº›å·®åˆ«ï¼Œ<code>Dataset</code> ä¸»è¦åŒºåˆ†ä¸¤ç§ç‰¹æ€§ï¼š <strong>æœ‰ç±»å‹</strong>å’Œ<strong>æ— ç±»å‹</strong> ã€‚</p><p><img src="https://s2.loli.net/2023/04/10/897iHPxjcUebNE5.jpg" alt="hadoop_spark_4.jpg"></p><p>ä»æ¦‚å¿µä¸Šçœ‹ï¼Œå¯ä»¥å°† <code>DataFrame</code> çœ‹ä½œæ˜¯ <code>Dataset[Row]</code> è¿™ç§ç”±æ™®é€šå¯¹è±¡ç»„æˆçš„é›†åˆçš„ä¸€ä¸ªåˆ«ç§°ï¼Œå…¶ä¸­ <code>Row</code> æ˜¯æ™®é€šçš„æ— ç±»å‹å¯¹è±¡ï¼Œå¯ä»¥åŒ…å«ä¸åŒæ•°æ®ç±»å‹çš„å­—æ®µã€‚è€Œ <code>Dataset</code> åˆ™ä¸ä¹‹ç›¸åï¼Œæ˜¯ç”±åŒä¸€ç±»å‹çš„å¯¹è±¡æ‰€ç»„æˆçš„é›†åˆã€‚æ­£å¦‚å®˜æ–¹æ–‡æ¡£ä¸­æè¿°çš„é‚£æ ·ï¼š</p><blockquote><p>ä¸€ç§ç”±é¢†åŸŸä¸“ç”¨å¯¹è±¡ç»„æˆçš„å¼ºç±»å‹é›†åˆï¼Œå¯ä»¥ä½¿ç”¨å‡½æ•°å¼æˆ–å…³ç³»å‹çš„æ“ä½œå°†å…¶å¹¶è¡Œè½¬åŒ–ã€‚</p></blockquote><table><thead><tr><th>è¯­è¨€</th><th>æœ‰ç±»å‹å’Œæ— ç±»å‹çš„ä¸»è¦æŠ½è±¡ç»“æ„</th><th>æœ‰ç±»å‹æˆ–æ— ç±»å‹</th></tr></thead><tbody><tr><td><code>Scala</code></td><td><code>Dataset[T]</code> å’Œ <code>DataFrame</code>ï¼ˆ<code>Dataset[Row]</code> çš„åˆ«å‘½ï¼‰</td><td>éƒ½æœ‰</td></tr><tr><td><code>Java</code></td><td><code>Dataset&lt;T&gt;</code></td><td>æœ‰ç±»å‹</td></tr><tr><td><code>Python</code></td><td><code>DataFrame</code></td><td>æ™®é€š <code>Row</code> å¯¹è±¡ï¼Œæ— ç±»å‹</td></tr><tr><td><code>R</code></td><td><code>DataFrame</code></td><td>æ™®é€š <code>Row</code> å¯¹è±¡ï¼Œæ— ç±»å‹</td></tr></tbody></table><h4 id="è½¬åŒ–æ•°æ®"><a href="#è½¬åŒ–æ•°æ®" class="headerlink" title="è½¬åŒ–æ•°æ®"></a>è½¬åŒ–æ•°æ®</h4><p><code>Dataset</code> æ˜¯å¼ºç±»å‹çš„å¯¹è±¡é›†åˆï¼Œè¿™äº›å¯¹è±¡å¯ä»¥ä½¿ç”¨å‡½æ•°å¼æˆ–å…³ç³»å‹çš„ç®—å­å¹¶è¡Œè½¬åŒ–ã€‚å¯ç”¨çš„è½¬åŒ–æ“ä½œåŒ…æ‹¬ <code>map()</code>ã€<code>reduce()</code>ã€<code>filter()</code>ã€<code>select()</code> å’Œ <code>aggregate()</code>ï¼Œè¿™äº›æ–¹æ³•éƒ½å±äºé«˜é˜¶å‡½æ•°ï¼Œä»–ä»¬æ¥å— <code>lambda</code> è¡¨è¾¾å¼ã€é—­åŒ…æˆ–å‡½æ•°ä½œä¸ºå‚æ•°ï¼Œç„¶åè¿”å›ç»“æœï¼Œå› æ­¤è¿™äº›æ“ä½œéå¸¸é€‚åˆå‡½æ•°å¼ç¼–ç¨‹ã€‚</p><p>ä¸è¿‡ä¸Šè¿° <code>Dataset</code> æ˜¯æœ‰ä¸è¶³ä¹‹å¤„çš„ï¼Œåœ¨ä½¿ç”¨é«˜é˜¶å‡½æ•°æ—¶ï¼Œä¼šäº§ç”Ÿä» <code>Spark</code> å†…éƒ¨çš„ <code>Tungsten</code> æ ¼å¼ååºåˆ—åŒ–ä¸º <code>JVM</code> å¯¹è±¡çš„å¼€é”€ï¼Œé‚£ä¹ˆé¿å…å¤šä½™çš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–çš„ç­–ç•¥æœ‰ä»¥ä¸‹ä¸¤ç§ï¼š</p><ul><li>åœ¨æŸ¥è¯¢ä¸­ä½¿ç”¨ <code>DSL</code> è¡¨è¾¾å¼ï¼Œé¿å…è¿‡å¤šåœ°ä½¿ç”¨ <code>lambda</code> è¡¨è¾¾å¼çš„åŒ¿åå‡½æ•°ä½œä¸ºé«˜é˜¶å‡½æ•°çš„å‚æ•°ã€‚</li><li>å°†æŸ¥è¯¢ä¸²è”èµ·æ¥ï¼Œä»¥å°½é‡å‡å°‘åºåˆ—åŒ–å’Œååºåˆ—åŒ–ã€‚</li></ul><h4 id="ç¼–ç å™¨"><a href="#ç¼–ç å™¨" class="headerlink" title="ç¼–ç å™¨"></a>ç¼–ç å™¨</h4><p><strong>ç¼–ç å™¨å°†å †å¤–å†…å­˜ä¸­çš„æ•°æ®ä» <code>Tungsten</code> æ ¼å¼è½¬ä¸º <code>JVM</code> å¯¹è±¡ï¼Œå³ç¼–ç å™¨æ‰¿æ‹…ç€åœ¨ <code>Spark</code> å†…éƒ¨æ ¼å¼å’Œ <code>JVM</code> å¯¹è±¡ä¹‹é—´åºåˆ—åŒ–å’Œååºåˆ—åŒ– <code>Dataset</code> å¯¹è±¡</strong> ã€‚<br><code>Spark</code> æ”¯æŒè‡ªåŠ¨ç”ŸæˆåŸç”Ÿç±»å‹ã€<code>Scala</code> æ ·ä¾‹ç±»å’Œ <code>JavaBean</code> çš„ç¼–ç å™¨ã€‚æ¯”èµ· <code>Java</code> å’Œ <code>Kryo</code> çš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–ï¼Œ<code>Spark</code> çš„ç¼–ç å™¨è¦å¿«å¾ˆå¤šã€‚</p><p><code>Spark</code> ä¸ä¸º <code>Dataset</code> æˆ– <code>DataFrame</code> åˆ›å»ºåŸºäº <code>JVM</code> çš„å¯¹è±¡ï¼Œè€Œä¼šåˆ†é… <code>Java</code> å †å¤–å†…å­˜æ¥å­˜å‚¨æ•°æ®ï¼Œå¹¶ä½¿ç”¨ç¼–ç å™¨å°†å†…å­˜è¡¨ç¤ºçš„æ•°æ®è½¬ä¸º <code>JVM</code> å¯¹è±¡ã€‚<br>å½“æ•°æ®ä»¥ç´§å‡‘çš„æ–¹å¼å­˜å‚¨å¹¶é€šè¿‡æŒ‡é’ˆå’Œåç§»é‡è®¿é—®æ—¶ï¼Œç¼–ç å™¨å¯ä»¥å¿«é€Ÿåºåˆ—åŒ–å’Œååºåˆ—åŒ–æ•°æ®ã€‚</p><p><img src="https://s2.loli.net/2023/04/10/S5PKNrgB8GFZHRd.jpg" alt="hadoop_spark_5.jpg"></p><p>ç›¸æ¯” <code>JVM</code> è‡ªå»ºçš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–ï¼Œ<code>Dataset</code> ç¼–ç å™¨çš„ä¼˜ç‚¹å¦‚ä¸‹ï¼š</p><ul><li><code>Spark</code> å†…éƒ¨çš„ <code>Tungsten</code> äºŒè¿›åˆ¶æ ¼å¼å°†å¯¹è±¡å­˜å‚¨åœ¨ <code>Java</code> çš„å †å†…å­˜ä¹‹å¤–ï¼Œå­˜å‚¨çš„æ–¹å¼å¾ˆç´§å‡‘ï¼Œå› æ­¤å¯¹è±¡å ç”¨çš„ç©ºé—´æ›´å°ã€‚</li><li>é€šè¿‡ä½¿ç”¨æŒ‡é’ˆå’Œè®¡ç®—å‡ºçš„å†…å­˜åœ°å€ä¸åç§»é‡æ¥è®¿é—®å†…å­˜ï¼Œç¼–ç å™¨å¯ä»¥å®ç°å¿«é€Ÿåºåˆ—åŒ–ã€‚</li><li>åœ¨æ¥æ”¶ç«¯ï¼Œç¼–ç å™¨èƒ½å¿«é€Ÿåœ°å°†äºŒè¿›åˆ¶æ ¼å¼ååºåˆ—åŒ–ä¸º <code>Spark</code> å†…éƒ¨çš„è¡¨ç¤ºå½¢å¼ã€‚ç¼–ç å™¨ä¸å— <code>JVM</code> åƒåœ¾å›æ”¶æš‚åœçš„å½±å“ã€‚</li></ul><p><img src="https://s2.loli.net/2023/04/10/a6jyR9tQhSOGAEz.jpg" alt="hadoop_spark_6.jpg"></p><hr><h3 id="Spark-å¼•æ“"><a href="#Spark-å¼•æ“" class="headerlink" title="Spark å¼•æ“"></a><code>Spark</code> å¼•æ“</h3><p>åœ¨ç¼–ç¨‹å±‚é¢ä¸Šï¼Œ<code>Spark SQL</code> å…è®¸å¼€å‘äººå‘˜å¯¹å¸¦æœ‰è¡¨ç»“æ„çš„ç»“æ„åŒ–æ•°æ®å‘èµ·å…¼å®¹ <code>ANSI SQL:2003</code> æ ‡å‡†çš„æŸ¥è¯¢ã€‚è‡³æ­¤ <code>Spark SQL</code>  å·²ç»æ¼”å˜æˆä¸€ä¸ªéå¸¸é‡è¦çš„å¼•æ“ï¼Œè®¸å¤šé«˜å±‚çš„ç»“æ„åŒ–åŠŸèƒ½éƒ½æ˜¯åŸºäºå®ƒæ„å»ºå‡ºæ¥çš„ï¼Œé™¤äº†å¯ä»¥å¯¹æ•°æ®å‘èµ·ç±»ä¼¼ <code>SQL</code> çš„æŸ¥è¯¢ï¼Œ<code>Spark SQL</code> å¼•æ“è¿˜æ”¯æŒä¸‹åˆ—åŠŸèƒ½ï¼š</p><ul><li>ç»Ÿä¸€ <code>Spark</code> çš„å„ä¸ªç»„ä»¶ï¼Œå…è®¸åœ¨ <code>Java</code>ã€<code>Scala</code>ã€<code>Python</code>ã€<code>R</code> ç¨‹åºä¸­å°†ç»“æ„åŒ–æ•°æ®é›†æŠ½è±¡ä¸º <code>DataFrame</code> æˆ– <code>Dataset</code>ï¼Œä»è€Œç®€åŒ–ç¼–ç¨‹å·¥ä½œã€‚</li><li>è¿æ¥ <code>Apache Hive</code> çš„å…ƒæ•°æ®åº“å’Œè¡¨ã€‚</li><li>ä»ç»“æ„åŒ–çš„æ–‡ä»¶æ ¼å¼ï¼ˆ<code>JSON</code>ã€<code>CSV</code>ã€<code>Text</code>ã€<code>Avro</code>ã€<code>Parquet</code>ã€<code>ORC</code> ç­‰ï¼‰ä½¿ç”¨ç»™å®šçš„è¡¨ç»“æ„è¯»å–ç»“æ„åŒ–æ•°æ®ï¼Œå¹¶å°†æ•°æ®è½¬æ¢ä¸ºä¸´æ—¶è¡¨ã€‚</li><li>ä¸ºå¿«é€Ÿçš„æ•°æ®æ¢ç´¢æä¾›äº¤äº’å¼ <code>Spark SQL shell</code>ã€‚</li><li>é€šè¿‡æ ‡å‡†çš„ <code>JDBS/ODBC</code> è¿æ¥å™¨ï¼Œæä¾›ä¸å¤–éƒ¨å·¥å…·äº’ç›¸è¿æ¥çš„çº½å¸¦ã€‚</li><li>ç”Ÿæˆä¼˜åŒ–åçš„æŸ¥è¯¢è®¡åˆ’å’Œç´§å‡‘çš„ <code>JVM</code> äºŒè¿›åˆ¶ä»£ç ï¼Œç”¨äºæœ€ç»ˆæ‰§è¡Œã€‚</li></ul><p><img src="https://s2.loli.net/2023/04/10/yilF4BnUgvVhQTC.jpg" alt="hadoop_spark_7.jpg"></p><p><code>Spark SQL</code> å¼•æ“çš„æ ¸å¿ƒæ˜¯ <strong><code>Catalyst</code> ä¼˜åŒ–å™¨</strong>å’Œ <strong><code>Tungsten</code> é¡¹ç›®</strong> ï¼Œå…¶ä¸¤è€…å…±åŒæ”¯æ’‘é«˜å±‚çš„ <code>DataFrame API</code> å’Œ <code>Dataset API</code>ï¼Œä»¥åŠ <code>SQL</code> æŸ¥è¯¢ã€‚</p><h4 id="Catalyst-ä¼˜åŒ–å™¨"><a href="#Catalyst-ä¼˜åŒ–å™¨" class="headerlink" title="Catalyst ä¼˜åŒ–å™¨"></a><code>Catalyst</code> ä¼˜åŒ–å™¨</h4><p><code>Catalyst</code> ä¼˜åŒ–å™¨æ¥å—è®¡ç®—æŸ¥è¯¢ä½œä¸ºå‚æ•°ï¼Œå¹¶å°†æŸ¥è¯¢è½¬åŒ–ä¸ºæ‰§è¡Œè®¡åˆ’ã€‚å…±åˆ†ä¸ºå››ä¸ªè½¬æ¢é˜¶æ®µï¼š</p><ul><li><strong>è§£æ</strong><br><code>Spark SQL</code> å¼•æ“é¦–å…ˆä¼šä¸º <code>SQL</code> æˆ– <code>DataFrame</code> æŸ¥è¯¢ç”Ÿæˆç›¸åº”çš„æŠ½è±¡è¯­æ³•æ ‘ï¼ˆ<code>abstract synrax tree, AST</code>ï¼‰ã€‚æ‰€æœ‰çš„åˆ—åå’Œè¡¨åéƒ½ä¼šé€šè¿‡æŸ¥è¯¢å†…éƒ¨å…ƒæ•°æ®è€Œè§£æå‡ºæ¥ï¼Œå…¨éƒ¨è§£æå®Œæˆåï¼Œä¼šè¿›å…¥ä¸‹ä¸€é˜¶æ®µã€‚</li><li><strong>é€»è¾‘ä¼˜åŒ–</strong><br>è¿™ä¸ªé˜¶æ®µåœ¨å†…éƒ¨å…±åˆ†ä¸ºä¸¤æ­¥ã€‚é€šè¿‡åº”ç”¨åŸºäºè§„åˆ™çš„ä¼˜åŒ–ç­–ç•¥ï¼Œ<code>Catalyst</code> ä¼˜åŒ–å™¨ä¼šé¦–å…ˆæ„å»ºå‡ºå¤šä¸ªè®¡åˆ’ï¼Œç„¶åä½¿ç”¨åŸºäºä»£ä»·çš„ä¼˜åŒ–å™¨ï¼ˆ<code>cost-based optimizer, CBO</code>ï¼‰ä¸ºæ¯ä¸ªè®¡åˆ’è®¡ç®—å‡ºæ‰§è¡Œå¼€é”€ã€‚è¿™äº›è®¡åˆ’ä»¥ç®—å­æ ‘çš„å½¢å¼å‘ˆç°ï¼Œå…¶ä¼˜åŒ–è¿‡ç¨‹åŒ…æ‹¬å¸¸é‡æŠ˜å ã€è°“è¯ä¸‹æ¨ã€åˆ—è£å‰ªã€å¸ƒå°”è¡¨è¾¾å¼ç®€åŒ–ç­‰ï¼Œæœ€ç»ˆè·å¾—çš„é€»è¾‘è®¡åˆ’ä½œä¸ºä¸‹ä¸€é˜¶æ®µçš„è¾“å…¥ï¼Œç”¨äºç”Ÿæˆç‰©ç†è®¡åˆ’ã€‚</li><li><strong>ç”Ÿæˆç‰©ç†è®¡åˆ’</strong>hexo<br><code>Spark SQL</code> ä¼šä¸ºé€‰ä¸­çš„é€»è¾‘è®¡åˆ’ç”Ÿæˆæœ€ä½³çš„ç‰©ç†è®¡åˆ’ï¼Œè¿™ä¸ªç‰©ç†è®¡åˆ’ç”± <code>Spark</code> æ‰§è¡Œå¼•æ“å¯ç”¨çš„ç‰©ç†ç®—å­ç»„æˆã€‚</li><li><strong>ç”ŸæˆäºŒè¿›åˆ¶ä»£ç </strong><br>åœ¨æŸ¥è¯¢ä¼˜åŒ–çš„æœ€ç»ˆé˜¶æ®µï¼Œ<code>Spark</code> ä¼šæœ€ç»ˆç”Ÿæˆé«˜æ•ˆçš„ <code>Java</code> å­—èŠ‚ç ï¼Œç”¨äºåœ¨å„ä¸ªæœºå™¨ä¸Šæ‰§è¡Œã€‚è€Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ç”¨åˆ°äº† <code>Tungsten</code> é¡¹ç›®ï¼Œå®ç°äº†æ‰§è¡Œè®¡åˆ’çš„å…¨å±€ä»£ç ç”Ÿæˆã€‚<br>é‚£ä»€ä¹ˆæ˜¯å…¨å±€ä»£ç ç”Ÿæˆå‘¢ï¼Ÿä»–æ˜¯ç‰©ç†è®¡åˆ’çš„ä¸€ä¸ªä¼˜åŒ–é˜¶æ®µï¼Œå°†æ•´ä¸ªæŸ¥è¯¢åˆå¹¶ä¸ºä¸€ä¸ªå‡½æ•°ï¼Œé¿å…è™šå‡½æ•°è°ƒç”¨ï¼Œåˆ©ç”¨ <code>CPU</code> å¯„å­˜å™¨å­˜æ”¾ä¸­é—´æ•°æ®ï¼Œè€Œè¿™ç§é«˜æ•ˆç­–ç•¥å¯ä»¥æ˜¾è‘—æå‡ <code>CPU</code> æ•ˆç‡å’Œæ€§èƒ½ã€‚</li></ul><p><img src="https://s2.loli.net/2023/04/10/uevImbGLT7N9rJK.jpg" alt="hadoop_spark_8.jpg"></p><p>é€šè¿‡ä¸Šé¢çš„å›¾ç¤ºï¼Œå¯ä»¥å‘ç°åªè¦æ‰§è¡Œè¿‡ç¨‹ç›¸åŒï¼Œæœ€ç»ˆä¼šç”Ÿæˆç›¸ä¼¼çš„æŸ¥è¯¢è®¡åˆ’å’Œä¸€æ ·çš„å­—èŠ‚ç ç”¨äºæ‰§è¡Œï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæ— è®ºä½¿ç”¨ä»€ä¹ˆç¼–ç¨‹è¯­è¨€ï¼ŒæŸ¥è¯¢éƒ½ä¼šç»è¿‡åŒæ ·çš„è¿‡ç¨‹ï¼Œæ‰€ç”Ÿæˆçš„å­—èŠ‚ç å¾ˆæœ‰å¯èƒ½éƒ½æ˜¯ä¸€æ ·çš„ã€‚</p><p>åœ¨ç»è¿‡æœ€åˆçš„è§£æé˜¶æ®µä¹‹åï¼ŒæŸ¥è¯¢è®¡åˆ’ä¼šè¢« <code>Catalyst</code> ä¼˜åŒ–å™¨è½¬åŒ–å’Œé‡æ’ã€‚</p><p><img src="https://s2.loli.net/2023/04/10/cUXY3alpo6qZmrn.jpg" alt="hadoop_spark_9.jpg"></p><h4 id="Tungsten-é¡¹ç›®"><a href="#Tungsten-é¡¹ç›®" class="headerlink" title="Tungsten é¡¹ç›®"></a><code>Tungsten</code> é¡¹ç›®</h4><p><code>Tungsten</code> é¡¹ç›®è‡´åŠ›äºæå‡ <code>Spark</code> åº”ç”¨å¯¹å†…å­˜å’Œ <code>CPU</code> çš„åˆ©ç”¨ç‡ï¼Œä½¿æ€§èƒ½è¾¾åˆ°ç¡¬ä»¶çš„æé™ï¼Œä¸»è¦åŒ…å«ä»¥ä¸‹å†…å®¹ï¼š</p><ul><li><code>Memory Management and Binary Processing</code>: <code>off-heap</code> ç®¡ç†å†…å­˜ï¼Œé™ä½å¯¹è±¡çš„å¼€é”€å’Œæ¶ˆé™¤ <code>JVM GC</code> å¸¦æ¥çš„å»¶æ—¶ã€‚</li><li><code>Cache-aware computation</code>: ä¼˜åŒ–å­˜å‚¨ï¼Œæå‡ <code>CPU L1/L2/L3</code> ç¼“å­˜å‘½ä¸­ç‡ã€‚</li><li><code>Code generation</code>: ä¼˜åŒ– <code>Spark SQL</code> çš„ä»£ç ç”Ÿæˆéƒ¨åˆ†ï¼Œæå‡ <code>CPU</code> åˆ©ç”¨ç‡ã€‚</li></ul><hr><h3 id="å¼•ç”¨"><a href="#å¼•ç”¨" class="headerlink" title="å¼•ç”¨"></a>å¼•ç”¨</h3><hr><h3 id="ä¸ªäººå¤‡æ³¨"><a href="#ä¸ªäººå¤‡æ³¨" class="headerlink" title="ä¸ªäººå¤‡æ³¨"></a>ä¸ªäººå¤‡æ³¨</h3><p><strong>æ­¤åšå®¢å†…å®¹å‡ä¸ºä½œè€…å­¦ä¹ æ‰€åšç¬”è®°ï¼Œä¾µåˆ ï¼</strong><br><strong>è‹¥è½¬ä½œå…¶ä»–ç”¨é€”ï¼Œè¯·æ³¨æ˜æ¥æºï¼</strong></p>]]></content>
    
    
    <summary type="html">&lt;h3 id=&quot;å¼•å…¥&quot;&gt;&lt;a href=&quot;#å¼•å…¥&quot; class=&quot;headerlink&quot; title=&quot;å¼•å…¥&quot;&gt;&lt;/a&gt;å¼•å…¥&lt;/h3&gt;&lt;p&gt;&lt;code&gt;Spark&lt;/code&gt; æ˜¯ç”¨äº&lt;strong&gt;å¤„ç†å¤§æ•°æ®çš„é›†ç¾¤è®¡ç®—æ¡†æ¶&lt;/strong&gt; ï¼Œä¸å…¶ä»–å¤§å¤šæ•°æ•°æ®å¤„ç†æ¡†æ¶ä¸åŒä¹‹å¤„åœ¨äº &lt;code&gt;Spark&lt;/code&gt; æ²¡æœ‰ä»¥ &lt;code&gt;MapReduce&lt;/code&gt; ä½œä¸ºæ‰§è¡Œå¼•æ“ï¼Œè€Œæ˜¯ä½¿ç”¨å®ƒè‡ªå·±çš„&lt;strong&gt;åˆ†å¸ƒå¼è¿è¡Œç¯å¢ƒ&lt;/strong&gt;åœ¨é›†ç¾¤ä¸Šæ‰§è¡Œå·¥ä½œã€‚å¦å¤– &lt;code&gt;Spark&lt;/code&gt; ä¸ &lt;code&gt;Hadoop&lt;/code&gt; åˆç´§å¯†é›†æˆï¼Œ&lt;code&gt;Spark&lt;/code&gt; å¯ä»¥åœ¨ &lt;code&gt;YARN&lt;/code&gt; ä¸Šè¿è¡Œï¼Œå¹¶æ”¯æŒ &lt;code&gt;Hadoop&lt;/code&gt; æ–‡ä»¶æ ¼å¼åŠå…¶å­˜å‚¨åç«¯ï¼ˆä¾‹å¦‚ &lt;code&gt;HDFS&lt;/code&gt;ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;Spark&lt;/code&gt; æœ€çªå‡ºçš„è¡¨ç°åœ¨äºå…¶èƒ½å°† &lt;strong&gt;ä½œä¸šä¸ä½œä¸šä¹‹é—´çš„å¤§è§„æ¨¡çš„å·¥ä½œæ•°æ®é›†å­˜å‚¨åœ¨å†…å­˜ä¸­&lt;/strong&gt;ã€‚è¿™ç§èƒ½åŠ›ä½¿å¾—åœ¨æ€§èƒ½ä¸Šè¿œè¶… &lt;code&gt;MapReduce&lt;/code&gt; å¥½å‡ ä¸ªæ•°é‡çº§ï¼ŒåŸå› å°±åœ¨äº &lt;code&gt;MapReduce&lt;/code&gt; æ•°æ®éƒ½æ˜¯ä»ç£ç›˜ä¸ŠåŠ è½½ã€‚æ ¹æ® &lt;code&gt;Spark&lt;/code&gt; çš„å¤„ç†æ¨¡å‹æœ‰ä¸¤ç±»åº”ç”¨è·ç›Šæœ€å¤§ï¼Œåˆ†åˆ«æ˜¯ &lt;strong&gt;è¿­ä»£ç®—æ³•ï¼ˆå³å¯¹ä¸€ä¸ªæ•°æ®é›†é‡å¤åº”ç”¨æŸä¸ªå‡½æ•°ï¼Œç›´è‡³æ»¡è¶³é€€å‡ºæ¡ä»¶ï¼‰&lt;/strong&gt;å’Œ &lt;strong&gt;äº¤äº’å¼åˆ†æï¼ˆç”¨æˆ·å‘æ•°æ®é›†å‘å‡ºä¸€ç³»åˆ—ä¸“ç”¨çš„æ¢ç´¢æ€§æŸ¥è¯¢ï¼‰&lt;/strong&gt; ã€‚&lt;br&gt;å¦å¤– &lt;code&gt;Spark&lt;/code&gt; è¿˜å› ä¸ºå…¶å…·æœ‰çš„ &lt;strong&gt;&lt;code&gt;DAG&lt;/code&gt; å¼•æ“&lt;/strong&gt;æ›´å…·å¸å¼•åŠ›ï¼ŒåŸå› åœ¨äº &lt;code&gt;DAG&lt;/code&gt; å¼•æ“å¯ä»¥å¤„ç†ä»»æ„æ“ä½œæµæ°´çº¿ï¼Œå¹¶ä¸ºç”¨æˆ·å°†å…¶è½¬åŒ–ä¸ºå•ä¸ªä»»åŠ¡ã€‚&lt;/p&gt;</summary>
    
    
    
    
    <category term="Hadoop" scheme="https://blog.vgbhfive.cn/tags/Hadoop/"/>
    
  </entry>
  
  <entry>
    <title>MySQL-mysqldump warning GTID</title>
    <link href="https://blog.vgbhfive.cn/MySQL-mysqldump-warning-GTID/"/>
    <id>https://blog.vgbhfive.cn/MySQL-mysqldump-warning-GTID/</id>
    <published>2023-02-23T15:44:40.000Z</published>
    <updated>2023-02-23T16:09:54.000Z</updated>
    
    <content type="html"><![CDATA[<h3 id="å¤ç°"><a href="#å¤ç°" class="headerlink" title="å¤ç°"></a>å¤ç°</h3><p>å·¥ä½œæ—¶éœ€è¦æ‹‰ä¸€ä¸‹æµ‹è¯•ç¯å¢ƒçš„æ•°æ®åˆ°å¼€å‘ç¯å¢ƒï¼Œæ‰€ä»¥å°±æ˜¯ <code>mysqldump</code> è€å“¥å‡ºåœºäº†â€¦</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># mysqldump -h localhost -u root -p --tables test_table --where=&quot;str=&#x27;str1&#x27;&quot; &gt; test_table_data.sql</span><br><span class="line">Enter password:</span><br><span class="line">Warning: A partial dump from a server that has GTIDs will by default include the GTIDs of all transactions, even those that changed suppressed parts of the database. If you don&#x27;t want to restore GTIDs, pass --set-gtid-purged=OFF. To make a complete dump, pass --all-databases --triggers --routines --events.</span><br></pre></td></tr></table></figure><span id="more"></span><p>ä¸Šé¢çš„è­¦å‘Šå†…å®¹ç¿»è¯‘å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">é»˜è®¤æƒ…å†µä¸‹ï¼Œæ¥è‡ªå…·æœ‰ GTID çš„æœåŠ¡å™¨çš„éƒ¨åˆ†è½¬å‚¨å°†åŒ…æ‹¬æ‰€æœ‰äº‹åŠ¡çš„ GTIDï¼Œå³ä½¿æ˜¯é‚£äº›æ›´æ”¹äº†æ•°æ®åº“è¢«æŠ‘åˆ¶éƒ¨åˆ†çš„äº‹åŠ¡ã€‚å¦‚æœä¸æƒ³æ¢å¤ gtidï¼Œè¯·ä½¿ç”¨ --set-gtid-purged=OFF å‚æ•°ã€‚</span><br><span class="line">å¦‚æœè¦è¿›è¡Œå®Œæ•´çš„è½¬å‚¨ï¼Œè¯·ä½¿ç”¨å‚æ•° --all-databases --triggers --routines --events</span><br></pre></td></tr></table></figure><p>å¾—çŸ¥è­¦å‘ŠåŸå› ä¹‹åï¼Œå°±ä¼šæƒ³åˆ° <code>GTID</code> æ˜¯ç”¨æ¥ä¿è¯äº‹åŠ¡å…¨å±€å”¯ä¸€çš„é…ç½®ä¿¡æ¯ï¼Œå¦å¤–å‘ç°æ•°æ®å·²ç»å®Œæ•´è½¬å‚¨å‡ºæ¥ï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥è¿™ä¸ª <code>GTID</code> æ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿ</p><hr><h3 id="GTID"><a href="#GTID" class="headerlink" title="GTID"></a><code>GTID</code></h3><p><code>GTID (Global Transaction IDentifier) </code>æ˜¯å…¨å±€äº‹åŠ¡æ ‡è¯†ï¼Œå…¶å…·æœ‰å…¨å±€å”¯ä¸€æ€§ï¼Œä¸€ä¸ªäº‹åŠ¡å¯¹åº”ä¸€ä¸ª <code>GTID</code>ã€‚<br>ç”±äºå…¶å”¯ä¸€æ€§ä¸ä»…é™äºä¸»æœåŠ¡å™¨ï¼Œ<code>GTID</code> åœ¨æ‰€æœ‰çš„ä»æœåŠ¡å™¨ä¸Šä¹Ÿæ˜¯å”¯ä¸€çš„ï¼›ä¸€ä¸ª <code>GTID</code> åœ¨ä¸€ä¸ªæœåŠ¡å™¨ä¸Šåªæ‰§è¡Œä¸€æ¬¡ï¼Œä»è€Œé¿å…é‡å¤æ‰§è¡Œå¯¼è‡´æ•°æ®æ··ä¹±æˆ–ä¸»ä»ä¸ä¸€è‡´ã€‚</p><p>åœ¨ä¼ ç»Ÿçš„å¤åˆ¶é‡Œé¢ï¼Œå½“å‘ç”Ÿæ•…éšœéœ€è¦ä¸»ä»åˆ‡æ¢æ—¶ï¼ŒæœåŠ¡å™¨éœ€è¦æ‰¾åˆ° <code>binlog</code> å’Œ <code>pos</code> ç‚¹ï¼Œç„¶åå°†å…¶è®¾å®šä¸ºæ–°çš„ä¸»èŠ‚ç‚¹å¼€å¯å¤åˆ¶ã€‚ç›¸å¯¹æ¥è¯´æ¯”è¾ƒéº»çƒ¦ä¹Ÿå®¹æ˜“å‡ºé”™ï¼Œå› æ­¤åœ¨ <code>MySQL 5.6</code> ç‰ˆæœ¬é‡Œä¼šé€šè¿‡å†…éƒ¨æœºåˆ¶è‡ªåŠ¨åŒ¹é… <code>GTID</code> æ–­ç‚¹ï¼Œä¸å†å¯»æ‰¾ <code>binlog</code> å’Œ <code>pos</code> ç‚¹ï¼Œæ­¤æ—¶åªéœ€è¦çŸ¥é“ä¸»èŠ‚ç‚¹çš„ <code>IP</code>ã€ç«¯å£ã€ä»¥åŠè´¦å·å¯†ç å°±å¯ä»¥è‡ªåŠ¨å¤åˆ¶ã€‚</p><h4 id="äº§ç”Ÿ"><a href="#äº§ç”Ÿ" class="headerlink" title="äº§ç”Ÿ"></a>äº§ç”Ÿ</h4><p><code>GTID</code> çš„ç”Ÿæˆå— <strong><code>GTID_NEXT</code></strong> æ§åˆ¶ã€‚</p><p>åœ¨ä¸»æœåŠ¡å™¨ä¸Š <strong><code>GTID_NEXT</code> é»˜è®¤å€¼æ˜¯ <code>AUTOMATIC</code></strong> ï¼Œå³åœ¨æ¯æ¬¡äº‹åŠ¡æäº¤æ—¶è‡ªåŠ¨ç”Ÿæˆ <code>GTID</code>ï¼Œå¹¶ä¸”å®ƒä¼šä»å½“å‰å·²æ‰§è¡Œçš„ <code>GTID</code> é›†åˆï¼ˆå³<code>gtid_executed</code>ï¼‰ä¸­æ‰¾ä¸€ä¸ªå¤§äº <strong><code>0</code></strong> çš„æœªä½¿ç”¨çš„æœ€å°å€¼ä½œä¸ºä¸‹ä¸ªäº‹åŠ¡ <code>GTID</code>ã€‚è€Œç°å®ä¸­åœ¨å®é™…çš„æ›´æ–°äº‹åŠ¡è®°å½•ä¹‹å‰ï¼Œä¼šå°† <code>GTID</code> å†™å…¥åˆ° <code>binlog</code>ï¼ˆ<code>set GTID_NEXT</code> è®°å½•ï¼‰ã€‚<br>åœ¨ä»æœåŠ¡å™¨ä¸Šï¼Œé¦–å…ˆä» <code>binlog</code> å…ˆè¯»å–åˆ°ä¸»åº“çš„ <code>GTID</code>ï¼ˆ<code>get GTID_NEXT</code>è®°å½•ï¼‰ï¼Œç„¶åæ‰§è¡Œäº‹åŠ¡æ—¶ä½¿ç”¨è¯¥ <code>GTID</code>ã€‚</p><p>äº§ç”Ÿæ­¥éª¤ï¼š</p><ul><li>ä¸»æœåŠ¡å™¨æ›´æ–°æ•°æ®æ—¶ï¼Œä¼šåœ¨äº‹åŠ¡å‰äº§ç”Ÿ <code>GTID</code>ï¼Œä¸€åŒè®°å½•åˆ° <code>binlog</code> æ—¥å¿—ä¸­ã€‚</li><li><code>binlog</code> ä¼ é€åˆ°ä»æœåŠ¡å™¨åï¼Œè¢«å†™å…¥åˆ°æœ¬åœ°çš„ <code>relay log</code> ä¸­ï¼Œæ¥ç€ä»æœåŠ¡å™¨è¯»å– <code>GTID</code>ï¼Œå¹¶å°†å…¶è®¾å®šä¸ºè‡ªå·±çš„ <code>GTID</code>ã€‚</li><li>ä»æœåŠ¡å™¨çš„ <code>SQL</code> çº¿ç¨‹ä» <code>relay log</code> ä¸­è·å– <code>GTID</code>ï¼Œç„¶åå¯¹æ¯”ä»æœåŠ¡å™¨ç«¯çš„ <code>binlog</code> ä¸­æ˜¯å¦æœ‰è®°å½•ã€‚</li><li>å¦‚æœæœ‰è®°å½•ï¼Œè¯´æ˜è¯¥ <code>GTID</code> çš„äº‹åŠ¡å·²ç»æ‰§è¡Œï¼Œä»æœåŠ¡å™¨ä¼šå¿½ç•¥ã€‚</li><li>å¦‚æœæ²¡æœ‰è®°å½•ï¼Œä»æœåŠ¡å™¨å°±ä¼šä» <code>relay log</code> ä¸­æ‰§è¡Œè¯¥ <code>GTID</code> çš„äº‹åŠ¡ï¼Œå¹¶è®°å½•åˆ° <code>binlog</code>ã€‚</li></ul><h4 id="ç»„æˆ"><a href="#ç»„æˆ" class="headerlink" title="ç»„æˆ"></a>ç»„æˆ</h4><p><code>GDIT</code> ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼š <strong><code>source_id</code></strong> å’Œ <strong><code>transaction_id</code></strong> ã€‚<br><strong><code>source_id</code></strong> æ˜¯äº§ç”Ÿ <code>GTID</code> çš„æœåŠ¡å™¨ï¼Œå³ <code>server_uuid</code>ï¼Œåœ¨ç¬¬ä¸€æ¬¡å¯åŠ¨æ—¶ç”Ÿæˆï¼ˆ<code>sql/mysqld.cc: generate_server_uuid()</code>ï¼‰å¹¶ä¿å­˜åˆ° <code>DATADIR/auto.cnf</code> æ–‡ä»¶é‡Œã€‚<br><strong><code>transaction_id</code></strong> æ˜¯åºåˆ—å·ï¼ˆ<code>sequence number</code>ï¼‰ï¼Œåœ¨æ¯å° <code>MySQL</code> æœåŠ¡å™¨ä¸Šéƒ½æ˜¯ä» <code>1</code> å¼€å§‹è‡ªå¢é•¿çš„é¡ºåºå·ï¼Œæ˜¯äº‹åŠ¡çš„å”¯ä¸€æ ‡è¯†ã€‚</p><hr><h3 id="å¼•ç”¨"><a href="#å¼•ç”¨" class="headerlink" title="å¼•ç”¨"></a>å¼•ç”¨</h3><p><a href="http://mysql.taobao.org/monthly/2020/05/09/">http://mysql.taobao.org/monthly/2020/05/09/</a></p><hr><h3 id="ä¸ªäººå¤‡æ³¨"><a href="#ä¸ªäººå¤‡æ³¨" class="headerlink" title="ä¸ªäººå¤‡æ³¨"></a>ä¸ªäººå¤‡æ³¨</h3><p><strong>æ­¤åšå®¢å†…å®¹å‡ä¸ºä½œè€…å­¦ä¹ æ‰€åšç¬”è®°ï¼Œä¾µåˆ ï¼</strong><br><strong>è‹¥è½¬ä½œå…¶ä»–ç”¨é€”ï¼Œè¯·æ³¨æ˜æ¥æºï¼</strong></p>]]></content>
    
    
    <summary type="html">&lt;h3 id=&quot;å¤ç°&quot;&gt;&lt;a href=&quot;#å¤ç°&quot; class=&quot;headerlink&quot; title=&quot;å¤ç°&quot;&gt;&lt;/a&gt;å¤ç°&lt;/h3&gt;&lt;p&gt;å·¥ä½œæ—¶éœ€è¦æ‹‰ä¸€ä¸‹æµ‹è¯•ç¯å¢ƒçš„æ•°æ®åˆ°å¼€å‘ç¯å¢ƒï¼Œæ‰€ä»¥å°±æ˜¯ &lt;code&gt;mysqldump&lt;/code&gt; è€å“¥å‡ºåœºäº†â€¦&lt;/p&gt;
&lt;figure class=&quot;highlight plaintext&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;# mysqldump -h localhost -u root -p --tables test_table --where=&amp;quot;str=&amp;#x27;str1&amp;#x27;&amp;quot; &amp;gt; test_table_data.sql&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Enter password:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Warning: A partial dump from a server that has GTIDs will by default include the GTIDs of all transactions, even those that changed suppressed parts of the database. If you don&amp;#x27;t want to restore GTIDs, pass --set-gtid-purged=OFF. To make a complete dump, pass --all-databases --triggers --routines --events.&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;</summary>
    
    
    
    
    <category term="MySQL" scheme="https://blog.vgbhfive.cn/tags/MySQL/"/>
    
    <category term="Day" scheme="https://blog.vgbhfive.cn/tags/Day/"/>
    
  </entry>
  
  <entry>
    <title>Hadoop-MapReduce</title>
    <link href="https://blog.vgbhfive.cn/Hadoop-MapReduce/"/>
    <id>https://blog.vgbhfive.cn/Hadoop-MapReduce/</id>
    <published>2023-02-14T16:13:22.000Z</published>
    <updated>2023-03-11T15:10:44.000Z</updated>
    
    <content type="html"><![CDATA[<h3 id="åŸºç¡€"><a href="#åŸºç¡€" class="headerlink" title="åŸºç¡€"></a>åŸºç¡€</h3><p><code>MapReduce</code> æ˜¯ä¸€ç§ç”¨äº<strong>æ•°æ®å¤„ç†çš„ç¼–ç¨‹æ¨¡å‹</strong>ï¼Œå…¶æœ¬è´¨æ˜¯<strong>å¹¶è¡Œè¿è¡Œ</strong>ï¼Œå› æ­¤å¯ä»¥å°†å¤§è§„æ¨¡çš„æ•°æ®åˆ†æä»»åŠ¡åˆ†å‘ç»™ä»»ä½•ä¸€ä¸ªæ‹¥æœ‰è¶³å¤Ÿå¤šæœºå™¨çš„æ•°æ®ä¸­å¿ƒï¼Œå½“ç„¶å…¶ä¼˜åŠ¿ä¹Ÿæ˜¯<strong>å¤„ç†å¤§è§„æ¨¡æ•°æ®é›†</strong>ã€‚</p><p><code>MapReduce</code> ä»»åŠ¡è¿‡ç¨‹åˆ†ä¸ºä¸¤ä¸ªå¤„ç†é˜¶æ®µï¼š <strong><code>map</code> é˜¶æ®µ</strong>å’Œ <strong><code>reduce</code> é˜¶æ®µ</strong>ã€‚æ¯ä¸ªé˜¶æ®µéƒ½æ˜¯ä»¥<strong>é”®å€¼å¯¹</strong>ä½œä¸ºè¾“å…¥å’Œè¾“å‡ºï¼Œå…¶ç±»å‹ç”±å¼€å‘è€…å†³å®šï¼Œå½“ç„¶ <code>map</code> å‡½æ•°å’Œ <code>reduce</code> å‡½æ•°ä¹Ÿæ˜¯ç”±å¼€å‘è€…å®ç°ã€‚</p><span id="more"></span> <h4 id="MapReduce-åŸç†"><a href="#MapReduce-åŸç†" class="headerlink" title="MapReduce åŸç†"></a><code>MapReduce</code> åŸç†</h4><p><code>MapReduce</code> <strong>ä½œä¸šï¼ˆ<code>job</code>ï¼‰</strong>æ˜¯å®¢æˆ·ç«¯æ‰§è¡Œå·¥ä½œçš„å•å…ƒï¼ŒåŒ…å«ï¼š<strong>è¾“å…¥æ•°æ®</strong>ã€ <strong><code>MapReduce</code> ç¨‹åº</strong>å’Œ<strong>é…ç½®ä¿¡æ¯</strong>ã€‚<code>Hadoop</code> å°†ä½œä¸šåˆ†æˆè‹¥å¹²ä¸ª<strong>ä»»åŠ¡ï¼ˆ<code>task</code>ï¼‰</strong>æ¥æ‰§è¡Œï¼Œå…¶ä¸­åŒ…å«ä¸¤ç±»ä»»åŠ¡ï¼š <strong><code>map</code> ä»»åŠ¡</strong>å’Œ <strong><code>reduce</code> ä»»åŠ¡</strong>ï¼Œè¿™äº›ä»»åŠ¡è¿è¡Œåœ¨é›†ç¾¤çš„èŠ‚ç‚¹ä¸Šï¼Œå¹¶é€šè¿‡ <strong><code>YARN</code></strong> è¿›è¡Œè°ƒåº¦ï¼Œå…¶ä¸­å¦‚æœæœ‰ä¸€ä¸ªä»»åŠ¡å¤±è´¥ï¼Œåˆ™å°†åœ¨å¦ä¸€ä¸ªä¸åŒçš„èŠ‚ç‚¹ä¸Šé‡æ–°è°ƒåº¦è¿è¡Œã€‚</p><p><code>MapReduce</code> çš„è¾“å…¥æ•°æ®ä¼šè¢«åˆ’åˆ†ä¸ºç­‰é•¿çš„å°æ•°æ®å—ï¼Œç§°ä¸º<strong>è¾“å…¥åˆ†ç‰‡ï¼ˆ<code>input split</code>ï¼‰</strong>æˆ–è€…ç®€ç§°<strong>åˆ†ç‰‡</strong>ï¼Œè€Œæ¯ä¸€ä¸ªåˆ†ç‰‡ä¼šæ„å»ºä¸€ä¸ª <code>map</code> ä»»åŠ¡ï¼Œå¹¶ç”±è¯¥ä»»åŠ¡æ¥è¿è¡Œç”¨æˆ·è‡ªå®šä¹‰çš„ <code>map</code> å‡½æ•°ä»è€Œå¤„ç†åˆ†ç‰‡ä¸­çš„æ¯æ¡è®°å½•ã€‚<br><small>æœ‰è®¸å¤šåˆ†ç‰‡å°±æ„å‘³ç€æ¯ä¸ªåˆ†ç‰‡å¤„ç†æ‰€éœ€æ—¶é—´å°‘äºæ•´ä¸ªè¾“å…¥æ•°æ®æ‰€éœ€æ—¶é—´ï¼›å¦å¤–å¦‚æœåˆ†ç‰‡åˆ‡åˆ†å¾—å¤ªå°ï¼Œé‚£ç®¡ç†åˆ†ç‰‡å¾—äº‹ä»¶å’Œæ„å»º <code>map</code> ä»»åŠ¡çš„äº‹ä»¶å°†ç»„æˆä½œä¸šçš„æ•´ä½“è¿è¡Œäº‹ä»¶ã€‚</small><br><small>å¦‚æœ <code>map</code> ä»»åŠ¡è¿è¡Œåœ¨å­˜å‚¨æœ‰è¾“å…¥æ•°æ®ï¼ˆ<code>HDFS</code> ä¸­çš„æ•°æ®ï¼‰çš„èŠ‚ç‚¹ä¸Šï¼Œæ— éœ€ä½¿ç”¨å¸¦å®½èµ„æºå³å¯è·å¾—æœ€ä½³æ€§èƒ½ï¼Œä¹Ÿå°±æ˜¯<strong>æ•°æ®æœ¬åœ°åŒ–ä¼˜åŒ–ï¼ˆ<code>data locality optimization</code>ï¼‰</strong> ã€‚</small></p><p><code>map</code> ä»»åŠ¡å°†å…¶è¾“å‡ºå†™å…¥æœ¬åœ°ç£ç›˜ï¼ˆæ­¤è¾“å‡ºä¸º<strong>ä¸­é—´ç»“æœ</strong>ï¼‰ï¼Œè¯¥ä¸­é—´ç»“æœç”± <code>reduce</code> ä»»åŠ¡å¤„ç†åæ‰ä¼šäº§ç”Ÿæœ€ç»ˆè¾“å‡ºç»“æœï¼Œéšç€ä½œä¸šå®Œæˆï¼Œ<code>map</code> çš„ç»“æœä¹Ÿä¼šè¢«éšä¹‹åˆ é™¤ã€‚</p><p><code>reduce</code> ä»»åŠ¡çš„è¾“å…¥é€šå¸¸æ¥è‡ªäºæ‰€æœ‰ <code>map</code> ä»»åŠ¡çš„è¾“å‡ºï¼Œå…¶å¹¶ä¸å…·å¤‡æ•°æ®æœ¬åœ°åŒ–çš„ä¼˜åŠ¿ï¼Œä¸” <code>reduce</code> ä»»åŠ¡çš„æ•°é‡æ˜¯<strong>ç‹¬ç«‹æŒ‡å®š</strong>çš„ä¸ç”±è¾“å…¥æ•°æ®çš„å¤§å°å†³å®šã€‚å¦‚æœå­˜åœ¨å¤šä¸ª <code>reduce</code> ä»»åŠ¡ï¼Œé‚£æ¯ä¸ª <code>map</code> ä»»åŠ¡å°±ä¼šé’ˆå¯¹è¾“å‡ºè¿›è¡Œåˆ†åŒºï¼Œå³ä¸ºæ¯ä¸ª <code>reduce</code> ä»»åŠ¡åˆ›å»ºä¸€ä¸ªåˆ†åŒºï¼Œæ¯ä¸ªåˆ†åŒºéƒ½æœ‰è®¸å¤šé”®åŠå…¶å¯¹åº”çš„å€¼ï¼Œä½†æ˜¯æ¯ä¸ªé”®å¯¹åº”çš„é”®å€¼å¯¹è®°å½•éƒ½åœ¨åŒä¸€åˆ†åŒºä¸­ã€‚<br><small>åˆ†åŒºå¯ä»¥ç”±ç”¨æˆ·å®šä¹‰çš„åˆ†åŒºå‡½æ•°æ§åˆ¶ï¼Œä½†é€šå¸¸é‡‡ç”¨é»˜è®¤çš„ <code>partitioner</code> é€šè¿‡å“ˆå¸Œå‡½æ•°æ¥åŒºåˆ†ã€‚</small></p><p><code>map</code> ä»»åŠ¡å’Œ <code>reduce</code> ä»»åŠ¡ä¹‹é—´çš„æ’åºå’Œåˆ†ç»„ï¼Œè¯¥éƒ¨åˆ†ä¹Ÿè¢«ç§°ä¸º <strong><code>shuffle</code> ï¼ˆæ··æ´—ï¼‰</strong> ï¼Œæ¯ä¸ª <code>reduce</code> ä»»åŠ¡çš„è¾“å…¥éƒ½æ¥è‡ªäºæ‰€æœ‰ <code>map</code> ä»»åŠ¡çš„è¾“å‡ºï¼Œå¦å¤– <code>shuffle</code> ä¸€èˆ¬æ¯”å›¾ä¸­çš„æ›´åŠ å¤æ‚ï¼Œè€Œä¸”è°ƒæ•´æ··æ´—å‚æ•°å¯¹ä½œä¸šæ€»æ‰§è¡Œæ—¶é—´çš„å½±å“éå¸¸å¤§ã€‚<br><small>å½“æ•°æ®å®Œå…¨å¹¶è¡Œæ—¶ï¼ˆå³æ— éœ€æ··æ´—ï¼‰å¯èƒ½ä¼šå‡ºç°æ—  <code>reduce</code> ä»»åŠ¡çš„æƒ…å†µã€‚</small></p><p>æ€»ç»“ <code>map</code> é˜¶æ®µçš„è¾“å…¥æ˜¯ <code>NCDC</code> åŸå§‹æ•°æ®ï¼Œé”®æ˜¯æŸä¸€è¡Œèµ·å§‹ä½ç½®ç›¸å¯¹äºæ–‡ä»¶èµ·å§‹ä½ç½®çš„åç§»é‡ï¼Œè€Œå€¼æ˜¯æ–‡æœ¬æ–‡ä»¶çš„æ¯ä¸€è¡Œï¼›<code>reduce</code> é˜¶æ®µçš„è¾“å…¥åˆ™æ˜¯å°† <code>map</code> é˜¶æ®µçš„è¾“å‡ºç»“æœç»ç”± <code>shuffle</code> æ’åºå’Œåˆ†ç»„ä¹‹åçš„æ•°æ®ã€‚</p><h4 id="combiner-å‡½æ•°"><a href="#combiner-å‡½æ•°" class="headerlink" title="combiner å‡½æ•°"></a><code>combiner</code> å‡½æ•°</h4><p>é›†ç¾¤ä¸Šå¯ç”¨çš„å¸¦å®½é™åˆ¶äº† <code>MapReduce</code> ä½œä¸šçš„æ•°é‡ï¼Œå› æ­¤å°½é‡é¿å… <code>map</code> ä»»åŠ¡å’Œ <code>reduce</code> ä»»åŠ¡ä¹‹é—´çš„æ•°æ®ä¼ è¾“æ˜¯æœ‰åˆ©çš„ï¼›ä¸ºæ­¤ <code>Hadoop</code> å…è®¸ç”¨æˆ·æŒ‡å¯¹ <code>map</code> ä»»åŠ¡çš„è¾“å‡ºæŒ‡å®šä¸€ä¸ª <code>combiner</code>ï¼Œè¯¥ <strong><code>combiner</code> å‡½æ•°</strong>çš„è¾“å‡ºå°†ä½œä¸º <code>reduce</code> ä»»åŠ¡çš„è¾“å…¥ã€‚<br><small>ç”±äº <code>combiner</code> å±äºä¼˜åŒ–æ–¹æ¡ˆï¼Œå› æ­¤æ— æ³•ç¡®å®šè¦å¯¹ä¸€ä¸ªæŒ‡å®šçš„ <code>map</code> ä»»åŠ¡è¾“å‡ºè®°å½•è°ƒç”¨å¤šå°‘æ¬¡ <code>combiner</code>ã€‚</small></p><hr><h3 id="ç»å…¸ç¤ºä¾‹"><a href="#ç»å…¸ç¤ºä¾‹" class="headerlink" title="ç»å…¸ç¤ºä¾‹"></a>ç»å…¸ç¤ºä¾‹</h3><p><code>WordCount</code> å•è¯è®¡æ•°æ˜¯æœ€ç®€å•ä¹Ÿæ˜¯æœ€èƒ½ä½“ç° <code>MapReduce</code> æ€æƒ³çš„ç¤ºä¾‹ç¨‹åºä¹‹ä¸€ï¼Œè¯¥ç¨‹åºå®Œæ•´çš„ä»£ç å¯ä»¥åœ¨ <code>Hadoop</code> å®‰è£…åŒ…çš„ <code>src/examples</code> ç›®å½•ä¸‹æ‰¾åˆ°ã€‚å…¶ä¸»è¦åŠŸèƒ½æ˜¯ï¼šç»Ÿè®¡ä¸€ç³»åˆ—æ–‡æœ¬æ–‡ä»¶ä¸­æ¯ä¸ªå•è¯å‡ºç°çš„æ¬¡æ•°ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.StringTokenizer;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.conf.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.fs.Path;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.IntWritable;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.Text;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.Job;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.Mapper;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.Reducer;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.lib.input.FileInputFormat;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WordCount</span> &#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * ç»§æ‰¿ Mapper ç±»ï¼Œå®ç° map åŠŸèƒ½</span></span><br><span class="line"><span class="comment">   * </span></span><br><span class="line"><span class="comment">   * key è¡¨ç¤ºæ¯ä¸€è¡Œçš„èµ·å§‹ä½ç½®ï¼ˆåç§»é‡offsetï¼‰</span></span><br><span class="line"><span class="comment">   * value è¡¨ç¤ºæ¯ä¸€è¡Œçš„æ–‡æœ¬å†…å®¹</span></span><br><span class="line"><span class="comment">   * context.key è¡¨ç¤ºæ¯ä¸€è¡Œä¸­çš„æ¯ä¸ªå•è¯</span></span><br><span class="line"><span class="comment">   * context.value è¡¨ç¤ºæ¯ä¸€è¡Œä¸­çš„æ¯ä¸ªå•è¯çš„å‡ºç°æ¬¡æ•°ï¼Œå›ºå®šå€¼ä¸º1</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">TokenizerMapper</span> <span class="keyword">extends</span> <span class="title class_">Mapper</span>&lt;Object, Text, Text, IntWritable&gt;&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="type">IntWritable</span> <span class="variable">one</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">IntWritable</span>(<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">private</span> <span class="type">Text</span> <span class="variable">word</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Text</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// map åŠŸèƒ½å¿…é¡»å®ç°çš„å‡½æ•°</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">map</span><span class="params">(Object key, Text value, Context context)</span> <span class="keyword">throws</span> IOException, InterruptedException &#123;</span><br><span class="line">      <span class="type">StringTokenizer</span> <span class="variable">itr</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringTokenizer</span>(value.toString());</span><br><span class="line">      <span class="keyword">while</span> (itr.hasMoreTokens()) &#123;</span><br><span class="line">        word.set(itr.nextToken());</span><br><span class="line">        context.write(word, one);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ç»§æ‰¿ Reducer ç±»ï¼Œå®ç° reduce åŠŸèƒ½</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * key è¡¨ç¤ºæ¯ä¸€è¡Œä¸­çš„æ¯ä¸ªå•è¯</span></span><br><span class="line"><span class="comment"> * values è¡¨ç¤ºæ¯ä¸€è¡Œä¸­çš„æ¯ä¸ªå•è¯çš„å‡ºç°æ¬¡æ•°ï¼Œå›ºå®šå€¼ä¸º1</span></span><br><span class="line"><span class="comment"> * context.key è¡¨ç¤ºæ¯ä¸€è¡Œä¸­çš„æ¯ä¸ªå•è¯</span></span><br><span class="line"><span class="comment"> * context.value è¡¨ç¤ºæ¯ä¸€è¡Œä¸­çš„æ¯ä¸ªå•è¯çš„å‡ºç°æ¬¡æ•°ä¹‹å’Œ</span></span><br><span class="line"><span class="comment"> */</span> </span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">IntSumReducer</span> <span class="keyword">extends</span> <span class="title class_">Reducer</span>&lt;Text,IntWritable,Text,IntWritable&gt; &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">IntWritable</span> <span class="variable">result</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">IntWritable</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">reduce</span><span class="params">(Text key, Iterable&lt;IntWritable&gt; values, Context context)</span> <span class="keyword">throws</span> IOException, InterruptedException &#123;</span><br><span class="line">      <span class="type">int</span> <span class="variable">sum</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">for</span> (IntWritable val : values) &#123;</span><br><span class="line">        sum += val.get();</span><br><span class="line">      &#125;</span><br><span class="line">      result.set(sum);</span><br><span class="line">      context.write(key, result);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">    <span class="comment">// åˆå§‹åŒ– Configurationï¼Œè¯»å– mapreduce ç³»ç»Ÿé…ç½®ä¿¡æ¯</span></span><br><span class="line">    <span class="type">Configuration</span> <span class="variable">conf</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Configuration</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ„å»º Job å¹¶ä¸”åŠ è½½è®¡ç®—ç¨‹åº WordCount.class</span></span><br><span class="line">    <span class="type">Job</span> <span class="variable">job</span> <span class="operator">=</span> Job.getInstance(conf, <span class="string">&quot;word count&quot;</span>);</span><br><span class="line">    job.setJarByClass(WordCount.class);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æŒ‡å®š Mapperã€Combinerã€Reducerï¼Œä¹Ÿå°±æ˜¯ç»§æ‰¿å®ç°çš„ç±»</span></span><br><span class="line">    job.setMapperClass(TokenizerMapper.class);</span><br><span class="line">    job.setCombinerClass(IntSumReducer.class);</span><br><span class="line">    job.setReducerClass(IntSumReducer.class);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è®¾ç½®è¾“å…¥è¾“å‡ºæ•°æ®</span></span><br><span class="line">    job.setOutputKeyClass(Text.class);</span><br><span class="line">    job.setOutputValueClass(IntWritable.class);</span><br><span class="line">    FileInputFormat.setInputPath(job, <span class="keyword">new</span> <span class="title class_">Path</span>(args[<span class="number">0</span>]));</span><br><span class="line">    FileOutputFormat.setOutputPath(job, <span class="keyword">new</span> <span class="title class_">Path</span>(args[<span class="number">1</span>]));</span><br><span class="line">    System.exit(job.waitForCompletion(<span class="literal">true</span>) ? <span class="number">0</span> : <span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol><li><p><code>Job</code> åˆå§‹åŒ–<br><code>main</code> å‡½æ•°æ„å»º <code>Configuration</code> å¯¹è±¡è®¾ç½®ç³»ç»Ÿé…ç½®ä¿¡æ¯ï¼Œæ¥ç€ <code>Job</code> è‡ªå®šä¹‰å®ä¾‹å¹¶è®¾ç½®å¯åŠ¨ç±»ã€‚</p></li><li><p>è®¾ç½® <code>Job</code> çš„ <code>map</code>ï¼ˆæ‹†åˆ†ï¼‰ã€ <code>combiner</code>ï¼ˆä¸­é—´ç»“æœå¤„ç†ï¼‰ã€ <code>reduce</code>ï¼ˆåˆå¹¶ï¼‰<br>è®¾ç½® <code>Job</code> çš„ç›¸å…³ <code>map</code> ç±»ã€<code>reduce</code> ç±»ã€<code>combiner</code> ç±»ã€‚</p><ul><li><code>map</code>ï¼š<code>Mapper</code> ç±»å…±æœ‰å››ä¸ªæ³›å‹ï¼Œåˆ†åˆ«æ˜¯ <code>KEYIN</code>ã€<code>VALUEIN</code>ã€<code>KEYOUT</code>ã€<code>VALUEOUT</code>ï¼Œå‰é¢ä¸¤ä¸ª <code>KEYIN</code>ã€<code>VALUEIN</code> æŒ‡çš„æ˜¯ <code>map</code> å‡½æ•°è¾“å…¥å‚æ•°çš„é”®å€¼å¯¹çš„ç±»å‹ï¼›åé¢ä¸¤ä¸ª<code>KEYOUT</code>ã€<code>VALUEOUT</code> æŒ‡çš„æ˜¯ <code>map</code> å‡½æ•°è¾“å‡ºçš„é”®å€¼å¯¹çš„ç±»å‹ã€‚è€Œè¿™é‡Œçš„ <code>map</code> å‡½æ•°ä¸­é€šè¿‡ç©ºæ ¼ç¬¦å·æ¥åˆ†å‰²æ–‡æœ¬å†…å®¹ï¼Œå¹¶å¯¹å…¶è¿›è¡Œè®°å½•ã€‚</li><li><code>reduce</code>ï¼š<code>Reducer</code> ç±»ä¹Ÿæœ‰å››ä¸ªæ³›å‹ï¼Œåˆ†åˆ«æŒ‡çš„æ˜¯ <code>reduce</code> å‡½æ•°è¾“å…¥çš„é”®å€¼å¯¹ç±»å‹ï¼ˆè¿™é‡Œè¾“å…¥çš„é”®å€¼å¯¹ç±»å‹é€šå¸¸å’Œ <code>map</code> çš„è¾“å‡ºé”®å€¼å¯¹ç±»å‹ä¿æŒä¸€è‡´ï¼‰å’Œè¾“å‡ºçš„é”®å€¼å¯¹ç±»å‹ã€‚è€Œè¿™é‡Œçš„ <code>reduce</code> å‡½æ•°ä¸»è¦æ˜¯å°†ä¼ å…¥çš„é”®å€¼å¯¹è¿›è¡Œæœ€åçš„åˆå¹¶ç»Ÿè®¡ï¼Œå½¢æˆæœ€åçš„ç»Ÿè®¡ç»“æœã€‚</li></ul></li><li><p>è®¾ç½® <code>Job</code> çš„é”®å€¼å¯¹ç±»å‹<br>è®¾ç½® <code>Job</code> è¾“å‡ºç»“æœ <code>&lt;key,value&gt;</code> çš„ä¸­é”®å€¼å¯¹æ•°æ®ç±»å‹ï¼Œå› ä¸ºç»“æœæ˜¯&lt;å•è¯,ä¸ªæ•°&gt;ï¼Œæ‰€ä»¥ <code>key</code> è®¾ç½®ä¸º <code>Text</code> ç±»å‹ç›¸å½“äº <code>String</code> ç±»å‹ã€‚<code>Value</code> è®¾ç½®ä¸º <code>IntWritable</code> ç›¸å½“äº <code>int</code> ç±»å‹ã€‚</p></li><li><p>è®¾ç½® <code>Job</code> çš„è¾“å…¥è¾“å‡º<br>é€šè¿‡ <code>setInputPath</code> å’Œ <code>setOutputPath</code> è®¾ç½® <code>Job</code> çš„è¾“å…¥è¾“å‡ºè·¯å¾„ã€‚</p></li></ol><hr><h3 id="å·¥ä½œæœºåˆ¶"><a href="#å·¥ä½œæœºåˆ¶" class="headerlink" title="å·¥ä½œæœºåˆ¶"></a>å·¥ä½œæœºåˆ¶</h3><h4 id="ä½œä¸šè¿è¡Œæœºåˆ¶"><a href="#ä½œä¸šè¿è¡Œæœºåˆ¶" class="headerlink" title="ä½œä¸šè¿è¡Œæœºåˆ¶"></a>ä½œä¸šè¿è¡Œæœºåˆ¶</h4><p>åœ¨è¯´æ˜ä½œä¸šè¿è¡Œæœºåˆ¶ä¹‹å‰ï¼Œå¯ä»¥é€šè¿‡ <code>Job</code> å¯¹è±¡çš„ <code>submit()</code> æ–¹æ³•æ¥è¿è¡Œ <code>MapReduce</code> ä½œä¸šï¼Œä¸”å…¶å†…éƒ¨å°è£…äº†å¤§é‡çš„å¤„ç†ç»†èŠ‚ï¼›ä¹Ÿå¯ä»¥é€šè¿‡è°ƒç”¨ <code>waitForComplete()</code> æ–¹æ³•ç”¨æ¥æäº¤ä¹‹å‰æ²¡æœ‰æäº¤è¿‡çš„ä»»åŠ¡ï¼Œå¹¶ç­‰å¾…å®ƒå®Œæˆã€‚</p><p>æ•´ä½“æœºåˆ¶æµç¨‹å¦‚ä¸‹ï¼š</p><ul><li>å®¢æˆ·ç«¯æäº¤ <code>MapReduce</code> ä½œä¸šã€‚</li><li><code>YARN</code> èµ„æºç®¡ç†å™¨è´Ÿè´£åè°ƒé›†ç¾¤ä¸Šè®¡ç®—æœºèµ„æºçš„åˆ†é…ã€‚</li><li><code>YARN</code> èŠ‚ç‚¹ç®¡ç†å™¨è´Ÿè´£å¯åŠ¨å’Œç›‘è§†é›†ç¾¤ä¸­æœºå™¨ä¸Šçš„è®¡ç®—å®¹å™¨ï¼ˆ<code>container</code>ï¼‰ã€‚</li><li><code>MapReduce</code> çš„ <code>application master</code> è´Ÿè´£åè°ƒè¿è¡Œ <code>MapReduce</code> ä½œä¸šçš„ä»»åŠ¡ã€‚å®ƒå’Œ <code>MapReduce</code> ä»»åŠ¡åœ¨å®¹å™¨ä¸­è¿è¡Œï¼Œè¿™äº›å®¹å™¨ç”±èµ„æºç®¡ç†å™¨åˆ†é…å¹¶ç”±èŠ‚ç‚¹ç®¡ç†å™¨è¿›è¡Œç®¡ç†ã€‚</li><li>åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿç”¨æ¥ä¸å…¶ä»–å®ä½“é—´å…±äº«ä½œä¸šæ–‡ä»¶ã€‚</li></ul><p><img src="https://s2.loli.net/2023/03/11/FWK3eMbnlcvLNHG.png" alt="hadoop-2-1.jpg"></p><h5 id="æäº¤ä½œä¸š"><a href="#æäº¤ä½œä¸š" class="headerlink" title="æäº¤ä½œä¸š"></a>æäº¤ä½œä¸š</h5><p><code>Job</code> çš„ <code>submit()</code> æ–¹æ³•åˆ›å»ºä¸€ä¸ªå†…éƒ¨çš„ <strong><code>JobSummiter</code></strong> å®ä¾‹ï¼Œå¹¶ä¸”è°ƒç”¨å…¶ <code>submitJoobbInternal()</code> æ–¹æ³•ã€‚æäº¤ä½œä¸šåï¼Œ<code>waitForComplete()</code> æ¯ç§’è½®è¯¢ä½œä¸šçš„è¿›åº¦ï¼Œå¦‚æœå‘ç°è‡ªä¸Šæ¬¡æŠ¥å‘Šåæœ‰æ”¹å˜ï¼Œä¾¿æŠŠè¿›åº¦æŠ¥å‘Šåˆ°æ§åˆ¶å°ã€‚ä½œä¸šå®Œæˆåï¼Œå¦‚æœæˆåŠŸå°±æ˜¾ç¤ºä½œä¸šè®¡æ•°å™¨ï¼›å¦‚æœå¤±è´¥åˆ™å¯¼è‡´ä½œä¸šå¤±è´¥çš„é”™è¯¯è¢«è®°å½•åˆ°æ§åˆ¶å°ã€‚<br><code>JobSummiter</code> æ‰€å®ç°çš„ä½œä¸šæäº¤è¿‡ç¨‹å¦‚ä¸‹ï¼š</p><ul><li>å‘èµ„æºç®¡ç†å™¨è¯·æ±‚ä¸€ä¸ªæ–°åº”ç”¨ <code>ID</code>ï¼Œç”¨äº <code>MapReduce</code> ä½œä¸š <code>ID</code>ã€‚</li><li>æ£€æŸ¥ä½œä¸šçš„è¾“å‡ºè¯´æ˜ã€‚</li><li>è®¡ç®—ä½œä¸šçš„è¾“å…¥åˆ†ç‰‡ã€‚</li><li>å°†è¿è¡Œä½œä¸šæ‰€éœ€è¦çš„èµ„æºï¼ˆåŒ…æ‹¬ä½œä¸š <code>JAR</code> æ–‡ä»¶ã€é…ç½®æ–‡ä»¶å’Œè®¡ç®—æ‰€å¾—çš„è¾“å…¥åˆ†ç‰‡ï¼‰å¤åˆ¶åˆ°ä¸€ä¸ªä»¥ä½œä¸š <code>ID</code> å‘½åçš„ç›®å½•ä¸‹çš„å…±äº«æ–‡ä»¶ç³»ç»Ÿä¸­ã€‚ä½œä¸š <code>JAR</code> çš„å‰¯æœ¬è¾ƒå¤šï¼ˆç”± <code>mapreduce.client.submit.file.replication</code> å±æ€§æ§åˆ¶ï¼Œé»˜è®¤å€¼ä¸º <code>10</code>ï¼‰ï¼Œå› æ­¤åœ¨è¿è¡Œä½œä¸šçš„ä»»åŠ¡æ—¶ï¼Œé›†ç¾¤ä¸­æœ‰å¾ˆå¤šå‰¯æœ¬å¯ä¾›èŠ‚ç‚¹ç®¡ç†å™¨è®¿é—®ã€‚</li><li>é€šè¿‡è°ƒç”¨èµ„æºç®¡ç†å™¨çš„ <code>submitApplication()</code> æ–¹æ³•æäº¤ä½œä¸šã€‚</li></ul><h5 id="ä½œä¸šåˆå§‹åŒ–"><a href="#ä½œä¸šåˆå§‹åŒ–" class="headerlink" title="ä½œä¸šåˆå§‹åŒ–"></a>ä½œä¸šåˆå§‹åŒ–</h5><p>èµ„æºç®¡ç†å™¨æ”¶åˆ°è°ƒç”¨å®ƒçš„ <code>submitApplication()</code> æ¶ˆæ¯åï¼Œä¾¿å°†è¯·æ±‚ä¼ é€’ç»™ <strong><code>YARN</code> è°ƒåº¦å™¨ï¼ˆ<code>scheduler</code>ï¼‰</strong> ã€‚è°ƒåº¦å™¨åˆ†é…ä¸€ä¸ªå®¹å™¨ï¼Œç„¶åèµ„æºç®¡ç†å™¨åœ¨èŠ‚ç‚¹ç®¡ç†å™¨çš„ç®¡ç†ä¸‹åœ¨å®¹å™¨ä¸­å¯åŠ¨ <code>application master</code> çš„è¿›ç¨‹ã€‚</p><p><code>MapReduce</code> ä½œä¸šçš„ <code>application master</code> æ˜¯ä¸€ä¸ª <code>Java</code> åº”ç”¨ç¨‹åºï¼Œå®ƒçš„ä¸»ç±»æ˜¯ <strong><code>MRAppMaster</code></strong> ã€‚ç”±äºå°†æ¥å—æ¥è‡ªä»»åŠ¡çš„è¿›åº¦å’Œå®ŒæˆæŠ¥å‘Šï¼Œå› æ­¤ <code>application master</code> å¯¹ä½œä¸šçš„åˆå§‹åŒ–æ˜¯é€šè¿‡åˆ›å»ºå¤šä¸ª<strong>è–„è®°å¯¹è±¡</strong>ä»¥ä¿æŒå¯¹ä½œä¸šè¿›åº¦çš„è·Ÿè¸ªæ¥å®Œæˆçš„ã€‚æ¥ä¸‹æ¥å®ƒæ¥å—æ¥è‡ªå…±äº«æ–‡ä»¶ç³»ç»Ÿã€åœ¨å®¢æˆ·ç«¯è®¡ç®—çš„è¾“å…¥åˆ†ç‰‡ï¼Œæ¥ç€å¯¹æ¯ä¸€ä¸ªåˆ†ç‰‡åˆ›å»ºä¸€ä¸ª <code>map</code> ä»»åŠ¡å¯¹è±¡ä»¥åŠç”± <code>mapreduce.job.reduces</code> å±æ€§ï¼ˆé€šè¿‡ä½œä¸šçš„ <code>setNumReduceTasks()</code> æ–¹æ³•è®¾ç½®ï¼‰ç¡®å®šçš„å¤šä¸ª <code>reduce</code> ä»»åŠ¡å¯¹è±¡ã€‚ä»»åŠ¡ <code>ID</code> ä¹Ÿä¼šåœ¨æ­¤æ—¶åˆ†é…ã€‚</p><p><code>application master</code> å¿…é¡»å†³å®šå¦‚ä½•è¿è¡Œæ„æˆ <code>MapReduce</code> ä½œä¸šçš„å„ä¸ªä»»åŠ¡ã€‚å¦‚æœä½œä¸šå¾ˆå°ï¼Œå¹¶ä¸” <code>application master</code> åˆ¤æ–­åœ¨æ–°çš„å®¹å™¨ä¸­åˆ†é…å’Œè¿è¡Œä»»åŠ¡çš„å¼€é”€å¤§äºå¹¶è¡Œè¿è¡Œçš„å¼€é”€æ—¶ï¼Œå°±é€‰æ‹©å’Œè‡ªå·±åœ¨åŒä¸€ä¸ª <code>JVM</code> ä¸Šè¿è¡Œä»»åŠ¡ã€‚è¿™æ ·çš„ä½œä¸šè¢«ç§°ä¸º <strong><code>uberized</code>ï¼Œæˆ–è€…ä½œä¸º <code>uber</code> ä»»åŠ¡è¿è¡Œ</strong> ã€‚</p><p>å¦‚ä½•åˆ¤æ–­ä½œä½•å¾ˆå°å‘¢ï¼Ÿé»˜è®¤æƒ…å†µä¸‹ï¼Œå°ä½œä¸šå°±æ˜¯å°‘äº <code>10</code> ä¸ª <code>mapper</code> ä¸”åªæœ‰ <code>1</code> ä¸ª <code>reduce</code> ä¸”è¾“å…¥å¤§å°å°äºä¸€ä¸ª <code>HDFS</code> å—çš„ä½œä¸šï¼ˆè®¾ç½® <code>mapreduce.job.ubertask.maxmaps</code>ã€<code>mapreduce.job.ubertask.maxreduces</code> å’Œ <code>mapreduce.job.ubertask.maxbytes</code> å‚æ•°ï¼‰ã€‚å¿…é¡»æ˜ç¡®å¯ç”¨ <code>Uber</code> ä»»åŠ¡ï¼ˆå¯¹äºå•ä¸ªä½œä¸šæˆ–è€…æ•´ä¸ªé›†ç¾¤ï¼‰ï¼Œå…·ä½“æ–¹æ³•æ˜¯å°† <code>mapreduce.job.ubertask.enable</code> è®¾ç½®ä¸º <code>true</code>ã€‚</p><p>æœ€ååœ¨è¿è¡Œä»»åŠ¡å‰ï¼Œ<code>application master</code> è°ƒç”¨ <code>setupJob()</code> æ–¹æ³•è®¾ç½® <code>OutputCommitter</code>ã€‚é»˜è®¤å€¼ä¸º <code>FileOutputCommiter</code>ï¼Œè¡¨ç¤ºå°†å»ºç«‹ä½œä¸šçš„æœ€ç»ˆè¾“å‡ºç›®å½•åŠä»»åŠ¡è¾“å‡ºçš„ä¸´æ—¶å·¥ä½œç©ºé—´ã€‚</p><h5 id="åˆ†é…ä»»åŠ¡"><a href="#åˆ†é…ä»»åŠ¡" class="headerlink" title="åˆ†é…ä»»åŠ¡"></a>åˆ†é…ä»»åŠ¡</h5><p>å¦‚æœä½œä¸šä¸é€‚åˆä½œä¸º <code>uber</code> ä»»åŠ¡è¿è¡Œï¼Œé‚£ä¹ˆ <code>application master</code> å°±ä¼šä¸ºè¯¥ä½œä¸šä¸­çš„æ‰€æœ‰ <code>map</code> ä»»åŠ¡å’Œ <code>reduce</code> ä»»åŠ¡å‘èµ„æºç®¡ç†å™¨è¯·æ±‚å®¹å™¨ã€‚é¦–å…ˆä¸º <code>map</code> ä»»åŠ¡å‘å‡ºè¯·æ±‚ï¼Œè¯¥è¯·æ±‚ä¼˜å…ˆçº§è¦é«˜äº <code>reduce</code> ä»»åŠ¡çš„è¯·æ±‚ï¼Œè¿™æ˜¯å› ä¸ºæ‰€æœ‰çš„ <code>map</code> ä»»åŠ¡å¿…é¡»åœ¨ <code>reduce</code> çš„æ’åºé˜¶æ®µèƒ½å¤Ÿå¯åŠ¨å‰å®Œæˆï¼Œç›´åˆ°æœ‰ <code>5%</code> çš„ <code>map</code> ä»»åŠ¡å·²ç»å®Œæˆæ—¶ä¸º <code>reduce</code> ä»»åŠ¡çš„è¯·æ±‚æ‰ä¼šå‘å‡ºã€‚</p><p><code>reduce</code> ä»»åŠ¡èƒ½å¤Ÿåœ¨é›†ç¾¤ä¸­ä»»æ„ä½ç½®è¿è¡Œï¼Œä½†æ˜¯ <code>map</code> ä»»åŠ¡çš„è¯·æ±‚æœ‰ç€æ•°æ®æœ¬åœ°åŒ–å±€é™ï¼Œåœ¨ç†æƒ³çš„æƒ…å†µä¸‹ï¼Œä»»åŠ¡æ˜¯æ•°æ®æœ¬åœ°åŒ–ï¼ˆ<code>data local</code>ï¼‰çš„ï¼Œæ„å‘³ç€ä»»åŠ¡åœ¨åˆ†ç‰‡é©»ç•™çš„åŒä¸€èŠ‚ç‚¹ä¸Šè¿è¡Œã€‚å¯é€‰çš„æƒ…å†µä¸‹ï¼Œä»»åŠ¡å¯èƒ½æ—¶æœºæ¶æœ¬åœ°åŒ–ï¼ˆ<code>rack local</code>ï¼‰çš„ï¼Œå³å’Œåˆ†ç‰‡åœ¨åŒä¸€æœºæ¶è€ŒéåŒä¸€èŠ‚ç‚¹ä¸Šè¿è¡Œã€‚åŒæ—¶ä¹Ÿæœ‰ä¸€äº›ä»»åŠ¡æ—¢ä¸æ˜¯æ•°æ®æœ¬åœ°åŒ–ï¼Œä¹Ÿä¸æ˜¯æœºæ¶æœ¬åœ°åŒ–ï¼Œå®ƒä»¬ä¼šä»åˆ«çš„æœºæ¶ä¸Šè·å–è‡ªå·±çš„æ•°æ®ã€‚</p><p>è¯·æ±‚ä¹Ÿä¸ºä»»åŠ¡æŒ‡å®šäº†å†…å­˜éœ€æ±‚å’Œ <code>CPU</code> æ•°ã€‚åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œæ¯ä¸ª <code>map</code> ä»»åŠ¡å’Œ <code>reduce</code> ä»»åŠ¡éƒ½åˆ†é…åˆ° <code>1024MB</code> çš„å†…å­˜å’Œä¸€ä¸ªè™šæ‹Ÿå†…æ ¸ï¼Œè¿™äº›å€¼å¯ä»¥åœ¨æ¯ä¸ªä½œä¸šçš„åŸºç¡€ä¸Šè¿›è¡Œé…ç½®ï¼Œåˆ†åˆ«é€šè¿‡ <code>4</code> ä¸ªå±æ€§æ¥è®¾ç½® <code>mapreduce.map.memory.mb</code>ã€<code>mapreduce.map.cpu.vcores</code>ã€<code>mapreduce.reduce.memory.mb</code> å’Œ <code>mapreduce.reduce.cpu.vcoresp.memory.mb</code>ã€‚</p><h5 id="æ‰§è¡Œä»»åŠ¡"><a href="#æ‰§è¡Œä»»åŠ¡" class="headerlink" title="æ‰§è¡Œä»»åŠ¡"></a>æ‰§è¡Œä»»åŠ¡</h5><p>ä¸€æ—¦èµ„æºç®¡ç†å™¨çš„è°ƒåº¦å™¨ä¸ºä»»åŠ¡åˆ†é…äº†ä¸€ä¸ªç‰¹å®šèŠ‚ç‚¹ä¸Šçš„å®¹å™¨ï¼Œ<code>application master</code> å°±é€šè¿‡ä¸èŠ‚ç‚¹ç®¡ç†å™¨é€šä¿¡æ¥å¯åŠ¨å®¹å™¨ã€‚è¯¥ä»»åŠ¡ç”±ä¸»ç±»ä¸º <code>YarnChild</code> çš„ä¸€ä¸ª <code>Java</code> åº”ç”¨ç¨‹åºæ‰§è¡Œï¼Œåœ¨å®ƒè¿è¡Œä»»åŠ¡ä¹‹å‰ï¼Œéœ€è¦é¦–å…ˆå°†ä»»åŠ¡éœ€è¦çš„èµ„æºæœ¬åœ°åŒ–ï¼ŒåŒ…æ‹¬ä½œä¸šçš„é…ç½®ã€<code>JAR</code> æ–‡ä»¶å’Œæ‰€æœ‰æ¥è‡ªåˆ†å¸ƒå¼ç¼“å­˜çš„æ–‡ä»¶ã€‚æœ€åè¿è¡Œ <code>map</code> ä»»åŠ¡æˆ– <code>reduce</code> ä»»åŠ¡ã€‚</p><p><code>YarnChild</code> åœ¨æŒ‡å®šçš„ <code>JVM</code> ä¸­è¿è¡Œï¼Œå› æ­¤ç”¨æˆ·å®šä¹‰çš„ <code>map</code> æˆ– <code>reduce</code> å‡½æ•°ä¸­çš„ä»»ä½•ç¼ºé™·ä¸ä¼šå½±å“åˆ°èŠ‚ç‚¹ç®¡ç†å™¨ã€‚</p><p>æ¯ä¸ªä»»åŠ¡éƒ½èƒ½å¤Ÿæ‰§è¡Œæ­å»ºï¼ˆ<code>setup</code>ï¼‰å’Œæäº¤ï¼ˆ<code>commit</code>ï¼‰åŠ¨ä½œï¼Œå®ƒä»¬å’Œä»»åŠ¡æœ¬èº«åœ¨åŒä¸€ä¸ª <code>JVM</code> ä¸­è¿è¡Œï¼Œå¹¶ç”±ä½œä¸šçš„ <code>OutputCommitter</code> ç¡®å®šã€‚å¯¹äºåŸºäºæ–‡ä»¶çš„ä½œä¸šï¼Œæäº¤åŠ¨ä½œå°†ä»»åŠ¡è¾“å‡ºç”±ä¸´æ—¶ä½ç½®è¿ç§»åˆ°æœ€ç»ˆä½ç½®ã€‚æäº¤åè®®ç¡®ä¿å½“æ¨æµ‹æ‰§è¡Œï¼ˆ<code>speculative execution</code>ï¼‰è¢«å¯ç”¨æ—¶ï¼Œåªæœ‰ä¸€ä¸ªä»»åŠ¡å‰¯æœ¬è¢«æäº¤ï¼Œå…¶ä»–çš„éƒ½è¢«å–æ¶ˆã€‚</p><h5 id="æ›´æ–°ä½œä¸šçŠ¶æ€å’Œè¿›åº¦"><a href="#æ›´æ–°ä½œä¸šçŠ¶æ€å’Œè¿›åº¦" class="headerlink" title="æ›´æ–°ä½œä¸šçŠ¶æ€å’Œè¿›åº¦"></a>æ›´æ–°ä½œä¸šçŠ¶æ€å’Œè¿›åº¦</h5><p><code>MapReduce</code> ä½œä¸šæ˜¯é•¿æ—¶é—´è¿è¡Œçš„æ‰¹é‡ä½œä¸šï¼Œè¿è¡Œæ—¶é—´èŒƒå›´ä»æ•°ç§’åˆ°æ•°å°æ—¶ã€‚ä¸€ä¸ªä½œä¸šå’Œå®ƒçš„æ¯ä¸ªä»»åŠ¡éƒ½æœ‰ä¸€ä¸ªçŠ¶æ€ï¼ˆ<code>status</code>ï¼‰ï¼ŒåŒ…æ‹¬ï¼šä½œä¸šæˆ–ä»»åŠ¡çš„çŠ¶æ€ã€<code>map</code> å’Œ <code>reduce</code> çš„è¿›åº¦ã€ä½œä¸šè®¡æ•°å™¨çš„å€¼ã€çŠ¶æ€æ¶ˆæ¯æˆ–æè¿°ï¼ˆå¯ä»¥ç”±ç”¨æˆ·æ¥è®¾ç½®ï¼‰ã€‚<br>ä¸Šè¿°çš„çŠ¶æ€ä¿¡æ¯åœ¨ä½œä¸šæœŸé—´ä¸æ–­æ”¹å˜ï¼Œé‚£åˆæ˜¯å¦‚ä½•ä¸å®¢æˆ·ç«¯é€šä¿¡å‘¢ï¼Ÿä»»åŠ¡åœ¨è¿è¡Œæ—¶ï¼Œå¯¹å…¶è¿›åº¦ï¼ˆ<code>progress</code>ï¼Œå³ä»»åŠ¡å®Œæˆç™¾åˆ†æ¯”ï¼‰ä¿æŒè·Ÿè¸ªã€‚å¯¹ <code>map</code> ä»»åŠ¡ï¼Œä»»åŠ¡è¿›åº¦æ˜¯å·²å¤„ç†è¾“å…¥æ‰€å æ¯”ä¾‹ã€‚å¯¹ <code>reduce</code> ä»»åŠ¡ï¼Œæƒ…å†µæœ‰ç‚¹å¤æ‚ï¼Œæ•´ä¸ªè¿‡ç¨‹åˆ†ä¸ºä¸‰ä¸ªæ­¥éª¤ï¼Œä¸ <code>shuffle</code> çš„ä¸‰ä¸ªé˜¶æ®µç›¸å¯¹åº”ï¼ŒåŒæ—¶ä¹Ÿä¼šä¼°è®¡å·²å¤„ç† <code>reduce</code> è¾“å…¥çš„æ¯”ä¾‹ã€‚</p><p><code>MapReduce</code> ä¸­è¿›åº¦çš„ç»„æˆå¦‚ä¸‹ï¼š</p><ul><li>è¯»å…¥ä¸€æ¡è¾“å…¥è®°å½•</li><li>å†™å…¥ä¸€æ¡è¾“å‡ºè®°å½•</li><li>è®¾ç½®çŠ¶æ€æè¿°</li><li>å¢åŠ è®¡æ•°å™¨çš„å€¼</li><li>è°ƒç”¨ <code>Reporter</code> æˆ– <code>TaskAttemptContext</code> çš„ <code>progress()</code> æ–¹æ³•</li></ul><p>ä»»åŠ¡ä¹Ÿæœ‰ä¸€ç»„è®¡æ•°å™¨ï¼Œè´Ÿè´£å¯¹ä»»åŠ¡è¿è¡Œè¿‡ç¨‹ä¸­å„ä¸ªäº‹ä»¶è¿›è¡Œè®¡æ•°ï¼Œè¿™äº›è®¡æ•°å™¨è¦ä¹ˆç½®äºæ¡†æ¶ä¸­ï¼Œè¦ä¹ˆç”±ç”¨æˆ·è‡ªå·±å®šä¹‰ã€‚</p><p>å½“ <code>map</code> ä»»åŠ¡æˆ– <code>reduce</code> ä»»åŠ¡è¿è¡Œæ—¶ï¼Œå­è¿›ç¨‹å’Œè‡ªå·±çš„çˆ¶ <code>application master</code> é€šè¿‡ <code>umbilical</code> æ¥å£é€šä¿¡ã€‚æ¯ä¸ªä¸‰ç§’é’Ÿï¼Œä»»åŠ¡é€šè¿‡è¿™ä¸ª <code>umbilical</code> æ¥å£å‘è‡ªå·±çš„ <code>application master</code> æŠ¥å‘Šè¿›åº¦å’ŒçŠ¶æ€ï¼ˆåŒ…æ‹¬è®¡æ•°å™¨ï¼‰ï¼Œ<code>application master</code> ä¼šå½¢æˆä¸€ä¸ªä½œä¸šçš„æ±‡èšè§†å›¾ï¼ˆ<code>aggregate view</code>ï¼‰ã€‚</p><p>åœ¨ä½œä¸šæœŸé—´ï¼Œå®¢æˆ·ç«¯æ¯ç§’é’Ÿè½®è¯¢ä¸€æ¬¡ <code>application master</code> ä»¥æ¥æ”¶æœ€æ–°çŠ¶æ€ï¼ˆè½®è¯¢é—´éš”é€šè¿‡ <code>mapreduce.client.progressmonitor.pollinterval</code> å‚æ•°è®¾ç½®ï¼‰ã€‚å®¢æˆ·ç«¯ä¹Ÿå¯ä»¥ä½¿ç”¨ <code>Job</code> çš„ <code>getStatus()</code> æ–¹æ³•å¾—åˆ°ä¸€ä¸ª <code>JobStatus</code> å¯¹è±¡çš„å®ä¾‹ï¼Œåè€…ä¼šåŒ…å«ä½œä¸šçš„æ‰€æœ‰çŠ¶æ€ä¿¡æ¯ã€‚</p><p><img src="https://s2.loli.net/2023/03/11/usIrqE6z2K8biB9.png" alt="hadoop-2-2.jpg"></p><h5 id="ä½œä¸šå®Œæˆ"><a href="#ä½œä¸šå®Œæˆ" class="headerlink" title="ä½œä¸šå®Œæˆ"></a>ä½œä¸šå®Œæˆ</h5><p>å½“ <code>application master</code> æ”¶åˆ°ä½œä¸šæœ€åä¸€ä¸ªä»»åŠ¡å·²å®Œæˆçš„é€šçŸ¥åï¼Œä¾¿å°†ä½œä¸šçš„çŠ¶æ€è®¾ç½®ä¸ºâ€œæˆåŠŸâ€ã€‚åœ¨ <code>Job</code> è½®è¯¢çŠ¶æ€æ—¶ï¼Œä¾¿çŸ¥é“ä»»åŠ¡å·²æˆåŠŸå®Œæˆï¼Œäºæ˜¯ <code>Job</code> æ‰“å°ä¸€æ¡æ¶ˆæ¯å‘ŠçŸ¥ç”¨æˆ·ï¼Œç„¶åä» <code>waitForComplete()</code> æ–¹æ³•è¿”å›ï¼›<code>Job</code> çš„ç»Ÿè®¡ä¿¡æ¯å’Œè®¡æ•°å€¼åœ¨è¿™ä¸ªæ—¶å€™ä¹Ÿä¼šè¾“å‡ºåˆ°æ§åˆ¶å°ã€‚</p><p>å¦‚æœ <code>application master</code> æœ‰ç›¸åº”çš„è®¾ç½®ï¼Œä¹Ÿä¼šå‘é€ä¸€æ¡ <code>HTTP</code> ä½œä¸šé€šçŸ¥ï¼Œå¯ä»¥é€šè¿‡ <code>mapreduce.job.end-notification.url</code> å±æ€§æ¥è®¾ç½®åœ¨æ”¶åˆ°å›è°ƒæŒ‡ä»¤åé€šçŸ¥å®¢æˆ·ç«¯ã€‚<br>æœ€ååœ¨ä½œä¸šå®Œæˆæ—¶ï¼Œ<code>application master</code> å’Œä»»åŠ¡å®¹å™¨æ¸…ç†å…¶å·¥ä½œçŠ¶æ€ï¼ˆä¸­é—´çŠ¶æ€ä¼šè¢«åˆ é™¤ï¼‰ï¼Œæ¥ç€ <code>OutputCommitter</code> çš„ <code>commitJob()</code> æ–¹æ³•ä¼šè¢«è°ƒç”¨ã€‚ä½œä¸šä¿¡æ¯ç”±ä½œä¸šå†å²æœåŠ¡å™¨å­˜æ¡£ï¼Œä»¥ä¾¿æ—¥åç”¨æˆ·éœ€è¦æ—¶å¯ä»¥æŸ¥è¯¢ã€‚</p><h4 id="shuffle"><a href="#shuffle" class="headerlink" title="shuffle"></a><code>shuffle</code></h4><p><code>MapReduce</code> ç¡®ä¿æ¯ä¸ª <code>reduce</code> çš„è¾“å…¥éƒ½æ˜¯æŒ‰é”®æ’åºçš„ï¼Œç³»ç»Ÿæ‰§è¡Œæ’åºå°† <code>map</code> è¾“å‡ºä½œä¸ºè¾“å…¥ä¼ ç»™ <code>reducer</code> çš„è¿‡ç¨‹ç§°ä¸º <code>shuffle</code>ã€‚<code>shuffle</code> å±äºä¸æ–­è¢«ä¼˜åŒ–å’Œæ”¹è¿›çš„éƒ¨åˆ†ï¼Œä¹Ÿæ˜¯ <code>MapReduce</code> çš„â€œå¿ƒè„â€ï¼Œæ˜¯å¥‡è¿¹å‘ç”Ÿçš„åœ°æ–¹ã€‚</p><h5 id="map"><a href="#map" class="headerlink" title="map"></a><code>map</code></h5><p><code>map</code> å‡½æ•°å¼€å§‹äº§ç”Ÿè¾“å‡ºæ—¶ï¼Œå¹¶ä¸æ˜¯ç®€å•åœ°å°†æ•°æ®å†™å…¥ç£ç›˜ï¼Œè€Œæ˜¯åˆ©ç”¨ç¼“å†²çš„æ–¹å¼å†™åˆ°å†…å­˜å¹¶å¤„äºæ•ˆç‡çš„è€ƒè™‘è¿›è¡Œé¢„æ’åºã€‚</p><p><img src="https://s2.loli.net/2023/03/11/gbXM2sNYIwR7aDu.png" alt="hadoop-2-3.jpg"></p><p>æ¯ä¸ª <code>map</code> ä»»åŠ¡éƒ½æœ‰ä¸€ä¸ªç¯å½¢å†…å­˜ç¼“å†²åŒºç”¨äºå­˜å‚¨ä»»åŠ¡è¾“å‡ºï¼Œä¸€æ—¦ç¼“å†²å†…å®¹è¾¾åˆ°é˜ˆå€¼ï¼ˆé»˜è®¤ä¸º <code>80%</code>ï¼‰ï¼Œæ­¤æ—¶ä¸€ä¸ªåå°çº¿ç¨‹ä¾¿å¼€å§‹æŠŠå†…å®¹æº¢å‡ºåˆ°ç£ç›˜ã€‚åœ¨æº¢å‡ºå†™åˆ°ç£ç›˜çš„è¿‡ç¨‹ä¸­ï¼Œ<code>map</code> è¾“å‡ºç»§ç»­å†™åˆ°ç¼“å†²åŒºï¼Œä½†å¦‚æœåœ¨æ­¤æœŸé—´ç¼“å†²åŒºè¢«å¡«æ»¡ï¼Œ<code>map</code> ä¼šè¢«é˜»å¡ç›´åˆ°å†™ç£ç›˜è¿‡ç¨‹å®Œæˆã€‚æº¢å‡ºå†™è¿‡ç¨‹æŒ‰è½®è¯¢æ–¹å¼å°†ç¼“å†²åŒºå†…å®¹å†™åˆ° <code>mapreduce.cluster.local.dir</code> å±æ€§åœ¨ä½œä¸šç‰¹å®šå­ç›®å½•ä¸‹æŒ‡å®šçš„ç›®å½•ä¸­ã€‚<br><small>é»˜è®¤æƒ…å†µä¸‹ï¼Œç¼“å†²åŒºå¤§å°ä¸º <code>100MB</code>ï¼Œæ­¤å€¼å¯ä»¥é€šè¿‡ <code>mapreduce.task.io.sort.mb</code> å±æ€§è°ƒæ•´</small></p><p>å¦‚æœ <code>map</code> è¾“å‡ºç›¸å½“å°ï¼Œåˆ™è¾“å‡ºä¼šè¢«ç›´æ¥å¤åˆ¶åˆ° <code>reduce</code> ä»»åŠ¡çš„ <code>JVM</code> å†…å­˜ä¸­ã€‚æŒ‡å®šç”¨äºæ­¤ç”¨é€”çš„å †ç©ºé—´çš„ç™¾åˆ†æ¯”å¤§å°å¯ä»¥ç”± <code>mapreduce.reduce.shuffle.input.buffer.percent</code> å±æ€§æ§åˆ¶ï¼Œã€‚</p><p>åœ¨å†™ç£ç›˜ä¹‹å‰åå°çº¿ç¨‹ä¼šæ ¹æ®æ•°æ®æœ€ç»ˆè¦ä¼ é€’ç»™çš„ <code>reducer</code> å°†æ•°æ®åˆ’åˆ†ä¸ºç›¸åº”çš„åˆ†åŒºã€‚åœ¨æ¯ä¸ªåˆ†åŒºä¸­åå°çº¿ç¨‹ä¼šæ ¹æ®é”®è¿›è¡Œæ’åºï¼Œå¦‚æœæ­¤æ—¶æœ‰ä¸€ä¸ª <code>combiner</code> å‡½æ•°ï¼Œåœ¨æ’åºåè¿è¡Œæ­¤å‡½æ•°ï¼Œæ­¤åä¼šå‡å°‘å†™åˆ°ç£ç›˜ä¸Šçš„æ•°æ®å’Œä¼ é€’ç»™ <code>reducer</code> çš„æ•°æ®ã€‚</p><p>æ¯æ¬¡å†…å­˜ç¼“å†²åŒºè¾¾åˆ°æº¢å‡ºé˜ˆå€¼ï¼Œå°±ä¼šåˆ›å»ºä¸€ä¸ªæº¢å‡ºæ–‡ä»¶ï¼ˆ<code>spill file</code>ï¼‰ï¼Œå› æ­¤åœ¨ <code>map</code> ä»»åŠ¡å†™å®Œå…¶æœ€åä¸€ä¸ªè¾“å‡ºè®°å½•ä¹‹åå°±ä¼šæœ‰å‡ ä¸ªæº¢å‡ºæ–‡ä»¶ã€‚åœ¨ä»»åŠ¡å®Œæˆä¹‹å‰ï¼Œæº¢å‡ºæ–‡ä»¶è¢«åˆå¹¶æˆä¸€ä¸ªå·²åˆ†åŒºä¸”å·²æ’åºçš„è¾“å‡ºæ–‡ä»¶ã€‚<br><small>å±æ€§ <code>mapreduce.task.io.sort.factor</code> å¯ä»¥æ§åˆ¶ä¸€æ¬¡æœ€å¤šåˆå¹¶å¤šå°‘æº¢å‡ºæ–‡ä»¶ï¼Œé»˜è®¤å€¼ä¸º <code>10</code>ã€‚å¦‚æœæœ€å°‘å­˜åœ¨ <code>3</code> ä¸ªæº¢å‡ºæ–‡ä»¶æ—¶ï¼Œåˆ™ <code>combiner</code> å‡½æ•°ä¼šåœ¨è¾“å‡ºæ–‡ä»¶å†™åˆ°ç£ç›˜ä¹‹å‰å†æ¬¡è¿è¡Œ</small></p><p>åœ¨å°†å‹ç¼© <code>map</code> è¾“å‡ºå†™åˆ°ç£ç›˜çš„è¿‡ç¨‹ä¸­æ˜¯å¦èƒ½ä½¿ç”¨å‹ç¼©å‘¢ï¼Ÿåœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œè¾“å‡ºæ˜¯ä¸å‹ç¼©çš„ï¼Œä½†å¯ä»¥é€šè¿‡å±æ€§ <code>mapreduce.map.output.compress</code> è®¾ç½®ä¸º <code>true</code>ï¼Œå³å¯å¯ç”¨æ­¤åŠŸèƒ½ã€‚è€Œä½¿ç”¨çš„å‹ç¼©åº“åˆ™ç”± <code>mapreduce.map.output.compress.codec</code> å‚æ•°æŒ‡å®šã€‚</p><p><code>reducer</code> é€šè¿‡ <code>HTTP</code> å¾—åˆ°è¾“å‡ºæ–‡ä»¶çš„åˆ†åŒºã€‚è€Œç”¨äºæ–‡ä»¶åˆ†åŒºçš„å·¥ä½œçº¿ç¨‹çš„æ•°é‡ç”±ä»»åŠ¡çš„ <code>mapreduce.shuffle.max.threads</code> å±æ€§æ§åˆ¶ï¼Œæ­¤è®¾ç½®é’ˆå¯¹çš„æ˜¯æ¯ä¸€ä¸ªèŠ‚ç‚¹ç®¡ç†å™¨ï¼Œè€Œä¸æ˜¯æ¯ä¸ª <code>map</code> ä»»åŠ¡ã€‚</p><h5 id="reduce"><a href="#reduce" class="headerlink" title="reduce"></a><code>reduce</code></h5><p><code>map</code> è¾“å‡ºæ–‡ä»¶ä½äºè¿è¡Œ <code>map</code> ä»»åŠ¡çš„ <code>tasktracker</code> çš„æœ¬åœ°ç£ç›˜ï¼Œä¹‹å <code>tasktracker</code> ä¼šä¸ºåˆ†åŒºæ–‡ä»¶è¿è¡Œ <code>reduce</code> ä»»åŠ¡ã€‚é‚£ <code>reducer</code> å¦‚ä½•çŸ¥é“ä»é‚£å°æœºå™¨ä¸Šè·å– <code>map</code> è¾“å‡ºï¼Ÿ<code>map</code> ä»»åŠ¡æˆåŠŸåï¼Œä¼šé€šè¿‡å¿ƒè·³æœºåˆ¶é€šçŸ¥ä»–ä»¬çš„ <code>application master</code>ï¼Œ<code>reducer</code> ä¸­çš„ä¸€ä¸ªçº¿ç¨‹å®šæœŸè¯¢é—® <code>master</code> ä»¥ä¾¿è·å– <code>map</code> è¾“å‡ºæ–‡ä»¶ä¸»æœºçš„ä½ç½®ï¼Œç›´åˆ°è·å–æ‰€æœ‰è¾“å‡ºä½ç½®ã€‚</p><p>æ¯ä¸ª <code>map</code> ä»»åŠ¡çš„å®Œæˆä¸å°½ç›¸åŒï¼Œå› æ­¤æ¯ä¸ªä»»åŠ¡å®Œæˆæ—¶ï¼Œ<code>reduce</code> ä»»åŠ¡å°±å¼€å§‹å¤åˆ¶å…¶è¾“å‡ºï¼ˆæ­¤ä¸º <code>reduce</code> ä»»åŠ¡çš„å¤åˆ¶é˜¶æ®µï¼‰ã€‚<code>reduce</code> ä»»åŠ¡æœ‰å°‘é‡å¤åˆ¶çº¿ç¨‹ï¼Œå¯ä»¥å¹¶è¡Œè·å– <code>map</code> è¾“å‡ºï¼Œé»˜è®¤ä¸º <code>5</code> ä¸ªçº¿ç¨‹ï¼Œæ­¤é»˜è®¤å€¼å¯ä»¥é€šè¿‡ <code>mapreduce.reduce.shuffle.parallelcopies</code> å±æ€§ä¿®æ”¹ã€‚</p><p>å¤åˆ¶å®Œæˆæ‰€æœ‰çš„ <code>map</code> è¾“å‡ºä¹‹åï¼Œ<code>reduce</code> ä»»åŠ¡è¿›è¡Œåˆå¹¶é˜¶æ®µï¼Œæ­¤é˜¶æ®µä¼šåˆå¹¶ <code>map</code> è¾“å‡ºï¼Œç»´æŒå…¶é¡ºåºæ’åºã€‚<br><small>é»˜è®¤å€¼ä¸º <code>10</code>ï¼Œé€šè¿‡ <code>mapreduce.task.io.sort.factor</code> å±æ€§æ§åˆ¶ã€‚</small></p><p>åœ¨æœ€åé˜¶æ®µï¼Œå³ç›´æ¥å°†æ•°æ®è¾“å…¥ <code>reduce</code> å‡½æ•°ï¼Œä»è€Œçœç•¥ä¸€æ¬¡ç£ç›˜çš„å¾€è¿”è¡Œç¨‹ï¼Œå¹¶æ²¡æœ‰å°†è¾“å‡ºæ–‡ä»¶åˆå¹¶ä¸ºä¸€ä¸ªå·²æ’åºçš„æ–‡ä»¶ä½œä¸ºæœ€åä¸€æ¬¡ã€‚</p><p>åœ¨ <code>reduce</code> é˜¶æ®µï¼Œå¯¹å·²æ’åºè¾“å‡ºä¸­çš„æ¯ä¸ªé”®è°ƒç”¨ <code>reduce</code> å‡½æ•°ï¼Œæ­¤é˜¶æ®µçš„è¾“å‡ºç›´æ¥å†™åˆ°è¾“å‡ºæ–‡ä»¶ç³»ç»Ÿï¼Œä¸€èˆ¬ä¸º <code>HDFS</code>ã€‚å¦‚æœé‡‡ç”¨ <code>HDFS</code>ï¼Œç”±äºèŠ‚ç‚¹ç®¡ç†å™¨ä¹Ÿè¿è¡Œç€æ•°æ®èŠ‚ç‚¹ï¼Œåˆ™ç¬¬ä¸€å—æ•°æ®å‰¯æœ¬å°†è¢«å†™åˆ°æœ¬åœ°ç£ç›˜ã€‚</p><h5 id="é…ç½®è°ƒä¼˜"><a href="#é…ç½®è°ƒä¼˜" class="headerlink" title="é…ç½®è°ƒä¼˜"></a>é…ç½®è°ƒä¼˜</h5><ol><li><p><code>map</code> ç«¯çš„è°ƒä¼˜å±æ€§</p><table><thead><tr><th>å±æ€§åç§°</th><th>ç±»å‹</th><th>é»˜è®¤å€¼</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>mapreduce.task.io.sort.mb</code></td><td><code>int</code></td><td><code>100</code></td><td>æ’åº <code>map</code> è¾“å‡ºæ—¶æ‰€ä½¿ç”¨çš„å†…å­˜ç¼“å†²åŒºçš„å¤§å°ï¼Œä»¥ <code>MB</code> ä¸ºå•ä½</td></tr><tr><td><code>mapreduce.map.sort.spill.percent</code></td><td><code>float</code></td><td><code>0.80</code></td><td><code>map</code> è¾“å‡ºå†…å­˜ç¼“å­˜å’Œç”¨æ¥å¼€å§‹ç£ç›˜æº¢å‡ºå†™è¿‡ç¨‹çš„è®°å½•è¾¹ç•Œç´¢å¼•ï¼Œä½¿ç”¨æ¯”ä¾‹çš„é˜ˆå€¼</td></tr><tr><td><code>mapreduce.task.io.sort.factor</code></td><td><code>int</code></td><td><code>10</code></td><td>æ’åºæ–‡ä»¶æ—¶ï¼Œä¸€æ¬¡æœ€å¤šåˆå¹¶çš„æµæ•°ã€‚åœ¨ <code>reduce</code> ä¸­ä½¿ç”¨ã€‚</td></tr><tr><td><code>mapreduce.map.combine.minspills</code></td><td><code>int</code></td><td><code>3</code></td><td>è¿è¡Œ <code>combiner</code> æ‰€éœ€çš„æœ€å°‘æº¢å‡ºæ–‡ä»¶æ•°</td></tr><tr><td><code>mapreduce.map.output.compress</code></td><td><code>Boolean</code></td><td><code>false</code></td><td>æ˜¯å¦å‹ç¼© <code>map</code> è¾“å‡º</td></tr><tr><td><code>mapreduce.map.output.compress.codec</code></td><td><code>Class name</code></td><td><code>org.apache. hadoop.io.compress. DefaultCodec</code></td><td>ç”¨äº <code>map</code> è¾“å‡ºçš„å‹ç¼©ç¼–è§£ç å™¨</td></tr><tr><td><code>mapreduce.shuffle.max.threads</code></td><td><code>int</code></td><td><code>0</code></td><td>æ¯ä¸ªèŠ‚ç‚¹ç®¡ç†å™¨çš„å·¥ä½œçº¿ç¨‹æ•°ï¼Œç”¨äºå°† <code>map</code> è¾“å‡ºåˆ° <code>reducer</code>ã€‚ <code>0</code> è¡¨ç¤ºä½¿ç”¨ <code>Netty</code> é»˜è®¤å€¼ï¼Œä¸¤å€äºå¯ç”¨çš„å¤„ç†å™¨æ•°ã€‚</td></tr></tbody></table><p> æ€»çš„åŸåˆ™æ˜¯ç»™ <code>shuffle</code> è¿‡ç¨‹å°½å¯èƒ½å¤šæä¾›å†…å­˜ç©ºé—´ã€‚ä½†æ˜¯ <code>map</code> å‡½æ•°å’Œ <code>reduce</code> å‡½æ•°ä¸èƒ½æ— é™åˆ¶ä½¿ç”¨å†…å­˜ï¼Œéœ€è¦å°½å¯èƒ½å°‘ç”¨å†…å­˜ã€‚<br> è¿è¡Œ <code>map</code> ä»»åŠ¡å’Œ <code>reduce</code> ä»»åŠ¡çš„ <code>JVM</code> ç”± <code>mapred.child.java.opts</code> å±æ€§è®¾ç½®å†…å­˜å¤§å°ã€‚<br> åœ¨ <code>map</code> ç«¯é€šè¿‡é¿å…å¤šæ¬¡æº¢å‡ºå†™ç£ç›˜æ¥è·å¾—æœ€ä½³æ€§èƒ½ï¼Œä¸€æ¬¡æœ€å¥½ï¼›è€Œåœ¨ <code>reduce</code> ç«¯ï¼Œä¸­é—´æ•°æ®å…¨éƒ¨é©»ç•™åœ¨å†…å­˜æ—¶å°±èƒ½è·å¾—æœ€ä½³æ€§èƒ½ã€‚</p></li><li><p><code>reduce</code> ç«¯çš„è°ƒä¼˜å±æ€§</p><table><thead><tr><th>å±æ€§åç§°</th><th>ç±»å‹</th><th>é»˜è®¤å€¼</th><th>æè¿°</th></tr></thead><tbody><tr><td><code>mapreduce.reduce.shuffle.parallelcopies</code></td><td><code>int</code></td><td><code>5</code></td><td>ç”¨äºæŠŠ <code>map</code> è¾“å‡ºå¤åˆ¶åˆ° <code>reducer</code> çš„çº¿ç¨‹æ•°</td></tr><tr><td><code>mapreduce.reduce.shuffle.maxfetchfailures</code></td><td><code>int</code></td><td><code>10</code></td><td>åœ¨å£°æ˜å¤±è´¥ä¹‹å‰ <code>reducer</code> è·å–ä¸€ä¸ª <code>map</code> è¾“å‡ºæ‰€èŠ±çš„æœ€å¤§æ—¶é—´</td></tr><tr><td><code>mapreduce.task.io.sort.factor</code></td><td><code>int</code></td><td><code>10</code></td><td>æ’åºæ–‡ä»¶æ—¶ä¸€æ¬¡æœ€å¤šåˆå¹¶çš„æµçš„æ•°é‡ï¼Œ</td></tr><tr><td><code>mapreduce.reduce.shuffle.input.buffer.percent</code></td><td><code>float</code></td><td><code>0.70</code></td><td><code>shuffle</code> å¤åˆ¶é˜¶æ®µåˆ†é…ç»™ <code>map</code> è¾“å‡ºçš„ç¼“å†²åŒºå å †ç©ºé—´çš„ç™¾åˆ†æ¯”</td></tr><tr><td><code>mapreduce.reduce.shuffle.merge.percent</code></td><td><code>float</code></td><td><code>0.66</code></td><td><code>map</code> è¾“å‡ºç¼“å†²åŒºçš„é˜ˆå€¼ä½¿ç”¨æ¯”ä¾‹ï¼Œç”¨äºå¯åŠ¨åˆå¹¶è¾“å‡ºå’Œç£ç›˜æº¢å‡ºå†™çš„è¿‡ç¨‹</td></tr><tr><td><code>mapreduce.reduce.merge.inmen.threshold</code></td><td><code>int</code></td><td><code>1000</code></td><td>å¯åŠ¨åˆå¹¶è¾“å‡ºå’Œç£ç›˜æº¢å‡ºå†™è¿‡ç¨‹çš„ <code>map</code> è¾“å‡ºçš„é˜ˆå€¼æ•°ï¼Œ<code>0</code> æˆ–è€…æ›´å°çš„æ•°æ„å‘³è€…æ²¡æœ‰é˜ˆå€¼é™åˆ¶</td></tr><tr><td><code>mapreduce.reduce.input.buffer.percent</code></td><td><code>float</code></td><td><code>0.0</code></td><td><code>reduce</code> è¿‡ç¨‹ä¸­åœ¨å†…å­˜ä¸­ä¿å­˜ <code>map</code> è¾“å‡ºçš„ç©ºé—´å æ•´ä¸ªå †ç©ºé—´çš„æ¯”ä¾‹ã€‚</td></tr></tbody></table></li></ol><hr><h3 id="ç‰¹æ€§"><a href="#ç‰¹æ€§" class="headerlink" title="ç‰¹æ€§"></a>ç‰¹æ€§</h3><h4 id="è®¡æ•°å™¨"><a href="#è®¡æ•°å™¨" class="headerlink" title="è®¡æ•°å™¨"></a>è®¡æ•°å™¨</h4><p>è®¡æ•°å™¨æ˜¯æ”¶é›†ä½œä¸šç»Ÿè®¡ä¿¡æ¯çš„æœ‰æ•ˆæ‰‹æ®µä¹‹ä¸€ï¼Œç”¨äºè´¨é‡æ§åˆ¶å’Œåº”ç”¨çº§ç»Ÿè®¡ï¼Œå¦å¤–è®¡æ•°å™¨è¿˜å¯ä»¥è¾…åŠ©è¯Šæ–­ç³»ç»Ÿæ•…éšœã€‚</p><h5 id="å†…ç½®è®¡æ•°å™¨"><a href="#å†…ç½®è®¡æ•°å™¨" class="headerlink" title="å†…ç½®è®¡æ•°å™¨"></a>å†…ç½®è®¡æ•°å™¨</h5><p><code>Hadoop</code> ä¸ºæ¯ä¸ªä½œä¸šç»´æŠ¤è‹¥å¹²ä¸ªå†…ç½®è®¡æ•°å™¨ï¼Œä»¥æè¿°å¤šé¡¹æŒ‡æ ‡ã€‚</p><table><thead><tr><th>ç»„åˆ«</th><th>åç§°&#x2F;ç±»åˆ«</th></tr></thead><tbody><tr><td><code>MapReduce</code> è®¡æ•°å™¨</td><td><code>org.apache.hadoop.mapreduce.TaskCounter</code></td></tr><tr><td>æ–‡ä»¶ç³»ç»Ÿè®¡æ•°å™¨</td><td><code>org.apache.hadoop.mapreduce.FileSystemCounter</code></td></tr><tr><td><code>FileInputFormat</code> è®¡æ•°å™¨</td><td><code>org.apache.hadoop.mapreduce.lib.input.FileInputFormatCounter</code></td></tr><tr><td><code>FileOutputFormat</code> è®¡æ•°å™¨</td><td><code>org.apache.hadoop.mapreduce.lib.output.FileOutputFormatCounter</code></td></tr><tr><td>ä½œä¸šè®¡æ•°å™¨</td><td><code>org.apache.hadoop.mapreduce.JobCounter</code></td></tr></tbody></table><p>è¿™äº›è®¡æ•°å™¨è¢«åˆ’åˆ†ä¸ºè‹¥å¹²ç»„ï¼Œå„ç»„è¦ä¹ˆåŒ…å«ä»»åŠ¡è®¡æ•°å™¨ï¼ˆåœ¨ä»»åŠ¡å¤„ç†è¿‡ç¨‹ä¸­ä¸æ–­æ›´æ–°ï¼‰ï¼Œè¦ä¹ˆåŒ…å«ä½œä¸šè®¡æ•°å™¨ï¼ˆåœ¨ä½œä¸šå¤„ç†è¿‡ç¨‹ä¸­ä¸æ–­æ›´æ–°ï¼‰ã€‚</p><h5 id="Java-è‡ªå®šä¹‰è®¡æ•°å™¨"><a href="#Java-è‡ªå®šä¹‰è®¡æ•°å™¨" class="headerlink" title="Java è‡ªå®šä¹‰è®¡æ•°å™¨"></a><code>Java</code> è‡ªå®šä¹‰è®¡æ•°å™¨</h5><p><code>MapReduce</code> å…è®¸ç”¨æˆ·ç¼–å†™ç¨‹åºæ¥å®šä¹‰è®¡æ•°å™¨ï¼Œè®¡æ•°å™¨çš„å€¼å¯ä»¥åœ¨ <code>mapper</code> æˆ– <code>reducer</code> ä¸­å¢åŠ ï¼Œ<strong>è®¡æ•°å™¨ç”±ä¸€ä¸ª <code>Java</code> æšä¸¾ç±»å‹æ¥å®šä¹‰</strong>ï¼Œä»¥ä¾¿å¯¹æœ‰å…³çš„è®¡æ•°å™¨åˆ†ç»„ã€‚<br>ä¸€ä¸ªä½œä¸šå¯ä»¥å®šä¹‰çš„æšä¸¾ç±»å‹æ•°é‡ä¸é™ï¼Œå„ä¸ªæšä¸¾ç±»å‹æ‰€åŒ…å«çš„å­—æ®µæ•°é‡ä¹Ÿä¸é™ã€‚æšä¸¾ç±»å‹çš„åç§°å³ä¸ºç»„çš„åç§°ï¼Œæšä¸¾ç±»å‹çš„å­—æ®µå°±æ˜¯è®¡æ•°å™¨åç§°ï¼Œè®¡æ•°å™¨æ˜¯å…¨å±€çš„ã€‚æ¢è¨€ä¹‹ï¼Œ<code>MapReduce</code> æ¡†æ¶å°†è·¨æ‰€æœ‰ <code>map</code> å’Œ <code>reduce</code> èšé›†è¿™äº›è®¡æ•°å™¨ï¼Œå¹¶åœ¨ä½œä¸šç»“æŸæ—¶äº§ç”Ÿä¸€ä¸ªæœ€ç»ˆç»“æœã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®šä¹‰</span></span><br><span class="line"><span class="keyword">enum</span> <span class="title class_">Tem</span> &#123;</span><br><span class="line">MISSING,</span><br><span class="line">MALFORMED</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ä½¿ç”¨</span></span><br><span class="line">context.getCounter(Tem.MISSING).increment(<span class="number">1</span>);</span><br></pre></td></tr></table></figure><h4 id="æ’åº"><a href="#æ’åº" class="headerlink" title="æ’åº"></a>æ’åº</h4><p>æ’åºæ˜¯ <code>MapReduce</code> çš„æ ¸å¿ƒï¼Œ<code>MapReduce</code> ä½¿ç”¨æ’åºæ¥ç»„ç»‡æ•°æ®ï¼Œè€Œæ’åºä¹Ÿåˆ†ä¸ºä¸åŒçš„æ•°æ®é›†æ’åºæ–¹å¼ã€‚</p><h5 id="éƒ¨åˆ†æ’åº"><a href="#éƒ¨åˆ†æ’åº" class="headerlink" title="éƒ¨åˆ†æ’åº"></a>éƒ¨åˆ†æ’åº</h5><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œ<code>MapReduce</code> ä¼šæ ¹æ®è¾“å…¥è®°å½•çš„é”®å¯¹æ•°æ®é›†æ’åºã€‚</p><h5 id="å…¨æ’åº"><a href="#å…¨æ’åº" class="headerlink" title="å…¨æ’åº"></a>å…¨æ’åº</h5><p>å¦‚ä½•ç”Ÿæˆä¸€ä¸ªå…¨å±€æ’åºçš„æ–‡ä»¶å‘¢ï¼Ÿ<br>æœ€ç®€å•çš„æ–¹æ³•å°±æ˜¯ï¼Œé¦–å…ˆåˆ›å»ºä¸€ç³»åˆ—æ’åºå¥½çš„æ–‡ä»¶ï¼›å…¶æ¬¡ä¸²è”è¿™äº›æ–‡ä»¶ï¼›æœ€åç”Ÿæˆä¸€ä¸ªå…¨å±€æ’åºçš„æ–‡ä»¶ã€‚å…¶ä¸»è¦æ€è·¯å°±æ˜¯ä½¿ç”¨ä¸€ä¸ª <code>patitioner</code> æ¥æè¿°è¾“å‡ºçš„å…¨å±€æ’åºã€‚</p><p>è¯¥æ–¹æ³•çš„å…³é”®ç‚¹åœ¨äºå¦‚ä½•åˆ’åˆ†å„ä¸ªåˆ†åŒºã€‚åœ¨ç†æƒ³æƒ…å†µä¸‹ï¼Œå„åˆ†åŒºæ‰€åŒ…å«çš„è®°å½•æ•°åº”å¤§è‡´ç›¸ç­‰ã€‚ä½¿ä½œä¸šçš„æ€»ä½“æ‰§è¡Œæ—¶é—´ä¸ä¼šå—åˆ¶äºä¸ªåˆ« <code>reducer</code>ã€‚</p><h5 id="è¾…åŠ©æ’åº"><a href="#è¾…åŠ©æ’åº" class="headerlink" title="è¾…åŠ©æ’åº"></a>è¾…åŠ©æ’åº</h5><p>é€šè¿‡ç‰¹å®šçš„æ–¹æ³•å¯¹é”®è¿›è¡Œæ’åºå’Œåˆ†ç»„ä»¥å®ç°å¯¹å€¼çš„æ’åºã€‚<br>é€šè¿‡è®¾ç½®ä¸€ä¸ªæŒ‰ç…§é”®è¿›è¡Œåˆ†åŒºçš„ <code>patitioner</code>ï¼Œè¿™æ ·å¯ä»¥ç¡®ä¿ç›¸åŒ <code>patitioner</code> çš„è®°å½•ä¼šè¢«å‘é€åˆ°åŒä¸€ä¸ª <code>reducer</code> ä¸­ï¼Œè€Œåœ¨åŒä¸€ä¸ªåˆ†åŒºä¸­ï¼Œä»ç„¶å¯ä»¥é€šè¿‡é”®è¿›è¡Œåˆ†ç»„ã€‚</p><p>æŒ‰å€¼æ’åºçš„æ–¹æ³•æ€»ç»“ï¼š</p><ul><li>å®šä¹‰åŒ…æ‹¬è‡ªç„¶é”®å’Œè‡ªç„¶å€¼çš„ç»„åˆé”®ã€‚</li><li>æ ¹æ®ç»„åˆé”®å¯¹è®°å½•è¿›è¡Œæ’åºï¼Œå³åŒæ—¶ç”¨è‡ªç„¶é”®å’Œè‡ªç„¶å€¼è¿›è¡Œæ’åºã€‚</li><li>é’ˆå¯¹ç»„åˆé”®è¿›è¡Œåˆ†åŒºå’Œåˆ†ç»„æ—¶å‡åªè€ƒè™‘è‡ªç„¶é”®ã€‚</li></ul><h4 id="è¾¹æ•°æ®"><a href="#è¾¹æ•°æ®" class="headerlink" title="è¾¹æ•°æ®"></a>è¾¹æ•°æ®</h4><p><strong>è¾¹æ•°æ®ï¼ˆ<code>side data</code>ï¼‰æ˜¯ä½œä¸šæ‰€éœ€çš„é¢å¤–çš„åªè¯»æ•°æ®ï¼Œä»¥è¾…åŠ©å¤„ç†ä¸»æ•°æ®é›†</strong> ã€‚å…¶æ‰€é¢ä¸´çš„æŒ‘æˆ˜åœ¨äºå¦‚ä½•ä½¿æ‰€æœ‰ <code>map</code> æˆ– <code>reduce</code> ä»»åŠ¡ï¼ˆæ•£å¸ƒåœ¨é›†ç¾¤å†…ä¸ï¼‰éƒ½èƒ½å¤Ÿæ–¹ä¾¿è€Œé«˜æ•ˆåœ°ä½¿ç”¨è¾¹æ•°æ®ã€‚</p><p><code>Hadoop</code> çš„åˆ†å¸ƒå¼ç¼“å­˜æœºåˆ¶èƒ½å¤Ÿåœ¨ä»»åŠ¡è¿è¡Œè¿‡ç¨‹ä¸­åŠæ—¶åœ°å°†æ–‡ä»¶å’Œå­˜æ¡£å¤åˆ¶åˆ°ä»»åŠ¡èŠ‚ç‚¹ä»¥ä¾›ä½¿ç”¨ï¼Œä¸è¿‡ä¸ºäº†èŠ‚çº¦ç½‘ç»œå¸¦å®½ï¼Œåœ¨æ¯ä¸€ä¸ªä½œä¸šä¸­ï¼Œå„ä¸ªæ–‡ä»¶é€šå¸¸åªéœ€è¦å¤åˆ¶åˆ°ä¸€ä¸ªèŠ‚ç‚¹ä¸€æ¬¡ã€‚<br>å¯¹äºä½¿ç”¨ <code>GenericOptionsParser</code> çš„å·¥å…·æ¥è¯´ï¼Œç”¨æˆ·å¯ä»¥ä½¿ç”¨ <code>-files</code> é€‰é¡¹æŒ‡å®šå¾…åˆ†å‘çš„æ–‡ä»¶ï¼Œæ–‡ä»¶å†…åŒ…å«ä»¥é€—å·éš”å¼€çš„ <code>URI</code> åˆ—è¡¨ï¼Œå¦‚æœæ²¡æœ‰æŒ‡å®šæ–‡ä»¶ç³»ç»Ÿï¼Œåˆ™è¿™äº›æ–‡ä»¶ä¼šè¢«é»˜è®¤ä¸ºæœ¬åœ°æ–‡ä»¶ã€‚<code>-archives</code> é€‰é¡¹å¯ä»¥å‘è‡ªå·±çš„ä»»åŠ¡ä¸­å¤åˆ¶å­˜æ¡£æ–‡ä»¶ï¼ˆ<code>JAR</code> æ–‡ä»¶ã€<code>ZIP</code> æ–‡ä»¶ã€<code>tar</code> æ–‡ä»¶å’Œ <code>gzipped tar</code> æ–‡ä»¶ï¼‰ï¼Œè¿™äº›æ–‡ä»¶ä¼šè¢«è§£æ¡£åˆ°ä»»åŠ¡èŠ‚ç‚¹ã€‚<code>-libjars</code> é€‰é¡¹ä¼šæŠŠ <code>JAR</code> æ–‡ä»¶æ·»åŠ åˆ° <code>mapper</code> å’Œ <code>reducer</code> ä»»åŠ¡çš„ç±»è·¯å¾„ä¸­ã€‚</p><hr><h3 id="å¼•ç”¨"><a href="#å¼•ç”¨" class="headerlink" title="å¼•ç”¨"></a>å¼•ç”¨</h3><hr><h3 id="ä¸ªäººå¤‡æ³¨"><a href="#ä¸ªäººå¤‡æ³¨" class="headerlink" title="ä¸ªäººå¤‡æ³¨"></a>ä¸ªäººå¤‡æ³¨</h3><p><strong>æ­¤åšå®¢å†…å®¹å‡ä¸ºä½œè€…å­¦ä¹ æ‰€åšç¬”è®°ï¼Œä¾µåˆ ï¼</strong><br><strong>è‹¥è½¬ä½œå…¶ä»–ç”¨é€”ï¼Œè¯·æ³¨æ˜æ¥æºï¼</strong></p>]]></content>
    
    
    <summary type="html">&lt;h3 id=&quot;åŸºç¡€&quot;&gt;&lt;a href=&quot;#åŸºç¡€&quot; class=&quot;headerlink&quot; title=&quot;åŸºç¡€&quot;&gt;&lt;/a&gt;åŸºç¡€&lt;/h3&gt;&lt;p&gt;&lt;code&gt;MapReduce&lt;/code&gt; æ˜¯ä¸€ç§ç”¨äº&lt;strong&gt;æ•°æ®å¤„ç†çš„ç¼–ç¨‹æ¨¡å‹&lt;/strong&gt;ï¼Œå…¶æœ¬è´¨æ˜¯&lt;strong&gt;å¹¶è¡Œè¿è¡Œ&lt;/strong&gt;ï¼Œå› æ­¤å¯ä»¥å°†å¤§è§„æ¨¡çš„æ•°æ®åˆ†æä»»åŠ¡åˆ†å‘ç»™ä»»ä½•ä¸€ä¸ªæ‹¥æœ‰è¶³å¤Ÿå¤šæœºå™¨çš„æ•°æ®ä¸­å¿ƒï¼Œå½“ç„¶å…¶ä¼˜åŠ¿ä¹Ÿæ˜¯&lt;strong&gt;å¤„ç†å¤§è§„æ¨¡æ•°æ®é›†&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;MapReduce&lt;/code&gt; ä»»åŠ¡è¿‡ç¨‹åˆ†ä¸ºä¸¤ä¸ªå¤„ç†é˜¶æ®µï¼š &lt;strong&gt;&lt;code&gt;map&lt;/code&gt; é˜¶æ®µ&lt;/strong&gt;å’Œ &lt;strong&gt;&lt;code&gt;reduce&lt;/code&gt; é˜¶æ®µ&lt;/strong&gt;ã€‚æ¯ä¸ªé˜¶æ®µéƒ½æ˜¯ä»¥&lt;strong&gt;é”®å€¼å¯¹&lt;/strong&gt;ä½œä¸ºè¾“å…¥å’Œè¾“å‡ºï¼Œå…¶ç±»å‹ç”±å¼€å‘è€…å†³å®šï¼Œå½“ç„¶ &lt;code&gt;map&lt;/code&gt; å‡½æ•°å’Œ &lt;code&gt;reduce&lt;/code&gt; å‡½æ•°ä¹Ÿæ˜¯ç”±å¼€å‘è€…å®ç°ã€‚&lt;/p&gt;</summary>
    
    
    
    
    <category term="Hadoop" scheme="https://blog.vgbhfive.cn/tags/Hadoop/"/>
    
  </entry>
  
  <entry>
    <title>Lombok-constructor is already defined</title>
    <link href="https://blog.vgbhfive.cn/Lombok-constructor-is-already-defined/"/>
    <id>https://blog.vgbhfive.cn/Lombok-constructor-is-already-defined/</id>
    <published>2023-02-14T13:42:33.000Z</published>
    <updated>2023-02-14T13:53:36.000Z</updated>
    
    <content type="html"><![CDATA[<h3 id="å¼•å…¥"><a href="#å¼•å…¥" class="headerlink" title="å¼•å…¥"></a>å¼•å…¥</h3><p>ä»Šå¤©å·¥ä½œçš„æ—¶å€™å†™äº†è¿™ä¹ˆä¸€æ®µä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Getter</span></span><br><span class="line"><span class="meta">@Setter</span></span><br><span class="line"><span class="meta">@ToString</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ObjectA</span> &#123;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><span id="more"></span><p>æ¥ä¸‹æ¥å°±æ˜¯ä¸€ç³»åˆ—çš„ä¸Šä¼ ä»£ç ã€å‘ç‰ˆã€æ‰“åŒ…â€¦..ï¼Œç„¶åå°±å‡ºç°äº†ç¥å¥‡çš„å¼‚å¸¸ä¿¡æ¯ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">constructor <span class="title function_">ObjectA</span><span class="params">()</span> is already defined in ObjectA</span><br></pre></td></tr></table></figure><p>å›å¤´å»çœ‹ä»£ç ï¼Œè¿™çœŸæ˜¯è®©äººç™¾æ€ä¸å¾—å…¶è§£å•Š</p><hr><h3 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h3><ol><li><p>æ— å¼•ç”¨å³åˆ é™¤è¯¥ç±»<br>è¯¥ç±»å†…éƒ¨æ— ä»»ä½•å±æ€§ï¼Œå³å¯è®¤ä¸ºæ— ç”¨ï¼Œå†åˆ¤æ–­æ²¡æœ‰ä»»ä½•å¼•ç”¨ï¼Œæœ€ç»ˆåˆ é™¤æ‰è¿™ä¸ªç±»å°±å¯ä»¥äº†ã€‚</p></li><li><p>è¯¥ç±»å·²è¢«å¼•ç”¨ä½†æ— å±æ€§<br>åˆ†æå¼‚å¸¸å‡ºç°çš„åŸå› å³å¯ä»¥åˆ¤æ–­ä¸º <code>@NoArgsConstructor</code> ä¸ <code>@AllArgsConstructor</code> æ³¨è§£ç”Ÿæˆçš„æ„é€ å¯¹è±¡å‡½æ•°å› ä¸ºè¯¥å¯¹è±¡æ— å±æ€§å¯¼è‡´é‡åå†²çªï¼Œé‚£ä¹ˆåˆ é™¤å…¶ä¸­ä¸€ä¸ªæ³¨è§£å³å¯è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p></li></ol><hr><h3 id="å¼•ç”¨"><a href="#å¼•ç”¨" class="headerlink" title="å¼•ç”¨"></a>å¼•ç”¨</h3><hr><h3 id="ä¸ªäººå¤‡æ³¨"><a href="#ä¸ªäººå¤‡æ³¨" class="headerlink" title="ä¸ªäººå¤‡æ³¨"></a>ä¸ªäººå¤‡æ³¨</h3><p><strong>æ­¤åšå®¢å†…å®¹å‡ä¸ºä½œè€…å­¦ä¹ æ‰€åšç¬”è®°ï¼Œä¾µåˆ ï¼</strong><br><strong>è‹¥è½¬ä½œå…¶ä»–ç”¨é€”ï¼Œè¯·æ³¨æ˜æ¥æºï¼</strong></p>]]></content>
    
    
    <summary type="html">&lt;h3 id=&quot;å¼•å…¥&quot;&gt;&lt;a href=&quot;#å¼•å…¥&quot; class=&quot;headerlink&quot; title=&quot;å¼•å…¥&quot;&gt;&lt;/a&gt;å¼•å…¥&lt;/h3&gt;&lt;p&gt;ä»Šå¤©å·¥ä½œçš„æ—¶å€™å†™äº†è¿™ä¹ˆä¸€æ®µä»£ç ï¼š&lt;/p&gt;
&lt;figure class=&quot;highlight java&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;@Getter&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;@Setter&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;@ToString&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;@NoArgsConstructor&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;@AllArgsConstructor&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title class_&quot;&gt;ObjectA&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;</summary>
    
    
    
    
    <category term="Day" scheme="https://blog.vgbhfive.cn/tags/Day/"/>
    
    <category term="Spring Boot" scheme="https://blog.vgbhfive.cn/tags/Spring-Boot/"/>
    
  </entry>
  
  <entry>
    <title>Hadoop-HDFS</title>
    <link href="https://blog.vgbhfive.cn/Hadoop-HDFS/"/>
    <id>https://blog.vgbhfive.cn/Hadoop-HDFS/</id>
    <published>2023-02-04T08:02:34.000Z</published>
    <updated>2023-03-11T15:16:52.000Z</updated>
    
    <content type="html"><![CDATA[<h3 id="HDFS"><a href="#HDFS" class="headerlink" title="HDFS"></a><code>HDFS</code></h3><p>å½“æ•°æ®é›†çš„å¤§å°è¶…è¿‡ä¸€å°è®¡ç®—æœºçš„å­˜å‚¨ä¸Šé™æ—¶ï¼Œå°±æœ‰å¿…è¦å¯¹æ•°æ®è¿›è¡Œåˆ†åŒºç„¶åå­˜å‚¨åˆ°å…¶ä»–çš„è®¡ç®—æœºä¸Šã€‚ç®¡ç†ç½‘ç»œä¸­è·¨å¤šå°è®¡ç®—æœºå­˜å‚¨çš„æ–‡ä»¶ç³»ç»Ÿè¢«ç§°ä¸º<strong>åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿï¼ˆ<code>distributed filesystem</code>ï¼‰</strong>ï¼Œè¯¥æ¶æ„äºç½‘ç»œä¹‹ä¸Šï¼ŒåŠ¿å¿…ä¼šå¼•èµ·ç½‘ç»œç¼–ç¨‹çš„å¤æ‚æ€§ï¼Œå› æ­¤åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿæ¯”æ™®é€šç£ç›˜æ–‡ä»¶ç³»ç»Ÿæ›´ä¸ºå¤æ‚ã€‚<br><code>Hadoop</code> è‡ªå¸¦ä¸€ä¸ªç§°ä¸º <code>HDFS</code> çš„åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿï¼Œä¹Ÿæ˜¯ <code>Hadoop</code> çš„æ——èˆ°çº§æ–‡ä»¶ç³»ç»Ÿï¼Œå³ <code>Hadoop Distributed Filesystem</code>ã€‚</p><span id="more"></span><p><code>HDFS</code> ä»¥æµå¼æ•°æ®è®¿é—®æ¨¡å¼æ¥å­˜å‚¨è¶…å¤§æ–‡ä»¶ï¼Œè¿è¡Œäºå•†ä¸šç¡¬ä»¶é›†ç¾¤ä¸Šã€‚</p><ul><li><strong>è¶…å¤§æ–‡ä»¶</strong>ã€‚è¿™é‡ŒæŒ‡çš„æ˜¯å…·æœ‰å‡ ç™¾ <code>MB</code>ã€å‡ ç™¾ <code>GB</code>æˆ–è€…ä»¥ä¸Šå¤§å°çš„æ–‡ä»¶ã€‚</li><li><strong>æµå¼æ•°æ®è®¿é—®</strong>ã€‚<code>HDFS</code> é‡‡ç”¨çš„æ˜¯ä¸€æ¬¡å†™å…¥ã€å¤šæ¬¡è¯»å†™çš„é«˜æ•ˆè®¿é—®æ¨¡å¼ã€‚</li><li><strong>å•†ä¸šç¡¬ä»¶</strong>ã€‚è¿è¡Œäºå„ç§å•†ä¸šç¡¬ä»¶ä¸Šå³å¯ï¼Œä¸éœ€è¦ä¸“ä¸šçš„ç¡¬ä»¶ã€‚</li></ul><hr><h3 id="HDFS-ç›¸å…³æ¦‚å¿µ"><a href="#HDFS-ç›¸å…³æ¦‚å¿µ" class="headerlink" title="HDFS ç›¸å…³æ¦‚å¿µ"></a><code>HDFS</code> ç›¸å…³æ¦‚å¿µ</h3><h4 id="æ•°æ®å—"><a href="#æ•°æ®å—" class="headerlink" title="æ•°æ®å—"></a>æ•°æ®å—</h4><p>æ¯ä¸ªç£ç›˜éƒ½æœ‰é»˜è®¤çš„æ•°æ®å—å¤§å°ï¼Œè¿™æ˜¯ç£ç›˜è¿›è¡Œ<strong>æ•°æ®è¯»&#x2F;å†™çš„æœ€å°å•ä½</strong>ã€‚æ„å»ºäºå•ä¸ªç£ç›˜ä¹‹ä¸Šçš„æ–‡ä»¶ç³»ç»Ÿé€šè¿‡ç£ç›˜å—æ¥ç®¡ç†è¯¥æ–‡ä»¶ç³»ç»Ÿä¸­çš„å—ï¼Œè¯¥æ–‡ä»¶ç³»ç»Ÿå—çš„å¤§å°å¯ä»¥æ˜¯ç£ç›˜å—çš„æ•´æ•°å€ï¼Œæ–‡ä»¶ç³»ç»Ÿå—ä¸€èˆ¬ä¸ºå‡ åƒä¸ªå­—èŠ‚ï¼Œè€Œç£ç›˜å—ä¸€èˆ¬ä¸º <code>512</code> å­—èŠ‚ã€‚<br><code>HDFS</code> ä¹ŸåŒæ ·å­˜åœ¨ç±»ä¼¼<strong>å—ï¼ˆ<code>block</code>ï¼‰</strong>çš„æ¦‚å¿µï¼Œé»˜è®¤ä¸º <code>128MB</code>ã€‚ä¸å•ä¸€ç£ç›˜ä¸Šçš„æ–‡ä»¶ç³»ç»Ÿç±»ä¼¼ï¼Œ<code>HDFS</code> ä¸Šçš„æ–‡ä»¶ä¹Ÿä¼šè¢«åˆ’åˆ†ä¸ºå—å¤§å°çš„å¤šä¸ªåˆ†å—ï¼ˆ<code>chunk</code>ï¼‰ï¼Œä½œä¸ºç‹¬ç«‹çš„å­˜å‚¨å•å…ƒã€‚<br><small>ä¸å•ä¸€ç£ç›˜æ–‡ä»¶ç³»ç»Ÿä¸åŒä¹‹å¤„åœ¨äº <code>HDFS</code> ä¸­å°äºä¸€ä¸ªå—å¤§å°çš„æ–‡ä»¶ä¸ä¼šå æ®æ•´ä¸ªå—çš„ç©ºé—´ã€‚</small></p><p>é‚£ä¹ˆ <code>HDFS</code> ä¸­çš„å—ä¸ºä»€ä¹ˆè¿™ä¹ˆå¤§ï¼Ÿæœ‰ä½•å¥½å¤„ï¼Ÿ</p><ol><li><p><code>HDFS</code> ä¸­çš„å—æ¯”ç£ç›˜çš„å—å¤§ï¼Œå…¶ç›®çš„åœ¨äº<strong>æœ€å°åŒ–å¯»å€å¼€é”€</strong>ã€‚å¦‚æœå—è¶³å¤Ÿå¤§ï¼Œé‚£ä¹ˆä»ç£ç›˜ä¼ è¾“æ•°æ®çš„æ—¶é—´ä¼šæ˜æ˜¾å¤§äºå®šä½è¿™ä¸ªå—å¼€å§‹ä½ç½®æ‰€éœ€çš„æ—¶é—´ï¼Œå› æ­¤ä¼ è¾“ä¸€ä¸ªç”±å¤šä¸ªå—ç»„æˆçš„å¤§æ–‡ä»¶çš„æ—¶é—´å–å†³äºç£ç›˜ä¼ è¾“é€Ÿç‡ã€‚<br>é»˜è®¤çš„å—å¤§å°ä¸º <code>128MB</code>ï¼Œä½†æ˜¯å¾ˆå¤šæƒ…å†µä¸‹ <code>HDFS</code> å®‰è£…æ—¶ä¼šä½¿ç”¨æ›´å¤§çš„å—ï¼Œå¹¶ä¸”éšç€æ–°ä¸€ä»£ç£ç›˜é©±åŠ¨å™¨ä¼ è¾“é€Ÿç‡çš„æå‡ï¼Œå—çš„å¤§å°ä¼šè¢«è®¾ç½®çš„æ›´å¤§ã€‚ä½†æ˜¯è¿™ä¸ªå‚æ•°ä¹Ÿä¸èƒ½è¢«è®¾ç½®çš„å¤ªå¤§ï¼Œ<code>MapReduce</code> ä¸­çš„ <code>map</code> ä»»åŠ¡é€šå¸¸ä¸€æ¬¡åªå¤„ç†ä¸€ä¸ªå—ä¸­çš„æ•°æ®ï¼Œå› æ­¤å¦‚æœä»»åŠ¡æ•°å¤ªå°‘ï¼ˆå°äºé›†ç¾¤ä¸­çš„èŠ‚ç‚¹æ•°é‡ï¼‰ï¼Œä½œä¸šçš„è¿è¡Œé€Ÿåº¦å°±ä¼šå¾ˆæ…¢ã€‚</p></li><li><p>å¯¹åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿä¸­çš„å—è¿›è¡ŒæŠ½è±¡å¸¦æ¥çš„å¥½å¤„å¦‚ä¸‹ï¼š</p><ul><li>ä¸€ä¸ªæ–‡ä»¶çš„å¤§å°å¯ä»¥<strong>å¤§äºç½‘ç»œä¸­ä»»æ„ä¸€ä¸ªç£ç›˜çš„å®¹é‡</strong>ã€‚æ–‡ä»¶çš„æ‰€æœ‰å—å¹¶ä¸éœ€è¦å­˜å‚¨åœ¨åŒä¸€å—ç£ç›˜ä¸Šï¼Œå¯ä»¥åˆ©ç”¨é›†ç¾¤ä¸­ä»»æ„ä¸€ä¸ªç£ç›˜è¿›è¡Œå­˜å‚¨ã€‚</li><li>ä½¿ç”¨æŠ½è±¡å—è€Œéæ•´ä¸ªæ–‡ä»¶ä½œä¸ºå­˜å‚¨å•å…ƒï¼Œå¤§å¤§<strong>ç®€åŒ–å­˜å‚¨å­ç³»ç»Ÿçš„è®¾è®¡</strong>ã€‚å°†å­˜å‚¨å­ç³»ç»Ÿçš„å¤„ç†å¯¹è±¡è®¾ç½®ä¸ºå—ï¼Œå¯ç®€åŒ–å­˜å‚¨ç®¡ç†ï¼ˆå—å¤§å°å·²ç»å›ºå®šï¼Œå› æ­¤è®¡ç®—å­˜å‚¨å®¹é‡ç›¸å¯¹å®¹æ˜“ï¼‰ï¼ŒåŒæ—¶ä¹Ÿæ¶ˆé™¤äº†å¯¹å…ƒæ•°æ®çš„é¡¾è™‘ï¼ˆå—åªéœ€è¦å­˜å‚¨æ•°æ®å³å¯ï¼Œå¹¶ä¸éœ€è¦å­˜å‚¨æ–‡ä»¶çš„å…ƒæ•°æ®ï¼Œä¾‹å¦‚æƒé™ä¿¡æ¯ç­‰ï¼Œè¿™æ ·å…¶å®ƒç³»ç»Ÿå¯ä»¥å•ç‹¬ç®¡ç†è¿™äº›å…ƒæ•°æ®ï¼‰ã€‚</li><li>å—éå¸¸é€‚ç”¨äºæ•°æ®å¤‡ä»½è¿›è€Œæä¾›<strong>æ•°æ®å®¹é”™èƒ½åŠ›</strong>å’Œ<strong>æé«˜å¯ç”¨æ€§</strong>ã€‚</li></ul></li></ol><p><code>HDFS</code> ä¸­çš„ <code>fsck</code> æŒ‡ä»¤å¯ä»¥å±•ç¤ºå—ä¿¡æ¯ã€‚ç”¨æ³•ï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hdfs fsck / -files -blocks</span><br></pre></td></tr></table></figure><h4 id="namenode-å’Œ-datanode"><a href="#namenode-å’Œ-datanode" class="headerlink" title="namenode å’Œ datanode"></a><code>namenode</code> å’Œ <code>datanode</code></h4><p><code>HDFS</code> é›†ç¾¤ç”±ä¸¤ç±»èŠ‚ç‚¹ä»¥<strong>ç®¡ç†èŠ‚ç‚¹-å·¥ä½œèŠ‚ç‚¹æ¨¡å¼</strong>è¿è¡Œï¼Œå³<strong>ä¸€ä¸ª <code>namenode</code>ï¼ˆç®¡ç†èŠ‚ç‚¹ï¼‰</strong>å’Œ<strong>å¤šä¸ª <code>datanode</code>ï¼ˆå·¥ä½œèŠ‚ç‚¹ï¼‰</strong>ã€‚</p><p><code>namenode</code> ç®¡ç†æ–‡ä»¶ç³»ç»Ÿçš„å‘½åç©ºé—´ï¼Œä»–ç»´æŠ¤ç€æ–‡ä»¶ç³»ç»Ÿæ ‘åŠæ•´é¢—æ ‘å†…æ‰€æœ‰çš„æ–‡ä»¶å’Œç›®å½•ï¼Œè¿™äº›ä¿¡æ¯ä»¥ä¸¤ä¸ªæ–‡ä»¶å½¢å¼æ°¸ä¹…ä¿å­˜åœ¨æœ¬åœ°ç£ç›˜ä¸Šï¼š<strong>å‘½åç©ºé—´é•œåƒæ–‡ä»¶</strong>å’Œ<strong>ç¼–è¾‘æ—¥å¿—æ–‡ä»¶</strong>ã€‚åŒæ—¶ <code>namenode</code> ä¹Ÿè´Ÿè´£è®°å½•æ¯ä¸ªæ–‡ä»¶ä¸­å„ä¸ªå—æ‰€åœ¨çš„èŠ‚ç‚¹ä¿¡æ¯ï¼Œä½†æ˜¯å¹¶ä¸ä¼šæ°¸ä¹…ä¿å­˜å—çš„ä½ç½®ä¿¡æ¯ï¼Œå› ä¸ºè¿™äº›ä¿¡æ¯ä¼šåœ¨ç³»ç»Ÿå¯åŠ¨æ—¶æ ¹æ®æ•°æ®èŠ‚ç‚¹ä¿¡æ¯é‡å»ºã€‚<br><code>datanode</code> æ˜¯æ–‡ä»¶ç³»ç»Ÿçš„å·¥ä½œèŠ‚ç‚¹ï¼Œæ ¹æ®éœ€è¦<strong>å­˜å‚¨å¹¶æ£€ç´¢æ•°æ®å—</strong>ï¼ˆå—å®¢æˆ·ç«¯æˆ–è€… <code>namenode</code> è°ƒåº¦ï¼‰ï¼Œå¹¶ä¸”è¿˜éœ€è¦å®šæœŸå‘ <code>namenode</code> å‘é€æ‰€å­˜å‚¨å—çš„åˆ—è¡¨å’Œå¿ƒè·³è¯·æ±‚ã€‚<br>å®¢æˆ·ç«¯ä»£è¡¨ç”¨æˆ·é€šè¿‡ä¸ <code>namenode</code> å’Œ <code>datanode</code> äº¤äº’æ¥è®¿é—®æ•´ä¸ªæ–‡ä»¶ç³»ç»Ÿï¼Œå®¢æˆ·ç«¯é€šè¿‡æä¾›ä¸€ä¸ª<strong>ç±»ä¼¼äº <code>POSIX</code> çš„æ–‡ä»¶ç³»ç»Ÿæ¥å£</strong>æ¥å®ç°åŠŸèƒ½ï¼Œè€Œä¸éœ€è¦çŸ¥é“ <code>namenode</code> å’Œ <code>datanode</code> çš„å­˜åœ¨ã€‚</p><p>ç»†å¿ƒçš„äººä¼šå‘ç°<strong>ä¸€ä¸ª <code>namenode</code> ä¸ä¼šå­˜åœ¨å•ç‚¹æ•…éšœ</strong>å—ï¼Ÿé‚£ä¹ˆ <code>Hadoop</code> æä¾›äº†ä¸¤ç§æœºåˆ¶ï¼š</p><ul><li><strong>å¤‡ä»½ç»„æˆæ–‡ä»¶ç³»ç»Ÿå…ƒæ•°æ®æŒä¹…çŠ¶æ€çš„æ–‡ä»¶</strong>ã€‚<code>Hadoop</code> å¯ä»¥é€šè¿‡é…ç½®ä½¿ <code>namenode</code> åœ¨å¤šä¸ªæ–‡ä»¶ç³»ç»Ÿä¸Šä¿å­˜å…ƒæ•°æ®çš„æŒä¹…çŠ¶æ€ï¼Œè¿™äº›å†™æ“ä½œéƒ½æ˜¯å®æ—¶åŒæ­¥çš„ï¼Œå¹¶ä¸”è¿˜æ˜¯åŸå­æ“ä½œã€‚ä¸€èˆ¬çš„é…ç½®éƒ½æ˜¯åœ¨æŒä¹…åŒ–æœ¬åœ°ç£ç›˜æ—¶åŒæ—¶å†™å…¥è¿œç¨‹æŒ‚è½½çš„ç½‘ç»œæ–‡ä»¶ç³»ç»Ÿï¼ˆ<code>NFS</code>ï¼‰ã€‚</li><li><strong>è¿è¡Œä¸€ä¸ªè¾…åŠ© <code>namenode</code>ï¼Œ</strong>ä½†æ˜¯ä»–ä¸èƒ½è¢«ç”¨ä½œ <code>namenode</code>ã€‚è¿™ä¸ªè¾…åŠ© <code>namenode</code> çš„ä½œç”¨åœ¨äº<strong>å®šæœŸ</strong>åˆå¹¶ç¼–è¾‘æ—¥å¿—ä¸å‘½åç©ºé—´é•œåƒï¼Œä»¥é˜²æ­¢é•œåƒæ—¥å¿—è¿‡å¤§ã€‚å¦å¤–è¾…åŠ© <code>namenode</code> é€šå¸¸éƒ¨ç½²åœ¨å¦å¤–ä¸€å°æœºå™¨ä¸Šï¼Œéœ€è¦å ç”¨å¤§é‡ <code>CPU</code> æ—¶é—´å’Œå†…å­˜æ¥æ‰§è¡Œåˆå¹¶æ“ä½œã€‚ç”±äºè¾…åŠ© <code>namenode</code> æ˜¯å®šæœŸåŒæ­¥ä¸»èŠ‚ç‚¹ <code>namenode</code>ï¼Œå› æ­¤ä¼šå­˜åœ¨ä¿å­˜çš„çŠ¶æ€æ»åäºä¸»èŠ‚ç‚¹ï¼Œéš¾å…ä¼šä¸¢å¤±éƒ¨åˆ†æ•°æ®ï¼Œè¿™ç§æƒ…å†µä¸‹éƒ½æ˜¯å°†è¿œç¨‹æŒ‚è½½çš„ <code>NFS</code> å¤åˆ¶åˆ°è¾…åŠ© <code>namenode</code> ä½œä¸ºæ–°çš„ä¸»èŠ‚ç‚¹ <code>namenode</code> è¿è¡Œã€‚</li></ul><h4 id="å—ç¼“å­˜"><a href="#å—ç¼“å­˜" class="headerlink" title="å—ç¼“å­˜"></a>å—ç¼“å­˜</h4><p>é€šå¸¸ <code>datanode</code> ä»ç£ç›˜ä¸­è¯»å–å—ï¼Œä½†æ˜¯å¯¹äºé¢‘ç¹è®¿é—®çš„å—ï¼Œè¯¥å—å¯èƒ½ä¼šè¢«æ˜¾å¼åœ°å­˜å‚¨åœ¨ <code>datanode</code> çš„å†…å­˜ä¸­ï¼Œä»¥<strong>å †å¤–ç¼“å­˜ï¼ˆ<code>off-heap block cache</code>ï¼‰</strong>çš„å½¢å¼å­˜åœ¨ã€‚é»˜è®¤æƒ…å†µä¸‹ä¸€ä¸ªå—ä»…ç¼“å­˜åœ¨ä¸€ä¸ª <code>datanode</code> çš„å†…å­˜ä¸­ï¼ˆå¯ä»¥é’ˆå¯¹æ–‡ä»¶ä¿®æ”¹ <code>datanode</code> çš„æ•°é‡ï¼‰ã€‚</p><p>é€šè¿‡<strong>å—ç¼“å­˜</strong>ä½œä¸šè°ƒåº¦å™¨åœ¨ç¼“å­˜å—çš„ <code>datanode</code> ä¸Šæ‰§è¡Œä»»åŠ¡ï¼Œå¯ä»¥æé«˜è¯»æ“ä½œçš„æ€§èƒ½ã€‚å½“ç„¶ç”¨æˆ·å¯ä»¥é€šè¿‡åœ¨ç¼“å­˜æ± ï¼ˆ<code>cache pool</code>ï¼‰ä¸­å¢åŠ ä¸€ä¸ª <code>cache directive</code> æ¥å‘Šè¯‰ <code>namenode</code> éœ€è¦ç¼“å­˜å“ªäº›æ–‡ä»¶ç¼“å­˜å¤šä¹…ã€‚<br><small>ç¼“å­˜æ± æ˜¯ä¸€ä¸ªç”¨äºç®¡ç†ç¼“å­˜æƒé™å’Œèµ„æºä½¿ç”¨çš„ç®¡ç†æ€§åˆ†ç»„ã€‚</small></p><h4 id="è”é‚¦-HDFS"><a href="#è”é‚¦-HDFS" class="headerlink" title="è”é‚¦ HDFS"></a>è”é‚¦ <code>HDFS</code></h4><p><code>namenode</code> åœ¨å†…å­˜ä¸­ä¿å­˜ç€æ–‡ä»¶ç³»ç»Ÿä¸­æ¯ä¸ªæ–‡ä»¶å’Œæ¯ä¸ªæ•°æ®å—çš„å¼•ç”¨å…³ç³»ï¼Œè¿™ä¹Ÿæ„å‘³ç€å¯¹äºä¸€ä¸ªè¶…å¤§é›†ç¾¤æ¥è¯´ï¼Œ<strong>å†…å­˜å°†æˆä¸ºé™åˆ¶ç³»ç»Ÿæ¨ªå‘æ‰©å±•çš„ç“¶é¢ˆ</strong>ã€‚ä¸è¿‡è”é‚¦ <code>HDFS</code> å…è®¸ç³»ç»Ÿé€šè¿‡æ·»åŠ å¤šä¸ª <code>namenode</code> æ¥å®ç°æ¨ªå‘æ‰©å±•ï¼Œå³æ¯ä¸ª <code>namenode</code> ç®¡ç†æ–‡ä»¶ç³»ç»Ÿå‘½åç©ºé—´ä¸­çš„ä¸€éƒ¨åˆ†ã€‚<br><small>ä¾‹å¦‚ <code>A</code> <code>namenode</code> è´Ÿè´£ç®¡ç† <code>/home/a</code> ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ï¼Œè€Œ <code>B</code> <code>namenode</code> è´Ÿè´£ç®¡ç† <code>/home/b</code> ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ã€‚</small></p><p>åœ¨è”é‚¦ç¯å¢ƒä¸‹<strong>æ¯ä¸ª <code>namenode</code> ç»´æŠ¤ä¸€ä¸ªå‘½åç©ºé—´å·ï¼ˆ<code>namespace volume</code>ï¼‰</strong>ï¼Œç”±<strong>å‘½åç©ºé—´çš„å…ƒæ•°æ®</strong>å’Œ<strong>ä¸€ä¸ªæ•°æ®å—æ± ï¼ˆ<code>block pool</code>ï¼‰</strong>ç»„æˆï¼Œæ•°æ®å—æ± åŒ…å«è¯¥å‘½åç©ºé—´ä¸‹æ–‡ä»¶çš„æ‰€æœ‰æ•°æ®å—ã€‚<br>å‘½åç©ºé—´å·ä¹‹é—´æ˜¯ç›¸äº’ç‹¬ç«‹çš„ï¼Œä¸¤ä¸¤ä¹‹é—´å¹¶ä¸ç›¸äº’é€šä¿¡ï¼Œç”šè‡³æŸä¸€ä¸ª <code>namenode</code> å¤±æ•ˆä¹Ÿä¸ä¼šå½±å“åˆ°å…¶ä»– <code>namenode</code> çš„å¯ç”¨æ€§ï¼›å¦å¤–å‘½åç©ºé—´å·ä¸‹çš„æ•°æ®å—æ± ä¸èƒ½å†åˆ‡åˆ†ï¼Œè¿™å°±æ„å‘³ç€é›†ç¾¤ä¸­çš„ <code>datanode</code> éœ€è¦æ³¨å†Œåˆ°æ¯ä¸ª <code>namenode</code> ä¸­ï¼Œ<code>namenode</code> å­˜å‚¨æ¥è‡ªå¤šä¸ªæ•°æ®å—æ± ä¸­çš„æ•°æ®å—ã€‚</p><p>å®¢æˆ·ç«¯é€šè¿‡ä½¿ç”¨<strong>æŒ‚è½½æ•°æ®è¡¨å°†æ–‡ä»¶è·¯å¾„æ˜ å°„åˆ° <code>namenode</code></strong> æ¥è®¿é—®è”é‚¦ <code>HDFS</code>ï¼Œé€šè¿‡ <code>ViewFileSystem</code> å’Œ <code>viewfa://URI</code> è¿›è¡Œé…ç½®å’Œç®¡ç†ã€‚ </p><h4 id="é«˜å¯ç”¨æ€§"><a href="#é«˜å¯ç”¨æ€§" class="headerlink" title="é«˜å¯ç”¨æ€§"></a>é«˜å¯ç”¨æ€§</h4><p>é€šè¿‡è”åˆä½¿ç”¨åœ¨å¤šä¸ªæ–‡ä»¶ç³»ç»Ÿä¸­å¤‡ä»½ <code>namenode</code> çš„å…ƒæ•°æ®å’Œé€šè¿‡å¤‡ç”¨ <code>datanode</code> åˆ›å»ºç›‘æµ‹ç‚¹é˜²æ­¢æ•°æ®ä¸¢å¤±ï¼Œä½†è¿™ä¾ç„¶æ— æ³•è§£å†³æ–‡ä»¶ç³»ç»Ÿçš„é«˜å¯ç”¨æ€§ï¼Œ<code>namenode</code> ä¾ç„¶å­˜åœ¨<strong>å•ç‚¹å¤±æ•ˆï¼ˆ<code>SPOFï¼Œsingle point of failure</code>ï¼‰</strong>çš„é—®é¢˜ï¼Œå¦‚æœ <code>namenode</code> å¤±æ•ˆåˆ™ <code>MapReduce</code> ä½œä¸šå‡æ— æ³•è¯»ã€å†™æ–‡ä»¶ã€‚<br>åœ¨è¿™ç§æƒ…å†µä¸‹ä»ä¸€ä¸ªå¤±æ•ˆçš„ <code>namenode</code> æ¢å¤ï¼Œç®¡ç†å‘˜éœ€è¦å¯åŠ¨ä¸€ä¸ªæ‹¥æœ‰æ–‡ä»¶ç³»ç»Ÿå…ƒæ•°æ®å‰¯æœ¬çš„æ–°çš„ <code>namenode</code> ï¼Œå¹¶é…ç½® <code>datanode</code> å’Œå®¢æˆ·ç«¯ä»¥ä¾¿ä½¿ç”¨æ–°çš„ <code>namenode</code>ï¼Œè€Œæ–°çš„ <code>namenode</code> éœ€è¦è¾¾åˆ°ä»¥ä¸‹æƒ…å½¢æ‰èƒ½å“åº”æœåŠ¡ï¼š</p><ul><li><strong>å°†å‘½åç©ºé—´çš„é•œåƒå¯¼å…¥å†…å­˜ä¸­</strong>ã€‚</li><li><strong>é‡æ¼”ç¼–è¾‘æ—¥å¿—</strong>ã€‚</li><li><strong>æ¥æ”¶åˆ°è¶³å¤Ÿå¤šçš„æ¥è‡ª <code>datanode</code> çš„æ•°æ®å—æŠ¥å‘Šå¹¶é€€å‡ºå®‰å…¨æ¨¡å¼</strong>ã€‚</li></ul><p><small>å¯¹äºä¸€ä¸ªå¤§å‹é›†ç¾¤ <code>namenode</code> çš„å†·å¯åŠ¨éœ€è¦ <code>30</code> åˆ†é’Ÿä»¥ä¸Šï¼Œç”šè‡³æ›´ä¹…ã€‚</small></p><p>ä¸ºäº†è§£å†³ä¸Šè¿°é‡åˆ°çš„é—®é¢˜ï¼Œ<code>HDFS</code> æ”¯æŒåœ¨ <code>2.x</code> ç‰ˆæœ¬æ”¯æŒ<strong>é«˜å¯ç”¨æ€§</strong>ï¼Œå³é€šè¿‡é…ç½®ä¸€å¯¹<strong>æ´»åŠ¨-å¤‡ç”¨ï¼ˆ<code>active-standby</code>ï¼‰</strong><code>namenode</code>ã€‚å½“æ´»åŠ¨ <code>namenode</code> å¤±æ•ˆï¼Œå¤‡ç”¨ <code>namenode</code> ä¼šæ¥ç®¡å®ƒçš„ä»»åŠ¡å¹¶å¼€å§‹æœåŠ¡æ¥è‡ªå®¢æˆ·ç«¯çš„è¯·æ±‚ï¼Œä¸ä¼šæœ‰ä»»ä½•æ˜æ˜¾ä¸­æ–­ã€‚ä¸è¿‡è¦æ”¯æŒé«˜å¯ç”¨æ€§è¿˜éœ€è¦ä»¥ä¸‹å‡ ä¸ªæ–¹é¢çš„æ”¯æŒï¼š</p><ul><li><code>namenode</code> ä¹‹é—´é€šè¿‡<strong>é«˜å¯ç”¨æ€§å…±äº«å­˜å‚¨</strong>å®ç°ç¼–è¾‘æ—¥å¿—çš„å…±äº«ã€‚</li><li><code>datanode</code> éœ€è¦<strong>åŒæ—¶å‘ä¸¤ä¸ª <code>namenode</code> å‘é€æ•°æ®å—å¤„ç†æŠ¥å‘Š</strong>ã€‚</li><li>å®¢æˆ·ç«¯éœ€è¦ä½¿ç”¨<strong>ç‰¹å®šçš„æœºåˆ¶</strong>æ¥å¤„ç† <code>namenode</code> å¤±æ•ˆçš„é—®é¢˜ï¼Œä¸è¿‡è¯¥æœºåˆ¶å¯¹ç”¨æˆ·æ˜¯é€æ˜çš„ã€‚</li><li>è¾…åŠ© <code>namenode</code> çš„è§’è‰²è¢«å¤‡ç”¨ <code>namenode</code> æ‰€åŒ…å«ï¼Œå¤‡ç”¨ <code>namenode</code> ä¸ºæ´»åŠ¨ <code>namenode</code> å‘½ä»¤ç©ºé—´<strong>è®¾ç½®å‘¨æœŸæ€§æ£€æŸ¥ç‚¹</strong>ã€‚</li></ul><hr><h3 id="å‘½ä»¤è¡Œæ¥å£"><a href="#å‘½ä»¤è¡Œæ¥å£" class="headerlink" title="å‘½ä»¤è¡Œæ¥å£"></a>å‘½ä»¤è¡Œæ¥å£</h3><h4 id="å‘½ä»¤è¡Œ"><a href="#å‘½ä»¤è¡Œ" class="headerlink" title="å‘½ä»¤è¡Œ"></a>å‘½ä»¤è¡Œ</h4><p>ç°åœ¨é€šè¿‡å‘½ä»¤è¡Œäº¤äº’æ¥è¿›ä¸€æ­¥äº†è§£ <code>HDFS</code>ï¼Œåœ¨è®¾ç½®ä¼ªåˆ†å¸ƒé…ç½®æ—¶ï¼Œæœ‰ä¸¤ä¸ªå±æ€§éœ€è¦ç€é‡è¯´æ˜ï¼š</p><ul><li><code>fs.defaultFS</code>ï¼šè®¾ç½®ä¸º <code>hdfs://localhost/</code>ï¼Œç”¨äºè®¾ç½® <code>Hadoop</code> çš„é»˜è®¤æ–‡ä»¶ç³»ç»Ÿã€‚<br> <small>æ–‡ä»¶ç³»ç»Ÿç”± <code>URI</code> æŒ‡å®šï¼Œä½¿ç”¨ <code>hdfs URI</code> æ¥é…ç½® <code>HDFS</code> ä¸º <code>Hadoop</code> çš„é»˜è®¤æ–‡ä»¶ç³»ç»Ÿï¼Œ<code>HDFS</code> çš„å®ˆæŠ¤ç¨‹åºé€šè¿‡è¯¥å±æ€§é¡¹æ¥ç¡®å®š <code>HDFS namenode</code> çš„ä¸»æœºåŠç«¯å£ã€‚</small></li><li><code>dfs.replication</code>ï¼šé»˜è®¤å€¼ä¸º <code>3</code>ï¼Œä¿®æ”¹é…ç½®å€¼è®¾ç½®ä¸º <code>1</code>ï¼Œä¸ç„¶ä¼šå‡ºç°å‰¯æœ¬ä¸è¶³çš„è­¦å‘Šï¼Œå› ä¸º <code>HDFS</code> æ— æ³•å°†æ•°æ®å—å¤åˆ¶åˆ°ä¸‰ä¸ª <code>datanode</code> ä¸Šã€‚</li></ul><p>è‡³æ­¤æ–‡ä»¶ç³»ç»Ÿå·²ç»é…ç½®å®Œæ¯•ï¼Œæ¥ä¸‹æ¥å°±å¯ä»¥æ‰§è¡Œå¸¸è§çš„æ–‡ä»¶ç³»ç»Ÿæ“ä½œã€‚ï¼ˆç›¸å…³å‘½ä»¤è¡Œçš„å†…å®¹å¯ä»¥çœ‹å‰ä¸€ç¯‡æ–‡ç« ï¼‰</p><h5 id="æ–‡ä»¶è®¿é—®æƒé™"><a href="#æ–‡ä»¶è®¿é—®æƒé™" class="headerlink" title="æ–‡ä»¶è®¿é—®æƒé™"></a>æ–‡ä»¶è®¿é—®æƒé™</h5><p>é’ˆå¯¹æ–‡ä»¶å’Œç›®å½•ï¼Œ<code>HDFS</code> çš„æƒé™æ¨¡å¼å’Œ <code>POSIX</code> çš„æƒé™æ¨¡å¼éå¸¸ç›¸ä¼¼ã€‚å…±æä¾›ä¸‰ç±»æƒé™æ¨¡å¼ï¼š</p><ul><li><strong>åªè¯»æƒé™ï¼ˆ<code>r</code>ï¼‰</strong>ï¼šè¯»å–æ–‡ä»¶æˆ–åˆ—å‡ºç›®å½•å†…å®¹æ—¶éœ€è¦è¯¥æƒé™ã€‚</li><li><strong>å†™å…¥æƒé™ï¼ˆ<code>w</code>ï¼‰</strong>ï¼šå†™å…¥ä¸€ä¸ªæ–‡ä»¶æˆ–æ˜¯åœ¨ä¸€ä¸ªç›®å½•ä¸Šæ–°å»ºåŠåˆ é™¤æ–‡ä»¶æˆ–ç›®å½•éœ€è¦è¯¥æƒé™ã€‚</li><li><strong>å¯æ‰§è¡Œæƒé™ï¼ˆ<code>x</code>ï¼‰</strong>ï¼šè¯¥æƒé™å¯¹äºæ–‡ä»¶è€Œè¨€å¯ä»¥å¿½ç•¥ï¼Œä¸è¿‡åœ¨è®¿é—®ç›®å½•çš„å­é¡¹æ—¶éœ€è¦è¯¥æƒé™ã€‚</li></ul><p>æ¯ä¸ªæ–‡ä»¶å’Œç›®å½•éƒ½æœ‰æ‰€å±ç”¨æˆ·ï¼ˆ<code>owner</code>ï¼‰ã€æ‰€å±ç»„åˆ«ï¼ˆ<code>group</code>ï¼‰åŠæ¨¡å¼ï¼ˆ<code>mode</code>ï¼‰ï¼Œè¿™ä¸ªæ¨¡å¼æ˜¯ç”±æ‰€æœ‰ç”¨æˆ·çš„æƒé™ã€ç»„å†…ç”¨æˆ·çš„æƒé™åŠå…¶ä»–ç”¨æˆ·çš„æƒé™ç»„æˆã€‚</p><h4 id="distcp"><a href="#distcp" class="headerlink" title="distcp"></a><code>distcp</code></h4><p><code>DistCp</code>ï¼ˆåˆ†å¸ƒå¼æ‹·è´ï¼‰æ˜¯ç”¨äº<strong>å¤§è§„æ¨¡é›†ç¾¤å†…éƒ¨å’Œé›†ç¾¤ä¹‹é—´æ‹·è´çš„å·¥å…·</strong>ï¼Œä½¿ç”¨ <strong><code>Map/Reduce</code> å®ç°æ–‡ä»¶åˆ†å‘ã€é”™è¯¯å¤„ç†å’Œæ¢å¤ä»¥åŠæŠ¥å‘Šç”Ÿæˆ</strong>ã€‚é€šè¿‡æŠŠæ–‡ä»¶å’Œç›®å½•çš„åˆ—è¡¨ä½œä¸º <code>map</code> ä»»åŠ¡çš„è¾“å…¥ï¼Œæ¯ä¸ªä»»åŠ¡ä¼šå®Œæˆæºåˆ—è¡¨ä¸­éƒ¨åˆ†æ–‡ä»¶çš„æ‹·è´ã€‚ç”¨æ³•ï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bin/hadoop distcp [-p [rbugp]] [-i] [-<span class="built_in">log</span> &lt;logdir&gt;] [-m &lt;num_maps&gt;] [-overwrite] [-update] [-f &lt;urilist_uri&gt;] &lt;source-path&gt; &lt;dest-path&gt;</span><br></pre></td></tr></table></figure><p><small>ä¸Šè¿°å‘½ä»¤ä»…é™äºç›¸åŒç‰ˆæœ¬çš„ <code>HDFS</code> ä¹‹é—´æ‹·è´æ•°æ®ã€‚</small></p><ol><li><p><code>p</code><br>ä¿å­˜æ–‡ä»¶ä¿¡æ¯ã€‚<code>rbugp</code> åˆ†åˆ«è¡¨ç¤º <em>å‰¯æœ¬æ•°é‡</em>ã€<em>å—å¤§å°</em>ã€<em>ç”¨æˆ·</em>ã€<em>ç»„</em>ã€<em>æƒé™</em>ã€‚</p></li><li><p><code>i</code><br>å¿½ç•¥å¤±è´¥</p></li><li><p><code>log</code><br>è®°å½•æ—¥å¿—åˆ° <code>&lt;logdir&gt;</code></p></li><li><p><code>m</code><br>åŒæ—¶æ‹·è´çš„æœ€å¤§æ•°ç›®ã€‚</p></li><li><p><code>overwrite</code><br>æ˜¯å¦è¦†ç›–ç›®æ ‡ã€‚</p></li><li><p><code>update</code><br>å¦‚æœæºå’Œç›®æ ‡çš„å¤§å°ä¸ä¸€æ ·åˆ™è¿›è¡Œè¦†ç›–ã€‚</p></li><li><p><code>f</code><br>ä½¿ç”¨ <code>&lt;urilist_uri&gt;</code> ä½œä¸ºæºæ–‡ä»¶åˆ—è¡¨ã€‚</p></li></ol><hr><h3 id="æ–‡ä»¶ç³»ç»Ÿ"><a href="#æ–‡ä»¶ç³»ç»Ÿ" class="headerlink" title="æ–‡ä»¶ç³»ç»Ÿ"></a>æ–‡ä»¶ç³»ç»Ÿ</h3><p><code>Hadoop</code> æœ‰ä¸€ä¸ª<strong>æŠ½è±¡çš„æ–‡ä»¶ç³»ç»Ÿæ¦‚å¿µ</strong>ï¼Œè€Œ <code>HDFS</code> åªæ˜¯å…¶ä¸­çš„ä¸€ä¸ªå®ç°ã€‚<code>Java</code> æŠ½è±¡ç±» <code>org.apache.hadoop.fs.FileSystem</code> å®šä¹‰äº† <code>Hadoop</code> æ–‡ä»¶ç³»ç»Ÿçš„å®¢æˆ·ç«¯æ¥å£ï¼Œå¹¶ä¸”è¯¥æŠ½è±¡ç±»ä¹Ÿæœ‰å‡ ä¸ªå…·ä½“çš„å®ç°ï¼š</p><table><thead><tr><th>æ–‡ä»¶ç³»ç»Ÿ</th><th><code>URI</code></th><th><code>Java</code> å®ç°</th><th>æè¿°</th></tr></thead><tbody><tr><td><code>Local</code></td><td><code>file</code></td><td><code>fs.LocalFileSystem</code></td><td><div style="width: 300px">ä½¿ç”¨å®¢æˆ·ç«¯æ ¡éªŒå’Œçš„æœ¬åœ°ç£ç›˜æ–‡ä»¶ç³»ç»Ÿã€‚å…¶ä¸­ä½¿ç”¨ <code>RawLocalFileSystem</code> è¡¨ç¤ºæ— æ ¡éªŒå’Œçš„æœ¬åœ°ç£ç›˜æ–‡ä»¶ç³»ç»Ÿ</div></td></tr><tr><td><code>HDFS</code></td><td><code>hdfs</code></td><td><code>hdfs.DistributedFileSystem</code></td><td><code>Hadoop</code> çš„åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿã€‚å°† <code>HDFS</code> è®¾è®¡æˆä¸ <code>MapReduce</code> ç»“åˆä½¿ç”¨ï¼Œå¯ä»¥å®ç°é«˜æ€§èƒ½ã€‚</td></tr><tr><td><code>WebHDFS</code></td><td><code>Webhdfs</code></td><td><code>Hdfs.web.WebHdfsFileSystem</code></td><td>åŸºäº <code>HTTP</code> çš„æ–‡ä»¶ç³»ç»Ÿï¼Œæä¾›å¯¹ <code>HDFS</code> çš„è®¤è¯è¯»&#x2F;å†™è®¿é—®ã€‚</td></tr><tr><td><code>Secure</code> <code>WebHdfs</code></td><td><code>swebhdfs</code></td><td>hdfs.web.SWebHdfsFileSystem</td><td><code>WebHDFS</code> çš„ <code>HTTPS</code> ç‰ˆæœ¬</td></tr><tr><td><code>HAR</code></td><td><code>har</code></td><td><code>fa.HarFileSystem</code></td><td>ä¸€ä¸ªæ„å»ºåœ¨å…¶ä»–æ–‡ä»¶ç³»ç»Ÿä¹‹ä¸Šç”¨äºæ–‡ä»¶å­˜æ¡£çš„æ–‡ä»¶ç³»ç»Ÿã€‚<code>Hadoop</code> å­˜æ¡£æ–‡ä»¶é€šå¸¸ç”¨äºå°† <code>HDFS</code> ä¸­çš„å¤šä¸ªæ–‡ä»¶æ‰“åŒ…æˆä¸€ä¸ªå­˜æ¡£æ–‡ä»¶ï¼Œä»¥å‡å°‘ <code>namenode</code> å†…å­˜çš„ä½¿ç”¨ã€‚ä½¿ç”¨ <code>hadoop</code> çš„ <code>achive</code> å‘½ä»¤æ¥åˆ›å»º <code>HAR</code> æ–‡ä»¶ã€‚</td></tr><tr><td><code>View</code></td><td><code>viewfs</code></td><td><code>viewfs.ViewFileSystem</code></td><td>é’ˆå¯¹å…¶ä»– <code>Hadoop</code> æ–‡ä»¶ç³»ç»Ÿçš„å®¢æˆ·ç«¯æŒ‚è½½è¡¨ã€‚é€šå¸¸ç”¨äºä¸ºè”é‚¦ <code>namenode</code> åˆ›å»ºæŒ‚è½½ç‚¹ã€‚</td></tr><tr><td><code>FTP</code></td><td><code>ftp</code></td><td><code>fa.ftp.FTPFileSystem</code></td><td>ç”± <code>FTP</code> æœåŠ¡å™¨æ”¯æŒçš„æ–‡ä»¶ç³»ç»Ÿ</td></tr><tr><td><code>S3</code></td><td><code>S3a</code></td><td><code>fa.s3a.S3AFileSystem</code></td><td>ç”± <code>Amazon S3</code> æ”¯æŒçš„æ–‡ä»¶ç³»ç»Ÿã€‚æ›¿ä»£è€ç‰ˆçš„ <code>s3n</code> å®ç°ã€‚</td></tr><tr><td><code>Azure</code></td><td><code>wasb</code></td><td><code>fs.azure.NativeAzureFileSystem</code></td><td>ç”± <code>Microsoft Azure</code> æ”¯æŒçš„æ–‡ä»¶ç³»ç»Ÿã€‚</td></tr><tr><td><code>Swift</code></td><td><code>swift</code></td><td><code>fs.swift.snative.SwiftNativeFileSystem</code></td><td>ç”± <code>OpenStack Swift</code> æ”¯æŒçš„æ–‡ä»¶ç³»ç»Ÿã€‚</td></tr></tbody></table><p><code>Hadoop</code> å¯¹æ–‡ä»¶ç³»ç»Ÿæä¾›äº†è®¸å¤šæ¥å£ï¼Œä¸€èˆ¬ä½¿ç”¨ <code>URI</code> æ–¹æ¡ˆæ¥é€‰å–åˆé€‚çš„æ–‡ä»¶ç³»ç»Ÿå®ä¾‹è¿›è¡Œäº¤äº’ã€‚ä¾‹å¦‚åˆ—å‡ºæœ¬åœ°æ–‡ä»¶ç³»ç»Ÿæ ¹ç›®å½•ä¸‹çš„æ–‡ä»¶ï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bin/hadoop fs -<span class="built_in">ls</span> file:///</span><br></pre></td></tr></table></figure><h4 id="æ¥å£"><a href="#æ¥å£" class="headerlink" title="æ¥å£"></a>æ¥å£</h4><p><code>Hadoop</code> æ˜¯ç”¨ <code>Java</code> å†™çš„ï¼Œé€šè¿‡ <code>Java API</code> å¯ä»¥è°ƒç”¨å¤§éƒ¨åˆ† <code>Hadoop</code> æ–‡ä»¶ç³»ç»Ÿçš„äº¤äº’æ“ä½œã€‚</p><ol><li><p><code>HTTP</code><br>é <code>Java</code> å¼€å‘çš„åº”ç”¨è®¿é—® <code>HDFS</code> ä¼šå¾ˆä¸æ–¹ä¾¿ï¼Œå› æ­¤ç”± <code>WebHDFS</code> åè®®æä¾›çš„ <code>HTTP REST API</code> åˆ™ä½¿å¾—å…¶ä»–è¯­è¨€å¼€å‘çš„åº”ç”¨èƒ½å¤Ÿæ›´æ–¹ä¾¿åœ°ä¸ <code>HDFS</code> äº¤äº’ã€‚<br><small><code>HTTP</code> æ¥å£æ¯”åŸç”Ÿ <code>Java</code> å®¢æˆ·ç«¯è¦æ…¢ï¼Œå› æ­¤å°½é‡ä¸è¦ä¼ è¾“ç‰¹å¤§æ•°æ®ã€‚</small></p><p> é€šè¿‡ <code>HTTP</code> è®¿é—® <code>HDFS</code> æœ‰ä¸¤ç§æ–¹æ³•ï¼š</p><ul><li>ç›´æ¥è®¿é—®ï¼Œ<code>HDFS</code> å®ˆæŠ¤è¿›ç¨‹ç›´æ¥æœåŠ¡äºæ¥ä½å®¢æˆ·ç«¯çš„ <code>HTTP</code> è¯·æ±‚ã€‚<br> <img src="https://s2.loli.net/2023/02/09/wFOC1HuLXivtez2.png" alt="hadoop_1_3.jpg"><br> <code>namenode</code> å’Œ <code>datanode</code> å†…åµŒçš„ <strong><code>web</code> æœåŠ¡å™¨</strong>ä½œä¸º <code>WebHDFS</code> çš„ç«¯èŠ‚ç‚¹è¿è¡Œã€‚æ–‡ä»¶å…ƒæ•°æ®æ“ä½œç”± <code>namenode</code> ç®¡ç†ï¼Œæ–‡ä»¶è¯»&#x2F;å†™æ“ä½œé¦–å…ˆè¢«å‘å¾€ <code>namenode</code>ï¼Œç”± <code>namenode</code> å‘é€ä¸€ä¸ª <code>HTTP</code> é‡å®šå‘è‡³æŸä¸ªå®¢æˆ·ç«¯ï¼ŒæŒ‡ç¤ºä»¥æµæ–¹å¼ä¼ è¾“æ–‡ä»¶æ•°æ®çš„ç›®çš„æˆ–æº <code>datanode</code>ã€‚ï¼ˆç”±äº <code>dfs.webhdfs.enabled</code> è¢«è®¾ç½®ä¸º <code>true</code>ï¼Œ<code>WebHDFS</code> é»˜è®¤æ˜¯å¯ç”¨çŠ¶æ€ï¼‰</li><li>é€šè¿‡ä»£ç†ï¼ˆä¸€ä¸ªæˆ–å¤šä¸ªï¼‰è®¿é—®ï¼Œå®¢æˆ·ç«¯é€šå¸¸ä½¿ç”¨ <code>DistributedFileSystem API</code> è®¿é—® <code>HDFS</code>ã€‚<br> <img src="https://s2.loli.net/2023/02/09/q8SQF3xibR9dgnM.png" alt="hadoop_1_4.jpg"><br> ä¾é ä¸€ä¸ªæˆ–å¤šä¸ª<strong>ç‹¬ç«‹ä»£ç†æœåŠ¡å™¨</strong>é€šè¿‡ <code>HTTP</code> è®¿é—® <code>HDFS</code>ã€‚æ‰€æœ‰åˆ°é›†ç¾¤çš„ç½‘è·¯é€šä¿¡éƒ½éœ€è¦ç»è¿‡ä»£ç†ï¼Œå› æ­¤å®¢æˆ·ç«¯ä»ä¸ç›´æ¥è®¿é—® <code>namenode</code> å’Œ <code>datanode</code>ã€‚<code>HttpFS</code> ä»£ç†æä¾›å’Œ <code>WebHDFS</code> ç›¸åŒçš„ <code>HTTP</code> å’Œ <code>HTTPS</code> æ¥å£ï¼Œè¿™æ ·å®¢æˆ·ç«¯èƒ½å¤Ÿé€šè¿‡ <code>webhdfs URI</code> åè®®è®¿é—®è¿™ç±»æ¥å£ã€‚<br> <code>httpFS</code> ä»£ç†çš„å¯åŠ¨ç‹¬ç«‹äº <code>namenode</code> å’Œ <code>datanode</code> çš„å®ˆæŠ¤è¿›ç¨‹ï¼Œä½¿ç”¨ <code>httpfs.sh</code> è„šæœ¬å¯åŠ¨ï¼Œé»˜è®¤åœ¨ä¸€ä¸ªä¸åŒçš„ç«¯å£ä¸Šç›‘å¬ï¼ˆç«¯å£å·ä¸º <code>14000</code>ï¼‰ã€‚</li></ul><p> <small>ä¸Šè¿°ä¸¤è€…éƒ½ä½¿ç”¨äº† <strong><code>WebHDFS</code></strong> åè®®ã€‚</small></p></li><li><p><code>C</code><br><code>Hadoop</code> æä¾›äº†ä¸€ä¸ªåä¸º <strong><code>libhdfs</code></strong> çš„ <code>C</code> è¯­è¨€åº“ï¼Œè¯¥è¯­è¨€åº“æ˜¯ <code>Java FileSystem</code> æ¥å£ç±»çš„ä¸€ä¸ªé•œåƒï¼Œä½¿ç”¨ <strong><code>Java</code> åŸç”Ÿæ¥å£ï¼ˆ<code>JNI, Java Native Interface</code>ï¼‰</strong>è°ƒç”¨ <code>Java</code> æ–‡ä»¶ç³»ç»Ÿå®¢æˆ·ç«¯ã€‚åŒæ—¶è¿˜æœ‰ä¸€ä¸ª <code>libwebhdfs</code> åº“ï¼Œè¯¥åº“æ˜¯ <code>WebHDFS</code> æ¥å£çš„å®ç°ã€‚</p></li><li><p><code>NFS</code><br>ä½¿ç”¨ <code>Hadoop</code> çš„ <strong><code>NFSv3</code></strong> ç½‘å…³å°† <code>HDFS</code> æŒ‚è½½ä¸ºæœ¬åœ°å®¢æˆ·ç«¯çš„æ–‡ä»¶ç³»ç»Ÿçš„æƒ³æ³•æ˜¯å¯è¡Œçš„ã€‚å¯ä»¥é€šè¿‡ä½¿ç”¨ <code>Unix</code> ç¨‹åºä¸è¯¥æ–‡ä»¶ç³»ç»Ÿäº¤äº’ï¼Œé€šè¿‡ä»»æ„ä¸€ç§ç¼–ç¨‹è¯­è¨€è°ƒç”¨ <code>POSIX</code> åº“æ¥è®¿é—®æ–‡ä»¶ç³»ç»Ÿï¼Œç”±äº <code>HDFS</code> ä»…èƒ½ä»¥ <em>è¿½åŠ æ¨¡å¼</em> å†™æ–‡ä»¶ï¼Œå› æ­¤å¯ä»¥å¾€æ–‡ä»¶æœ«å°¾æ·»åŠ æ•°æ®ï¼Œä½†ä¸èƒ½éšå³ä¿®æ”¹æ–‡ä»¶ã€‚</p></li><li><p><code>FUSE</code><br><strong>ç”¨æˆ·ç©ºé—´æ–‡ä»¶ç³»ç»Ÿï¼ˆ<code>FUSE, FileSystem in Userspace</code>ï¼‰</strong>å…è®¸å°†ç”¨æˆ·ç©ºé—´å®ç°çš„æ–‡ä»¶ç³»ç»Ÿä½œä¸º <code>Unix</code> æ–‡ä»¶ç³»ç»Ÿè¿›è¡Œé›†æˆã€‚é€šè¿‡ä½¿ç”¨ <code>Hadoop</code> çš„ <code>Fuse-DFS</code> åŠŸèƒ½æ¨¡å—ï¼Œ<code>HDFS</code> æˆ–è€…ä»»ä½•ä¸€ä¸ª <code>Hadoop</code> æ–‡ä»¶ç³»ç»Ÿå‡å¯ä»¥ä½œä¸ºä¸€ä¸ªæ ‡å‡†çš„æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿè¿›è¡ŒæŒ‚è½½ã€‚<br><code>Fuse-DFS</code> æ˜¯ç”¨ <code>C</code> è¯­è¨€å®ç°çš„ï¼Œä½¿ç”¨ <code>libhdfs</code> ä½œä¸ºè®¿é—® <code>HDFS</code> çš„æ¥å£ã€‚<br><small>å¯¹äºæŒ‚è½½ <code>HDFS</code> çš„è§£å†³æ–¹æ¡ˆï¼Œ<code>Hadoop NFS</code> ç›¸æ¯” <code>Fuse-DFS</code> æ›´ä¼˜å…ˆé€‰æ‹©ã€‚</small></p></li></ol><hr><h3 id="Java-æ¥å£"><a href="#Java-æ¥å£" class="headerlink" title="Java æ¥å£"></a><code>Java</code> æ¥å£</h3><p>è¯¥éƒ¨åˆ†ä¸»è¦æ¢ç´¢ <code>Hadoop</code> çš„ <code>FileSystem</code> ç±»ï¼Œè¯¥ç±»æ˜¯ä¸ <code>Hadoop</code> çš„æŸä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿè¿›è¡Œäº¤äº’çš„ <code>API</code>ã€‚</p><h4 id="è¯»å–æ•°æ®"><a href="#è¯»å–æ•°æ®" class="headerlink" title="è¯»å–æ•°æ®"></a>è¯»å–æ•°æ®</h4><h5 id="Hadoop-URL"><a href="#Hadoop-URL" class="headerlink" title="Hadoop URL"></a><code>Hadoop URL</code></h5><p>ä» <code>Hadoop</code> æ–‡ä»¶ç³»ç»Ÿè¯»å–æ–‡ä»¶ï¼Œæœ€ç®€å•çš„åŠæ³•å°±æ˜¯ä½¿ç”¨ <code>java.net.URL</code> å¯¹è±¡æ‰“å¼€æ•°æ®æµï¼Œç„¶åä»ä¸­è¯»å–æ•°æ®ã€‚ç¤ºä¾‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CatURL</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        URL.setURLStreamHandlerFactory(<span class="keyword">new</span> <span class="title class_">FsUrlStreamHandlerFactory</span>());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">InputStream</span> <span class="variable">in</span> <span class="operator">=</span> <span class="literal">null</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            in = <span class="keyword">new</span> <span class="title class_">URL</span>(args[<span class="number">0</span>]).openStream();</span><br><span class="line">            IOUtils.cpoyBytes(in, System.out, <span class="number">4096</span>, <span class="literal">false</span>);</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            IOUtils.closeStream(in);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿è¡Œç¤ºä¾‹ï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">% bin/hadoop CatURL hdfs://localhost/user/vgbh/test.txt</span><br><span class="line">Hello World!</span><br></pre></td></tr></table></figure><p><code>Java</code> ç¨‹åºè¦æƒ³è¯†åˆ« <code>Hadoop</code> çš„ <code>hdfs URL</code>ï¼Œéœ€è¦é€šè¿‡ <code>FsUrlStreamHandlerFactory</code> å®ä¾‹è°ƒç”¨ <code>java.net.URL</code> å¯¹è±¡çš„ <code>setURLStreamHandlerFactory</code> æ–¹æ³•ã€‚å¦å¤–å¯ä»¥è°ƒç”¨ <code>Hadoop</code> ä¸­çš„ <code>IOUtils</code> ç±»ï¼Œå¹¶åœ¨ <code>finally</code> å­å¥ä¸­å…³é—­æ•°æ®æµï¼ŒåŒæ—¶åœ¨è¾“å…¥æµå’Œè¾“å‡ºæµä¹‹é—´å¤åˆ¶æ•°æ®ã€‚<br><small><code>setURLStreamHandlerFactory</code> æ–¹æ³•åœ¨æ¯ä¸€ä¸ªè™šæ‹Ÿæœºä¸­åªèƒ½è¢«è°ƒç”¨ä¸€æ¬¡ï¼Œé€šå¸¸åœ¨é™æ€æ–¹æ³•ä¸­è°ƒç”¨ï¼Œè¯¥é™åˆ¶åˆ™æ„å‘³ç€å¦‚æœç¨‹åºçš„å…¶ä»–ç»„ä»¶å·²ç»å£°æ˜äº† <code>FsUrlStreamHandlerFactory</code> å®ä¾‹ï¼Œé‚£ä¹ˆå°±ä¸èƒ½ä½¿ç”¨è¯¥æ–¹æ³•ä» <code>Hadoop</code> ä¸­è¯»å–æ•°æ®ã€‚</small></p><h5 id="FileSystem-API"><a href="#FileSystem-API" class="headerlink" title="FileSystem API"></a><code>FileSystem API</code></h5><p>å‰ä¸€ä¸ªéƒ¨åˆ†æœ‰æ—¶å€™ä¼šé‡åˆ°ä¸èƒ½è®¾ç½® <code>FsUrlStreamHandlerFactory</code> å®ä¾‹ï¼Œé‚£ä¹ˆè¿™ç§æƒ…å†µä¸‹å¯ä»¥ä½¿ç”¨ <strong><code>FileSystem API</code></strong> æ¥æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶çš„è¾“å…¥æµã€‚<br><code>Hadoop</code> æ–‡ä»¶ç³»ç»Ÿé€šè¿‡ <strong><code>Hadoop Path</code> å¯¹è±¡æ¥è¡¨ç¤ºä¸€ä¸ªæ–‡ä»¶</strong>ï¼Œå› æ­¤å¯ä»¥å°†<strong>è·¯å¾„è§†ä¸ºä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿ <code>URI</code></strong> ã€‚</p><p><code>FileSystem</code> æ˜¯ä¸€ä¸ªé€šç”¨çš„æ–‡ä»¶ç³»ç»Ÿ <code>API</code>ï¼Œé‚£ä¹ˆç¬¬ä¸€æ­¥å°±æ˜¯è·å–å¯¹åº”çš„æ–‡ä»¶ç³»ç»Ÿå®ä¾‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> FileSystem <span class="title function_">get</span><span class="params">(Configuration conf [,URI uri] [,String user])</span> <span class="keyword">throws</span> IOException</span><br></pre></td></tr></table></figure><ul><li><code>conf</code>ï¼š<code>Configuration</code> å¯¹è±¡å°è£…äº†å®¢æˆ·ç«¯æˆ–æœåŠ¡å™¨çš„é…ç½®ï¼Œé€šè¿‡é…ç½®æ–‡ä»¶è¯»å–ç±»è·¯å¾„æ¥å®ç°ï¼ˆ<code>etc/hadoop/core-site.xml</code>ï¼‰ã€‚</li><li><code>uri</code>ï¼šæ ¹æ®ç»™å®šçš„ <code>URI</code> ç¡®å®šä½¿ç”¨çš„æ–‡ä»¶ç³»ç»Ÿã€‚</li><li><code>user</code>ï¼šç»™å®šç”¨æˆ·æ¥è®¿é—®æ–‡ä»¶ç³»ç»Ÿã€‚</li></ul><p>åœ¨æŸäº›æƒ…å†µä¸‹å¸Œæœ›è·å¾—æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿçš„è¿è¡Œå®ä¾‹ï¼Œæ­¤æ—¶ä½¿ç”¨ <code>getLocal</code> æ–¹æ³•ä¼šæ›´åŠ æ–¹ä¾¿ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> LocalFileSystem <span class="title function_">getLocal</span><span class="params">(Configuration conf)</span> <span class="keyword">throws</span> IOException</span><br></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥çš„ç¬¬äºŒéƒ¨å°±æ˜¯åœ¨è·å–åˆ° <code>FileSystem</code> ä¹‹åï¼Œå°±å¯ä»¥è°ƒç”¨ <code>open()</code> å‡½æ•°æ¥è·å–æ–‡ä»¶çš„è¾“å…¥æµï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> FSDataInputStream <span class="title function_">open</span><span class="params">(Path f [,<span class="type">int</span> bufferSize])</span> <span class="keyword">throws</span> IOException</span><br></pre></td></tr></table></figure><p><code>bufferSize</code> è¡¨ç¤ºå¯è®¾ç½®ç¼“å†²åŒºçš„å¤§å°ï¼Œä¸è®¾ç½®æ—¶é»˜è®¤å¤§å°ä¸º <code>4KB</code>ã€‚</p><p>å®Œæ•´ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CatFileSystem</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Configuration</span> <span class="variable">conf</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Configuration</span>();</span><br><span class="line">        <span class="type">FileSystem</span> <span class="variable">fs</span> <span class="operator">=</span> FileSystem.get(URI.create(args[<span class="number">0</span>]), conf);</span><br><span class="line">        <span class="type">InputStream</span> <span class="variable">in</span> <span class="operator">=</span> <span class="literal">null</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            in = fs.open(<span class="keyword">new</span> <span class="title class_">Path</span>(args[<span class="number">0</span>]));</span><br><span class="line">            IOUtils.cpoyBytes(in, System.out, <span class="number">4096</span>, <span class="literal">false</span>);</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            IOUtils.closeStream(in);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿è¡Œç¤ºä¾‹ï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">% bin/hadoop CatFileSystem hdfs://localhost/user/vgbh/test.txt</span><br><span class="line">Hello World!</span><br></pre></td></tr></table></figure><p><small>å…³äºæ›´å¤šçš„ä½¿ç”¨æ–¹æ³•å¯ä»¥äº†è§£ä¸‹ <code>FileSystem</code> çš„æ¥å£ç±» <strong><code>Seekable</code></strong> å’Œ <strong><code>PositionedReadable</code></strong> </small></p><h4 id="å†™å…¥æ•°æ®"><a href="#å†™å…¥æ•°æ®" class="headerlink" title="å†™å…¥æ•°æ®"></a>å†™å…¥æ•°æ®</h4><p><code>FileSystem</code> ç±»æœ‰ä¸€ç³»åˆ—æ–°å»ºæ–‡ä»¶çš„æ–¹æ³•ã€‚</p><ol><li><p>æœ€ç®€å•çš„æ–¹æ³•å°±æ˜¯ç»™å‡†å¤‡åˆ›å»ºçš„æ–‡ä»¶ä¸€ä¸ª <code>Path</code> å¯¹è±¡ï¼Œç„¶åè¿”å›ä¸€ä¸ªç”¨äºå†™å…¥æ•°æ®çš„è¾“å‡ºæµï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> FSDataOutputStream <span class="title function_">create</span><span class="params">(Path f)</span> <span class="keyword">throws</span> IOException</span><br></pre></td></tr></table></figure><p>æ­¤æ–¹æ³•æœ‰å¤šä¸ªé‡è½½ç‰ˆæœ¬ï¼Œå…è®¸æŒ‡å®šæ˜¯å¦å¼ºåˆ¶è¦†ç›–ç°æœ‰æ–‡ä»¶ã€æ–‡ä»¶å¤‡ä»½æ•°é‡ã€å†™å…¥æ–‡ä»¶æ—¶ç¼“å†²åŒºå¤§å°ã€æ–‡ä»¶å—å¤§å°ä»¥åŠæ–‡ä»¶æƒé™ã€‚è¿˜æœ‰ä¸€ä¸ª<strong>é‡è½½æ–¹æ³• <code>Progressable</code> ç”¨äºä¼ é€’å›è°ƒæ¥å£</strong>ï¼Œå¯ä»¥å°†æ•°æ®å†™å…¥ <code>datanode</code> çš„è¿›åº¦é€šçŸ¥ç»™åº”ç”¨ã€‚<br><small><code>create()</code> æ–¹æ³•èƒ½å¤Ÿä¸ºéœ€è¦å†™å…¥å½“å½“å‰å¹¶ä¸å­˜åœ¨çš„æ–‡ä»¶åˆ›å»ºçˆ¶ç›®å½•ã€‚å¦‚æœä¸å¸Œæœ›è¿™æ ·ï¼Œå¯ä»¥åœ¨å†™å…¥æ—¶å…ˆè°ƒç”¨ <code>exist()</code> æ–¹æ³•æ£€æŸ¥çˆ¶ç›®å½•æ˜¯å¦å­˜åœ¨ã€‚</small></p></li><li><p>ä½¿ç”¨ <code>append()</code> æ–¹æ³•åœ¨ä¸€ä¸ªç°æœ‰æ–‡ä»¶çš„æœ«å°¾è¿½åŠ æ•°æ®ï¼Œè¿½åŠ æ“ä½œå…è®¸ä¸€ä¸ª <code>writer</code> æ‰“å¼€æ–‡ä»¶ååœ¨è®¿é—®è¯¥æ–‡ä»¶çš„æœ€ååç§»é‡å¤„è¿½åŠ æ•°æ®ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> FSDataOutputStream <span class="title function_">append</span><span class="params">(Path f)</span> <span class="keyword">throws</span> IOException</span><br></pre></td></tr></table></figure></li></ol><p><small><code>FSDataOutputStream</code> ä¸ <code>FSDataInputStream</code> ä¸åŒä¹‹å¤„åœ¨äºï¼Œå‰è€…ä¸å…è®¸åœ¨æ–‡ä»¶ä¸­å®šä½ã€‚å› ä¸º <code>HDFS</code> åªå…è®¸å¯¹ä¸€ä¸ªå·²æ‰“å¼€çš„æ–‡ä»¶é¡ºåºå†™å…¥æˆ–è€…åœ¨æœ«å°¾æ·»åŠ æ•°æ®ã€‚</small></p><p>å®Œæ•´ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FileCopyWithProgress</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">loc</span> <span class="operator">=</span> args[<span class="number">0</span>];</span><br><span class="line">        <span class="type">String</span> <span class="variable">dst</span> <span class="operator">=</span> args[<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">        <span class="type">InputStream</span> <span class="variable">in</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedInputStream</span>(<span class="keyword">new</span> <span class="title class_">FileInputStream</span>(loc));</span><br><span class="line">        <span class="type">Configuration</span> <span class="variable">conf</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Configuration</span>();</span><br><span class="line">        <span class="type">FileSystem</span> <span class="variable">fs</span> <span class="operator">=</span> FileSystem.get(URI.create(dst), conf);</span><br><span class="line"></span><br><span class="line">        <span class="type">OutputStream</span> <span class="variable">out</span> <span class="operator">=</span> fs.create(<span class="keyword">new</span> <span class="title class_">Path</span>(dst), <span class="keyword">new</span> <span class="title class_">Progressable</span>() &#123;</span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">progress</span><span class="params">()</span> &#123;</span><br><span class="line">                System.out.print(<span class="string">&quot;.&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        IOUtils.cpoyBytes(in, out, <span class="number">4096</span>, <span class="literal">false</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿è¡Œç¤ºä¾‹ï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">% bin/hadoop FileCopyWithProgress input/vgbh/a.txt hdfs://localhost/user/vgbh/test_1.txt</span><br><span class="line">.....</span><br></pre></td></tr></table></figure><h4 id="ç›®å½•"><a href="#ç›®å½•" class="headerlink" title="ç›®å½•"></a>ç›®å½•</h4><p><code>FileSystem</code> å®ä¾‹æä¾›äº†åˆ›å»ºç›®å½•çš„æ–¹æ³•ï¼Œè¯¥æ–¹æ³•å¯ä»¥ä¸€æ¬¡æ€§åˆ›å»ºæ‰€æœ‰å¿…è¦ä½†è¿˜æ²¡æœ‰çš„ç›®å½•ï¼Œå‡åˆ›å»ºæˆåŠŸåè¿”å› <code>true</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">mkdirs</span><span class="params">(Path f)</span> <span class="keyword">throws</span> IOException</span><br></pre></td></tr></table></figure><h4 id="æŸ¥è¯¢æ–‡ä»¶"><a href="#æŸ¥è¯¢æ–‡ä»¶" class="headerlink" title="æŸ¥è¯¢æ–‡ä»¶"></a>æŸ¥è¯¢æ–‡ä»¶</h4><h5 id="æ–‡ä»¶å…ƒæ•°æ®"><a href="#æ–‡ä»¶å…ƒæ•°æ®" class="headerlink" title="æ–‡ä»¶å…ƒæ•°æ®"></a>æ–‡ä»¶å…ƒæ•°æ®</h5><p>ä»»ä½•æ–‡ä»¶ç³»ç»Ÿçš„é‡è¦ç‰¹å¾å…¶ä¸­ä¹‹ä¸€éƒ½æ˜¯æä¾›å…¶<strong>ç›®å½•ç»“æ„æµè§ˆ</strong>å’Œ<strong>æ£€ç´¢æ‰€å­˜æ–‡ä»¶å’Œç›®å½•ç›¸å…³ä¿¡æ¯</strong>çš„åŠŸèƒ½ã€‚<code>FileStatus</code> ç±»å°è£…äº†æ–‡ä»¶ç³»ç»Ÿä¸­æ–‡ä»¶å’Œç›®å½•çš„å…ƒæ•°æ®ï¼ŒåŒ…æ‹¬æ–‡ä»¶é•¿åº¦ã€å—å¤§å°ã€å¤æœ¬ã€ä¿®æ”¹æ—¶é—´ã€æ‰€æœ‰è€…ä»¥åŠæƒé™ä¿¡æ¯ã€‚<br><code>FileSystem</code> çš„ <strong><code>getFileStatus()</code></strong> æ–¹æ³•ç”¨äºè·å–æ–‡ä»¶æˆ–ç›®å½•çš„ <code>FileStatus</code> å¯¹è±¡ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> FileStatus <span class="title function_">getFileStatus</span><span class="params">(Path f)</span> <span class="keyword">throws</span> FileNotFoundException</span><br></pre></td></tr></table></figure><h5 id="åˆ—è¡¨"><a href="#åˆ—è¡¨" class="headerlink" title="åˆ—è¡¨"></a>åˆ—è¡¨</h5><p>åœ¨æŸ¥æ‰¾åˆ°æ–‡ä»¶æˆ–ç›®å½•çš„ç›¸å…³ä¿¡æ¯åï¼Œé‚£ä¹ˆå°±ä¸‹æ¥å°±æ˜¯åˆ—å‡ºç›®å½•ä¸­çš„å†…å®¹ã€‚<code>FileSystem</code> çš„ <strong><code>listStatus()</code></strong> æ–¹æ³•å¯ä»¥å®ç°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> FileStatus[] listStatus(Path f [,PathFilter filter]) <span class="keyword">throws</span> IOException</span><br><span class="line"><span class="keyword">public</span> FileStatus[] listStatus(Path[] f [,PathFilter filter]) <span class="keyword">throws</span> IOException</span><br></pre></td></tr></table></figure><p>å½“ <code>f</code> ä¼ å…¥çš„å‚æ•°ä¸ºä¸€ä¸ªæ–‡ä»¶æ—¶ï¼Œé‚£ä¹ˆå°±ä¼šè¿”å›æ•°ç»„é•¿åº¦ä¸º <code>1</code> çš„ <code>FileStatus</code> å¯¹è±¡ï¼›ä½†è‹¥æ˜¯ä¸€ä¸ªç›®å½•æ—¶ï¼Œåˆ™è¿”å›å¤šä¸ª <code>FileStatus</code> å¯¹è±¡ï¼Œè¡¨ç¤ºæ­¤ç›®å½•ä¸­åŒ…å«çš„ç›®å½•å’Œæ–‡ä»¶ã€‚å¦å¤–<strong>é‡è½½æ–¹æ³•å…è®¸ä½¿ç”¨ <code>PathFilter</code> æ¥é™åˆ¶åŒ¹é…çš„æ–‡ä»¶å’Œç›®å½•</strong> ã€‚</p><h5 id="æ–‡ä»¶æ¨¡å¼"><a href="#æ–‡ä»¶æ¨¡å¼" class="headerlink" title="æ–‡ä»¶æ¨¡å¼"></a>æ–‡ä»¶æ¨¡å¼</h5><p>å¶å°”ä¼šå‡ºç°åœ¨å•ä¸ªæ“ä½œä¸­å¤„ç†ä¸€æ‰¹æ–‡ä»¶çš„éœ€æ±‚ã€‚å› æ­¤åœ¨ä¸€ä¸ª<strong>è¡¨è¾¾å¼ä¸­ä½¿ç”¨é€šé…ç¬¦æ¥åŒ¹é…å¤šä¸ªæ–‡ä»¶</strong>æ­£æ˜¯è§£å†³åŠæ³•ï¼Œæ— éœ€åˆ—ä¸¾æ¯ä¸ªæ–‡ä»¶å’Œç›®å½•æ¥æŒ‡å®šè¾“å…¥ã€‚<br><code>Hadoop</code> ä¸ºæ‰§è¡Œé€šé…ç¬¦æä¾›äº† <strong><code>globStatus()</code></strong> æ–¹æ³•ï¼Œè¯¥æ–¹æ³•è¿”å›è·¯å¾„æ ¼å¼ä¸æŒ‡å®šæ¨¡å¼åŒ¹é…çš„æ‰€æœ‰ <code>FileStatus</code> ç»„æˆçš„æ•°ç»„ï¼Œå¹¶æŒ‰è·¯å¾„æ’åºã€‚<code>PathFilter</code> å‚æ•°ä½œä¸ºå¯é€‰é¡¹è¿›ä¸€æ­¥å¯¹åŒ¹é…ç»“æœè¿›è¡Œé™åˆ¶ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> FileStatus[] globStatus(Path pathPattern [,PathFilter filter]) <span class="keyword">throws</span> IOException</span><br></pre></td></tr></table></figure><p>å¦å¤– <code>Hadoop</code> æ”¯æŒçš„é€šé…ç¬¦ä¸ <a href="https://www.cnblogs.com/chengmo/archive/2010/10/17/1853344.html"><code>Unix bash shell</code></a> æ”¯æŒçš„ç›¸åŒã€‚</p><h5 id="PathFilter-å¯¹è±¡"><a href="#PathFilter-å¯¹è±¡" class="headerlink" title="PathFilter å¯¹è±¡"></a><code>PathFilter</code> å¯¹è±¡</h5><p>é€šé…ç¬¦æ¨¡å¼æœ‰æ—¶å¹¶ä¸èƒ½å¤Ÿç²¾ç¡®åœ°æè¿°æƒ³è¦çš„æ–‡ä»¶é›†ã€‚å› æ­¤ <code>FileSystem</code> çš„ <code>listStatus()</code> å’Œ <code>globStatus()</code> æ–¹æ³•å‡æä¾›äº†å¯é€‰çš„ <strong><code>PathFilter</code> å¯¹è±¡æ¥æ§åˆ¶é€šé…ç¬¦</strong>ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">PathFilter</span> &#123;</span><br><span class="line">    <span class="type">boolean</span> <span class="title function_">accept</span><span class="params">(Path path)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="åˆ é™¤æ•°æ®"><a href="#åˆ é™¤æ•°æ®" class="headerlink" title="åˆ é™¤æ•°æ®"></a>åˆ é™¤æ•°æ®</h4><p><code>FileSystem</code> çš„ <code>delete()</code> æ–¹æ³•å¯ä»¥æ°¸ä¹…æ€§åˆ é™¤æ–‡ä»¶æˆ–ç›®å½•ã€‚å¦‚æœ <code>f</code> æ˜¯ä¸€ä¸ªæ–‡ä»¶æˆ–ç©ºç›®å½•ï¼Œåˆ™ <code>recursive</code> å€¼å°±ä¼šè¢«å¿½ç•¥ï¼Œåªæœ‰å€¼ä¸º <code>true</code> æ—¶éç©ºç›®å½•åŠå…¶å†…å®¹æ‰ä¼šè¢«åˆ é™¤ï¼Œå¦åˆ™ä¼šæŠ›å‡º <code>IOException</code> å¼‚å¸¸ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">delete</span><span class="params">(Path f, <span class="type">boolean</span> recursive)</span> <span class="keyword">throws</span> IOException</span><br></pre></td></tr></table></figure><hr><h3 id="æ•°æ®è¯»å–å’Œå†™å…¥"><a href="#æ•°æ®è¯»å–å’Œå†™å…¥" class="headerlink" title="æ•°æ®è¯»å–å’Œå†™å…¥"></a>æ•°æ®è¯»å–å’Œå†™å…¥</h3><p>äº†è§£å®¢æˆ·ç«¯å¦‚ä½•ä¸ <code>HDFS</code>ã€<code>datanode</code>ã€<code>namenode</code> è¿›è¡Œäº¤äº’ï¼Œæ˜ç™½å¦‚ä½•è¯»å–å’Œå†™å…¥æ–‡ä»¶ã€‚</p><h4 id="å‰–æè¯»å–"><a href="#å‰–æè¯»å–" class="headerlink" title="å‰–æè¯»å–"></a>å‰–æè¯»å–</h4><p>ä¸‹å›¾å±•ç¤ºåœ¨è¯»å–æ–‡ä»¶æ—¶äº‹ä»¶çš„å‘ç”Ÿé¡ºåºï¼š<br><img src="https://s2.loli.net/2023/02/14/jRGN2T9HokPLAtr.png" alt="hadoop_1_6.jpg"></p><ol><li><p><code>open</code><br>å®¢æˆ·ç«¯é€šè¿‡è°ƒç”¨ <code>FileSystem</code> å¯¹è±¡çš„ <code>open()</code> æ–¹æ³•æ¥æ‰“å¼€éœ€è¦è¯»å–çš„æ–‡ä»¶ï¼Œå¯¹äº <code>HDFS</code> æ¥è¯´è¯¥æ–‡ä»¶å°±æ˜¯ä¸€ä¸ª <strong><code>DistributedFileSystem</code></strong> å®ä¾‹ã€‚</p></li><li><p><code>get block locations</code><br><code>DistributedFileSystem</code> å®ä¾‹é€šè¿‡è¿œç¨‹è¿‡ç¨‹è°ƒç”¨ï¼ˆ<code>RPC</code>ï¼‰æ¥è°ƒç”¨ <code>namenode</code>ï¼Œä»¥ç¡®å®šæ–‡ä»¶èµ·å§‹å—çš„ä½ç½®ã€‚<code>DistributedFileSystem</code> ç±»è¿”å›ä¸€ä¸ª <strong><code>FSDataInputStream</code></strong> å¯¹è±¡ï¼ˆæ”¯æŒæ–‡ä»¶å®šä½çš„è¾“å…¥æµï¼‰ç»™å®¢æˆ·ç«¯ä»¥ä¾¿è¯»å–æ•°æ®ã€‚<br><code>FSDataInputStream</code> ç±»å†…éƒ¨å°è£… <code>DFSInputStream</code> å¯¹è±¡ï¼Œè¯¥å¯¹è±¡ç®¡ç† <code>datanode</code> å’Œ <code>namenode</code> çš„ <code>I/O</code>ã€‚<br>å¯¹äºæ¯ä¸€ä¸ªæ•°æ®å—ï¼Œ<code>namenode</code> ä¼šè¿”å›å­˜æœ‰è¯¥å—å‰¯æœ¬çš„ <code>datanode</code> åœ°å€ï¼Œè¯¥åœ°å€æ ¹æ®è·ç¦»å®¢æˆ·ç«¯çš„è·ç¦»è¿›è¡Œæ’åºã€‚</p></li><li><p><code>read</code><br>æ¥ç€å®¢æˆ·ç«¯å¯¹è¾“å…¥æµè°ƒç”¨ <code>read()</code> æ–¹æ³•ï¼Œå­˜å‚¨ç€æ–‡ä»¶èµ·å§‹å‡ ä¸ªå—çš„ <code>datanode</code> åœ°å€çš„ <code>DFSInputStream</code> éšå³è¿æ¥è·ç¦»æœ€è¿‘çš„æ–‡ä»¶ä¸­ç¬¬ä¸€ä¸ªå—æ‰€åœ¨çš„ <strong><code>datanode</code></strong> ã€‚<br><small>åœ¨è¯»å–æ•°æ®æ—¶å¦‚æœé‡åˆ°å¼‚å¸¸ï¼ˆä¾‹å¦‚é€šä¿¡å¼‚å¸¸æˆ–è€…æ£€æŸ¥æ ¡éªŒå’Œæœªé€šè¿‡ï¼‰ï¼Œä¼šå°è¯•ä»è¿™ä¸ªå—çš„å¦ä¸€ä¸ªé‚»è¿‘çš„ <code>datanode</code> è¯»å–æ•°æ®ï¼Œç„¶åæ ‡è®°è¿™ä¸ª <code>datanode</code>ï¼Œä¹‹åä¸ä¼šå†åœ¨è¿™ä¸ª <code>datanode</code> ä¸Šè¯»å–æ•°æ®ã€‚</small></p></li><li><p><code>read</code><br>é€šè¿‡å¯¹æ•°æ®æµåå¤è°ƒç”¨ <code>read()</code> æ–¹æ³•ï¼Œå°±å¯ä»¥å°†æ•°æ®ä» <code>datanode</code> ä¼ è¾“åˆ°å®¢æˆ·ç«¯ã€‚</p></li><li><p><code>read</code><br>åœ¨è¯»å–åˆ°æ•°æ®çš„æœ«ç«¯æ—¶ï¼Œ<code>DFSInputStream</code> å…³é—­ä¸è¯¥ <code>datanode</code> çš„è¿æ¥ï¼Œç„¶åå¯»æ‰¾ä¸‹ä¸€ä¸ªå—çš„æœ€ä½³ <code>datanode</code>ã€‚è¿™äº›å†…éƒ¨æ“ä½œå¯¹äºå®¢æˆ·ç«¯éƒ½æ˜¯é€æ˜çš„ï¼Œå¯¹å®¢æˆ·ç«¯æ¥è¯´ä¸€ç›´åœ¨è¯»å–ä¸€ä¸ªè¿ç»­çš„æ•°æ®æµã€‚<br>å®¢æˆ·ç«¯ä»æµä¸­è¯»å–æ•°æ®æ—¶ï¼Œå—æ˜¯æŒ‰ç…§æ‰“å¼€ <code>DFSInputStream</code> ä¸ <code>datanode</code> æ–°å»ºè¿æ¥çš„é¡ºåºè¯»å–çš„ï¼ŒåŒæ—¶ä¹Ÿä¼šæ ¹æ®éœ€è¦è¯¢é—® <code>namenode</code> æ¥æ£€ç´¢ä¸‹ä¸€æ‰¹æ•°æ®å—çš„ <code>datanode</code> çš„ä½ç½®ã€‚</p></li><li><p><code>close</code><br>ä¸€æ—¦å®¢æˆ·ç«¯è¯»å–æ•°æ®å®Œæˆï¼Œ<code>FSDataInputStream</code> å°±ä¼šè°ƒç”¨ <code>close()</code> æ–¹æ³•ã€‚</p></li></ol><p><small>å…³äºè·ç¦»å®¢æˆ·ç«¯æœ€è¿‘çš„ <code>datanode</code> çš„<strong>ç½‘ç»œæ‹“æ‰‘</strong>å¯ä»¥è‡ªè¡Œäº†è§£ã€‚</small></p><h4 id="å‰–æå†™å…¥"><a href="#å‰–æå†™å…¥" class="headerlink" title="å‰–æå†™å…¥"></a>å‰–æå†™å…¥</h4><p>ä¸‹å›¾å±•ç¤ºæ–‡ä»¶æ˜¯å¦‚ä½•å†™å…¥ <code>HDFS</code><br><img src="https://s2.loli.net/2023/02/14/moECnxvVA2uWPpq.png" alt="hadoop_1_5.jpg"></p><ol><li><p><code>create</code><br>å®¢æˆ·ç«¯é€šè¿‡å¯¹ <code>DistributedFileSystem</code> å¯¹è±¡è°ƒç”¨ <code>create()</code> æ–¹æ³•æ¥æ–°å»ºæ–‡ä»¶ã€‚</p></li><li><p><code>create</code><br><code>DistributedFileSystem</code> å¯¹è±¡å¯¹ <code>namenode</code> å‘èµ·ä¸€ä¸ª <code>RPC</code> è°ƒç”¨ï¼Œåœ¨æ–‡ä»¶ç³»ç»Ÿçš„å‘½åç©ºé—´ä¸­æ–°å»ºä¸€ä¸ªç©ºæ–‡ä»¶ï¼ˆè¿˜æ²¡æœ‰ç›¸åº”çš„æ•°æ®å—ï¼‰ï¼Œ<code>namenode</code> åœ¨æ”¶åˆ°è¯·æ±‚åå¼€å§‹æ‰§è¡Œå„ç§ä¸åŒçš„æ£€æŸ¥ä»¥ç¡®ä¿è¯¥æ–‡ä»¶ä¸å­˜åœ¨ä¸”å®¢æˆ·ç«¯æœ‰åˆ›å»ºè¯¥æ–‡ä»¶çš„æƒé™ã€‚æ¥ç€ <code>DistributedFileSystem</code> å‘å®¢æˆ·ç«¯è¿”å›ä¸€ä¸ª <strong><code>FSDataOutputStream</code></strong> å¯¹è±¡ï¼Œç„¶åå®¢æˆ·ç«¯å¼€å§‹å†™å…¥æ•°æ®ã€‚<br><code>FSDataOutputStream</code> å†…éƒ¨å°è£…äº†ä¸€ä¸ª <code>DFSOutputStream</code> å¯¹è±¡ï¼Œè¯¥å¯¹è±¡è´Ÿè´£å¤„ç† <code>datanode</code> å’Œ <code>namenode</code> ä¹‹é—´çš„é€šä¿¡ã€‚</p></li><li><p><code>write</code><br>åœ¨å®¢æˆ·ç«¯å†™å…¥æ•°æ®æ—¶ï¼Œ<code>DFSOutputStream</code> å°†å®ƒåˆ†æˆä¸€ä¸ªä¸ªçš„æ•°æ®åŒ…ï¼Œå¹¶å†™å…¥å†…éƒ¨é˜Ÿåˆ—ï¼Œç§°ä¸º<strong>æ•°æ®é˜Ÿåˆ—ï¼ˆ<code>data queue</code>ï¼‰</strong>ã€‚</p></li><li><p><code>write packet</code><br><code>DataStreamer</code> å¤„ç†æ•°æ®é˜Ÿåˆ—ï¼ŒæŒ‘é€‰å‡ºé€‚åˆå­˜å‚¨æ•°æ®å‰¯æœ¬çš„ä¸€ç»„ <code>datanode</code>ï¼Œå¹¶æ®æ­¤æ¥<strong>è¦æ±‚ <code>namenode</code> åˆ†é…æ–°çš„æ•°æ®å—</strong>ï¼›ä¸€ç»„ <code>datanode</code> ç»„æˆä¸€ä¸ªç®¡çº¿ï¼Œ<code>DataStreamer</code> å°†æ•°æ®åŒ…ä»¥æµå¼ä¼ è¾“åˆ°ç®¡çº¿ä¸­ç¬¬ä¸€ä¸ª <code>datanode</code>ï¼Œè¯¥ <code>datanode</code> å­˜å‚¨æ•°æ®åŒ…å¹¶å°†å®ƒå‘é€åˆ°ä¸‹ä¸€ä¸ªç®¡çº¿ä¸­ï¼Œä»¥æ­¤ç±»æ¨çŸ¥é“ <code>datanode</code> æ•°é‡è¾¾åˆ°è®¾ç½®çš„å¤æœ¬æ•°é‡ã€‚</p></li><li><p><code>ack packet</code><br><code>DFSOutputStream</code> å†…éƒ¨ä¹Ÿç»´æŠ¤ç€ä¸€ä¸ªå†…éƒ¨æ•°æ®åŒ…é˜Ÿåˆ—æ¥ç­‰å¾… <code>datanode</code> çš„æ”¶åˆ°ç¡®è®¤å›æ‰§ï¼Œç§°ä¸º<strong>ç¡®è®¤é˜Ÿåˆ—ï¼ˆ<code>ack queue</code>ï¼‰</strong>ã€‚æ”¶åˆ°ç®¡é“ä¸­æ‰€æœ‰ <code>datanode</code> ç¡®è®¤ä¿¡æ¯åï¼Œè¯¥æ•°æ®åŒ…æ‰ä¼šä»ç¡®è®¤é˜Ÿåˆ—ä¸­è¢«åˆ é™¤ã€‚</p></li><li><p><code>close</code><br>å®¢æˆ·ç«¯å®Œæˆæ•°æ®çš„å†™å…¥åï¼Œå¯¹æ•°æ®æµè°ƒç”¨ <code>close()</code> æ–¹æ³•ã€‚</p></li><li><p><code>complete</code><br>è¯¥æ“ä½œå°†å‰©ä½™çš„æ‰€æœ‰æ•°æ®åŒ…å†™å…¥ <code>datanode</code> ç®¡çº¿ï¼Œå¹¶åœ¨è”ç³»åˆ° <code>namenode</code> å‘ŠçŸ¥å…¶æ–‡ä»¶å†™å…¥å®Œæˆä¹‹å‰ç­‰å¾…ç¡®è®¤ã€‚<code>namenode</code> æ­¤æ—¶å·²çŸ¥å†™å…¥æ–‡ä»¶æœ‰å“ªäº›å—ç»„æˆï¼ˆ<code>DataStreamer</code> è¯·æ±‚åˆ†é…æ•°æ®å—ï¼‰ï¼Œå› æ­¤æœ€ç»ˆåªéœ€è¦ç­‰å¾…æ•°æ®å—å®Œæˆæœ€å°é‡çš„å¤åˆ¶å°±ä¼šè¿”å›æˆåŠŸã€‚</p></li></ol><h4 id="ä¸€è‡´æ¨¡å‹"><a href="#ä¸€è‡´æ¨¡å‹" class="headerlink" title="ä¸€è‡´æ¨¡å‹"></a>ä¸€è‡´æ¨¡å‹</h4><p>æ–‡ä»¶ç³»ç»Ÿçš„<strong>ä¸€è‡´æ¨¡å‹ï¼ˆ<code>coherency mode</code>ï¼‰</strong>æè¿°äº†<strong>æ–‡ä»¶è¯»&#x2F;å†™çš„æ•°æ®å¯è§æ€§</strong>ã€‚<code>HDFS</code> ä¸ºäº†æ»¡è¶³æ€§èƒ½ç‰ºç‰²äº†ä¸€äº› <code>POSIX</code> è¦æ±‚ï¼Œå…·ä½“å¦‚ä¸‹ï¼š</p><ul><li>æ–°å»ºæ–‡ä»¶åèƒ½ç«‹å³åœ¨æ–‡ä»¶ç³»ç»Ÿçš„<strong>å‘½åç©ºé—´ä¸­å¯è§</strong>ï¼Œä½†æ˜¯å†™å…¥<strong>æ–‡ä»¶çš„å†…å®¹å¹¶ä¸èƒ½ç«‹å³å¯è§</strong>ã€‚</li><li>å½“å†™å…¥çš„æ•°æ®è¶…è¿‡ä¸€ä¸ªå—åï¼Œç¬¬ä¸€ä¸ª<strong>æ•°æ®å—å¯¹äºæ–°çš„ <code>reader</code> æ˜¯å¯è§çš„ï¼Œæ€»ä¹‹å½“å‰æ­£åœ¨å†™å…¥çš„å—å¯¹äºå…¶ä»– <code>reader</code> ä¸å¯è§</strong>ã€‚</li><li><code>HDFS</code> ä¸­çš„ <code>FSDataOutputStream</code> ç±»ä½¿ç”¨ <strong><code>hflush()</code> æ–¹æ³•å¯ä»¥å°†æ‰€æœ‰ç¼“å­˜åˆ·æ–°åˆ° <code>datanode</code> ä¸­</strong>ï¼›<code>hflush()</code> æ–¹æ³•æ‰§è¡ŒæˆåŠŸåï¼Œå¯¹äºæ‰€æœ‰æ–°çš„ <code>reader</code> è€Œè¨€ï¼Œ<code>HDFS</code> å¯ä»¥ä¿è¯ç›®å‰å·²å†™å…¥åˆ°æ–‡ä»¶ä¸­çš„æ•°æ®å‡åˆ°è¾¾ <code>datanode</code> çš„ç®¡é“ä¸”å¯¹æ‰€æœ‰çš„ <code>reader</code> éƒ½æ˜¯å¯è§çš„ã€‚</li><li>æ³¨æ„ <code>hflush()</code> æ–¹æ³•ä¸èƒ½ä¿è¯ <code>datanode</code> å·²ç»å°†æ•°æ®å†™åˆ°ç£ç›˜ä¸Šï¼Œä»…ç¡®ä¿æ•°æ®ä¿å­˜åœ¨ <code>datanode</code> çš„å†…å­˜ä¸­ã€‚ <strong><code>hsync()</code> æ–¹æ³•å¯ä»¥ç¡®ä¿å°†æ•°æ®å†™å…¥åˆ°ç£ç›˜</strong>ä¸Šï¼Œç±»ä¼¼äº <code>POSIX</code> ä¸­çš„ <code>fsync()</code> ç³»ç»Ÿè°ƒç”¨ã€‚</li></ul><p><small>å…³äºåœ¨ä½•æ—¶è°ƒç”¨ <code>hflush()</code> å’Œ <code>hsync()</code> éœ€è¦åœ¨åº”ç”¨ç¨‹åºå’Œæ€§èƒ½ä¹‹é—´åšå¹³è¡¡ï¼Œé€‰æ‹©æœ€åˆé€‚çš„è°ƒç”¨é¢‘ç‡ã€‚</small></p><hr><h3 id="å¼•ç”¨"><a href="#å¼•ç”¨" class="headerlink" title="å¼•ç”¨"></a>å¼•ç”¨</h3><p><a href="https://blog.vgbhfive.cn/Hadoop-%E5%9F%BA%E7%A1%80/">Hadoop-åŸºç¡€</a><br><a href="https://www.cnblogs.com/jagel-95/p/10945317.html">Hadoopæºç”Ÿå®ç”¨å·¥å…·ä¹‹distcp</a><br><a href="https://www.cnblogs.com/chengmo/archive/2010/10/17/1853344.html">Unix bash shell</a></p><hr><h3 id="ä¸ªäººå¤‡æ³¨"><a href="#ä¸ªäººå¤‡æ³¨" class="headerlink" title="ä¸ªäººå¤‡æ³¨"></a>ä¸ªäººå¤‡æ³¨</h3><p><strong>æ­¤åšå®¢å†…å®¹å‡ä¸ºä½œè€…å­¦ä¹ æ‰€åšç¬”è®°ï¼Œä¾µåˆ ï¼</strong><br><strong>è‹¥è½¬ä½œå…¶ä»–ç”¨é€”ï¼Œè¯·æ³¨æ˜æ¥æºï¼</strong></p>]]></content>
    
    
    <summary type="html">&lt;h3 id=&quot;HDFS&quot;&gt;&lt;a href=&quot;#HDFS&quot; class=&quot;headerlink&quot; title=&quot;HDFS&quot;&gt;&lt;/a&gt;&lt;code&gt;HDFS&lt;/code&gt;&lt;/h3&gt;&lt;p&gt;å½“æ•°æ®é›†çš„å¤§å°è¶…è¿‡ä¸€å°è®¡ç®—æœºçš„å­˜å‚¨ä¸Šé™æ—¶ï¼Œå°±æœ‰å¿…è¦å¯¹æ•°æ®è¿›è¡Œåˆ†åŒºç„¶åå­˜å‚¨åˆ°å…¶ä»–çš„è®¡ç®—æœºä¸Šã€‚ç®¡ç†ç½‘ç»œä¸­è·¨å¤šå°è®¡ç®—æœºå­˜å‚¨çš„æ–‡ä»¶ç³»ç»Ÿè¢«ç§°ä¸º&lt;strong&gt;åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿï¼ˆ&lt;code&gt;distributed filesystem&lt;/code&gt;ï¼‰&lt;/strong&gt;ï¼Œè¯¥æ¶æ„äºç½‘ç»œä¹‹ä¸Šï¼ŒåŠ¿å¿…ä¼šå¼•èµ·ç½‘ç»œç¼–ç¨‹çš„å¤æ‚æ€§ï¼Œå› æ­¤åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿæ¯”æ™®é€šç£ç›˜æ–‡ä»¶ç³»ç»Ÿæ›´ä¸ºå¤æ‚ã€‚&lt;br&gt;&lt;code&gt;Hadoop&lt;/code&gt; è‡ªå¸¦ä¸€ä¸ªç§°ä¸º &lt;code&gt;HDFS&lt;/code&gt; çš„åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿï¼Œä¹Ÿæ˜¯ &lt;code&gt;Hadoop&lt;/code&gt; çš„æ——èˆ°çº§æ–‡ä»¶ç³»ç»Ÿï¼Œå³ &lt;code&gt;Hadoop Distributed Filesystem&lt;/code&gt;ã€‚&lt;/p&gt;</summary>
    
    
    
    
    <category term="Hadoop" scheme="https://blog.vgbhfive.cn/tags/Hadoop/"/>
    
  </entry>
  
</feed>
